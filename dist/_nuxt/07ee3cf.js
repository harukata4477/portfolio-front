(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{694:function(t,e,n){(function(e){!function(){var n;function o(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}}function r(a){var b="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return b?b.call(a):{next:o(a)}}function h(a){for(var b,t=[];!(b=a.next()).done;)t.push(b.value);return t}var l,c="function"==typeof Object.create?Object.create:function(a){function b(){}return b.prototype=a,new b};if("function"==typeof Object.setPrototypeOf)l=Object.setPrototypeOf;else{var f;t:{var d={};try{d.__proto__={a:!0},f=d.a;break t}catch(t){}f=!1}l=f?function(a,b){if(a.__proto__=b,a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null}var y=l;function m(a,b){if(a.prototype=c(b.prototype),a.prototype.constructor=a,y)y(a,b);else for(var t in b)if("prototype"!=t)if(Object.defineProperties){var e=Object.getOwnPropertyDescriptor(b,t);e&&Object.defineProperty(a,t,e)}else a[t]=b[t];a.zB=b.prototype}var v="undefined"!=typeof window&&window===self?self:void 0!==e&&null!=e?e:self,x="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,t){a!=Array.prototype&&a!=Object.prototype&&(a[b]=t.value)};!function(a){if(a){for(var b=v,t=["Array","prototype","fill"],e=0;e<t.length-1;e++){var n=t[e];n in b||(b[n]={}),b=b[n]}(a=a(e=b[t=t[t.length-1]]))!=e&&null!=a&&x(b,t,{writable:!0,value:a})}}((function(a){return a||function(a,t,e){var b=this.length||0;for(0>t&&(t=Math.max(0,b+t)),(null==e||e>b)&&(e=b),0>(e=Number(e))&&(e=Math.max(0,b+e)),t=Number(t||0);t<e;t++)this[t]=a;return this}}));var w="object"==typeof self&&self.self===self&&self||"object"==typeof e&&e.global===e&&e||"object"==typeof window&&window.window===window&&window||{};function k(){}function M(a,b){var t=-1;return function(){var e=this,n=arguments;-1!==t&&w.clearTimeout(t),t=S((function(){t=-1,a.apply(e,n)}),b)}}function S(a,b){return w.setTimeout(a,b)}function P(a){return w.document.createElement(a)}function N(a){throw Error(a)}function C(a,b){a="The object is frozen, so its properties cannot be set: "+a.toString(),void 0!==b&&(a+="  to value: "+b),N(a)}function T(a,b,t,e){t=null===t?"*":"string"==typeof t?t:"function"==typeof t&&"string"==typeof t.className?t.className:"",void 0!==e&&(t+="."+e),N(t+" is not in the range "+b+": "+a)}function L(a){w.console&&w.console.log(a)}function A(){w.console&&w.console.log("Warning: List/Map/Set constructors no longer take an argument that enforces type.Instead they take an optional collection of Values to add to the collection. See 2.0 changelog for details.")}function j(a){return"object"==typeof a&&null!==a}function D(a){return Array.isArray(a)||w.NodeList&&a instanceof w.NodeList||w.HTMLCollection&&a instanceof w.HTMLCollection}function O(a){return Array.prototype.slice.call(a)}function F(a,b,t){Array.isArray(a)?b>=a.length?a.push(t):a.splice(b,0,t):N("Cannot insert an object into an HTMLCollection or NodeList: "+t+" at "+b)}function B(a,b){Array.isArray(a)?b>=a.length?a.pop():a.splice(b,1):N("Cannot remove an object from an HTMLCollection or NodeList at "+b)}function I(){var a=$.pop();return void 0===a?[]:a}function R(a){a.length=0,$.push(a)}function E(a){if("function"==typeof a){if(a.className)return a.className;if(a.name)return a.name;var b=a.toString();if(""!==(b=b.substring(9,b.indexOf("(")).trim()))return a._className=b}else if(j(a)&&a.constructor)return E(a.constructor);return typeof a}function z(a){var b=a;return j(a)&&(a.text?b=a.text:a.name?b=a.name:void 0!==a.key?b=a.key:void 0!==a.id?b=a.id:a.constructor===Object&&(a.Text?b=a.Text:a.Name?b=a.Name:void 0!==a.Key?b=a.Key:void 0!==a.Id?b=a.Id:void 0!==a.ID&&(b=a.ID))),void 0===b?"undefined":null===b?"null":b.toString()}function V(a,b){if(a.hasOwnProperty(b))return!0;for(a=Object.getPrototypeOf(a);a&&a!==Function;){if(a.hasOwnProperty(b))return!0;var t=a.kB;if(t&&t[b])return!0;a=Object.getPrototypeOf(a)}return!1}function G(a,b,t){Object.defineProperty(Ge.prototype,a,{get:b,set:t})}function Y(){var a=Q;if(void 0===w.document)return a;if(0===a.length)for(var b=w.document.getElementsByTagName("canvas"),t=b.length,e=0;e<t;e++){var n=b[e];n.parentElement&&n.parentElement.B&&a.push(n.parentElement.B)}return a}function X(a){for(var b=[],t=0;256>t;t++)b["0123456789abcdef".charAt(t>>4)+"0123456789abcdef".charAt(15&t)]=String.fromCharCode(t);a.length%2&&(a="0"+a),t=[];for(var e=0,n=0;n<a.length;n+=2)t[e++]=b[a.substr(n,2)];for(a=""===(a=t.join(""))?"0":a,b=[],t=0;256>t;t++)b[t]=t;for(t=e=0;256>t;t++)e=(e+b[t]+119)%256,n=b[t],b[t]=b[e],b[e]=n;e=t=0;for(var o="",g=0;g<a.length;g++)e=(e+b[t=(t+1)%256])%256,n=b[t],b[t]=b[e],b[e]=n,o+=String.fromCharCode(a.charCodeAt(g)^b[(b[t]+b[e])%256]);return o}void 0===w.requestAnimationFrame&&(void 0===w.setImmediate?w.requestAnimationFrame=function(a){w.setTimeout(a,0)}:w.requestAnimationFrame=w.setImmediate);var U=void 0!==w.navigator&&0<w.navigator.userAgent.indexOf("MSIE 9.0"),K=void 0!==w.navigator&&0<w.navigator.userAgent.indexOf("MSIE 10.0"),H=void 0!==w.navigator&&0<w.navigator.userAgent.indexOf("Trident/7"),W=void 0!==w.navigator&&0<w.navigator.userAgent.indexOf("Edge/"),J=void 0!==w.navigator&&void 0!==w.navigator.platform&&0<=w.navigator.platform.toUpperCase().indexOf("MAC"),Z=void 0!==w.navigator&&void 0!==w.navigator.platform&&null!==w.navigator.platform.match(/(iPhone|iPod|iPad)/i),$=[];Object.freeze([]);var Q=[];function _(a,b,t){pt(this),this.l=a,this.Qa=b,this.v=t}function tt(a,b){return null==b||""===b?null:a[b]}function it(){this.qx=[]}function et(){}k.className="Util",k.Dx="32ab5ff3b26f42dc0ed90f21452913b5",k.adym="gojs.net",k.vfo="28e647fdb06f",k.className="Util",_.prototype.toString=function(){return"EnumValue."+this.Qa},v.Object.defineProperties(_.prototype,{classType:{get:function(){return this.l}},name:{get:function(){return this.Qa}},value:{get:function(){return this.v}}}),_.className="EnumValue",it.prototype.toString=function(){return this.qx.join("")},it.prototype.add=function(a){""!==a&&this.qx.push(a)},it.className="StringBuilder",et.className="PropertyCollection";var nt={mB:!1,rB:!1,oB:!1,qB:!1,wB:!1,uB:!1,ny:!1,nB:null,trace:function(a){w.console&&w.console.log(a)},pB:function(a,b,t,e){a.strokeStyle="red",a.fillStyle="red",a.font="8px sans-serif",a.beginPath(),a.moveTo(-10,0),a.lineTo(10,0),a.moveTo(0,-10),a.lineTo(0,10),a.stroke(),a.setTransform(1,0,0,1,0,0),a.scale(t,t),a.transform(b.m11,b.m12,b.m21,b.m22,b.dx,b.dy),a.lineWidth=2,a.beginPath(),a.moveTo(e.left,e.top+20),a.lineTo(e.left,e.top),a.lineTo(e.left+20,e.top),a.moveTo(e.right,e.bottom-20),a.lineTo(e.right,e.bottom),a.lineTo(e.right-20,e.bottom),a.stroke(),a.fillText("DB: "+Math.round(e.x)+", "+Math.round(e.y)+", "+Math.round(e.width)+", "+Math.round(e.height),e.left,e.top-5)},lB:function(a){var t,b={};for(t in a){if(b.x=t,"licenseKey"!==b.x){var e=a[b.x];if(void 0!==e.prototype){b.Hm=Object.getOwnPropertyNames(e.prototype);for(var n={xk:0};n.xk<b.Hm.length;(n={xk:n.xk}).xk++){var o=Object.getOwnPropertyDescriptor(e.prototype,b.Hm[n.xk]);void 0!==o.get&&void 0===o.set&&Object.defineProperty(e.prototype,b.Hm[n.xk],{set:function(a,b){return function(){throw Error("Property "+a.Hm[b.xk]+" of "+a.x+" is read-only.")}}(b,n)})}}}b={Hm:b.Hm,x:b.x}}}};function ot(){}ot.prototype.reset=function(){},ot.prototype.next=function(){return!1},ot.prototype.sd=function(){return!1},ot.prototype.first=function(){return null},ot.prototype.any=function(){return!1},ot.prototype.all=function(){return!0},ot.prototype.each=function(){return this},ot.prototype.map=function(){return this},ot.prototype.filter=function(){return this},ot.prototype.Pd=function(){},ot.prototype.toString=function(){return"EmptyIterator"},v.Object.defineProperties(ot.prototype,{iterator:{get:function(){return this}},count:{get:function(){return 0}}}),ot.prototype.first=ot.prototype.first,ot.prototype.hasNext=ot.prototype.sd,ot.prototype.next=ot.prototype.next,ot.prototype.reset=ot.prototype.reset;var st;function at(a){this.key=-1,this.value=a}function ht(a){this.tb=a,this.gf=null,a.Ha=null,this.ia=a.Aa,this.Pa=-1}function lt(a){this.tb=a,a.gh=null,this.ia=a.Aa,this.Pa=a.j.length}function ut(a){pt(this),this.s=!1,this.j=[],this.Aa=0,this.gh=this.Ha=null,void 0!==a&&("function"==typeof a||"string"==typeof a?A():this.addAll(a))}function ct(a){this.vg=a,a.Ha=null,this.ia=a.Aa,this.ka=null}function ft(a){pt(this),this.s=!1,this.Ib={},this.Gb=0,this.Ha=null,this.Aa=0,this.af=this.ba=null,void 0!==a&&("function"==typeof a||"string"==typeof a?A():this.addAll(a))}function pt(a){a.__gohashid=mt++}function gt(a){var b=a.__gohashid;return void 0===b&&(b=mt++,a.__gohashid=b),b}function yt(a){return a.__gohashid}ot.className="EmptyIterator",st=new ot,at.prototype.reset=function(){this.key=-1},at.prototype.next=function(){return-1===this.key&&(this.key=0,!0)},at.prototype.sd=function(){return this.next()},at.prototype.first=function(){return this.key=0,this.value},at.prototype.any=function(a){return this.key=-1,a(this.value)},at.prototype.all=function(a){return this.key=-1,a(this.value)},at.prototype.each=function(a){return this.key=-1,a(this.value),this},at.prototype.map=function(a){return new at(a(this.value))},at.prototype.filter=function(a){return a(this.value)?new at(this.value):st},at.prototype.Pd=function(){this.value=null},at.prototype.toString=function(){return"SingletonIterator("+this.value+")"},v.Object.defineProperties(at.prototype,{iterator:{get:function(){return this}},count:{get:function(){return 1}}}),at.prototype.first=at.prototype.first,at.prototype.hasNext=at.prototype.sd,at.prototype.next=at.prototype.next,at.prototype.reset=at.prototype.reset,at.className="SingletonIterator",ht.prototype.reset=function(){var a=this.tb;a.Ha=null,this.ia=a.Aa,this.Pa=-1},ht.prototype.next=function(){var a=this.tb;if(a.Aa!==this.ia&&0>this.key)return!1;var b=(a=a.j).length,t=++this.Pa,e=this.gf;if(null!==e)for(;t<b;){var n=a[t];if(e(n))return this.key=this.Pa=t,this.value=n,!0;t++}else{if(t<b)return this.key=t,this.value=a[t],!0;this.Pd()}return!1},ht.prototype.sd=function(){return this.next()},ht.prototype.first=function(){var a=this.tb;this.ia=a.Aa,this.Pa=0;var b=(a=a.j).length,t=this.gf;if(null!==t){for(var e=0;e<b;){var n=a[e];if(t(n))return this.key=this.Pa=e,this.value=n;e++}return null}return 0<b?(a=a[0],this.key=0,this.value=a):null},ht.prototype.any=function(a){var b=this.tb;b.Ha=null,this.Pa=-1;for(var t=(b=b.j).length,e=this.gf,n=0;n<t;n++){var o=b[n];if((null===e||e(o))&&a(o))return!0}return!1},ht.prototype.all=function(a){var b=this.tb;b.Ha=null,this.Pa=-1;for(var t=(b=b.j).length,e=this.gf,n=0;n<t;n++){var o=b[n];if((null===e||e(o))&&!a(o))return!1}return!0},ht.prototype.each=function(a){var b=this.tb;b.Ha=null,this.Pa=-1;for(var t=(b=b.j).length,e=this.gf,n=0;n<t;n++){var o=b[n];(null===e||e(o))&&a(o)}return this},ht.prototype.map=function(a){var b=this.tb;b.Ha=null,this.Pa=-1;for(var t=[],e=(b=b.j).length,n=this.gf,o=0;o<e;o++){var g=b[o];(null===n||n(g))&&t.push(a(g))}return(a=new ut).j=t,a.ob(),a.iterator},ht.prototype.filter=function(a){var b=this.tb;b.Ha=null,this.Pa=-1;for(var t=[],e=(b=b.j).length,n=this.gf,o=0;o<e;o++){var g=b[o];(null===n||n(g))&&a(g)&&t.push(g)}return(a=new ut).j=t,a.ob(),a.iterator},ht.prototype.Pd=function(){this.key=-1,this.value=null,this.ia=-1,this.gf=null,this.tb.Ha=this},ht.prototype.toString=function(){return"ListIterator@"+this.Pa+"/"+this.tb.count},v.Object.defineProperties(ht.prototype,{iterator:{get:function(){return this}},predicate:{get:function(){return this.gf},set:function(a){this.gf=a}},count:{get:function(){var a=this.gf;if(null!==a){for(var b=0,t=this.tb.j,e=t.length,n=0;n<e;n++)a(t[n])&&b++;return b}return this.tb.j.length}}}),ht.prototype.first=ht.prototype.first,ht.prototype.hasNext=ht.prototype.sd,ht.prototype.next=ht.prototype.next,ht.prototype.reset=ht.prototype.reset,ht.className="ListIterator",lt.prototype.reset=function(){var a=this.tb;a.gh=null,this.ia=a.Aa,this.Pa=a.j.length},lt.prototype.next=function(){var a=this.tb;if(a.Aa!==this.ia&&0>this.key)return!1;var b=--this.Pa;return 0<=b?(this.key=b,this.value=a.j[b],!0):(this.Pd(),!1)},lt.prototype.sd=function(){return this.next()},lt.prototype.first=function(){var a=this.tb;this.ia=a.Aa;var b=a.j;return this.Pa=a=b.length-1,0<=a?(b=b[a],this.key=a,this.value=b):null},lt.prototype.any=function(a){var b=this.tb;b.gh=null;var t=(b=b.j).length;for(this.Pa=t,--t;0<=t;t--)if(a(b[t]))return!0;return!1},lt.prototype.all=function(a){var b=this.tb;b.gh=null;var t=(b=b.j).length;for(this.Pa=t,--t;0<=t;t--)if(!a(b[t]))return!1;return!0},lt.prototype.each=function(a){var b=this.tb;b.gh=null;var t=(b=b.j).length;for(this.Pa=t,--t;0<=t;t--)a(b[t]);return this},lt.prototype.map=function(a){var b=this.tb;b.gh=null;var t=[],e=(b=b.j).length;for(this.Pa=e,--e;0<=e;e--)t.push(a(b[e]));return(a=new ut).j=t,a.ob(),a.iterator},lt.prototype.filter=function(a){var b=this.tb;b.gh=null;var t=[],e=(b=b.j).length;for(this.Pa=e,--e;0<=e;e--){var n=b[e];a(n)&&t.push(n)}return(a=new ut).j=t,a.ob(),a.iterator},lt.prototype.Pd=function(){this.key=-1,this.value=null,this.ia=-1,this.tb.gh=this},lt.prototype.toString=function(){return"ListIteratorBackwards("+this.Pa+"/"+this.tb.count+")"},v.Object.defineProperties(lt.prototype,{iterator:{get:function(){return this}},count:{get:function(){return this.tb.j.length}}}),lt.prototype.first=lt.prototype.first,lt.prototype.hasNext=lt.prototype.sd,lt.prototype.next=lt.prototype.next,lt.prototype.reset=lt.prototype.reset,lt.className="ListIteratorBackwards",(n=ut.prototype).ob=function(){var a=this.Aa;999999999<++a&&(a=0),this.Aa=a},n.freeze=function(){return this.s=!0,this},n.ea=function(){return this.s=!1,this},n.toString=function(){return"List()#"+yt(this)},n.add=function(a){return null===a||(this.s&&C(this,a),this.j.push(a),this.ob()),this},n.push=function(a){this.add(a)},n.addAll=function(a){if(null===a)return this;this.s&&C(this);var b=this.j;if(D(a))for(var t=a.length,e=0;e<t;e++)b.push(a[e]);else for(a=a.iterator;a.next();)b.push(a.value);return this.ob(),this},n.clear=function(){this.s&&C(this),this.j.length=0,this.ob()},n.contains=function(a){return null!==a&&-1!==this.j.indexOf(a)},n.has=function(a){return this.contains(a)},n.indexOf=function(a){return null===a?-1:this.j.indexOf(a)},n.J=function(a){var b=this.j;return(0>a||a>=b.length)&&T(a,"0 <= i < length",ut,"elt:i"),b[a]},n.get=function(a){return this.J(a)},n.Qc=function(a,b){var t=this.j;(0>a||a>=t.length)&&T(a,"0 <= i < length",ut,"setElt:i"),this.s&&C(this,a),t[a]=b},n.set=function(a,b){this.Qc(a,b)},n.first=function(){var a=this.j;return 0===a.length?null:a[0]},n.Xb=function(){var a=this.j,b=a.length;return 0<b?a[b-1]:null},n.pop=function(){this.s&&C(this);var a=this.j;return 0<a.length?a.pop():null},ut.prototype.any=function(a){for(var b=this.j,t=b.length,e=0;e<t;e++)if(a(b[e]))return!0;return!1},ut.prototype.all=function(a){for(var b=this.j,t=b.length,e=0;e<t;e++)if(!a(b[e]))return!1;return!0},ut.prototype.each=function(a){for(var b=this.j,t=b.length,e=0;e<t;e++)a(b[e]);return this},ut.prototype.map=function(a){for(var b=new ut,t=[],e=this.j,n=e.length,o=0;o<n;o++)t.push(a(e[o]));return b.j=t,b.ob(),b},ut.prototype.filter=function(a){for(var b=new ut,t=[],e=this.j,n=e.length,o=0;o<n;o++){var g=e[o];a(g)&&t.push(g)}return b.j=t,b.ob(),b},(n=ut.prototype).wb=function(a,b){0>a&&T(a,">= 0",ut,"insertAt:i"),this.s&&C(this,a);var t=this.j;a>=t.length?t.push(b):t.splice(a,0,b),this.ob()},n.remove=function(a){if(null===a)return!1;this.s&&C(this,a);var b=this.j;return-1!==(a=b.indexOf(a))&&(a===b.length-1?b.pop():b.splice(a,1),this.ob(),!0)},n.delete=function(a){return this.remove(a)},n.cb=function(a){var b=this.j;(0>a||a>=b.length)&&T(a,"0 <= i < length",ut,"removeAt:i"),this.s&&C(this,a),a===b.length-1?b.pop():b.splice(a,1),this.ob()},n.removeRange=function(a,b){var t=this.j,e=t.length;if(0>a)a=0;else if(a>=e)return this;if(0>b)return this;if(b>=e&&(b=e-1),a>b)return this;this.s&&C(this);for(var n=a,o=b+1;o<e;)t[n++]=t[o++];return t.length=e-(b-a+1),this.ob(),this},ut.prototype.copy=function(){var a=new ut,b=this.j;return 0<b.length&&(a.j=Array.prototype.slice.call(b)),a},(n=ut.prototype).ma=function(){for(var a=this.j,b=this.count,t=Array(b),e=0;e<b;e++)t[e]=a[e];return t},n.Lw=function(){for(var a=new ft,b=this.j,t=this.count,e=0;e<t;e++)a.add(b[e]);return a},n.sort=function(a){return this.s&&C(this),this.j.sort(a),this.ob(),this},n.tj=function(a,b,t){var e=this.j,n=e.length;void 0===b&&(b=0),void 0===t&&(t=n),this.s&&C(this);var o=t-b;if(1>=o)return this;if((0>b||b>=n-1)&&T(b,"0 <= from < length",ut,"sortRange:from"),2===o)return 0<a(t=e[b],n=e[b+1])&&(e[b]=n,e[b+1]=t,this.ob()),this;if(0===b)if(t>=n)e.sort(a);else for((b=e.slice(0,t)).sort(a),a=0;a<t;a++)e[a]=b[a];else if(t>=n)for((t=e.slice(b)).sort(a),a=b;a<n;a++)e[a]=t[a-b];else for((n=e.slice(b,t)).sort(a),a=b;a<t;a++)e[a]=n[a-b];return this.ob(),this},n.reverse=function(){return this.s&&C(this),this.j.reverse(),this.ob(),this},v.Object.defineProperties(ut.prototype,{_dataArray:{get:function(){return this.j}},count:{get:function(){return this.j.length}},size:{get:function(){return this.j.length}},length:{get:function(){return this.j.length}},iterator:{get:function(){if(0>=this.j.length)return st;var a=this.Ha;return null!==a?(a.reset(),a):new ht(this)}},iteratorBackwards:{get:function(){if(0>=this.j.length)return st;var a=this.gh;return null!==a?(a.reset(),a):new lt(this)}}}),ut.prototype.reverse=ut.prototype.reverse,ut.prototype.sortRange=ut.prototype.tj,ut.prototype.sort=ut.prototype.sort,ut.prototype.toSet=ut.prototype.Lw,ut.prototype.toArray=ut.prototype.ma,ut.prototype.removeRange=ut.prototype.removeRange,ut.prototype.removeAt=ut.prototype.cb,ut.prototype.delete=ut.prototype.delete,ut.prototype.remove=ut.prototype.remove,ut.prototype.insertAt=ut.prototype.wb,ut.prototype.pop=ut.prototype.pop,ut.prototype.last=ut.prototype.Xb,ut.prototype.first=ut.prototype.first,ut.prototype.set=ut.prototype.set,ut.prototype.setElt=ut.prototype.Qc,ut.prototype.get=ut.prototype.get,ut.prototype.elt=ut.prototype.J,ut.prototype.indexOf=ut.prototype.indexOf,ut.prototype.has=ut.prototype.has,ut.prototype.contains=ut.prototype.contains,ut.prototype.clear=ut.prototype.clear,ut.prototype.addAll=ut.prototype.addAll,ut.prototype.push=ut.prototype.push,ut.prototype.add=ut.prototype.add,ut.prototype.thaw=ut.prototype.ea,ut.prototype.freeze=ut.prototype.freeze,ut.className="List",ct.prototype.reset=function(){var a=this.vg;a.Ha=null,this.ia=a.Aa,this.ka=null},ct.prototype.next=function(){var a=this.vg;if(a.Aa!==this.ia&&null===this.key)return!1;var b=this.ka;return null!==(b=null===b?a.ba:b.oa)?(this.ka=b,this.value=b.value,this.key=b.key,!0):(this.Pd(),!1)},ct.prototype.sd=function(){return this.next()},ct.prototype.first=function(){var a=this.vg;if(this.ia=a.Aa,null!==(a=a.ba)){this.ka=a;var b=a.value;return this.key=a.key,this.value=b}return null},ct.prototype.any=function(a){var b=this.vg;for(this.ka=b.Ha=null,b=b.ba;null!==b;){if(a(b.value))return!0;b=b.oa}return!1},ct.prototype.all=function(a){var b=this.vg;for(this.ka=b.Ha=null,b=b.ba;null!==b;){if(!a(b.value))return!1;b=b.oa}return!0},ct.prototype.each=function(a){var b=this.vg;for(this.ka=b.Ha=null,b=b.ba;null!==b;)a(b.value),b=b.oa;return this},ct.prototype.map=function(a){var b=this.vg;b.Ha=null;var t=new ut;for(b=b.ba;null!==b;)t.add(a(b.value)),b=b.oa;return t.iterator},ct.prototype.filter=function(a){var b=this.vg;b.Ha=null;var t=new ut;for(b=b.ba;null!==b;){var e=b.value;a(e)&&t.add(e),b=b.oa}return t.iterator},ct.prototype.Pd=function(){this.value=this.key=null,this.ia=-1,this.vg.Ha=this},ct.prototype.toString=function(){return null!==this.ka?"SetIterator@"+this.ka.value:"SetIterator"},v.Object.defineProperties(ct.prototype,{iterator:{get:function(){return this}},count:{get:function(){return this.vg.Gb}}}),ct.prototype.first=ct.prototype.first,ct.prototype.hasNext=ct.prototype.sd,ct.prototype.next=ct.prototype.next,ct.prototype.reset=ct.prototype.reset,ct.className="SetIterator",(n=ft.prototype).ob=function(){var a=this.Aa;999999999<++a&&(a=0),this.Aa=a},n.freeze=function(){return this.s=!0,this},n.ea=function(){return this.s=!1,this},n.toString=function(){return"Set()#"+yt(this)},n.add=function(a){if(null===a)return this;this.s&&C(this,a);var b=a;return j(a)&&(b=gt(a)),void 0===this.Ib[b]&&(this.Gb++,a=new wt(a,a),this.Ib[b]=a,null===(b=this.af)?this.ba=a:(a.Vl=b,b.oa=a),this.af=a,this.ob()),this},n.addAll=function(a){if(null===a)return this;if(this.s&&C(this),D(a))for(var b=a.length,t=0;t<b;t++)this.add(a[t]);else for(a=a.iterator;a.next();)this.add(a.value);return this},n.contains=function(a){if(null===a)return!1;var b=a;return(!j(a)||void 0!==(b=yt(a)))&&void 0!==this.Ib[b]},n.has=function(a){return this.contains(a)},n.Ez=function(a){if(null===a)return!0;for(a=a.iterator;a.next();)if(!this.contains(a.value))return!1;return!0},n.Fz=function(a){if(null===a)return!0;for(a=a.iterator;a.next();)if(this.contains(a.value))return!0;return!1},n.first=function(){var a=this.ba;return null===a?null:a.value},ft.prototype.any=function(a){for(var b=this.ba;null!==b;){if(a(b.value))return!0;b=b.oa}return!1},ft.prototype.all=function(a){for(var b=this.ba;null!==b;){if(!a(b.value))return!1;b=b.oa}return!0},ft.prototype.each=function(a){for(var b=this.ba;null!==b;)a(b.value),b=b.oa;return this},ft.prototype.map=function(a){for(var b=new ft,t=this.ba;null!==t;)b.add(a(t.value)),t=t.oa;return b},ft.prototype.filter=function(a){for(var b=new ft,t=this.ba;null!==t;){var e=t.value;a(e)&&b.add(e),t=t.oa}return b},(n=ft.prototype).remove=function(a){if(null===a)return!1;this.s&&C(this,a);var b=a;if(j(a)&&void 0===(b=yt(a)))return!1;if(void 0===(a=this.Ib[b]))return!1;var t=a.oa,e=a.Vl;return null!==t&&(t.Vl=e),null!==e&&(e.oa=t),this.ba===a&&(this.ba=t),this.af===a&&(this.af=e),delete this.Ib[b],this.Gb--,this.ob(),!0},n.delete=function(a){return this.remove(a)},n.Yq=function(a){if(null===a)return this;if(this.s&&C(this),D(a))for(var b=a.length,t=0;t<b;t++)this.remove(a[t]);else for(a=a.iterator;a.next();)this.remove(a.value);return this},n.VA=function(a){if(null===a||0===this.count)return this;this.s&&C(this);var b=new ft;b.addAll(a),a=[];for(var t=this.iterator;t.next();){var e=t.value;b.contains(e)||a.push(e)}return this.Yq(a),this},n.clear=function(){this.s&&C(this),this.Ib={},this.Gb=0,null!==this.Ha&&this.Ha.reset(),this.af=this.ba=null,this.ob()},ft.prototype.copy=function(){var t,a=new ft,b=this.Ib;for(t in b)a.add(b[t].value);return a},ft.prototype.ma=function(){var t,a=Array(this.Gb),b=this.Ib,e=0;for(t in b)a[e]=b[t].value,e++;return a},ft.prototype.Kw=function(){var t,a=new ut,b=this.Ib;for(t in b)a.add(b[t].value);return a},v.Object.defineProperties(ft.prototype,{count:{get:function(){return this.Gb}},size:{get:function(){return this.Gb}},iterator:{get:function(){if(0>=this.Gb)return st;var a=this.Ha;return null!==a?(a.reset(),a):new ct(this)}}}),ft.prototype.toList=ft.prototype.Kw,ft.prototype.toArray=ft.prototype.ma,ft.prototype.clear=ft.prototype.clear,ft.prototype.retainAll=ft.prototype.VA,ft.prototype.removeAll=ft.prototype.Yq,ft.prototype.delete=ft.prototype.delete,ft.prototype.remove=ft.prototype.remove,ft.prototype.first=ft.prototype.first,ft.prototype.containsAny=ft.prototype.Fz,ft.prototype.containsAll=ft.prototype.Ez,ft.prototype.has=ft.prototype.has,ft.prototype.contains=ft.prototype.contains,ft.prototype.addAll=ft.prototype.addAll,ft.prototype.add=ft.prototype.add,ft.prototype.thaw=ft.prototype.ea,ft.prototype.freeze=ft.prototype.freeze;var mt=1;function vt(a){this.ga=a,this.ia=a.Aa,this.ka=null}function xt(a){ft.call(this),pt(this),this.s=!0,this.ga=a}function bt(a){this.ga=a,a.$e=null,this.ia=a.Aa,this.ka=null}function wt(a,b){this.key=a,this.value=b,this.Vl=this.oa=null}function kt(a){this.ga=a,a.Ha=null,this.ia=a.Aa,this.ka=null}function Mt(a){pt(this),this.s=!1,this.Ib={},this.Gb=0,this.$e=this.Ha=null,this.Aa=0,this.af=this.ba=null,void 0!==a&&("function"==typeof a||"string"==typeof a?A():this.addAll(a))}function St(a,b){void 0===a?this.y=this.x=0:"number"==typeof a&&"number"==typeof b?(this.x=a,this.y=b):N("Invalid arguments to Point constructor: "+a+", "+b),this.s=!1}function Pt(a){if("string"==typeof a){a=a.split(" ");for(var b=0,t=0;""===a[b];)b++;var e=a[b++];e&&(t=parseFloat(e));for(var n=0;""===a[b];)b++;return(e=a[b++])&&(n=parseFloat(e)),new St(t,n)}return new St}function Nt(a){return a.x.toString()+" "+a.y.toString()}function Ct(a,b){if(0===a)return 0<b?90:0>b?270:0;if(0===b)return 0<a?0:180;if(isNaN(a)||isNaN(b))return 0;var t=180*Math.atan(Math.abs(b/a))/Math.PI;return 0>a?t=0>b?t+180:180-t:0>b&&(t=360-t),t}function Tt(a,b){return b.Gd(a),a}function Lt(a,b,t,e,n,o){var g=n-t,r=o-e,h=g*g+r*r,l=-(t-=a)*g-(e-=b)*r;return 0>=l||l>=h?(g=n-a,r=o-b,Math.min(t*t+e*e,g*g+r*r)):(a=g*e-r*t)*a/h}function At(a,b,t,e){return(a=t-a)*a+(b=e-b)*b}function jt(a,b,t,e){return b=e-b,0===(a=t-a)?0<b?90:0>b?270:0:0===b?0<a?0:180:isNaN(a)||isNaN(b)?0:(e=180*Math.atan(Math.abs(b/a))/Math.PI,0>a?e=0>b?e+180:180-e:0>b&&(e=360-e),e)}ft.className="Set",ft.uniqueHash=pt,ft.hashIdUnique=gt,ft.hashId=yt,vt.prototype.reset=function(){this.ia=this.ga.Aa,this.ka=null},vt.prototype.next=function(){var a=this.ga;if(a.Aa!==this.ia&&null===this.key)return!1;var b=this.ka;return null!==(b=null===b?a.ba:b.oa)?(this.ka=b,this.value=this.key=a=b.key,!0):(this.Pd(),!1)},vt.prototype.sd=function(){return this.next()},vt.prototype.first=function(){var a=this.ga;return this.ia=a.Aa,null!==(a=a.ba)?(this.ka=a,this.value=this.key=a=a.key):null},vt.prototype.any=function(a){var b=this.ga;for(this.ka=null,b=b.ba;null!==b;){if(a(b.key))return!0;b=b.oa}return!1},vt.prototype.all=function(a){var b=this.ga;for(this.ka=null,b=b.ba;null!==b;){if(!a(b.key))return!1;b=b.oa}return!0},vt.prototype.each=function(a){var b=this.ga;for(this.ka=null,b=b.ba;null!==b;)a(b.key),b=b.oa;return this},vt.prototype.map=function(a){var b=this.ga;this.ka=null;var t=new ut;for(b=b.ba;null!==b;)t.add(a(b.key)),b=b.oa;return t.iterator},vt.prototype.filter=function(a){var b=this.ga;this.ka=null;var t=new ut;for(b=b.ba;null!==b;){var e=b.key;a(e)&&t.add(e),b=b.oa}return t.iterator},vt.prototype.Pd=function(){this.value=this.key=null,this.ia=-1},vt.prototype.toString=function(){return null!==this.ka?"MapKeySetIterator@"+this.ka.value:"MapKeySetIterator"},v.Object.defineProperties(vt.prototype,{iterator:{get:function(){return this}},count:{get:function(){return this.ga.Gb}}}),vt.prototype.first=vt.prototype.first,vt.prototype.hasNext=vt.prototype.sd,vt.prototype.next=vt.prototype.next,vt.prototype.reset=vt.prototype.reset,vt.className="MapKeySetIterator",m(xt,ft),(n=xt.prototype).freeze=function(){return this},n.ea=function(){return this},n.toString=function(){return"MapKeySet("+this.ga.toString()+")"},n.add=function(){return N("This Set is read-only: "+this.toString()),this},n.contains=function(a){return this.ga.contains(a)},n.has=function(a){return this.contains(a)},n.remove=function(){return N("This Set is read-only: "+this.toString()),!1},n.delete=function(a){return this.remove(a)},n.clear=function(){N("This Set is read-only: "+this.toString())},n.first=function(){var a=this.ga.ba;return null!==a?a.key:null},xt.prototype.any=function(a){for(var b=this.ga.ba;null!==b;){if(a(b.key))return!0;b=b.oa}return!1},xt.prototype.all=function(a){for(var b=this.ga.ba;null!==b;){if(!a(b.key))return!1;b=b.oa}return!0},xt.prototype.each=function(a){for(var b=this.ga.ba;null!==b;)a(b.key),b=b.oa;return this},xt.prototype.map=function(a){for(var b=new ft,t=this.ga.ba;null!==t;)b.add(a(t.key)),t=t.oa;return b},xt.prototype.filter=function(a){for(var b=new ft,t=this.ga.ba;null!==t;){var e=t.key;a(e)&&b.add(e),t=t.oa}return b},xt.prototype.copy=function(){return new xt(this.ga)},xt.prototype.Lw=function(){var t,a=new ft,b=this.ga.Ib;for(t in b)a.add(b[t].key);return a},xt.prototype.ma=function(){var t,a=this.ga.Ib,b=Array(this.ga.Gb),e=0;for(t in a)b[e]=a[t].key,e++;return b},xt.prototype.Kw=function(){var t,a=new ut,b=this.ga.Ib;for(t in b)a.add(b[t].key);return a},v.Object.defineProperties(xt.prototype,{count:{get:function(){return this.ga.Gb}},size:{get:function(){return this.ga.Gb}},iterator:{get:function(){return 0>=this.ga.Gb?st:new vt(this.ga)}}}),xt.prototype.toList=xt.prototype.Kw,xt.prototype.toArray=xt.prototype.ma,xt.prototype.toSet=xt.prototype.Lw,xt.prototype.first=xt.prototype.first,xt.prototype.clear=xt.prototype.clear,xt.prototype.delete=xt.prototype.delete,xt.prototype.remove=xt.prototype.remove,xt.prototype.has=xt.prototype.has,xt.prototype.contains=xt.prototype.contains,xt.prototype.add=xt.prototype.add,xt.prototype.thaw=xt.prototype.ea,xt.prototype.freeze=xt.prototype.freeze,xt.className="MapKeySet",bt.prototype.reset=function(){var a=this.ga;a.$e=null,this.ia=a.Aa,this.ka=null},bt.prototype.next=function(){var a=this.ga;if(a.Aa!==this.ia&&null===this.key)return!1;var b=this.ka;return null!==(b=null===b?a.ba:b.oa)?(this.ka=b,this.value=b.value,this.key=b.key,!0):(this.Pd(),!1)},bt.prototype.sd=function(){return this.next()},bt.prototype.first=function(){var a=this.ga;if(this.ia=a.Aa,null!==(a=a.ba)){this.ka=a;var b=a.value;return this.key=a.key,this.value=b}return null},bt.prototype.any=function(a){var b=this.ga;for(this.ka=b.$e=null,b=b.ba;null!==b;){if(a(b.value))return!0;b=b.oa}return!1},bt.prototype.all=function(a){var b=this.ga;for(this.ka=b.$e=null,b=b.ba;null!==b;){if(!a(b.value))return!1;b=b.oa}return!0},bt.prototype.each=function(a){var b=this.ga;for(this.ka=b.$e=null,b=b.ba;null!==b;)a(b.value),b=b.oa;return this},bt.prototype.map=function(a){var b=this.ga;this.ka=b.$e=null;var t=new ut;for(b=b.ba;null!==b;)t.add(a(b.value)),b=b.oa;return t.iterator},bt.prototype.filter=function(a){var b=this.ga;this.ka=b.$e=null;var t=new ut;for(b=b.ba;null!==b;){var e=b.value;a(e)&&t.add(e),b=b.oa}return t.iterator},bt.prototype.Pd=function(){this.value=this.key=null,this.ia=-1,this.ga.$e=this},bt.prototype.toString=function(){return null!==this.ka?"MapValueSetIterator@"+this.ka.value:"MapValueSetIterator"},v.Object.defineProperties(bt.prototype,{iterator:{get:function(){return this}},count:{get:function(){return this.ga.Gb}}}),bt.prototype.first=bt.prototype.first,bt.prototype.hasNext=bt.prototype.sd,bt.prototype.next=bt.prototype.next,bt.prototype.reset=bt.prototype.reset,bt.className="MapValueSetIterator",wt.prototype.toString=function(){return"{"+this.key+":"+this.value+"}"},wt.className="KeyValuePair",kt.prototype.reset=function(){var a=this.ga;a.Ha=null,this.ia=a.Aa,this.ka=null},kt.prototype.next=function(){var a=this.ga;if(a.Aa!==this.ia&&null===this.key)return!1;var b=this.ka;return null!==(b=null===b?a.ba:b.oa)?(this.ka=b,this.key=b.key,this.value=b.value,!0):(this.Pd(),!1)},kt.prototype.sd=function(){return this.next()},kt.prototype.first=function(){var a=this.ga;return this.ia=a.Aa,null!==(a=a.ba)?(this.ka=a,this.key=a.key,this.value=a.value,a):null},kt.prototype.any=function(a){var b=this.ga;for(this.ka=b.Ha=null,b=b.ba;null!==b;){if(a(b))return!0;b=b.oa}return!1},kt.prototype.all=function(a){var b=this.ga;for(this.ka=b.Ha=null,b=b.ba;null!==b;){if(!a(b))return!1;b=b.oa}return!0},kt.prototype.each=function(a){var b=this.ga;for(this.ka=b.Ha=null,b=b.ba;null!==b;)a(b),b=b.oa;return this},kt.prototype.map=function(a){var b=this.ga;this.ka=b.Ha=null;var t=new ut;for(b=b.ba;null!==b;)t.add(a(b)),b=b.oa;return t.iterator},kt.prototype.filter=function(a){var b=this.ga;this.ka=b.Ha=null;var t=new ut;for(b=b.ba;null!==b;)a(b)&&t.add(b),b=b.oa;return t.iterator},kt.prototype.Pd=function(){this.value=this.key=null,this.ia=-1,this.ga.Ha=this},kt.prototype.toString=function(){return null!==this.ka?"MapIterator@"+this.ka:"MapIterator"},v.Object.defineProperties(kt.prototype,{iterator:{get:function(){return this}},count:{get:function(){return this.ga.Gb}}}),kt.prototype.first=kt.prototype.first,kt.prototype.hasNext=kt.prototype.sd,kt.prototype.next=kt.prototype.next,kt.prototype.reset=kt.prototype.reset,kt.className="MapIterator",(n=Mt.prototype).ob=function(){var a=this.Aa;999999999<++a&&(a=0),this.Aa=a},n.freeze=function(){return this.s=!0,this},n.ea=function(){return this.s=!1,this},n.toString=function(){return"Map()#"+yt(this)},n.add=function(a,b){this.s&&C(this,a);var t=a;j(a)&&(t=gt(a));var e=this.Ib[t];return void 0===e?(this.Gb++,a=new wt(a,b),this.Ib[t]=a,null===(t=this.af)?this.ba=a:(a.Vl=t,t.oa=a),this.af=a,this.ob()):e.value=b,this},n.set=function(a,b){return this.add(a,b)},n.addAll=function(a){if(null===a)return this;if(D(a))for(var b=a.length,t=0;t<b;t++){var e=a[t];this.add(e.key,e.value)}else if(a instanceof Mt)for(a=a.iterator;a.next();)this.add(a.key,a.value);else for(a=a.iterator;a.next();)b=a.value,this.add(b.key,b.value);return this},n.first=function(){return this.ba},Mt.prototype.any=function(a){for(var b=this.ba;null!==b;){if(a(b))return!0;b=b.oa}return!1},Mt.prototype.all=function(a){for(var b=this.ba;null!==b;){if(!a(b))return!1;b=b.oa}return!0},Mt.prototype.each=function(a){for(var b=this.ba;null!==b;)a(b),b=b.oa;return this},Mt.prototype.map=function(a){for(var b=new Mt,t=this.ba;null!==t;)b.add(t.key,a(t)),t=t.oa;return b},Mt.prototype.filter=function(a){for(var b=new Mt,t=this.ba;null!==t;)a(t)&&b.add(t.key,t.value),t=t.oa;return b},(n=Mt.prototype).contains=function(a){var b=a;return(!j(a)||void 0!==(b=yt(a)))&&void 0!==this.Ib[b]},n.has=function(a){return this.contains(a)},n.H=function(a){var b=a;return j(a)&&void 0===(b=yt(a))||void 0===(a=this.Ib[b])?null:a.value},n.get=function(a){return this.H(a)},n.remove=function(a){if(null===a)return!1;this.s&&C(this,a);var b=a;if(j(a)&&void 0===(b=yt(a)))return!1;if(void 0===(a=this.Ib[b]))return!1;var t=a.oa,e=a.Vl;return null!==t&&(t.Vl=e),null!==e&&(e.oa=t),this.ba===a&&(this.ba=t),this.af===a&&(this.af=e),delete this.Ib[b],this.Gb--,this.ob(),!0},n.delete=function(a){return this.remove(a)},n.clear=function(){this.s&&C(this),this.Ib={},this.Gb=0,null!==this.Ha&&this.Ha.reset(),null!==this.$e&&this.$e.reset(),this.af=this.ba=null,this.ob()},Mt.prototype.copy=function(){var t,a=new Mt,b=this.Ib;for(t in b){var e=b[t];a.add(e.key,e.value)}return a},Mt.prototype.ma=function(){var t,a=this.Ib,b=Array(this.Gb),e=0;for(t in a){var n=a[t];b[e]=new wt(n.key,n.value),e++}return b},Mt.prototype.Mf=function(){return new xt(this)},v.Object.defineProperties(Mt.prototype,{count:{get:function(){return this.Gb}},size:{get:function(){return this.Gb}},iterator:{get:function(){if(0>=this.count)return st;var a=this.Ha;return null!==a?(a.reset(),a):new kt(this)}},iteratorKeys:{get:function(){return 0>=this.count?st:new vt(this)}},iteratorValues:{get:function(){if(0>=this.count)return st;var a=this.$e;return null!==a?(a.reset(),a):new bt(this)}}}),Mt.prototype.toKeySet=Mt.prototype.Mf,Mt.prototype.toArray=Mt.prototype.ma,Mt.prototype.clear=Mt.prototype.clear,Mt.prototype.delete=Mt.prototype.delete,Mt.prototype.remove=Mt.prototype.remove,Mt.prototype.get=Mt.prototype.get,Mt.prototype.getValue=Mt.prototype.H,Mt.prototype.has=Mt.prototype.has,Mt.prototype.contains=Mt.prototype.contains,Mt.prototype.first=Mt.prototype.first,Mt.prototype.addAll=Mt.prototype.addAll,Mt.prototype.set=Mt.prototype.set,Mt.prototype.add=Mt.prototype.add,Mt.prototype.thaw=Mt.prototype.ea,Mt.prototype.freeze=Mt.prototype.freeze,Mt.className="Map",St.prototype.assign=function(a){return this.x=a.x,this.y=a.y,this},St.prototype.h=function(a,b){return this.x=a,this.y=b,this},St.prototype.Jg=function(a,b){return this.x=a,this.y=b,this},St.prototype.set=function(a){return this.x=a.x,this.y=a.y,this},St.prototype.copy=function(){var a=new St;return a.x=this.x,a.y=this.y,a},(n=St.prototype).ca=function(){return this.s=!0,Object.freeze(this),this},n.G=function(){return this.s||Object.isFrozen(this)?this:this.copy().freeze()},n.freeze=function(){return this.s=!0,this},n.ea=function(){return Object.isFrozen(this)&&N("cannot thaw constant: "+this),this.s=!1,this},n.toString=function(){return"Point("+this.x+","+this.y+")"},n.w=function(a){return a instanceof St&&(this.x===a.x&&this.y===a.y)},n.ej=function(a,b){return this.x===a&&this.y===b},n.Na=function(a){return oe.A(this.x,a.x)&&oe.A(this.y,a.y)},n.add=function(a){return this.x+=a.x,this.y+=a.y,this},n.ee=function(a){return this.x-=a.x,this.y-=a.y,this},n.offset=function(a,b){return this.x+=a,this.y+=b,this},St.prototype.rotate=function(a){if(0===a)return this;var b=this.x,t=this.y;if(0===b&&0===t)return this;if(360<=a?a-=360:0>a&&(a+=360),90===a){a=0;var e=1}else 180===a?(a=-1,e=0):270===a?(a=0,e=-1):(e=a*Math.PI/180,a=Math.cos(e),e=Math.sin(e));return this.x=a*b-e*t,this.y=e*b+a*t,this},(n=St.prototype).scale=function(a,b){return this.x*=a,this.y*=b,this},n.Ge=function(a){var b=a.x-this.x;return b*b+(a=a.y-this.y)*a},n.rd=function(a,b){return(a-=this.x)*a+(b-=this.y)*b},n.normalize=function(){var a=this.x,b=this.y,t=Math.sqrt(a*a+b*b);return 0<t&&(this.x=a/t,this.y=b/t),this},n.Sa=function(a){return Ct(a.x-this.x,a.y-this.y)},n.direction=function(a,b){return Ct(a-this.x,b-this.y)},n.OA=function(a,b,t,e){return oe.Ph(a,b,t,e,this.x,this.y,this),this},n.PA=function(a,b){return oe.Ph(a.x,a.y,b.x,b.y,this.x,this.y,this),this},n.$A=function(a,b,t,e){return oe.Cq(this.x,this.y,a,b,t,e,this),this},n.aB=function(a,b){return oe.Cq(this.x,this.y,a.x,a.y,b.width,b.height,this),this},n.sj=function(a,b){return this.x=a.x+b.x*a.width+b.offsetX,this.y=a.y+b.y*a.height+b.offsetY,this},n.Qk=function(a,b,t,e,n){return this.x=a+n.x*t+n.offsetX,this.y=b+n.y*e+n.offsetY,this},n.transform=function(a){return a.sa(this),this},n.u=function(){return isFinite(this.x)&&isFinite(this.y)},St.alloc=function(){var a=qt.pop();return void 0===a?new St:a},St.allocAt=function(a,b){var t=qt.pop();return void 0===t?new St(a,b):(t.x=a,t.y=b,t)},St.free=function(a){qt.push(a)},St.prototype.isReal=St.prototype.u,St.prototype.setSpot=St.prototype.Qk,St.prototype.setRectSpot=St.prototype.sj,St.prototype.snapToGridPoint=St.prototype.aB,St.prototype.snapToGrid=St.prototype.$A,St.prototype.projectOntoLineSegmentPoint=St.prototype.PA,St.prototype.projectOntoLineSegment=St.prototype.OA,St.intersectingLineSegments=function(a,b,t,e,n,o,g,r){return oe.Kq(a,b,t,e,n,o,g,r)},St.prototype.direction=St.prototype.direction,St.prototype.directionPoint=St.prototype.Sa,St.prototype.normalize=St.prototype.normalize,St.prototype.distanceSquared=St.prototype.rd,St.prototype.distanceSquaredPoint=St.prototype.Ge,St.prototype.scale=St.prototype.scale,St.prototype.rotate=St.prototype.rotate,St.prototype.offset=St.prototype.offset,St.prototype.subtract=St.prototype.ee,St.prototype.add=St.prototype.add,St.prototype.equalsApprox=St.prototype.Na,St.prototype.equalTo=St.prototype.ej,St.prototype.equals=St.prototype.w,St.prototype.set=St.prototype.set,St.prototype.setTo=St.prototype.Jg;var Dt,Ot,Ft,Bt,It,Rt,Et,zt,Vt,Gt,Yt,Xt,qt=[];function Ut(a,b){void 0===a?this.height=this.width=0:"number"==typeof a&&(0<=a||isNaN(a))&&"number"==typeof b&&(0<=b||isNaN(b))?(this.width=a,this.height=b):N("Invalid arguments to Size constructor: "+a+", "+b),this.s=!1}function Kt(a){if("string"==typeof a){a=a.split(" ");for(var b=0,t=0;""===a[b];)b++;var e=a[b++];e&&(t=parseFloat(e));for(var n=0;""===a[b];)b++;return(e=a[b++])&&(n=parseFloat(e)),new Ut(t,n)}return new Ut}function Ht(a){return a.width.toString()+" "+a.height.toString()}St.className="Point",St.parse=Pt,St.stringify=Nt,St.distanceLineSegmentSquared=Lt,St.distanceSquared=At,St.direction=jt,St.Origin=Dt=new St(0,0).ca(),St.InfiniteTopLeft=Ot=new St(-1/0,-1/0).ca(),St.InfiniteBottomRight=Ft=new St(1/0,1/0).ca(),St.SixPoint=Bt=new St(6,6).ca(),St.NoPoint=It=new St(NaN,NaN).ca(),St.parse=Pt,St.stringify=Nt,St.distanceLineSegmentSquared=Lt,St.distanceSquared=At,St.direction=jt,Ut.prototype.assign=function(a){return this.width=a.width,this.height=a.height,this},Ut.prototype.h=function(a,b){return this.width=a,this.height=b,this},Ut.prototype.Jg=function(a,b){return this.width=a,this.height=b,this},Ut.prototype.set=function(a){return this.width=a.width,this.height=a.height,this},Ut.prototype.copy=function(){var a=new Ut;return a.width=this.width,a.height=this.height,a},(n=Ut.prototype).ca=function(){return this.s=!0,Object.freeze(this),this},n.G=function(){return this.s||Object.isFrozen(this)?this:this.copy().freeze()},n.freeze=function(){return this.s=!0,this},n.ea=function(){return Object.isFrozen(this)&&N("cannot thaw constant: "+this),this.s=!1,this},n.toString=function(){return"Size("+this.width+","+this.height+")"},n.w=function(a){return a instanceof Ut&&(this.width===a.width&&this.height===a.height)},n.ej=function(a,b){return this.width===a&&this.height===b},n.Na=function(a){return oe.A(this.width,a.width)&&oe.A(this.height,a.height)},n.u=function(){return isFinite(this.width)&&isFinite(this.height)},Ut.alloc=function(){var a=Wt.pop();return void 0===a?new Ut:a},Ut.free=function(a){Wt.push(a)},Ut.prototype.isReal=Ut.prototype.u,Ut.prototype.equalsApprox=Ut.prototype.Na,Ut.prototype.equalTo=Ut.prototype.ej,Ut.prototype.equals=Ut.prototype.w,Ut.prototype.set=Ut.prototype.set,Ut.prototype.setTo=Ut.prototype.Jg;var Wt=[];function Jt(a,b,t,e){void 0===a?this.height=this.width=this.y=this.x=0:a instanceof St?(t=a.x,a=a.y,b instanceof St?(e=b.x,b=b.y,this.x=Math.min(t,e),this.y=Math.min(a,b),this.width=Math.abs(t-e),this.height=Math.abs(a-b)):b instanceof Ut?(this.x=t,this.y=a,this.width=b.width,this.height=b.height):N("Incorrect arguments supplied to Rect constructor")):"number"==typeof a&&"number"==typeof b&&"number"==typeof t&&(0<=t||isNaN(t))&&"number"==typeof e&&(0<=e||isNaN(e))?(this.x=a,this.y=b,this.width=t,this.height=e):N("Invalid arguments to Rect constructor: "+a+", "+b+", "+t+", "+e),this.s=!1}function Zt(a,b,t){a.width=b,a.height=t}function $t(a){if("string"==typeof a){a=a.split(" ");for(var b=0,t=0;""===a[b];)b++;var e=a[b++];e&&(t=parseFloat(e));for(var n=0;""===a[b];)b++;(e=a[b++])&&(n=parseFloat(e));for(var o=0;""===a[b];)b++;(e=a[b++])&&(o=parseFloat(e));for(var g=0;""===a[b];)b++;return(e=a[b++])&&(g=parseFloat(e)),new Jt(t,n,o,g)}return new Jt}function Qt(a){return a.x.toString()+" "+a.y.toString()+" "+a.width.toString()+" "+a.height.toString()}function _t(a,b){return oe.aa(a.x,b.x)&&oe.aa(a.y,b.y)&&oe.aa(a.width,b.width)&&oe.aa(a.height,b.height)}function ti(a,b,t,e,n){var o=a.width;return t+n<=-o?(a.x+=o/2,a.width=0):(a.x-=n,a.width+=t+n),b+e<=-(t=a.height)?(a.y+=t/2,a.height=0):(a.y-=b,a.height+=b+e),a}function ii(a,b,t,e,n){var o=Math.max(a.x,b),g=Math.max(a.y,t);return b=Math.min(a.x+a.width,b+e),t=Math.min(a.y+a.height,t+n),a.x=o,a.y=g,a.width=Math.max(0,b-o),a.height=Math.max(0,t-g),a}function ei(a,b){var t=a.width,e=a.x,n=b.x-10;return!(e>b.width+10+10+n||n>t+e)&&(t=a.height,a=a.y,e=b.y-10,!(a>b.height+10+10+e||e>t+a))}function ni(a,b,t,e,n){var o=Math.min(a.x,b),g=Math.min(a.y,t);return b=Math.max(a.x+a.width,b+e),t=Math.max(a.y+a.height,t+n),a.x=o,a.y=g,a.width=b-o,a.height=t-g,a}function oi(a,b,t,e,n,o,g,r){return void 0===g&&(g=0),void 0===r&&(r=0),a<=n&&n+g<=a+t&&b<=o&&o+r<=b+e}function ri(a,b,t,e,n,o,g,r){return!(a>g+n||n>t+a)&&!(b>r+o||o>e+b)}Ut.className="Size",Ut.parse=Kt,Ut.stringify=Ht,Ut.ZeroSize=Rt=new Ut(0,0).ca(),Ut.OneSize=Et=new Ut(1,1).ca(),Ut.SixSize=zt=new Ut(6,6).ca(),Ut.EightSize=Vt=new Ut(8,8).ca(),Ut.TenSize=Gt=new Ut(10,10).ca(),Ut.InfiniteSize=Yt=new Ut(1/0,1/0).ca(),Ut.NoSize=Xt=new Ut(NaN,NaN).ca(),Ut.parse=Kt,Ut.stringify=Ht,(n=Jt.prototype).assign=function(a){return this.x=a.x,this.y=a.y,this.width=a.width,this.height=a.height,this},n.h=function(a,b,t,e){return this.x=a,this.y=b,this.width=t,this.height=e,this},n.Jg=function(a,b,t,e){return this.x=a,this.y=b,this.width=t,this.height=e,this},n.set=function(a){return this.x=a.x,this.y=a.y,this.width=a.width,this.height=a.height,this},n.Rc=function(a){return this.x=a.x,this.y=a.y,this},n.ZA=function(a){return this.width=a.width,this.height=a.height,this},Jt.prototype.copy=function(){var a=new Jt;return a.x=this.x,a.y=this.y,a.width=this.width,a.height=this.height,a},(n=Jt.prototype).ca=function(){return this.s=!0,Object.freeze(this),this},n.G=function(){return this.s||Object.isFrozen(this)?this:this.copy().freeze()},n.freeze=function(){return this.s=!0,this},n.ea=function(){return Object.isFrozen(this)&&N("cannot thaw constant: "+this),this.s=!1,this},n.toString=function(){return"Rect("+this.x+","+this.y+","+this.width+","+this.height+")"},n.w=function(a){return a instanceof Jt&&(this.x===a.x&&this.y===a.y&&this.width===a.width&&this.height===a.height)},n.ej=function(a,b,t,e){return this.x===a&&this.y===b&&this.width===t&&this.height===e},n.Na=function(a){return oe.A(this.x,a.x)&&oe.A(this.y,a.y)&&oe.A(this.width,a.width)&&oe.A(this.height,a.height)},n.$=function(a){return this.x<=a.x&&this.x+this.width>=a.x&&this.y<=a.y&&this.y+this.height>=a.y},n.Ee=function(a){return this.x<=a.x&&a.x+a.width<=this.x+this.width&&this.y<=a.y&&a.y+a.height<=this.y+this.height},n.contains=function(a,b,t,e){return void 0===t&&(t=0),void 0===e&&(e=0),this.x<=a&&a+t<=this.x+this.width&&this.y<=b&&b+e<=this.y+this.height},n.offset=function(a,b){return this.x+=a,this.y+=b,this},n.Kc=function(a,b){return ti(this,b,a,b,a)},n.qq=function(a){return ti(this,a.top,a.right,a.bottom,a.left)},n.Jw=function(a){return ti(this,-a.top,-a.right,-a.bottom,-a.left)},n.sA=function(a,b,t,e){return ti(this,a,b,t,e)},n.Ey=function(a){return ii(this,a.x,a.y,a.width,a.height)},n.$v=function(a,b,t,e){return ii(this,a,b,t,e)},n.Nc=function(a){return this.aw(a.x,a.y,a.width,a.height)},n.aw=function(a,b,t,e){var n=this.width,o=this.x;return!(1/0!==n&&1/0!==t&&(n+=o,t+=a,isNaN(t)||isNaN(n)||o>t||a>n))&&(a=this.height,t=this.y,!(1/0!==a&&1/0!==e&&(a+=t,e+=b,isNaN(e)||isNaN(a)||t>e||b>a)))},n.Oe=function(a){return ni(this,a.x,a.y,0,0)},n.Tc=function(a){return ni(this,a.x,a.y,a.width,a.height)},n.Rw=function(a,b,t,e){return void 0===t&&(t=0),void 0===e&&(e=0),ni(this,a,b,t,e)},n.Qk=function(a,b,t){return this.x=a-t.offsetX-t.x*this.width,this.y=b-t.offsetY-t.y*this.height,this},n.u=function(){return isFinite(this.x)&&isFinite(this.y)&&isFinite(this.width)&&isFinite(this.height)},n.yA=function(){return 0===this.width&&0===this.height},Jt.alloc=function(){var a=hi.pop();return void 0===a?new Jt:a},Jt.allocAt=function(a,b,t,e){var n=hi.pop();return void 0===n?new Jt(a,b,t,e):n.h(a,b,t,e)},Jt.free=function(a){hi.push(a)},v.Object.defineProperties(Jt.prototype,{left:{get:function(){return this.x},set:function(a){this.x=a}},top:{get:function(){return this.y},set:function(a){this.y=a}},right:{get:function(){return this.x+this.width},set:function(a){this.x+=a-(this.x+this.width)}},bottom:{get:function(){return this.y+this.height},set:function(a){this.y+=a-(this.y+this.height)}},position:{get:function(){return new St(this.x,this.y)},set:function(a){this.x=a.x,this.y=a.y}},size:{get:function(){return new Ut(this.width,this.height)},set:function(a){this.width=a.width,this.height=a.height}},center:{get:function(){return new St(this.x+this.width/2,this.y+this.height/2)},set:function(a){this.x=a.x-this.width/2,this.y=a.y-this.height/2}},centerX:{get:function(){return this.x+this.width/2},set:function(a){this.x=a-this.width/2}},centerY:{get:function(){return this.y+this.height/2},set:function(a){this.y=a-this.height/2}}}),Jt.prototype.isEmpty=Jt.prototype.yA,Jt.prototype.isReal=Jt.prototype.u,Jt.intersectsLineSegment=function(a,b,t,e,n,o,g,r){return oe.Fy(a,b,t,e,n,o,g,r)},Jt.prototype.setSpot=Jt.prototype.Qk,Jt.prototype.union=Jt.prototype.Rw,Jt.prototype.unionRect=Jt.prototype.Tc,Jt.prototype.unionPoint=Jt.prototype.Oe,Jt.prototype.intersects=Jt.prototype.aw,Jt.prototype.intersectsRect=Jt.prototype.Nc,Jt.prototype.intersect=Jt.prototype.$v,Jt.prototype.intersectRect=Jt.prototype.Ey,Jt.prototype.grow=Jt.prototype.sA,Jt.prototype.subtractMargin=Jt.prototype.Jw,Jt.prototype.addMargin=Jt.prototype.qq,Jt.prototype.inflate=Jt.prototype.Kc,Jt.prototype.offset=Jt.prototype.offset,Jt.prototype.contains=Jt.prototype.contains,Jt.prototype.containsRect=Jt.prototype.Ee,Jt.prototype.containsPoint=Jt.prototype.$,Jt.prototype.equalsApprox=Jt.prototype.Na,Jt.prototype.equalTo=Jt.prototype.ej,Jt.prototype.equals=Jt.prototype.w,Jt.prototype.setSize=Jt.prototype.ZA,Jt.prototype.setPoint=Jt.prototype.Rc,Jt.prototype.set=Jt.prototype.set,Jt.prototype.setTo=Jt.prototype.Jg;var si,ai,hi=[];function ui(a,b,t,e){void 0===a?this.left=this.bottom=this.right=this.top=0:void 0===b?this.left=this.bottom=this.right=this.top=a:void 0===t?(this.top=a,this.right=b,this.bottom=a,this.left=b):void 0!==e?(this.top=a,this.right=b,this.bottom=t,this.left=e):N("Invalid arguments to Margin constructor: "+a+", "+b+", "+t+", "+e),this.s=!1}function ci(a){if("string"==typeof a){a=a.split(" ");for(var b=0,t=NaN;""===a[b];)b++;var e=a[b++];if(e&&(t=parseFloat(e)),isNaN(t))return new ui;for(var n=NaN;""===a[b];)b++;if((e=a[b++])&&(n=parseFloat(e)),isNaN(n))return new ui(t);for(var o=NaN;""===a[b];)b++;if((e=a[b++])&&(o=parseFloat(e)),isNaN(o))return new ui(t,n);for(var g=NaN;""===a[b];)b++;return(e=a[b++])&&(g=parseFloat(e)),isNaN(g)?new ui(t,n):new ui(t,n,o,g)}return new ui}function fi(a){return a.top.toString()+" "+a.right.toString()+" "+a.bottom.toString()+" "+a.left.toString()}Jt.className="Rect",Jt.parse=$t,Jt.stringify=Qt,Jt.contains=oi,Jt.intersects=ri,Jt.ZeroRect=si=new Jt(0,0,0,0).ca(),Jt.NoRect=ai=new Jt(NaN,NaN,NaN,NaN).ca(),Jt.parse=$t,Jt.stringify=Qt,Jt.contains=oi,Jt.intersects=ri,ui.prototype.assign=function(a){return this.top=a.top,this.right=a.right,this.bottom=a.bottom,this.left=a.left,this},ui.prototype.Jg=function(a,b,t,e){return this.top=a,this.right=b,this.bottom=t,this.left=e,this},ui.prototype.set=function(a){return this.top=a.top,this.right=a.right,this.bottom=a.bottom,this.left=a.left,this},ui.prototype.copy=function(){var a=new ui;return a.top=this.top,a.right=this.right,a.bottom=this.bottom,a.left=this.left,a},(n=ui.prototype).ca=function(){return this.s=!0,Object.freeze(this),this},n.G=function(){return this.s||Object.isFrozen(this)?this:this.copy().freeze()},n.freeze=function(){return this.s=!0,this},n.ea=function(){return Object.isFrozen(this)&&N("cannot thaw constant: "+this),this.s=!1,this},n.toString=function(){return"Margin("+this.top+","+this.right+","+this.bottom+","+this.left+")"},n.w=function(a){return a instanceof ui&&(this.top===a.top&&this.right===a.right&&this.bottom===a.bottom&&this.left===a.left)},n.ej=function(a,b,t,e){return this.top===a&&this.right===b&&this.bottom===t&&this.left===e},n.Na=function(a){return oe.A(this.top,a.top)&&oe.A(this.right,a.right)&&oe.A(this.bottom,a.bottom)&&oe.A(this.left,a.left)},n.u=function(){return isFinite(this.top)&&isFinite(this.right)&&isFinite(this.bottom)&&isFinite(this.left)},ui.alloc=function(){var a=Zi.pop();return void 0===a?new ui:a},ui.free=function(a){Zi.push(a)},ui.prototype.isReal=ui.prototype.u,ui.prototype.equalsApprox=ui.prototype.Na,ui.prototype.equalTo=ui.prototype.ej,ui.prototype.equals=ui.prototype.w,ui.prototype.set=ui.prototype.set,ui.prototype.setTo=ui.prototype.Jg;var di,pi,gi,yi,mi,vi,xi,bi,wi,ki,Mi,Si,Pi,Ni,Ci,Ti,Li,Ai,ji,Di,Oi,Fi,Bi,Ii,Ri,Ei,zi,Vi,Gi,Yi,Xi,qi,dd,Ui,Ki,Hi,Wi,Ji,Zi=[];function $i(a,b,t,e){void 0===a?this.offsetY=this.offsetX=this.y=this.x=0:(void 0===b&&(b=0),void 0===t&&(t=0),void 0===e&&(e=0),this.x=a,this.y=b,this.offsetX=t,this.offsetY=e),this.s=!1}function Qi(a,b){return a.x=NaN,a.y=NaN,a.offsetX=b,a}function _i(a){if("string"==typeof a){if("None"===(a=a.trim()))return gi;if("TopLeft"===a)return yi;if("Top"===a||"TopCenter"===a||"MiddleTop"===a)return mi;if("TopRight"===a)return vi;if("Left"===a||"LeftCenter"===a||"MiddleLeft"===a)return xi;if("Center"===a)return bi;if("Right"===a||"RightCenter"===a||"MiddleRight"===a)return wi;if("BottomLeft"===a)return ki;if("Bottom"===a||"BottomCenter"===a||"MiddleBottom"===a)return Mi;if("BottomRight"===a)return Si;if("TopSide"===a)return Pi;if("LeftSide"===a)return Ni;if("RightSide"===a)return Ci;if("BottomSide"===a)return Ti;if("TopBottomSides"===a)return Li;if("LeftRightSides"===a)return Ai;if("TopLeftSides"===a)return ji;if("TopRightSides"===a)return Di;if("BottomLeftSides"===a)return Oi;if("BottomRightSides"===a)return Fi;if("NotTopSide"===a)return Bi;if("NotLeftSide"===a)return Ii;if("NotRightSide"===a)return Ri;if("NotBottomSide"===a)return Ei;if("AllSides"===a)return zi;if("Default"===a)return Vi;a=a.split(" ");for(var b=0,t=0;""===a[b];)b++;var e=a[b++];void 0!==e&&0<e.length&&(t=parseFloat(e));for(var n=0;""===a[b];)b++;void 0!==(e=a[b++])&&0<e.length&&(n=parseFloat(e));for(var o=0;""===a[b];)b++;void 0!==(e=a[b++])&&0<e.length&&(o=parseFloat(e));for(var g=0;""===a[b];)b++;return void 0!==(e=a[b++])&&0<e.length&&(g=parseFloat(e)),new $i(t,n,o,g)}return new $i}function te(a){return a.kb()?a.x.toString()+" "+a.y.toString()+" "+a.offsetX.toString()+" "+a.offsetY.toString():a.toString()}ui.className="Margin",ui.parse=ci,ui.stringify=fi,ui.ZeroMargin=di=new ui(0,0,0,0).ca(),ui.TwoMargin=pi=new ui(2,2,2,2).ca(),ui.parse=ci,ui.stringify=fi,$i.prototype.assign=function(a){return this.x=a.x,this.y=a.y,this.offsetX=a.offsetX,this.offsetY=a.offsetY,this},$i.prototype.Jg=function(a,b,t,e){return this.x=a,this.y=b,this.offsetX=t,this.offsetY=e,this},$i.prototype.set=function(a){return this.x=a.x,this.y=a.y,this.offsetX=a.offsetX,this.offsetY=a.offsetY,this},$i.prototype.copy=function(){var a=new $i;return a.x=this.x,a.y=this.y,a.offsetX=this.offsetX,a.offsetY=this.offsetY,a},(n=$i.prototype).ca=function(){return this.s=!0,Object.freeze(this),this},n.G=function(){return this.s||Object.isFrozen(this)?this:this.copy().freeze()},n.freeze=function(){return this.s=!0,this},n.ea=function(){return Object.isFrozen(this)&&N("cannot thaw constant: "+this),this.s=!1,this},n.toString=function(){return this.kb()?0===this.offsetX&&0===this.offsetY?"Spot("+this.x+","+this.y+")":"Spot("+this.x+","+this.y+","+this.offsetX+","+this.offsetY+")":this.w(gi)?"None":this.w(yi)?"TopLeft":this.w(mi)?"Top":this.w(vi)?"TopRight":this.w(xi)?"Left":this.w(bi)?"Center":this.w(wi)?"Right":this.w(ki)?"BottomLeft":this.w(Mi)?"Bottom":this.w(Si)?"BottomRight":this.w(Pi)?"TopSide":this.w(Ni)?"LeftSide":this.w(Ci)?"RightSide":this.w(Ti)?"BottomSide":this.w(Li)?"TopBottomSides":this.w(Ai)?"LeftRightSides":this.w(ji)?"TopLeftSides":this.w(Di)?"TopRightSides":this.w(Oi)?"BottomLeftSides":this.w(Fi)?"BottomRightSides":this.w(Bi)?"NotTopSide":this.w(Ii)?"NotLeftSide":this.w(Ri)?"NotRightSide":this.w(Ei)?"NotBottomSide":this.w(zi)?"AllSides":this.w(Vi)?"Default":"None"},n.w=function(a){return a instanceof $i&&((this.x===a.x||isNaN(this.x)&&isNaN(a.x))&&(this.y===a.y||isNaN(this.y)&&isNaN(a.y))&&this.offsetX===a.offsetX&&this.offsetY===a.offsetY)},n.kw=function(){return new $i(.5-(this.x-.5),.5-(this.y-.5),-this.offsetX,-this.offsetY)},n.Gf=function(a){if(!this.Pc())return!1;if(!a.Pc())if(a.w(Gi))a=Ni;else if(a.w(Yi))a=Ci;else if(a.w(Xi))a=Pi;else{if(!a.w(qi))return!1;a=Ti}return a=a.offsetY,(this.offsetY&a)===a},n.kb=function(){return!isNaN(this.x)&&!isNaN(this.y)},n.nc=function(){return isNaN(this.x)||isNaN(this.y)},n.Pc=function(){return isNaN(this.x)&&isNaN(this.y)&&1===this.offsetX&&0!==this.offsetY},n.Ut=function(){return isNaN(this.x)&&isNaN(this.y)&&0===this.offsetX&&0===this.offsetY},n.Nb=function(){return isNaN(this.x)&&isNaN(this.y)&&-1===this.offsetX&&0===this.offsetY},$i.alloc=function(){var a=ie.pop();return void 0===a?new $i:a},$i.free=function(a){ie.push(a)},$i.prototype.isDefault=$i.prototype.Nb,$i.prototype.isNone=$i.prototype.Ut,$i.prototype.isSide=$i.prototype.Pc,$i.prototype.isNoSpot=$i.prototype.nc,$i.prototype.isSpot=$i.prototype.kb,$i.prototype.includesSide=$i.prototype.Gf,$i.prototype.opposite=$i.prototype.kw,$i.prototype.equals=$i.prototype.w,$i.prototype.set=$i.prototype.set,$i.prototype.setTo=$i.prototype.Jg;var ie=[];function ee(){this.m11=1,this.m21=this.m12=0,this.m22=1,this.dy=this.dx=0}$i.className="Spot",$i.parse=_i,$i.stringify=te,$i.None=gi=Qi(new $i(0,0,0,0),0).ca(),$i.Default=Vi=Qi(new $i(0,0,-1,0),-1).ca(),$i.TopLeft=yi=new $i(0,0,0,0).ca(),$i.TopCenter=mi=new $i(.5,0,0,0).ca(),$i.TopRight=vi=new $i(1,0,0,0).ca(),$i.LeftCenter=xi=new $i(0,.5,0,0).ca(),$i.Center=bi=new $i(.5,.5,0,0).ca(),$i.RightCenter=wi=new $i(1,.5,0,0).ca(),$i.BottomLeft=ki=new $i(0,1,0,0).ca(),$i.BottomCenter=Mi=new $i(.5,1,0,0).ca(),$i.BottomRight=Si=new $i(1,1,0,0).ca(),$i.MiddleTop=dd=mi,$i.MiddleLeft=Ui=xi,$i.MiddleRight=Ki=wi,$i.MiddleBottom=Hi=Mi,$i.Top=Xi=mi,$i.Left=Gi=xi,$i.Right=Yi=wi,$i.Bottom=qi=Mi,$i.TopSide=Pi=Qi(new $i(0,0,1,1),1).ca(),$i.LeftSide=Ni=Qi(new $i(0,0,1,2),1).ca(),$i.RightSide=Ci=Qi(new $i(0,0,1,4),1).ca(),$i.BottomSide=Ti=Qi(new $i(0,0,1,8),1).ca(),$i.TopBottomSides=Li=Qi(new $i(0,0,1,9),1).ca(),$i.LeftRightSides=Ai=Qi(new $i(0,0,1,6),1).ca(),$i.TopLeftSides=ji=Qi(new $i(0,0,1,3),1).ca(),$i.TopRightSides=Di=Qi(new $i(0,0,1,5),1).ca(),$i.BottomLeftSides=Oi=Qi(new $i(0,0,1,10),1).ca(),$i.BottomRightSides=Fi=Qi(new $i(0,0,1,12),1).ca(),$i.NotTopSide=Bi=Qi(new $i(0,0,1,14),1).ca(),$i.NotLeftSide=Ii=Qi(new $i(0,0,1,13),1).ca(),$i.NotRightSide=Ri=Qi(new $i(0,0,1,11),1).ca(),$i.NotBottomSide=Ei=Qi(new $i(0,0,1,7),1).ca(),$i.AllSides=zi=Qi(new $i(0,0,1,15),1).ca(),Wi=new $i(.156,.156).ca(),Ji=new $i(.844,.844).ca(),$i.parse=_i,$i.stringify=te,ee.prototype.set=function(a){return this.m11=a.m11,this.m12=a.m12,this.m21=a.m21,this.m22=a.m22,this.dx=a.dx,this.dy=a.dy,this},ee.prototype.copy=function(){var a=new ee;return a.m11=this.m11,a.m12=this.m12,a.m21=this.m21,a.m22=this.m22,a.dx=this.dx,a.dy=this.dy,a},(n=ee.prototype).toString=function(){return"Transform("+this.m11+","+this.m12+","+this.m21+","+this.m22+","+this.dx+","+this.dy+")"},n.w=function(a){return this.m11===a.m11&&this.m12===a.m12&&this.m21===a.m21&&this.m22===a.m22&&this.dx===a.dx&&this.dy===a.dy},n.St=function(){return 0===this.dx&&0===this.dy&&1===this.m11&&0===this.m12&&0===this.m21&&1===this.m22},n.reset=function(){return this.m11=1,this.m21=this.m12=0,this.m22=1,this.dy=this.dx=0,this},n.multiply=function(a){var b=this.m11*a.m11+this.m21*a.m12,t=this.m12*a.m11+this.m22*a.m12,e=this.m11*a.m21+this.m21*a.m22,n=this.m12*a.m21+this.m22*a.m22;return this.dx=this.m11*a.dx+this.m21*a.dy+this.dx,this.dy=this.m12*a.dx+this.m22*a.dy+this.dy,this.m11=b,this.m12=t,this.m21=e,this.m22=n,this},n.hw=function(a){var b=1/(a.m11*a.m22-a.m12*a.m21),t=a.m22*b,e=-a.m12*b,n=-a.m21*b,o=a.m11*b,g=b*(a.m21*a.dy-a.m22*a.dx);return a=b*(a.m12*a.dx-a.m11*a.dy),b=this.m11*t+this.m21*e,t=this.m12*t+this.m22*e,e=this.m11*n+this.m21*o,n=this.m12*n+this.m22*o,this.dx=this.m11*g+this.m21*a+this.dx,this.dy=this.m12*g+this.m22*a+this.dy,this.m11=b,this.m12=t,this.m21=e,this.m22=n,this},n.Rt=function(){var a=1/(this.m11*this.m22-this.m12*this.m21),b=-this.m12*a,t=-this.m21*a,e=this.m11*a,n=a*(this.m21*this.dy-this.m22*this.dx),o=a*(this.m12*this.dx-this.m11*this.dy);return this.m11=this.m22*a,this.m12=b,this.m21=t,this.m22=e,this.dx=n,this.dy=o,this},ee.prototype.rotate=function(a,b,t){if(360<=a?a-=360:0>a&&(a+=360),0===a)return this;if(this.translate(b,t),90===a){a=0;var e=1}else 180===a?(a=-1,e=0):270===a?(a=0,e=-1):(e=a*Math.PI/180,a=Math.cos(e),e=Math.sin(e));var n=this.m12*a+this.m22*e,o=this.m11*-e+this.m21*a,g=this.m12*-e+this.m22*a;return this.m11=this.m11*a+this.m21*e,this.m12=n,this.m21=o,this.m22=g,this.translate(-b,-t),this},(n=ee.prototype).translate=function(a,b){return this.dx+=this.m11*a+this.m21*b,this.dy+=this.m12*a+this.m22*b,this},n.scale=function(a,b){return void 0===b&&(b=a),this.m11*=a,this.m12*=a,this.m21*=b,this.m22*=b,this},n.sa=function(a){var b=a.x,t=a.y;return a.h(b*this.m11+t*this.m21+this.dx,b*this.m12+t*this.m22+this.dy)},n.Gd=function(a){var b=1/(this.m11*this.m22-this.m12*this.m21),t=a.x,e=a.y;return a.h(t*this.m22*b+e*-this.m21*b+b*(this.m21*this.dy-this.m22*this.dx),t*-this.m12*b+e*this.m11*b+b*(this.m12*this.dx-this.m11*this.dy))},n.ay=function(a){var b=1/(this.m11*this.m22-this.m12*this.m21),t=1.25*a.x,e=1.2*a.y;return a.h(t*this.m22*b+e*-this.m21*b+b*(this.m21*this.dy-this.m22*this.dx),t*-this.m12*b+e*this.m11*b+b*(this.m12*this.dx-this.m11*this.dy))},n.Pw=function(a){var b=a.x,t=a.y,e=b+a.width,n=t+a.height,o=this.m11,g=this.m12,r=this.m21,h=this.m22,l=this.dx,c=this.dy,f=b*o+t*r+l,p=b*g+t*h+c,d=e*o+t*r+l,q=e*g+t*h+c;return t=b*o+n*r+l,b=b*g+n*h+c,o=e*o+n*r+l,e=e*g+n*h+c,n=Math.min(f,d),f=Math.max(f,d),d=Math.min(p,q),p=Math.max(p,q),n=Math.min(n,t),f=Math.max(f,t),d=Math.min(d,b),p=Math.max(p,b),n=Math.min(n,o),f=Math.max(f,o),d=Math.min(d,e),p=Math.max(p,e),a.h(n,d,f-n,p-d),a},ee.alloc=function(){var a=ne.pop();return void 0===a?new ee:a},ee.free=function(a){ne.push(a)},ee.prototype.transformRect=ee.prototype.Pw,ee.prototype.transformPoint=ee.prototype.sa,ee.prototype.scale=ee.prototype.scale,ee.prototype.translate=ee.prototype.translate,ee.prototype.rotate=ee.prototype.rotate,ee.prototype.invert=ee.prototype.Rt,ee.prototype.multiplyInverted=ee.prototype.hw,ee.prototype.multiply=ee.prototype.multiply,ee.prototype.reset=ee.prototype.reset,ee.prototype.isIdentity=ee.prototype.St,ee.prototype.equals=ee.prototype.w,ee.prototype.set=ee.prototype.set;var ne=[];ee.className="Transform",ee.xF="54a702f3e53909c447824c6706603faf4c";var oe={iB:"7da71ca0ad381e90",Lg:(Math.sqrt(2)-1)/3*4,jx:null,sqrt:function(a){if(0>=a)return 0;var b=oe.jx;if(null===b){b=[];for(var t=0;2e3>=t;t++)b[t]=Math.sqrt(t);oe.jx=b}return 1>a?2e3>=(t=1/a)?1/b[0|t]:Math.sqrt(a):2e3>=a?b[0|a]:Math.sqrt(a)},A:function(a,b){return.5>(a-=b)&&-.5<a},aa:function(a,b){return 5e-8>(a-=b)&&-5e-8<a},Ob:function(a,b,t,e,n,o,g){if(0>=n&&(n=1e-6),a<t)var r=a,h=t;else r=t,h=a;if(b<e)var l=b,c=e;else l=e,c=b;if(a===t)return l<=g&&g<=c&&a-n<=o&&o<=a+n;if(b===e)return r<=o&&o<=h&&b-n<=g&&g<=b+n;if(h+=n,(r-=n)<=o&&o<=h&&(c+=n,(l-=n)<=g&&g<=c))if(h-r>c-l){if(!(a-t>n||t-a>n))return!0;if((o=(e-b)/(t-a)*(o-a)+b)-n<=g&&g<=o+n)return!0}else{if(!(b-e>n||e-b>n))return!0;if((g=(t-a)/(e-b)*(g-b)+a)-n<=o&&o<=g+n)return!0}return!1},wt:function(a,b,t,e,n,o,g,r,h,l,c,f){if(oe.Ob(a,b,g,r,f,t,e)&&oe.Ob(a,b,g,r,f,n,o))return oe.Ob(a,b,g,r,f,l,c);var p=(a+t)/2,d=(b+e)/2,q=(t+n)/2,u=(e+o)/2,y=((e=(p+q)/2)+(q=(q+(n=(n+g)/2))/2))/2,m=((t=(d+u)/2)+(u=(u+(o=(o+r)/2))/2))/2;return oe.wt(a,b,p,d,e,t,y,m,h,l,c,f)||oe.wt(y,m,q,u,n,o,g,r,h,l,c,f)},yz:function(a,b,t,e,n,o,g,r,h){var l=(t+n)/2,c=(e+o)/2;return h.h((((a+t)/2+l)/2+(l+(n+g)/2)/2)/2,(((b+e)/2+c)/2+(c+(o+r)/2)/2)/2),h},xz:function(a,b,t,e,n,o,g,r){var h=(t+n)/2,l=(e+o)/2;return jt(((a+t)/2+h)/2,((b+e)/2+l)/2,(h+(n+g)/2)/2,(l+(o+r)/2)/2)},sm:function(a,b,t,e,n,o,g,r,h,l){if(oe.Ob(a,b,g,r,h,t,e)&&oe.Ob(a,b,g,r,h,n,o))ni(l,a,b,0,0),ni(l,g,r,0,0);else{var c=(a+t)/2,f=(b+e)/2,p=(t+n)/2,d=(e+o)/2,q=((e=(c+p)/2)+(p=(p+(n=(n+g)/2))/2))/2,u=((t=(f+d)/2)+(d=(d+(o=(o+r)/2))/2))/2;oe.sm(a,b,c,f,e,t,q,u,h,l),oe.sm(q,u,p,d,n,o,g,r,h,l)}return l},De:function(a,b,t,e,n,o,g,r,h,l){if(oe.Ob(a,b,g,r,h,t,e)&&oe.Ob(a,b,g,r,h,n,o))0===l.length&&(l.push(a),l.push(b)),l.push(g),l.push(r);else{var c=(a+t)/2,f=(b+e)/2,p=(t+n)/2,d=(e+o)/2,q=((e=(c+p)/2)+(p=(p+(n=(n+g)/2))/2))/2,u=((t=(f+d)/2)+(d=(d+(o=(o+r)/2))/2))/2;oe.De(a,b,c,f,e,t,q,u,h,l),oe.De(q,u,p,d,n,o,g,r,h,l)}return l},ow:function(a,b,t,e,n,o,g,r,h,l){if(oe.Ob(a,b,n,o,l,t,e))return oe.Ob(a,b,n,o,l,r,h);var c=(a+t)/2,f=(b+e)/2,p=(c+(t=(t+n)/2))/2,d=(f+(e=(e+o)/2))/2;return oe.ow(a,b,c,f,p,d,g,r,h,l)||oe.ow(p,d,t,e,n,o,g,r,h,l)},xB:function(a,b,t,e,n,o,g){return g.h(((a+t)/2+(t+n)/2)/2,((b+e)/2+(e+o)/2)/2),g},nw:function(a,b,t,e,n,o,g,r){if(oe.Ob(a,b,n,o,g,t,e))ni(r,a,b,0,0),ni(r,n,o,0,0);else{var h=(a+t)/2,l=(b+e)/2,c=(h+(t=(t+n)/2))/2,f=(l+(e=(e+o)/2))/2;oe.nw(a,b,h,l,c,f,g,r),oe.nw(c,f,t,e,n,o,g,r)}return r},Uq:function(a,b,t,e,n,o,g,r){if(oe.Ob(a,b,n,o,g,t,e))0===r.length&&(r.push(a),r.push(b)),r.push(n),r.push(o);else{var h=(a+t)/2,l=(b+e)/2,c=(h+(t=(t+n)/2))/2,f=(l+(e=(e+o)/2))/2;oe.Uq(a,b,h,l,c,f,g,r),oe.Uq(c,f,t,e,n,o,g,r)}return r},sq:function(a,b,t,e,n,o,g,r,h,l,c,f,p,d){if(oe.Ob(a,b,g,r,p,t,e)&&oe.Ob(a,b,g,r,p,n,o)){if(a<h&&g<h&&a<c&&g<c||a>h&&g>h&&a>c&&g>c||b<l&&r<l&&b<f&&r<f||b>l&&r>l&&b>f&&r>f)return!1;var q=(a-g)*(l-f)-(b-r)*(h-c);if(0===q)return!1;if(p=((a*r-b*g)*(h-c)-(a-g)*(h*f-l*c))/q,q=((a*r-b*g)*(l-f)-(b-r)*(h*f-l*c))/q,(h>c?h-c:c-h)<(l>f?l-f:f-l)){if(b<r?g=b:(g=r,r=b),1e-5+q<g||q>r+1e-5)return!1}else if(a<g?r=a:(r=g,g=a),1e-5+p<r||p>g+1e-5)return!1;return d.h(p,q),!0}var u=(b+e)/2,y=(t+n)/2,m=(e+o)/2,v=((e=((q=(a+t)/2)+y)/2)+(y=(y+(n=(n+g)/2))/2))/2,x=((t=(u+m)/2)+(m=(m+(o=(o+r)/2))/2))/2,w=1/0,k=!1,M=0,S=0;return oe.sq(a,b,q,u,e,t,v,x,h,l,c,f,p,d)&&((a=(d.x-h)*(d.x-h)+(d.y-l)*(d.y-l))<w&&(w=a,k=!0,M=d.x,S=d.y)),oe.sq(v,x,y,m,n,o,g,r,h,l,c,f,p,d)&&(d.x-h)*(d.x-h)+(d.y-l)*(d.y-l)<w&&(k=!0,M=d.x,S=d.y),k&&(d.x=M,d.y=S),k},tq:function(a,b,t,e,n,o,g,r,h,l,c,f,p){var d=0;if(oe.Ob(a,b,g,r,p,t,e)&&oe.Ob(a,b,g,r,p,n,o)){if(0===(p=(a-g)*(l-f)-(b-r)*(h-c)))return d;var q=((a*r-b*g)*(h-c)-(a-g)*(h*f-l*c))/p,u=((a*r-b*g)*(l-f)-(b-r)*(h*f-l*c))/p;if(q>=c)return d;if((h>c?h-c:c-h)<(l>f?l-f:f-l)){if(b<r?(a=b,b=r):a=r,u<a||u>b)return d}else if(a<g?(b=a,a=g):b=g,q<b||q>a)return d;0<p?d++:0>p&&d--}else{u=(b+e)/2;var y=(t+n)/2,m=(e+o)/2,v=((e=((q=(a+t)/2)+y)/2)+(y=(y+(n=(n+g)/2))/2))/2,x=((t=(u+m)/2)+(m=(m+(o=(o+r)/2))/2))/2;d+=oe.tq(a,b,q,u,e,t,v,x,h,l,c,f,p),d+=oe.tq(v,x,y,m,n,o,g,r,h,l,c,f,p)}return d},Ph:function(a,b,t,e,n,o,g){return oe.aa(a,t)?(b<e?(t=b,b=e):t=e,o<t?(g.h(a,t),!1):o>b?(g.h(a,b),!1):(g.h(a,o),!0)):oe.aa(b,e)?(a<t?(e=a,a=t):e=t,n<e?(g.h(e,b),!1):n>a?(g.h(a,b),!1):(g.h(n,b),!0)):-5e-6>(n=((a-n)*(a-t)+(b-o)*(b-e))/((t-a)*(t-a)+(e-b)*(e-b)))?(g.h(a,b),!1):1.000005<n?(g.h(t,e),!1):(g.h(a+n*(t-a),b+n*(e-b)),!0)},Ke:function(a,b,t,e,n,o,g,r,h){return oe.A(a,t)&&oe.A(b,e)?(h.h(a,b),!1):oe.aa(n,g)?oe.aa(a,t)?(oe.Ph(a,b,t,e,n,o,h),!1):oe.Ph(a,b,t,e,n,(e-b)/(t-a)*(n-a)+b,h):(r=(r-o)/(g-n),oe.aa(a,t)?(t=r*(a-n)+o,b<e?(n=b,b=e):n=e,t<n?(h.h(a,n),!1):t>b?(h.h(a,b),!1):(h.h(a,t),!0)):(g=(e-b)/(t-a),oe.aa(r,g)?(oe.Ph(a,b,t,e,n,o,h),!1):(n=(g*a-r*n+o-b)/(g-r),oe.aa(g,0)?(a<t?(e=a,a=t):e=t,n<e?(h.h(e,b),!1):n>a?(h.h(a,b),!1):(h.h(n,b),!0)):oe.Ph(a,b,t,e,n,g*(n-a)+b,h))))},vB:function(a,b,t,e,n){return oe.Ke(t.x,t.y,e.x,e.y,a.x,a.y,b.x,b.y,n)},tB:function(a,b,t,e,n,o,g,r,h,l){function c(t,e){var n=(t-a)*(t-a)+(e-b)*(e-b);n<f&&(f=n,h.h(t,e))}var f=1/0;c(h.x,h.y);var p=0,d=0,q=0,u=0;if(n<g?(p=n,d=g):(p=g,d=n),o<r?(q=n,u=g):(q=g,u=n),p=(d-p)/2+l,l=(u-q)/2+l,n=(n+g)/2,o=(o+r)/2,0===p||0===l)return h;if(.5>(t>a?t-a:a-t)){if(0>(p=1-(t-n)*(t-n)/(p*p)))return h;e=-l*(p=Math.sqrt(p))+o,c(t,l*p+o),c(t,e)}else{if(0>(p=(r=2*(t=(e-b)/(t-a))*(b-t*a)/(l*l)-2*t*o/(l*l)-2*n/(p*p))*r-4*(e=1/(p*p)+t*t/(l*l))*(2*t*a*o/(l*l)-2*b*o/(l*l)+o*o/(l*l)+n*n/(p*p)-1+(b-t*a)*(b-t*a)/(l*l))))return h;c(l=(-r+(p=Math.sqrt(p)))/(2*e),t*l-t*a+b),c(p=(-r-p)/(2*e),t*p-t*a+b)}return h},Ef:function(a,b,t,e,n,o,g,r,h){var l=1e21,c=a,f=b;if(oe.Ke(a,b,a,e,n,o,g,r,h)){var p=(h.x-n)*(h.x-n)+(h.y-o)*(h.y-o);p<l&&(l=p,c=h.x,f=h.y)}return oe.Ke(t,b,t,e,n,o,g,r,h)&&((p=(h.x-n)*(h.x-n)+(h.y-o)*(h.y-o))<l&&(l=p,c=h.x,f=h.y)),oe.Ke(a,b,t,b,n,o,g,r,h)&&((b=(h.x-n)*(h.x-n)+(h.y-o)*(h.y-o))<l&&(l=b,c=h.x,f=h.y)),oe.Ke(a,e,t,e,n,o,g,r,h)&&((a=(h.x-n)*(h.x-n)+(h.y-o)*(h.y-o))<l&&(l=a,c=h.x,f=h.y)),h.h(c,f),1e21>l},sB:function(a,b,t,e,n,o,g,r,h){return g=n-g,0===(t=a-t)||0===g?0===t?n=(b=(o-r)/g)*(r=a)+(o-b*n):n=(o=(b-e)/t)*(r=n)+(b-o*a):n=(e=(b-e)/t)*(r=(o-(r=(o-r)/g)*n-(a=b-e*a))/(e-r))+a,h.h(r,n),h},Pt:function(a,b,t){return oe.Fy(a.x,a.y,a.width,a.height,b.x,b.y,t.x,t.y)},Fy:function(a,b,t,e,n,o,g,r){var h=a+t,l=b+e;return n===g?(o<r?(g=o,o=r):g=r,a<=n&&n<=h&&g<=l&&o>=b):o===r?(n<g?(r=n,n=g):r=g,b<=o&&o<=l&&r<=h&&n>=a):!!(oi(a,b,t,e,n,o)||oi(a,b,t,e,g,r)||oe.Kq(a,b,h,b,n,o,g,r)||oe.Kq(h,b,h,l,n,o,g,r)||oe.Kq(h,l,a,l,n,o,g,r)||oe.Kq(a,l,a,b,n,o,g,r))},Kq:function(a,b,t,e,n,o,g,r){return 0>=oe.zt(a,b,t,e,n,o)*oe.zt(a,b,t,e,g,r)&&0>=oe.zt(n,o,g,r,a,b)*oe.zt(n,o,g,r,t,e)},zt:function(a,b,t,e,n,o){return t-=a,0===(o=(a=n-a)*(e-=b)-(b=o-b)*t)&&(0<(o=a*t+b*e)&&(0>(o=(a-t)*t+(b-e)*e)&&(o=0))),0>o?-1:0<o?1:0},Rq:function(a){return 0>a&&(a+=360),360<=a&&(a-=360),a},iy:function(a,b,t,e,n,o){var g=Math.PI;o||(e*=g/180,n*=g/180);var r=e>n?-1:1;o=[];var h=g/2,l=e;if(1e-5>(e=Math.min(2*g,Math.abs(n-e))))return h=l+r*Math.min(e,h),r=a+t*Math.cos(l),l=b+t*Math.sin(l),a+=t*Math.cos(h),b+=t*Math.sin(h),t=(r+a)/2,h=(l+b)/2,o.push([r,l,t,h,t,h,a,b]),o;for(;1e-5<e;)n=l+r*Math.min(e,h),o.push(oe.Hz(t,l,n,a,b)),e-=Math.abs(n-l),l=n;return o},Hz:function(a,b,t,e,n){var o=(t-b)/2,g=a*Math.cos(o),r=a*Math.sin(o),h=-r,l=g*g+h*h,c=l+g*g+h*r;return r=g-(l=4/3*(Math.sqrt(2*l*c)-c)/(g*r-h*g))*h,h=-(g=h+l*g),l=o+b,o=Math.cos(l),l=Math.sin(l),[e+a*Math.cos(b),n+a*Math.sin(b),e+r*o-g*l,n+r*l+g*o,e+r*o-h*l,n+r*l+h*o,e+a*Math.cos(t),n+a*Math.sin(t)]},Cq:function(a,b,t,e,n,o,g){var r=t=Math.floor((a-t)/n)*n+t;return t+n-a<n/2&&(r=t+n),a=e=Math.floor((b-e)/o)*o+e,e+o-b<o/2&&(a=e+o),g.h(r,a),g},vy:function(a,b){var t,e=Math.max(a,b);a=Math.min(a,b);do{b=e%a,e=t=a,a=b}while(0<b);return t},Mz:function(a,b,t,e){var n=0>t,o=0>e;if(a<b)var g=1,r=0;else g=0,r=1;var h=0===g?a:b,l=0===g?t:e;return(0===g?n:o)&&(l=-l),t=0===(g=r)?t:e,(0===g?n:o)&&(t=-t),oe.Nz(h,0===g?a:b,l,t,0,0)},Nz:function(a,b,t,e,n,o){if(0<e)if(0<t){n=a*a,a*=t;var g=b*e,r=-(o=b*b)+g,h=-o+Math.sqrt(a*a+g*g);b=r;for(var l=0;9999999999>l&&((b=.5*(r+h))!==r&&b!==h);++l){var c=a/(b+n),f=g/(b+o);if(0<(c=c*c+f*f-1))r=b;else{if(!(0>c))break;h=b}}t=n*t/(b+n)-t,e=o*e/(b+o)-e,t=Math.sqrt(t*t+e*e)}else t=Math.abs(e-b);else(o=a*t)<(e=a*a-b*b)?(e=o/e,o=b*Math.sqrt(Math.abs(1-e*e)),t=a*e-t,t=Math.sqrt(t*t+o*o)):t=Math.abs(t-a);return t},Qe:new et,an:new et,Th:new et,Uh:0};function td(a){pt(this),this.s=!1,void 0===a&&(a=ve),this.pa=a,this.oc=this.hc=this.fd=this.ed=0,this.Hj=new ut,this.Xr=this.Hj.Aa,this.Fr=(new Jt).freeze(),this.qa=!0,this.hn=this.Zk=null,this.jn=NaN,this.qf=yi,this.rf=Si,this.Bl=this.Cl=NaN,this.Uf=Bs}function re(a,b){return a.type===ge&&b.type===ve&&!!(1===b.figures.count&&(b=b.figures.J(0),1===b.segments.count&&oe.A(a.startX,b.startX)&&oe.A(a.startY,b.startY)&&(b=b.segments.J(0),b.type===Pe&&oe.A(a.endX,b.endX)&&oe.A(a.endY,b.endY))))}function se(a){return a.toString()}function ae(a,b){function t(){return u>=w-1||null!==f[u+1].match(k)}function e(){return u++,f[u]}function n(){var a=new St(parseFloat(e()),parseFloat(e()));return y===y.toLowerCase()&&(a.x=x.x+a.x,a.y=x.y+a.y),a}function o(){return x=n()}function g(){return v=n()}function r(){var a=m.toLowerCase();return"c"!==a&&"s"!==a&&"q"!==a&&"t"!==a?x:new St(2*x.x-v.x,2*x.y-v.y)}void 0===b&&(b=!1);var h=new RegExp("(["+xe+"])(["+xe+"])","gm"),l=new RegExp("(["+xe+"])([^s])","gm"),c=new RegExp("([^s])(["+xe+"])","gm"),f=(a=(a=(a=(a=(a=(a=(a=(a=a.replace(/,/gm," ")).replace(h,"$1 $2")).replace(h,"$1 $2")).replace(l,"$1 $2")).replace(c,"$1 $2")).replace(/([0-9])([+\-])/gm,"$1 $2")).replace(/[\s\r\t\n]+/gm," ")).replace(/^\s+|\s+$/g,"")).split(" ");for(a=0;a<f.length;a++)if(null!==(l=f[a]).match(/(\.[0-9]*)(\.)/gm)){h=I(),c="";for(var p=!1,d=0;d<l.length;d++){var q=l[d];"."!==q||p?"."===q?(h.push(c),c="."):c+=q:(p=!0,c+=q)}for(h.push(c),f.splice(a,1),l=0;l<h.length;l++)f.splice(a+l,0,h[l]);a+=h.length-1,R(h)}var u=-1,y="",m="";h=new St(0,0);var v=new St(0,0),x=new St(0,0),w=f.length;a=du(null),c=l=!1,p=!0,d=null;for(var k=new RegExp("["+xe+"]");!(u>=w-1);)if(m=y,""!==(y=e()))switch(y.toUpperCase()){case"X":p=!0,c=l=!1;break;case"M":for(d=o(),null===a.ic||!0===p?(hu(a,d.x,d.y,l,!c),p=!1):a.moveTo(d.x,d.y),h=x;!t();)d=o(),a.lineTo(d.x,d.y);break;case"L":for(;!t();)d=o(),a.lineTo(d.x,d.y);break;case"H":for(;!t();)x=new St((y===y.toLowerCase()?x.x:0)+parseFloat(e()),x.y),a.lineTo(x.x,x.y);break;case"V":for(;!t();)x=new St(x.x,(y===y.toLowerCase()?x.y:0)+parseFloat(e())),a.lineTo(x.x,x.y);break;case"C":for(;!t();){d=n(),q=g();var M=o();uu(a,d.x,d.y,q.x,q.y,M.x,M.y)}break;case"S":for(;!t();)d=r(),q=g(),M=o(),uu(a,d.x,d.y,q.x,q.y,M.x,M.y);break;case"Q":for(;!t();)d=g(),q=o(),cu(a,d.x,d.y,q.x,q.y);break;case"T":for(;!t();)v=d=r(),q=o(),cu(a,d.x,d.y,q.x,q.y);break;case"B":for(;!t();){d=parseFloat(e()),q=parseFloat(e()),M=parseFloat(e());var S=parseFloat(e()),P=parseFloat(e()),N=P,C=!1;t()||(N=parseFloat(e()),t()||(C=0!==parseFloat(e()))),y===y.toLowerCase()&&(M+=x.x,S+=x.y),a.arcTo(d,q,M,S,P,N,C)}break;case"A":for(;!t();)d=Math.abs(parseFloat(e())),q=Math.abs(parseFloat(e())),M=parseFloat(e()),P=S=!1,C=N=0,1===(N=e()).length?(S=!!parseFloat(N),P=!!parseFloat(e()),N=parseFloat(e())):2===N.length?(S=!!parseFloat(N[0]),P=!!parseFloat(N[1]),N=parseFloat(e())):(S=!!parseFloat(N[0]),P=!!parseFloat(N[1]),N=parseFloat(N.slice(2))),C=parseFloat(e()),y===y.toLowerCase()&&(N=x.x+N,C=x.y+C),x.h(N,C),fu(a,d,q,M,S,P,N,C);break;case"Z":lu(a),x=h;break;case"F":for(d="",q=1;f[u+q];)if(null!==f[u+q].match(/[Uu]/))q++;else{if(null!==f[u+q].match(k)){d=f[u+q];break}q++}d.match(/[Mm]/)?l=!0:0<a.ic.segments.length&&(a.ic.isFilled=!0);break;case"U":for(d="",q=1;f[u+q];)if(null!==f[u+q].match(/[Ff]/))q++;else{if(null!==f[u+q].match(k)){d=f[u+q];break}q++}d.match(/[Mm]/)?c=!0:a.er(!1)}if(h=a.Jt,pu=a,b)for(b=h.figures.iterator;b.next();)b.value.isFilled=!0;return h}function he(a,b){for(var t=a.length,e=St.alloc(),n=0;n<t;n++){var o=a[n];e.x=o[0],e.y=o[1],b.sa(e),o[0]=e.x,o[1]=e.y,e.x=o[2],e.y=o[3],b.sa(e),o[2]=e.x,o[3]=e.y,e.x=o[4],e.y=o[5],b.sa(e),o[4]=e.x,o[5]=e.y,e.x=o[6],e.y=o[7],b.sa(e),o[6]=e.x,o[7]=e.y}St.free(e)}function le(a,b,t){switch(a.type){case ge:case ye:case me:t?b.h(a.ed,a.fd,0,0):ni(b,a.ed,a.fd,0,0),ni(b,a.hc,a.oc,0,0);break;case ve:var e=a.figures;a=e.j,e=e.length;for(var n=0;n<e;n++){var o=a[n];t&&0===n?b.h(o.startX,o.startY,0,0):ni(b,o.startX,o.startY,0,0);for(var g=o.segments.j,r=g.length,h=o.startX,l=o.startY,c=0;c<r;c++){var f=g[c];switch(f.type){case Pe:case Se:ni(b,h=f.endX,l=f.endY,0,0);break;case Ne:oe.sm(h,l,f.point1X,f.point1Y,f.point2X,f.point2Y,f.endX,f.endY,.5,b),h=f.endX,l=f.endY;break;case Ce:oe.nw(h,l,f.point1X,f.point1Y,f.endX,f.endY,.5,b),h=f.endX,l=f.endY;break;case Te:case Le:var p=f.type===Te?ke(f,o):Me(f,o,h,l),d=p.length;if(0===d){ni(b,h=f.centerX,l=f.centerY,0,0);break}f=null;for(var q=0;q<d;q++)f=p[q],oe.sm(f[0],f[1],f[2],f[3],f[4],f[5],f[6],f[7],.5,b);null!==f&&(h=f[6],l=f[7]);break;default:N("Unknown Segment type: "+f.type)}}}break;default:N("Unknown Geometry type: "+a.type)}}function ue(a,b,t,e,n){var o=b.x;b=b.y;for(var r,h,l,c,g=a.bounds.x-20,f=0,p=a.figures.j,d=p.length,q=0;q<d;q++){var u=p[q];if(u.isFilled){if(e&&u.$(o,b,t))return!0;for(var y=u.segments,m=r=u.startX,v=h=u.startY,x=y.j,w=0;w<=y.length;w++){var k=void 0;if(w!==y.length){var M=(k=x[w]).type;a=k.endX,c=k.endY}else M=Pe,a=m,c=v;switch(M){case Se:if(m=ce(o,b,g,b,r,h,m,v),isNaN(m))return!0;f+=m,m=a,v=c;break;case Pe:if(r=ce(o,b,g,b,r,h,a,c),isNaN(r))return!0;f+=r;break;case Ne:f+=l=oe.tq(r,h,k.point1X,k.point1Y,k.point2X,k.point2Y,a,c,g,b,o,b,.5);break;case Ce:f+=l=oe.tq(r,h,(r+2*k.point1X)/3,(h+2*k.point1Y)/3,(2*k.point1X+a)/3,(2*k.point1Y+c)/3,a,c,g,b,o,b,.5);break;case Te:case Le:var S=(M=k.type===Te?ke(k,u):Me(k,u,r,h)).length;if(0===S){if(r=ce(o,b,g,b,r,h,k.centerX,k.centerY),isNaN(r))return!0;f+=r;break}k=null;for(var P=0;P<S;P++){if(k=M[P],0===P){if(l=ce(o,b,g,b,r,h,k[0],k[1]),isNaN(l))return!0;f+=l}f+=l=oe.tq(k[0],k[1],k[2],k[3],k[4],k[5],k[6],k[7],g,b,o,b,.5)}null!==k&&(a=k[6],c=k[7]);break;default:N("Unknown Segment type: "+k.type)}r=a,h=c}if(0!==f)return!0;f=0}else if(u.$(o,b,n?t:t+2))return!0}return 0!==f}function ce(a,b,t,e,n,o,g,r){if(oe.Ob(n,o,g,r,.05,a,b))return NaN;var h=(a-t)*(o-r);if(0===h)return 0;var l=((a*e-b*t)*(n-g)-(a-t)*(n*r-o*g))/h;if(b=(a*e-b*t)*(o-r)/h,l>=a)return 0;if((n>g?n-g:g-n)<(o>r?o-r:r-o)){if(o<r){if(b<o||b>r)return 0}else if(b<r||b>o)return 0}else if(n<g){if(l<n||l>g)return 0}else if(l<g||l>n)return 0;return 0<h?1:-1}function fe(a,b,t,e){for(var n=(a=a.figures.j).length,o=0;o<n;o++)if(a[o].$(b,t,e))return!0;return!1}function de(a){if(null===a.Zk){var b=a.Zk=[],t=a.hn=[],e=[],n=[];if(a.type===ge)e.push(a.startX),e.push(a.startY),e.push(a.endX),e.push(a.endY),b.push(e),n.push(Math.sqrt((a.startX-a.endX)*(a.startX-a.endX)+(a.startY-a.endY)*(a.startY-a.endY))),t.push(n);else if(a.type===ye)e.push(a.startX),e.push(a.startY),e.push(a.endX),e.push(a.startY),e.push(a.endX),e.push(a.endY),e.push(a.startX),e.push(a.endY),e.push(a.startX),e.push(a.startY),b.push(e),n.push(Math.abs(a.startX-a.endX)),n.push(Math.abs(a.startY-a.endY)),n.push(Math.abs(a.startX-a.endX)),n.push(Math.abs(a.startY-a.endY)),t.push(n);else if(a.type===me){var o=new be;o.startX=a.endX,o.startY=(a.startY+a.endY)/2;var g=new we(Te);if(g.startAngle=0,g.sweepAngle=360,g.centerX=(a.startX+a.endX)/2,g.centerY=(a.startY+a.endY)/2,g.radiusX=Math.abs(a.startX-a.endX)/2,g.radiusY=Math.abs(a.startY-a.endY)/2,o.add(g),0===(n=(a=ke(g,o)).length))e.push(g.centerX),e.push(g.centerY);else{g=o.startX,o=o.startY;for(var r=0;r<n;r++){var h=a[r];oe.De(g,o,h[2],h[3],h[4],h[5],h[6],h[7],.5,e),g=h[6],o=h[7]}}b.push(e),t.push(pe(e))}else for(a=a.figures.iterator;a.next();){n=a.value,(e=[]).push(n.startX),e.push(n.startY),r=g=n.startX,h=o=n.startY;for(var l=n.segments.j,c=l.length,f=0;f<c;f++){var p=l[f];switch(p.type){case Se:4<=e.length&&(b.push(e),t.push(pe(e))),(e=[]).push(p.endX),e.push(p.endY),r=g=p.endX,h=o=p.endY;break;case Pe:e.push(p.endX),e.push(p.endY),g=p.endX,o=p.endY;break;case Ne:oe.De(g,o,p.point1X,p.point1Y,p.point2X,p.point2Y,p.endX,p.endY,.5,e),g=p.endX,o=p.endY;break;case Ce:oe.Uq(g,o,p.point1X,p.point1Y,p.endX,p.endY,.5,e),g=p.endX,o=p.endY;break;case Te:var d=ke(p,n),q=d.length;if(0===q){e.push(p.centerX),e.push(p.centerY),g=p.centerX,o=p.centerY;break}for(var u=0;u<q;u++){var y=d[u];oe.De(g,o,y[2],y[3],y[4],y[5],y[6],y[7],.5,e),g=y[6],o=y[7]}break;case Le:if(0===(q=(d=Me(p,n,g,o)).length)){e.push(p.centerX),e.push(p.centerY),g=p.centerX,o=p.centerY;break}for(u=0;u<q;u++)y=d[u],oe.De(g,o,y[2],y[3],y[4],y[5],y[6],y[7],.5,e),g=y[6],o=y[7];break;default:N("Segment not of valid type: "+p.type)}p.isClosed&&(e.push(r),e.push(h))}4<=e.length&&(b.push(e),t.push(pe(e)))}}}function pe(a){for(var b=[],t=0,e=0,n=a.length,o=0;o<n;o+=2){var g=a[o],r=a[o+1];0!==o&&b.push(Math.sqrt(At(t,e,g,r))),t=g,e=r}return b}oe.za=oe.iB,td.prototype.copy=function(){var a=new td;a.pa=this.pa,a.ed=this.ed,a.fd=this.fd,a.hc=this.hc,a.oc=this.oc;for(var b=this.Hj.j,t=b.length,e=a.Hj,n=0;n<t;n++){var o=b[n].copy();e.add(o)}return a.Xr=this.Xr,a.Fr.assign(this.Fr),a.qa=this.qa,a.Zk=this.Zk,a.hn=this.hn,a.jn=this.jn,a.qf=this.qf.G(),a.rf=this.rf.G(),a.Cl=this.Cl,a.Bl=this.Bl,a.Uf=this.Uf,a},(n=td.prototype).ca=function(){return this.freeze(),Object.freeze(this),this},n.freeze=function(){this.s=!0;var a=this.figures;a.freeze();for(var b=(a=a.j).length,t=0;t<b;t++)a[t].freeze();return this},n.ea=function(){Object.isFrozen(this)&&N("cannot thaw constant: "+this),this.s=!1;var a=this.figures;a.ea();for(var b=(a=a.j).length,t=0;t<b;t++)a[t].ea();return this},n.Na=function(a){if(!(a instanceof td))return!1;if(this.type!==a.type)return this.type===ge&&a.type===ve?re(this,a):a.type===ge&&this.type===ve&&re(a,this);if(this.type===ve){var b=this.figures.j;a=a.figures.j;var t=b.length;if(t!==a.length)return!1;for(var e=0;e<t;e++)if(!b[e].Na(a[e]))return!1;return!0}return oe.A(this.startX,a.startX)&&oe.A(this.startY,a.startY)&&oe.A(this.endX,a.endX)&&oe.A(this.endY,a.endY)},n.jb=function(a){a.classType===td&&(this.type=a)},n.toString=function(a){switch(void 0===a&&(a=-1),this.type){case ge:return 0>a?"M"+this.startX.toString()+" "+this.startY.toString()+"L"+this.endX.toString()+" "+this.endY.toString():"M"+this.startX.toFixed(a)+" "+this.startY.toFixed(a)+"L"+this.endX.toFixed(a)+" "+this.endY.toFixed(a);case ye:var b=new Jt(this.startX,this.startY,0,0);return b.Rw(this.endX,this.endY,0,0),0>a?"M"+b.x.toString()+" "+b.y.toString()+"H"+b.right.toString()+"V"+b.bottom.toString()+"H"+b.left.toString()+"z":"M"+b.x.toFixed(a)+" "+b.y.toFixed(a)+"H"+b.right.toFixed(a)+"V"+b.bottom.toFixed(a)+"H"+b.left.toFixed(a)+"z";case me:if((b=new Jt(this.startX,this.startY,0,0)).Rw(this.endX,this.endY,0,0),0>a)return"M"+(a=b.left.toString()+" "+(b.y+b.height/2).toString())+"A"+(b.width/2).toString()+" "+(b.height/2).toString()+" 0 0 1 "+b.right.toString()+" "+(b.y+b.height/2).toString()+"A"+(b.width/2).toString()+" "+(b.height/2).toString()+" 0 0 1 "+a;var t=b.left.toFixed(a)+" "+(b.y+b.height/2).toFixed(a);return"M"+t+"A"+(b.width/2).toFixed(a)+" "+(b.height/2).toFixed(a)+" 0 0 1 "+b.right.toFixed(a)+" "+(b.y+b.height/2).toFixed(a)+"A"+(b.width/2).toFixed(a)+" "+(b.height/2).toFixed(a)+" 0 0 1 "+t;case ve:b="";for(var e=(t=this.figures.j).length,n=0;n<e;n++){var o=t[n];0<n&&(b+=" x "),o.isFilled&&(b+="F "),b+=o.toString(a)}return b;default:return this.type.toString()}},n.ew=function(){if(this.qa||this.Xr!==this.figures.Aa)return!0;for(var a=this.figures.j,b=a.length,t=0;t<b;t++)if(a[t].ew())return!0;return!1},td.prototype.computeBounds=function(){this.qa=!1,this.hn=this.Zk=null,this.jn=NaN,this.Xr=this.figures.Aa;for(var a=this.figures.j,b=a.length,t=0;t<b;t++){var e=a[t];e.qa=!1;var n=e.segments;e.bt=n.Aa,n=(e=n.j).length;for(var o=0;o<n;o++){var g=e[o];g.qa=!1,g.Se=null}}(a=this.Fr).ea(),isNaN(this.Cl)||isNaN(this.Bl)?a.h(0,0,0,0):a.h(0,0,this.Cl,this.Bl),le(this,a,!1),ni(a,0,0,0,0),a.freeze()},td.prototype.hy=function(){var a=new Jt;return le(this,a,!0),a},td.prototype.normalize=function(){this.s&&C(this);var a=this.hy();return this.offset(-a.x,-a.y),new St(-a.x,-a.y)},td.prototype.offset=function(a,b){return this.s&&C(this),this.transform(1,0,0,1,a,b),this},td.prototype.scale=function(a,b){return this.s&&C(this),this.transform(a,0,0,b,0,0),this},td.prototype.rotate=function(a,b,t){this.s&&C(this),void 0===b&&(b=0),void 0===t&&(t=0);var e=ee.alloc();return e.reset(),e.rotate(a,b,t),this.transform(e.m11,e.m12,e.m21,e.m22,e.dx,e.dy),ee.free(e),this},(n=td.prototype).transform=function(a,b,t,e,n,o){switch(this.type){case ge:case ye:case me:var g=this.ed,r=this.fd;this.ed=g*a+r*t+n,this.fd=g*b+r*e+o,g=this.hc,r=this.oc,this.hc=g*a+r*t+n,this.oc=g*b+r*e+o;break;case ve:for(var h=this.figures.j,l=h.length,c=0;c<l;c++){var f=h[c];g=f.startX,r=f.startY,f.startX=g*a+r*t+n,f.startY=g*b+r*e+o;for(var p=(f=f.segments.j).length,d=0;d<p;d++){var q=f[d];switch(q.type){case Pe:case Se:g=q.endX,r=q.endY,q.endX=g*a+r*t+n,q.endY=g*b+r*e+o;break;case Ne:g=q.point1X,r=q.point1Y,q.point1X=g*a+r*t+n,q.point1Y=g*b+r*e+o,g=q.point2X,r=q.point2Y,q.point2X=g*a+r*t+n,q.point2Y=g*b+r*e+o,g=q.endX,r=q.endY,q.endX=g*a+r*t+n,q.endY=g*b+r*e+o;break;case Ce:g=q.point1X,r=q.point1Y,q.point1X=g*a+r*t+n,q.point1Y=g*b+r*e+o,g=q.endX,r=q.endY,q.endX=g*a+r*t+n,q.endY=g*b+r*e+o;break;case Te:g=q.centerX,r=q.centerY,q.centerX=g*a+r*t+n,q.centerY=g*b+r*e+o,0!==b&&(0>(g=180*Math.atan2(b,a)/Math.PI)&&(g+=360),q.startAngle+=g),0>a&&(q.startAngle=180-q.startAngle,q.sweepAngle=-q.sweepAngle),0>e&&(q.startAngle=-q.startAngle,q.sweepAngle=-q.sweepAngle),q.radiusX*=Math.sqrt(a*a+t*t),void 0!==q.radiusY&&(q.radiusY*=Math.sqrt(b*b+e*e));break;case Le:g=q.endX,r=q.endY,q.endX=g*a+r*t+n,q.endY=g*b+r*e+o,0!==b&&(0>(g=180*Math.atan2(b,a)/Math.PI)&&(g+=360),q.xAxisRotation+=g),0>a&&(q.xAxisRotation=180-q.xAxisRotation,q.isClockwiseArc=!q.isClockwiseArc),0>e&&(q.xAxisRotation=-q.xAxisRotation,q.isClockwiseArc=!q.isClockwiseArc),q.radiusX*=Math.sqrt(a*a+t*t),q.radiusY*=Math.sqrt(b*b+e*e);break;default:N("Unknown Segment type: "+q.type)}}}}return this.qa=!0,this},n.$=function(a,b){void 0===b&&(b=0);var t=this.ed,e=this.fd,n=this.hc,o=this.oc;switch(this.type){case ge:return oe.Ob(t,e,n,o,b,a.x,a.y);case ye:var g=Jt.allocAt(Math.min(t,n)-b,Math.min(e,o)-b,Math.abs(n-t)+2*b,Math.abs(o-e)+2*b);return a=g.$(a),Jt.free(g),a;case me:g=Math.min(t,n)-b;var r=Math.min(e,o)-b;return t=(Math.abs(n-t)+2*b)/2,b=(Math.abs(o-e)+2*b)/2,0>=t||0>=b?!1:1>=(g=a.x-(g+t))*g/(t*t)+(r=a.y-(r+b))*r/(b*b);case ve:return ue(this,a,b,!0,!1);default:return!1}},n.Vv=function(a,b){if(0>a?a=0:1<a&&(a=1),void 0===b&&(b=new St),this.type===ge)return b.h(this.startX+a*(this.endX-this.startX),this.startY+a*(this.endY-this.startY)),b;for(var t=this.flattenedSegments,e=this.flattenedLengths,n=t.length,o=this.flattenedTotalLength*a,g=0,r=0;r<n;r++){var h=e[r],l=h.length;for(a=0;a<l;a++){var c=h[a];if(g+c>=o)return e=o-g,e=0===c?0:e/c,r=(t=t[r])[2*a],n=t[2*a+1],b.h(r+(t[2*a+2]-r)*e,n+(t[2*a+3]-n)*e),b;g+=c}}return b},n.wy=function(a){if(0>a?a=0:1<a&&(a=1),this.type===ge)return 180*Math.atan2(this.endY-this.startY,this.endX-this.startX)/Math.PI;for(var b=this.flattenedSegments,t=this.flattenedLengths,e=b.length,n=this.flattenedTotalLength*a,o=0,g=0;g<e;g++){var r=t[g],h=r.length;for(a=0;a<h;a++){var l=r[a];if(o+l>=n)return b=(n=b[g])[2*a],t=n[2*a+1],e=n[2*a+2],a=n[2*a+3],1>Math.abs(e-b)&&1>Math.abs(a-t)?0:1>Math.abs(e-b)?0<=a-t?90:270:1>Math.abs(a-t)?0<=e-b?0:180:180*Math.atan2(a-t,e-b)/Math.PI;o+=l}}return NaN},n.Wv=function(a,b){if(0>a?a=0:1<a&&(a=1),void 0===b&&(b=[]),b.length=3,this.type===ge)return b[0]=this.startX+a*(this.endX-this.startX),b[1]=this.startY+a*(this.endY-this.startY),b[2]=180*Math.atan2(this.endY-this.startY,this.endX-this.startX)/Math.PI,b;for(var t=this.flattenedSegments,e=this.flattenedLengths,n=t.length,o=this.flattenedTotalLength*a,g=0,r=0;r<n;r++){var h=e[r],l=h.length;for(a=0;a<l;a++){var c=h[a];if(g+c>=o)return e=o-g,e=0===c?0:e/c,t=(c=t[r])[2*a],r=c[2*a+1],n=c[2*a+2],a=c[2*a+3],b[0]=t+(n-t)*e,b[1]=r+(a-r)*e,b[2]=1>Math.abs(n-t)&&1>Math.abs(a-r)?0:1>Math.abs(n-t)?0<=a-r?90:270:1>Math.abs(a-r)?0<=n-t?0:180:180*Math.atan2(a-r,n-t)/Math.PI,b;g+=c}}return b},n.xy=function(a){if(this.type===ge){var b=this.startX,t=this.startY,e=this.endX,n=this.endY;if(b!==e||t!==n){var o=a.x;if(a=a.y,b===e){if(t<n){var g=t;e=n}else g=n,e=t;return a<=g?g===t?0:1:a>=e?e===t?0:1:Math.abs(a-t)/(e-g)}if(t===n)return b<e?g=b:(g=e,e=b),o<=g?g===b?0:1:o>=e?e===b?0:1:Math.abs(o-b)/(e-g);g=(e-b)*(e-b)+(n-t)*(n-t);var r=St.alloc();return oe.Ph(b,t,e,n,o,a,r),a=r.x,o=r.y,St.free(r),Math.sqrt(((a-b)*(a-b)+(o-t)*(o-t))/g)}}else{if(this.type!==ye){b=this.flattenedSegments,t=this.flattenedLengths,o=this.flattenedTotalLength,e=St.alloc(),n=1/0,r=g=0,m=b.length;for(var h=v=0,l=0;l<m;l++)for(var p=b[l],c=t[l],q=p.length,u=0;u<q;u+=2){var f=p[u],d=p[u+1];if(0!==u){oe.Ph(v,h,f,d,a.x,a.y,e);var y=(e.x-a.x)*(e.x-a.x)+(e.y-a.y)*(e.y-a.y);y<n&&(n=y,g=r,g+=Math.sqrt((e.x-v)*(e.x-v)+(e.y-h)*(e.y-h))),r+=c[(u-2)/2]}v=f,h=d}return St.free(e),0>(a=g/o)?0:1<a?1:a}g=this.startX,r=this.startY;var m=this.endX;if(n=this.endY,g!==m||r!==n){o=2*(b=m-g)+2*(t=n-r),e=a.x,a=a.y,e=Math.min(Math.max(e,g),m),a=Math.min(Math.max(a,r),n),g=Math.abs(e-g),m=Math.abs(e-m),r=Math.abs(a-r),n=Math.abs(a-n);var v=Math.min(g,m,r,n);if(v===r)return e/o;if(v===m)return(b+a)/o;if(v===n)return(2*b+t-e)/o;if(v===g)return(2*b+2*t-a)/o}}return 0},n.add=function(a){return this.Hj.add(a),this},n.Wm=function(a,b,t,e,n,o,g,r){return this.s&&C(this),this.qf=new $i(a,b,n,o).freeze(),this.rf=new $i(t,e,g,r).freeze(),this},v.Object.defineProperties(td.prototype,{flattenedSegments:{get:function(){return de(this),this.Zk}},flattenedLengths:{get:function(){return de(this),this.hn}},flattenedTotalLength:{get:function(){var a=this.jn;if(isNaN(a)){if(this.type===ge){a=Math.abs(this.endX-this.startX);var b=Math.abs(this.endY-this.startY);a=Math.sqrt(a*a+b*b)}else if(this.type===ye)a=2*Math.abs(this.endX-this.startX)+2*Math.abs(this.endY-this.startY);else for(var t=(b=this.flattenedLengths).length,e=a=0;e<t;e++)for(var n=b[e],o=n.length,g=0;g<o;g++)a+=n[g];this.jn=a}return a}},type:{get:function(){return this.pa},set:function(a){this.pa!==a&&(this.s&&C(this,a),this.pa=a,this.qa=!0)}},startX:{get:function(){return this.ed},set:function(a){this.ed!==a&&(this.s&&C(this,a),this.ed=a,this.qa=!0)}},startY:{get:function(){return this.fd},set:function(a){this.fd!==a&&(this.s&&C(this,a),this.fd=a,this.qa=!0)}},endX:{get:function(){return this.hc},set:function(a){this.hc!==a&&(this.s&&C(this,a),this.hc=a,this.qa=!0)}},endY:{get:function(){return this.oc},set:function(a){this.oc!==a&&(this.s&&C(this,a),this.oc=a,this.qa=!0)}},figures:{get:function(){return this.Hj},set:function(a){this.Hj!==a&&(this.s&&C(this,a),this.Hj=a,this.qa=!0)}},spot1:{get:function(){return this.qf},set:function(a){this.s&&C(this,a),this.qf=a.G()}},spot2:{get:function(){return this.rf},set:function(a){this.s&&C(this,a),this.rf=a.G()}},defaultStretch:{get:function(){return this.Uf},set:function(a){this.s&&C(this,a),this.Uf=a}},bounds:{get:function(){return this.ew()&&this.computeBounds(),this.Fr}}}),td.prototype.setSpots=td.prototype.Wm,td.prototype.add=td.prototype.add,td.prototype.getFractionForPoint=td.prototype.xy,td.prototype.getPointAndAngleAlongPath=td.prototype.Wv,td.prototype.getAngleAlongPath=td.prototype.wy,td.prototype.getPointAlongPath=td.prototype.Vv,td.prototype.containsPoint=td.prototype.$,td.prototype.transform=td.prototype.transform,td.prototype.rotate=td.prototype.rotate,td.prototype.scale=td.prototype.scale,td.prototype.offset=td.prototype.offset,td.prototype.normalize=td.prototype.normalize,td.prototype.computeBoundsWithoutOrigin=td.prototype.hy,td.prototype.equalsApprox=td.prototype.Na;var ge=new _(td,"Line",0),ye=new _(td,"Rectangle",1),me=new _(td,"Ellipse",2),ve=new _(td,"Path",3),xe="UuBbMmZzLlHhVvCcSsQqTtAaFfXx";function be(a,b,t,e){pt(this),this.sx=null,this.s=!1,void 0===t&&(t=!0),this.js=t,void 0===e&&(e=!0),this.os=e,this.ed=void 0!==a?a:0,this.fd=void 0!==b?b:0,this.am=new ut,this.bt=this.am.Aa,this.qa=!0}function we(a,b,t,e,n,o,g,r){pt(this),this.s=!1,void 0===a&&(a=Pe),this.pa=a,this.hc=void 0!==b?b:0,this.oc=void 0!==t?t:0,void 0===e&&(e=0),void 0===n&&(n=0),void 0===o&&(o=0),void 0===g&&(g=0),a===Le?(0>(a=o%360)&&(a+=360),this.Ae=a,this.Pi=0,this.Qi=Math.max(e,0),this.qh=Math.max(n,0),this.Kl="boolean"==typeof g?g:"number"==typeof g&&!!g,this.cl=!!r):(this.Ae=e,this.Pi=n,a===Te&&(o=Math.max(o,0)),this.Qi=o,"number"==typeof g?(a===Te&&(g=Math.max(g,0)),this.qh=g):this.qh=0,this.cl=this.Kl=!1),this.Mj=!1,this.qa=!0,this.Se=null}function ke(a,b){if(null!==a.Se&&!1===b.qa)return a.Se;var t=a.radiusX,e=a.radiusY;if(void 0===e&&(e=t),0===t||0===e)return a.Se=[],a.Se;b=a.Ae;var n=a.Pi,o=oe.iy(0,0,t<e?t:e,a.startAngle,a.startAngle+a.sweepAngle,!1);if(t!==e){var g=ee.alloc();g.reset(),t<e?g.scale(1,e/t):g.scale(t/e,1),he(o,g),ee.free(g)}for(t=o.length,e=0;e<t;e++)(g=o[e])[0]+=b,g[1]+=n,g[2]+=b,g[3]+=n,g[4]+=b,g[5]+=n,g[6]+=b,g[7]+=n;return a.Se=o,a.Se}function Me(a,b,t,e){function n(a,b,t,e){return(a*e<b*t?-1:1)*Math.acos((a*t+b*e)/(Math.sqrt(a*a+b*b)*Math.sqrt(t*t+e*e)))}if(null!==a.Se&&!1===b.qa)return a.Se;b=a.Qi;var o=a.qh;0===b&&(b=1e-4),0===o&&(o=1e-4);var g=Math.PI/180*a.Ae,r=a.Kl,h=a.cl,l=a.hc,c=a.oc,f=Math.cos(g),p=Math.sin(g),d=f*(t-l)/2+p*(e-c)/2,q=d*d/(b*b)+(g=-p*(t-l)/2+f*(e-c)/2)*g/(o*o);return 1<q&&(b*=Math.sqrt(q),o*=Math.sqrt(q)),q=(r===h?-1:1)*Math.sqrt((b*b*o*o-b*b*g*g-o*o*d*d)/(b*b*g*g+o*o*d*d)),isNaN(q)&&(q=0),r=q*b*g/o,q=q*-o*d/b,isNaN(r)&&(r=0),isNaN(q)&&(q=0),t=(t+l)/2+f*r-p*q,e=(e+c)/2+p*r+f*q,c=n(1,0,(d-r)/b,(g-q)/o),g=n(f=(d-r)/b,l=(g-q)/o,d=(-d-r)/b,r=(-g-q)/o),-1>=(d=(f*d+l*r)/(Math.sqrt(f*f+l*l)*Math.sqrt(d*d+r*r)))?g=Math.PI:1<=d&&(g=0),!h&&0<g&&(g-=2*Math.PI),h&&0>g&&(g+=2*Math.PI),h=b>o?1:b/o,d=b>o?o/b:1,b=oe.iy(0,0,b>o?b:o,c,c+g,!0),(o=ee.alloc()).reset(),o.translate(t,e),o.rotate(a.Ae,0,0),o.scale(h,d),he(b,o),ee.free(o),a.Se=b,a.Se}td.className="Geometry",td.stringify=se,td.fillPath=function(a){for(var b=(a=a.split(/[Xx]/)).length,t="",e=0;e<b;e++){var n=a[e];t=null!==n.match(/[Ff]/)?0===e?t+n:t+"X"+(" "===n[0]?"":" ")+n:t+(0===e?"":"X ")+"F"+(" "===n[0]?"":" ")+n}return t},td.parse=ae,td.Line=ge,td.Rectangle=ye,td.Ellipse=me,td.Path=ve,be.prototype.copy=function(){var a=new be;a.js=this.js,a.os=this.os,a.ed=this.ed,a.fd=this.fd;for(var b=this.am.j,t=b.length,e=a.am,n=0;n<t;n++){var o=b[n].copy();e.add(o)}return a.bt=this.bt,a.qa=this.qa,a.sx=this.sx,a},(n=be.prototype).Na=function(a){if(!(a instanceof be&&oe.A(this.startX,a.startX)&&oe.A(this.startY,a.startY)))return!1;var b=this.segments.j;a=a.segments.j;var t=b.length;if(t!==a.length)return!1;for(var e=0;e<t;e++)if(!b[e].Na(a[e]))return!1;return!0},n.toString=function(a){void 0===a&&(a=-1);for(var b=0>a?"M"+this.startX.toString()+" "+this.startY.toString():"M"+this.startX.toFixed(a)+" "+this.startY.toFixed(a),t=this.segments.j,e=t.length,n=0;n<e;n++)b+=" "+t[n].toString(a);return b},n.freeze=function(){this.s=!0;var a=this.segments;a.freeze();var b=a.j;a=a.length;for(var t=0;t<a;t++)b[t].freeze();return this},n.ea=function(){this.s=!1;var a=this.segments;a.ea();for(var b=(a=a.j).length,t=0;t<b;t++)a[t].ea();return this},n.ew=function(){if(this.qa)return!0;var a=this.segments;if(this.bt!==a.Aa)return!0;for(var b=(a=a.j).length,t=0;t<b;t++)if(a[t].qa)return!0;return!1},n.add=function(a){return this.am.add(a),this},n.$=function(a,b,t){for(var e=this.startX,n=this.startY,o=e,g=n,r=this.segments.j,h=r.length,l=0;l<h;l++){var c=r[l];switch(c.type){case Se:o=c.endX,g=c.endY,e=c.endX,n=c.endY;break;case Pe:if(oe.Ob(e,n,c.endX,c.endY,t,a,b))return!0;e=c.endX,n=c.endY;break;case Ne:if(oe.wt(e,n,c.point1X,c.point1Y,c.point2X,c.point2Y,c.endX,c.endY,.5,a,b,t))return!0;e=c.endX,n=c.endY;break;case Ce:if(oe.ow(e,n,c.point1X,c.point1Y,c.endX,c.endY,.5,a,b,t))return!0;e=c.endX,n=c.endY;break;case Te:case Le:var f=c.type===Te?ke(c,this):Me(c,this,e,n),p=f.length;if(0===p){if(oe.Ob(e,n,c.centerX,c.centerY,t,a,b))return!0;e=c.centerX,n=c.centerY;break}for(var d=null,q=0;q<p;q++)if(d=f[q],0===q&&oe.Ob(e,n,d[0],d[1],t,a,b)||oe.wt(d[0],d[1],d[2],d[3],d[4],d[5],d[6],d[7],.5,a,b,t))return!0;null!==d&&(e=d[6],n=d[7]);break;default:N("Unknown Segment type: "+c.type)}if(c.isClosed&&(e!==o||n!==g)&&oe.Ob(e,n,o,g,t,a,b))return!0}return!1},v.Object.defineProperties(be.prototype,{isFilled:{get:function(){return this.js},set:function(a){this.s&&C(this,a),this.js=a}},isShadowed:{get:function(){return this.os},set:function(a){this.s&&C(this,a),this.os=a}},startX:{get:function(){return this.ed},set:function(a){this.s&&C(this,a),this.ed=a,this.qa=!0}},startY:{get:function(){return this.fd},set:function(a){this.s&&C(this,a),this.fd=a,this.qa=!0}},segments:{get:function(){return this.am},set:function(a){this.s&&C(this,a),this.am=a,this.qa=!0}}}),be.prototype.add=be.prototype.add,be.prototype.equalsApprox=be.prototype.Na,be.className="PathFigure",we.prototype.copy=function(){var a=new we;return a.pa=this.pa,a.hc=this.hc,a.oc=this.oc,a.Ae=this.Ae,a.Pi=this.Pi,a.Qi=this.Qi,a.qh=this.qh,a.Kl=this.Kl,a.cl=this.cl,a.Mj=this.Mj,a.qa=this.qa,a},(n=we.prototype).Na=function(a){if(!(a instanceof we)||this.type!==a.type||this.isClosed!==a.isClosed)return!1;switch(this.type){case Se:case Pe:return oe.A(this.endX,a.endX)&&oe.A(this.endY,a.endY);case Ne:return oe.A(this.endX,a.endX)&&oe.A(this.endY,a.endY)&&oe.A(this.point1X,a.point1X)&&oe.A(this.point1Y,a.point1Y)&&oe.A(this.point2X,a.point2X)&&oe.A(this.point2Y,a.point2Y);case Ce:return oe.A(this.endX,a.endX)&&oe.A(this.endY,a.endY)&&oe.A(this.point1X,a.point1X)&&oe.A(this.point1Y,a.point1Y);case Te:return oe.A(this.startAngle,a.startAngle)&&oe.A(this.sweepAngle,a.sweepAngle)&&oe.A(this.centerX,a.centerX)&&oe.A(this.centerY,a.centerY)&&oe.A(this.radiusX,a.radiusX)&&oe.A(this.radiusY,a.radiusY);case Le:return this.isClockwiseArc===a.isClockwiseArc&&this.isLargeArc===a.isLargeArc&&oe.A(this.xAxisRotation,a.xAxisRotation)&&oe.A(this.endX,a.endX)&&oe.A(this.endY,a.endY)&&oe.A(this.radiusX,a.radiusX)&&oe.A(this.radiusY,a.radiusY);default:return!1}},n.jb=function(a){a.classType===we&&(this.type=a)},n.toString=function(a){switch(void 0===a&&(a=-1),this.type){case Se:a=0>a?"M"+this.endX.toString()+" "+this.endY.toString():"M"+this.endX.toFixed(a)+" "+this.endY.toFixed(a);break;case Pe:a=0>a?"L"+this.endX.toString()+" "+this.endY.toString():"L"+this.endX.toFixed(a)+" "+this.endY.toFixed(a);break;case Ne:a=0>a?"C"+this.point1X.toString()+" "+this.point1Y.toString()+" "+this.point2X.toString()+" "+this.point2Y.toString()+" "+this.endX.toString()+" "+this.endY.toString():"C"+this.point1X.toFixed(a)+" "+this.point1Y.toFixed(a)+" "+this.point2X.toFixed(a)+" "+this.point2Y.toFixed(a)+" "+this.endX.toFixed(a)+" "+this.endY.toFixed(a);break;case Ce:a=0>a?"Q"+this.point1X.toString()+" "+this.point1Y.toString()+" "+this.endX.toString()+" "+this.endY.toString():"Q"+this.point1X.toFixed(a)+" "+this.point1Y.toFixed(a)+" "+this.endX.toFixed(a)+" "+this.endY.toFixed(a);break;case Te:a=0>a?"B"+this.startAngle.toString()+" "+this.sweepAngle.toString()+" "+this.centerX.toString()+" "+this.centerY.toString()+" "+this.radiusX.toString()+" "+this.radiusY.toString():"B"+this.startAngle.toFixed(a)+" "+this.sweepAngle.toFixed(a)+" "+this.centerX.toFixed(a)+" "+this.centerY.toFixed(a)+" "+this.radiusX.toFixed(a)+" "+this.radiusY.toFixed(a);break;case Le:a=0>a?"A"+this.radiusX.toString()+" "+this.radiusY.toString()+" "+this.xAxisRotation.toString()+" "+(this.isLargeArc?1:0)+" "+(this.isClockwiseArc?1:0)+" "+this.endX.toString()+" "+this.endY.toString():"A"+this.radiusX.toFixed(a)+" "+this.radiusY.toFixed(a)+" "+this.xAxisRotation.toFixed(a)+" "+(this.isLargeArc?1:0)+" "+(this.isClockwiseArc?1:0)+" "+this.endX.toFixed(a)+" "+this.endY.toFixed(a);break;default:a=this.type.toString()}return a+(this.Mj?"z":"")},n.freeze=function(){return this.s=!0,this},n.ea=function(){return this.s=!1,this},n.close=function(){return this.Mj=!0,this},v.Object.defineProperties(we.prototype,{isClosed:{get:function(){return this.Mj},set:function(a){this.Mj!==a&&(this.Mj=a,this.qa=!0)}},type:{get:function(){return this.pa},set:function(a){this.s&&C(this,a),this.pa=a,this.qa=!0}},endX:{get:function(){return this.hc},set:function(a){this.s&&C(this,a),this.hc=a,this.qa=!0}},endY:{get:function(){return this.oc},set:function(a){this.s&&C(this,a),this.oc=a,this.qa=!0}},point1X:{get:function(){return this.Ae},set:function(a){this.s&&C(this,a),this.Ae=a,this.qa=!0}},point1Y:{get:function(){return this.Pi},set:function(a){this.s&&C(this,a),this.Pi=a,this.qa=!0}},point2X:{get:function(){return this.Qi},set:function(a){this.s&&C(this,a),this.Qi=a,this.qa=!0}},point2Y:{get:function(){return this.qh},set:function(a){this.s&&C(this,a),this.qh=a,this.qa=!0}},centerX:{get:function(){return this.Ae},set:function(a){this.s&&C(this,a),this.Ae=a,this.qa=!0}},centerY:{get:function(){return this.Pi},set:function(a){this.s&&C(this,a),this.Pi=a,this.qa=!0}},radiusX:{get:function(){return this.Qi},set:function(a){0>a&&T(a,">= zero",we,"radiusX"),this.s&&C(this,a),this.Qi=a,this.qa=!0}},radiusY:{get:function(){return this.qh},set:function(a){0>a&&T(a,">= zero",we,"radiusY"),this.s&&C(this,a),this.qh=a,this.qa=!0}},startAngle:{get:function(){return this.hc},set:function(a){this.hc!==a&&(this.s&&C(this,a),0>(a%=360)&&(a+=360),this.hc=a,this.qa=!0)}},sweepAngle:{get:function(){return this.oc},set:function(a){this.s&&C(this,a),360<a&&(a=360),-360>a&&(a=-360),this.oc=a,this.qa=!0}},isClockwiseArc:{get:function(){return this.cl},set:function(a){this.s&&C(this,a),this.cl=a,this.qa=!0}},isLargeArc:{get:function(){return this.Kl},set:function(a){this.s&&C(this,a),this.Kl=a,this.qa=!0}},xAxisRotation:{get:function(){return this.Ae},set:function(a){0>(a%=360)&&(a+=360),this.s&&C(this,a),this.Ae=a,this.qa=!0}}}),we.prototype.equalsApprox=we.prototype.Na;var Se=new _(we,"Move",0),Pe=new _(we,"Line",1),Ne=new _(we,"Bezier",2),Ce=new _(we,"QuadraticBezier",3),Te=new _(we,"Arc",4),Le=new _(we,"SvgArc",4);function Ae(){this.B=null,this.wv=new St(0,0).freeze(),this.Fu=new St(0,0).freeze(),this.xr=this.zs=0,this.yr=1,this.Bi="",this.qt=this.Rr=!1,this.Or=this.Ar=0,this.Qg=this.bs=this.ms=!1,this.Wr=null,this.lt=0,this.qd=this.kt=null}function je(){this.B=null,this.Qa="",this.Js=this.it=null}function De(){this.tn=Fe,this.hf=this.ys="",this.ap=this.bp=this.ip=this.jp=this.hp=this.B=this.bc=null}we.className="PathSegment",we.Move=Se,we.Line=Pe,we.Bezier=Ne,we.QuadraticBezier=Ce,we.Arc=Te,we.SvgArc=Le,Ae.prototype.copy=function(){var a=new Ae;return this.clone(a)},Ae.prototype.clone=function(a){return a.B=this.B,a.wv.assign(this.viewPoint),a.Fu.assign(this.documentPoint),a.zs=this.zs,a.xr=this.xr,a.yr=this.yr,a.Bi=this.Bi,a.Rr=this.Rr,a.qt=this.qt,a.Ar=this.Ar,a.Or=this.Or,a.ms=this.ms,a.bs=this.bs,a.Qg=this.Qg,a.Wr=this.Wr,a.lt=this.lt,a.kt=this.kt,a.qd=this.qd,a},Ae.prototype.toString=function(){var a="^";return 0!==this.modifiers&&(a+="M:"+this.modifiers),0!==this.button&&(a+="B:"+this.button),""!==this.key&&(a+="K:"+this.key),0!==this.clickCount&&(a+="C:"+this.clickCount),0!==this.delta&&(a+="D:"+this.delta),this.handled&&(a+="h"),this.bubbles&&(a+="b"),null!==this.documentPoint&&(a+="@"+this.documentPoint.toString()),a},Ae.prototype.Fq=function(a,b){var t=this.diagram;return null===t||pr(t,this.event,a,b),b},Ae.prototype.mA=function(a,b){var t=this.diagram;return null===t||(pr(t,this.event,a,b),b.assign(t.lu(b))),b},v.Object.defineProperties(Ae.prototype,{diagram:{get:function(){return this.B},set:function(a){this.B=a}},viewPoint:{get:function(){return this.wv},set:function(a){this.wv.assign(a)}},documentPoint:{get:function(){return this.Fu},set:function(a){this.Fu.assign(a)}},modifiers:{get:function(){return this.zs},set:function(a){this.zs=a}},button:{get:function(){return this.xr},set:function(a){if(this.xr=a,null===this.event)switch(a){case 0:this.buttons=1;break;case 1:this.buttons=4;break;case 2:this.buttons=2}}},buttons:{get:function(){return this.yr},set:function(a){this.yr=a}},key:{get:function(){return this.Bi},set:function(a){this.Bi=a}},down:{get:function(){return this.Rr},set:function(a){this.Rr=a}},up:{get:function(){return this.qt},set:function(a){this.qt=a}},clickCount:{get:function(){return this.Ar},set:function(a){this.Ar=a}},delta:{get:function(){return this.Or},set:function(a){this.Or=a}},isMultiTouch:{get:function(){return this.ms},set:function(a){this.ms=a}},handled:{get:function(){return this.bs},set:function(a){this.bs=a}},bubbles:{get:function(){return this.Qg},set:function(a){this.Qg=a}},event:{get:function(){return this.Wr},set:function(a){this.Wr=a}},isTouchEvent:{get:function(){var a=w.TouchEvent,b=this.event;return!!(a&&b instanceof a)||(a=w.PointerEvent)&&b instanceof a&&("touch"===b.pointerType||"pen"===b.pointerType)}},timestamp:{get:function(){return this.lt},set:function(a){this.lt=a}},targetDiagram:{get:function(){return this.kt},set:function(a){this.kt=a}},targetObject:{get:function(){return this.qd},set:function(a){this.qd=a}},control:{get:function(){return 0!=(1&this.modifiers)},set:function(a){this.modifiers=a?1|this.modifiers:-2&this.modifiers}},shift:{get:function(){return 0!=(4&this.modifiers)},set:function(a){this.modifiers=a?4|this.modifiers:-5&this.modifiers}},alt:{get:function(){return 0!=(2&this.modifiers)},set:function(a){this.modifiers=a?2|this.modifiers:-3&this.modifiers}},meta:{get:function(){return 0!=(8&this.modifiers)},set:function(a){this.modifiers=a?8|this.modifiers:-9&this.modifiers}},left:{get:function(){var a=this.event;return null===a||"mousedown"!==a.type&&"mouseup"!==a.type&&"pointerdown"!==a.type&&"pointerup"!==a.type?0!=(1&this.buttons):0===this.button},set:function(a){this.buttons=a?1|this.buttons:-2&this.buttons}},right:{get:function(){var a=this.event;return null===a||"mousedown"!==a.type&&"mouseup"!==a.type&&"pointerdown"!==a.type&&"pointerup"!==a.type?0!=(2&this.buttons):2===this.button},set:function(a){this.buttons=a?2|this.buttons:-3&this.buttons}},middle:{get:function(){var a=this.event;return null===a||"mousedown"!==a.type&&"mouseup"!==a.type&&"pointerdown"!==a.type&&"pointerup"!==a.type?0!=(4&this.buttons):1===this.button},set:function(a){this.buttons=a?4|this.buttons:-5&this.buttons}}}),Ae.prototype.getMultiTouchDocumentPoint=Ae.prototype.mA,Ae.prototype.getMultiTouchViewPoint=Ae.prototype.Fq,Ae.className="InputEvent",je.prototype.copy=function(){var a=new je;return a.B=this.B,a.Qa=this.Qa,a.it=this.it,a.Js=this.Js,a},je.prototype.toString=function(){var a="*"+this.name;return null!==this.subject&&(a+=":"+this.subject.toString()),null!==this.parameter&&(a+="("+this.parameter.toString()+")"),a},v.Object.defineProperties(je.prototype,{diagram:{get:function(){return this.B},set:function(a){this.B=a}},name:{get:function(){return this.Qa},set:function(a){this.Qa=a}},subject:{get:function(){return this.it},set:function(a){this.it=a}},parameter:{get:function(){return this.Js},set:function(a){this.Js=a}}}),je.className="DiagramEvent",De.prototype.clear=function(){this.ap=this.bp=this.ip=this.jp=this.hp=this.B=this.bc=null},De.prototype.copy=function(){var a=new De;a.tn=this.tn,a.ys=this.ys,a.hf=this.hf,a.bc=this.bc,a.B=this.B,a.hp=this.hp;var b=this.jp;return a.jp=j(b)&&"function"==typeof b.G?b.G():b,b=this.ip,a.ip=j(b)&&"function"==typeof b.G?b.G():b,b=this.bp,a.bp=j(b)&&"function"==typeof b.G?b.G():b,b=this.ap,a.ap=j(b)&&"function"==typeof b.G?b.G():b,a},De.prototype.jb=function(a){a.classType===De&&(this.change=a)},De.prototype.toString=function(){var a="";return a=this.change===Oe?a+"* ":this.change===Fe?a+(null!==this.model?"!m":"!d"):a+(null!==this.model?"!m":"!d")+this.change,this.propertyName&&"string"==typeof this.propertyName&&(a+=" "+this.propertyName),this.modelChange&&this.modelChange!==this.propertyName&&(a+=" "+this.modelChange),a+=": ",this.change===Oe?null!==this.oldValue&&(a+=" "+this.oldValue):(null!==this.object&&(a+=z(this.object)),null!==this.oldValue&&(a+="  old: "+z(this.oldValue)),null!==this.oldParam&&(a+=" "+this.oldParam),null!==this.newValue&&(a+="  new: "+z(this.newValue)),null!==this.newParam&&(a+=" "+this.newParam)),a},De.prototype.H=function(a){return a?this.oldValue:this.newValue},De.prototype.oA=function(a){return a?this.oldParam:this.newParam},De.prototype.canUndo=function(){return null!==this.model||null!==this.diagram},De.prototype.undo=function(){this.canUndo()&&(null!==this.model?this.model.changeState(this,!0):null!==this.diagram&&this.diagram.changeState(this,!0))},De.prototype.canRedo=function(){return null!==this.model||null!==this.diagram},De.prototype.redo=function(){this.canRedo()&&(null!==this.model?this.model.changeState(this,!1):null!==this.diagram&&this.diagram.changeState(this,!1))},v.Object.defineProperties(De.prototype,{model:{get:function(){return this.bc},set:function(a){this.bc=a}},diagram:{get:function(){return this.B},set:function(a){this.B=a}},change:{get:function(){return this.tn},set:function(a){this.tn=a}},modelChange:{get:function(){return this.ys},set:function(a){this.ys=a}},propertyName:{get:function(){return this.hf},set:function(a){this.hf=a}},isTransactionFinished:{get:function(){return this.tn===Oe&&("CommittedTransaction"===this.hf||"FinishedUndo"===this.hf||"FinishedRedo"===this.hf)}},object:{get:function(){return this.hp},set:function(a){this.hp=a}},oldValue:{get:function(){return this.jp},set:function(a){this.jp=a}},oldParam:{get:function(){return this.ip},set:function(a){this.ip=a}},newValue:{get:function(){return this.bp},set:function(a){this.bp=a}},newParam:{get:function(){return this.ap},set:function(a){this.ap=a}}}),De.prototype.redo=De.prototype.redo,De.prototype.canRedo=De.prototype.canRedo,De.prototype.undo=De.prototype.undo,De.prototype.canUndo=De.prototype.canUndo,De.prototype.getParam=De.prototype.oA,De.prototype.getValue=De.prototype.H,De.prototype.clear=De.prototype.clear;var Oe=new _(De,"Transaction",-1),Fe=new _(De,"Property",0),Be=new _(De,"Insert",1),Ie=new _(De,"Remove",2);function Re(){this.v=(new ut).freeze(),this.Qa="",this.l=!1}function Ee(){this.dv=new ft,this.nd=!1,this.I=(new ut).freeze(),this.Ud=-1,this.v=999,this.qe=!1,this.Lr=null,this.Xi=0,this.l=!1,this.we=(new ut).freeze(),this.Sl=new ut,this.Mu=!0,this.Tu=this.ks=this.Xu=this.Wu=!1}function ze(a,b,t){if(a.isUndoingRedoing)return!1;a.checksTransactionLevel&&1>a.transactionLevel&&L("Ending transaction without having started a transaction: "+t);var e=1===a.transactionLevel,n=a.currentTransaction;e&&b&&(a.isInternalTransaction||a.Cb("CommittingTransaction",t,n));var o=0;if(0<a.transactionLevel&&(a.Xi--,a.isEnabled)){var g=a.we.count;0<g&&(""===t&&(t=a.we.J(0)),a.we.ea(),a.we.cb(g-1),a.we.freeze()),0<(g=a.Sl.count)&&(o=a.Sl.J(g-1),a.Sl.cb(g-1))}if(e){if(b){if(a.ks=!1,null===n&&""!==t&&(n=a.currentTransaction),a.isEnabled&&null!==n){for(n.isComplete||(n.isComplete=!0,n.name=t),(b=a.history).ea(),e=b.count-1;e>a.historyIndex;e--)null!==(o=b.J(e))&&o.clear(),b.cb(e),a.ks=!0;0<=(e=a.maxHistoryLength)&&(0===e?b.clear():b.count>=e&&(null!==(o=b.J(0))&&o.clear(),b.cb(0),a.Ud--)),0===e||0!==b.count&&b.get(b.count-1)===n||(b.add(n),a.Ud++),b.freeze()}a.isInternalTransaction||a.Cb("CommittedTransaction",t,n)}else{a.qe=!0;try{a.isEnabled&&null!==n&&(n.isComplete=!0,n.undo())}finally{a.isInternalTransaction||a.Cb("RolledBackTransaction",t,n),a.qe=!1}null!==n&&n.clear()}return a.Lr=null,a.isPendingClear&&a.clear(),a.isPendingClear=!1,a.isPendingUnmodified=!1,!0}if(a.isEnabled&&!b&&null!==n){for(a=o,n=(t=n.changes).count-1;n>=a;n--)null!==(b=t.J(n))&&b.undo(),t.ea(),t.cb(n);t.freeze()}return!1}function Ve(){pt(this),this.B=os,this.Qa="",this.nd=!0,this.Uc=!1,this.ix=null,this.mz=new Ae,this.tt=-1}function Ge(){Ve.call(this),this.name="ToolManager",this.Cc=new ut,this.Vc=new ut,this.Md=new ut,this.T=this.Ja=850,this.v=new Ut(2,2).ca(),this.eb=5e3,this.Ka=Xe,this.I=Ke,this.Kr=this.l=null,this.gk=-1}function Ye(a,b){a.standardMouseOver(),a.isBeyondDragSize()&&a.standardWaitAfter(a.isActive?a.holdDelay:a.hoverDelay,b.lastInput)}De.className="ChangedEvent",De.Transaction=Oe,De.Property=Fe,De.Insert=Be,De.Remove=Ie,Re.prototype.toString=function(a){var b="Transaction: "+this.name+" "+this.changes.count.toString()+(this.isComplete?"":", incomplete");if(void 0!==a&&0<a){a=this.changes.count;for(var t=0;t<a;t++){var e=this.changes.J(t);null!==e&&(b+="\n  "+e.toString())}}return b},Re.prototype.clear=function(){var a=this.changes;a.ea();for(var b=a.count-1;0<=b;b--){var t=a.J(b);null!==t&&t.clear()}a.clear(),a.freeze()},Re.prototype.canUndo=function(){return this.isComplete},Re.prototype.undo=function(){if(this.canUndo())for(var a=this.changes.count-1;0<=a;a--){var b=this.changes.J(a);null!==b&&b.undo()}},Re.prototype.canRedo=function(){return this.isComplete},Re.prototype.redo=function(){if(this.canRedo())for(var a=this.changes.count,b=0;b<a;b++){var t=this.changes.J(b);null!==t&&t.redo()}},Re.prototype.lw=function(){if(this.isComplete){var a=this.changes;a.ea();for(var b=new Mt,t=0;t<a.count;t++){var e=a.J(t);if(null!==e&&e.change===Fe&&e.object){var n=b.get(e.object);n||(n=new Mt,b.set(e.object,n));var o=n.get(e.propertyName);null===o?n.set(e.propertyName,-1):(0<o&&a.Qc(o,null),n.set(e.propertyName,t))}}for(t=b=0;t<a.count;t++)null!==(e=a.J(t))&&(t>b&&a.Qc(b,e),b++);for(;a.length>b;)a.pop();a.freeze()}},v.Object.defineProperties(Re.prototype,{changes:{get:function(){return this.v}},name:{get:function(){return this.Qa},set:function(a){this.Qa=a}},isComplete:{get:function(){return this.l},set:function(a){this.l=a}}}),Re.prototype.optimize=Re.prototype.lw,Re.prototype.redo=Re.prototype.redo,Re.prototype.canRedo=Re.prototype.canRedo,Re.prototype.undo=Re.prototype.undo,Re.prototype.canUndo=Re.prototype.canUndo,Re.prototype.clear=Re.prototype.clear,Re.className="Transaction",Ee.prototype.toString=function(a){var b="UndoManager "+this.historyIndex+"<"+this.history.count+"<="+this.maxHistoryLength;b+="[";for(var t=this.nestedTransactionNames.count,e=0;e<t;e++)0<e&&(b+=" "),b+=this.nestedTransactionNames.J(e);if(b+="]",void 0!==a&&0<a)for(t=this.history.count,e=0;e<t;e++)b+="\n "+this.history.J(e).toString(a-1);return b},Ee.prototype.clear=function(){var a=this.history;a.ea();for(var b=a.count-1;0<=b;b--){var t=a.J(b);null!==t&&t.clear()}a.clear(),this.Ud=-1,a.freeze(),this.qe=!1,this.Lr=null,this.Xi=0,this.we.ea(),this.we.clear(),this.we.freeze(),this.Sl.clear(),this.Tu=this.ks=this.Xu=this.Wu=!1},Ee.prototype.copyProperties=function(a){this.isEnabled=a.isEnabled,this.maxHistoryLength=a.maxHistoryLength,this.checksTransactionLevel=a.checksTransactionLevel},(n=Ee.prototype).Xx=function(a){this.dv.add(a)},n.Ry=function(a){this.dv.remove(a)},n.xa=function(a){if(void 0===a&&(a=""),null===a&&(a=""),this.isUndoingRedoing)return!1;!0===this.Mu&&(this.Mu=!1,this.Xi++,this.isInternalTransaction||this.Cb("StartingFirstTransaction",a,this.currentTransaction),0<this.Xi&&this.Xi--),this.isEnabled&&(this.we.ea(),this.we.add(a),this.we.freeze(),null===this.currentTransaction?this.Sl.add(0):this.Sl.add(this.currentTransaction.changes.count)),this.Xi++;var b=1===this.transactionLevel;return b&&(this.isInternalTransaction||this.Cb("StartedTransaction",a,this.currentTransaction)),b},n.Wa=function(a){return void 0===a&&(a=""),ze(this,!0,a)},n.Kf=function(){return ze(this,!1,"")},Ee.prototype.canUndo=function(){if(!this.isEnabled||0<this.transactionLevel)return!1;var a=this.transactionToUndo;return!(null===a||!a.canUndo())},Ee.prototype.undo=function(){if(this.canUndo()){var a=this.transactionToUndo;try{this.qe=!0,this.Cb("StartingUndo","Undo",a),this.Ud--,a.undo()}catch(t){L("undo error: "+t.toString())}finally{this.Cb("FinishedUndo","Undo",a),this.qe=!1}}},Ee.prototype.canRedo=function(){if(!this.isEnabled||0<this.transactionLevel)return!1;var a=this.transactionToRedo;return!(null===a||!a.canRedo())},Ee.prototype.redo=function(){if(this.canRedo()){var a=this.transactionToRedo;try{this.qe=!0,this.Cb("StartingRedo","Redo",a),this.Ud++,a.redo()}catch(t){L("redo error: "+t.toString())}finally{this.Cb("FinishedRedo","Redo",a),this.qe=!1}}},Ee.prototype.Cb=function(a,b,t){void 0===t&&(t=null);var e=new De;for(e.change=Oe,e.propertyName=a,e.object=t,e.oldValue=b,a=this.models;a.next();)b=a.value,e.model=b,b.xt(e)},Ee.prototype.Zv=function(a){if(this.isEnabled&&!this.isUndoingRedoing&&!this.skipsEvent(a)){var b=this.currentTransaction;null===b&&(this.Lr=b=new Re);var t=a.copy();(b=b.changes).ea(),b.add(t),b.freeze(),this.checksTransactionLevel&&0>=this.transactionLevel&&!this.Mu&&(null!==(a=a.diagram)&&!1===a.oj||L("Change not within a transaction: "+t.toString()))}},Ee.prototype.skipsEvent=function(a){if(null===a||0>a.change.value)return!0;if(null===(a=a.object))return!1;if(void 0!==a.layer){if(null!==(a=a.layer)&&a.isTemporary)return!0}else if(a.isTemporary)return!0;return!1},v.Object.defineProperties(Ee.prototype,{models:{get:function(){return this.dv.iterator}},isEnabled:{get:function(){return this.nd},set:function(a){this.nd=a}},transactionToUndo:{get:function(){return 0<=this.historyIndex&&this.historyIndex<=this.history.count-1?this.history.J(this.historyIndex):null}},transactionToRedo:{get:function(){return this.historyIndex<this.history.count-1?this.history.J(this.historyIndex+1):null}},isUndoingRedoing:{get:function(){return this.qe}},history:{get:function(){return this.I}},maxHistoryLength:{get:function(){return this.v},set:function(a){this.v=a}},historyIndex:{get:function(){return this.Ud}},currentTransaction:{get:function(){return this.Lr}},transactionLevel:{get:function(){return this.Xi}},isInTransaction:{get:function(){return 0<this.Xi}},checksTransactionLevel:{get:function(){return this.l},set:function(a){this.l=a}},nestedTransactionNames:{get:function(){return this.we}},isPendingClear:{get:function(){return this.Wu},set:function(a){this.Wu=a}},isPendingUnmodified:{get:function(){return this.Xu},set:function(a){this.Xu=a}},isInternalTransaction:{get:function(){return this.Tu},set:function(a){this.Tu=a}},isJustDiscarded:{get:function(){return this.ks}}}),Ee.prototype.handleChanged=Ee.prototype.Zv,Ee.prototype.redo=Ee.prototype.redo,Ee.prototype.undo=Ee.prototype.undo,Ee.prototype.canUndo=Ee.prototype.canUndo,Ee.prototype.rollbackTransaction=Ee.prototype.Kf,Ee.prototype.commitTransaction=Ee.prototype.Wa,Ee.prototype.startTransaction=Ee.prototype.xa,Ee.prototype.removeModel=Ee.prototype.Ry,Ee.prototype.addModel=Ee.prototype.Xx,Ee.prototype.clear=Ee.prototype.clear,Ee.className="UndoManager",Ve.prototype.toString=function(){return""!==this.name?this.name+" Tool":E(this.constructor)},Ve.prototype.updateAdornments=function(){},Ve.prototype.canStart=function(){return this.isEnabled},Ve.prototype.doStart=function(){},Ve.prototype.doActivate=function(){this.isActive=!0},Ve.prototype.doDeactivate=function(){this.isActive=!1},Ve.prototype.doStop=function(){},Ve.prototype.doCancel=function(){this.transactionResult=null,this.stopTool()},Ve.prototype.stopTool=function(){var a=this.diagram;a.currentTool===this&&(a.currentTool=null,a.currentCursor="")},Ve.prototype.doMouseDown=function(){!this.isActive&&this.canStart()&&this.doActivate()},Ve.prototype.doMouseMove=function(){},Ve.prototype.doMouseUp=function(){this.stopTool()},Ve.prototype.doMouseWheel=function(){},Ve.prototype.canStartMultiTouch=function(){return!0},Ve.prototype.standardPinchZoomStart=function(){var a=this.diagram,b=a.lastInput,t=b.Fq(0,St.allocAt(NaN,NaN)),e=b.Fq(1,St.allocAt(NaN,NaN));if(t.u()&&e.u()&&(this.doCancel(),a.zm("hasGestureZoom"))){a.Ul=a.scale;var n=e.x-t.x,o=e.y-t.y;a.qv=Math.sqrt(n*n+o*o),b.bubbles=!1}St.free(t),St.free(e)},Ve.prototype.standardPinchZoomMove=function(){var a=this.diagram,b=a.lastInput,t=b.Fq(0,St.allocAt(NaN,NaN)),e=b.Fq(1,St.allocAt(NaN,NaN));if(t.u()&&e.u()&&(this.doCancel(),a.zm("hasGestureZoom"))){var n=e.x-t.x,o=e.y-t.y;o=Math.sqrt(n*n+o*o)/a.qv,n=new St((Math.min(e.x,t.x)+Math.max(e.x,t.x))/2,(Math.min(e.y,t.y)+Math.max(e.y,t.y))/2),o*=a.Ul;var g=a.commandHandler;if(o!==a.scale&&g.canResetZoom(o)){var r=a.zoomPoint;a.zoomPoint=n,g.resetZoom(o),a.zoomPoint=r}b.bubbles=!1}St.free(t),St.free(e)},Ve.prototype.doKeyDown=function(){"Esc"===this.diagram.lastInput.key&&this.doCancel()},Ve.prototype.doKeyUp=function(){},Ve.prototype.xa=function(a){return void 0===a&&(a=this.name),this.transactionResult=null,this.diagram.xa(a)},Ve.prototype.Kg=function(){var a=this.diagram;return null===this.transactionResult?a.Kf():a.Wa(this.transactionResult)},Ve.prototype.standardMouseSelect=function(){var a=this.diagram;if(a.allowSelect){var b=a.lastInput,t=a.xm(b.documentPoint,!1);if(null!==t){if(J?b.meta:b.control){for(a.R("ChangingSelection",a.selection),b=t;null!==b&&!b.canSelect();)b=b.containingGroup;null!==b&&(b.isSelected=!b.isSelected),a.R("ChangedSelection",a.selection)}else if(b.shift){if(!t.isSelected){for(a.R("ChangingSelection",a.selection),b=t;null!==b&&!b.canSelect();)b=b.containingGroup;null!==b&&(b.isSelected=!0),a.R("ChangedSelection",a.selection)}}else if(!t.isSelected){for(b=t;null!==b&&!b.canSelect();)b=b.containingGroup;null!==b&&a.select(b)}}else!b.left||(J?b.meta:b.control)||b.shift||a.clearSelection()}},Ve.prototype.standardMouseClick=function(a,b){void 0===a&&(a=null),void 0===b&&(b=function(a){return!a.layer.isTemporary});var t=this.diagram,e=t.lastInput;return a=t.Vb(e.documentPoint,a,b),e.targetObject=a,function(a,b,t){if(b.handled=!1,null===a||a.Ig()){var e=0;b.left?e=1===b.clickCount?1:2===b.clickCount?2:1:b.right&&1===b.clickCount&&(e=3);var n="ObjectSingleClicked";if(null!==a){switch(e){case 1:n="ObjectSingleClicked";break;case 2:n="ObjectDoubleClicked";break;case 3:n="ObjectContextClicked"}0!==e&&t.R(n,a)}else{switch(e){case 1:n="BackgroundSingleClicked";break;case 2:n="BackgroundDoubleClicked";break;case 3:n="BackgroundContextClicked"}0!==e&&t.R(n)}if(null!==a)for(;null!==a;){switch(t=null,e){case 1:t=a.click;break;case 2:t=a.doubleClick?a.doubleClick:a.click;break;case 3:t=a.contextClick}if(null!==t&&(t(b,a),b.handled))break;a=a.panel}else{switch(a=null,e){case 1:a=t.click;break;case 2:a=t.doubleClick?t.doubleClick:t.click;break;case 3:a=t.contextClick}null!==a&&a(b)}}}(a,e,t),e.handled},Ve.prototype.standardMouseOver=function(){var a=this.diagram,b=a.lastInput;if(!0!==a.animationManager.sc){var t=a.skipsUndoManager;a.skipsUndoManager=!0;var e=a.viewportBounds.$(b.documentPoint)?a.Vb(b.documentPoint,null,null):null;b.targetObject=e;var n=!1;if(e!==a.Cj){var o=a.Cj,g=o;for(a.Cj=e,this.doCurrentObjectChanged(o,e),b.handled=!1;null!==o;){var r=o.mouseLeave;if(null!==r){if(e===o)break;if(null!==e&&e.Hg(o))break;if(r(b,o,e),n=!0,b.handled)break}o=o.panel}for(o=g,b.handled=!1;null!==e;){if(null!==(g=e.mouseEnter)){if(o===e)break;if(null!==o&&o.Hg(e))break;if(g(b,e,o),n=!0,b.handled)break}e=e.panel}e=a.Cj}if(null!==e){for(o=e,g="";null!==o&&""===(g=o.cursor);)o=o.panel;for(a.currentCursor=g,b.handled=!1,o=e;null!==o&&(null===(e=o.mouseOver)||(e(b,o),n=!0,!b.handled));)o=o.panel}else a.currentCursor="",null!==(e=a.mouseOver)&&(e(b),n=!0);n&&a.Eb(),a.skipsUndoManager=t}},Ve.prototype.doCurrentObjectChanged=function(){},Ve.prototype.standardMouseWheel=function(){var a=this.diagram,b=a.lastInput,t=b.delta;if(0!==t&&a.documentBounds.u()){var e=a.commandHandler,n=a.toolManager.mouseWheelBehavior;if(null!==e&&(n===qe&&!b.shift||n===Xe&&b.control))(0<t?e.canIncreaseZoom():e.canDecreaseZoom())&&(n=a.zoomPoint,a.zoomPoint=b.viewPoint,0<t?e.increaseZoom():e.decreaseZoom(),a.zoomPoint=n),b.bubbles=!1;else if(n===qe&&b.shift||n===Xe&&!b.control){e=a.position.copy();var o=0<t?t:-t,g=b.event,r=g.deltaMode;if(n=g.deltaX,g=g.deltaY,(K||H||W)&&(r=1,0<n&&(n=3),0>n&&(n=-3),0<g&&(g=3),0>g&&(g=-3)),void 0===r||void 0===n||void 0===g||0===n&&0===g||b.shift)!b.shift&&a.allowVerticalScroll?(o=3*o*a.scrollVerticalLineChange,0<t?a.scroll("pixel","up",o):a.scroll("pixel","down",o)):b.shift&&a.allowHorizontalScroll&&(o=3*o*a.scrollHorizontalLineChange,0<t?a.scroll("pixel","left",o):a.scroll("pixel","right",o));else{switch(r){case 0:t="pixel";break;case 1:t="line";break;case 2:t="page";break;default:t="pixel"}0!==n&&a.allowHorizontalScroll&&(0<(n*=a.scrollHorizontalLineChange/16)?a.scroll(t,"left",-n):a.scroll(t,"right",n)),0!==g&&a.allowVerticalScroll&&(0<(g*=a.scrollVerticalLineChange/16)?a.scroll(t,"up",-g):a.scroll(t,"down",g))}a.position.w(e)||(b.bubbles=!1)}}},Ve.prototype.standardWaitAfter=function(a,b){void 0===b&&(b=this.diagram.lastInput),this.cancelWaitAfter();var t=this,e=b.clone(this.mz);this.tt=S((function(){t.doWaitAfter(e)}),a)},Ve.prototype.cancelWaitAfter=function(){-1!==this.tt&&w.clearTimeout(this.tt),this.tt=-1},Ve.prototype.doWaitAfter=function(){},Ve.prototype.findToolHandleAt=function(a,b){return null===(a=this.diagram.Vb(a,(function(a){for(;null!==a&&!(a.panel instanceof Eu);)a=a.panel;return a})))?null:a.part.category===b?a:null},Ve.prototype.isBeyondDragSize=function(a,b){var t=this.diagram;void 0===a&&(a=t.firstInput.viewPoint),void 0===b&&(b=t.lastInput.viewPoint);var e=t.toolManager.dragSize,n=e.width;return e=e.height,t.firstInput.isTouchEvent&&(n+=6,e+=6),Math.abs(b.x-a.x)>n||Math.abs(b.y-a.y)>e},v.Object.defineProperties(Ve.prototype,{diagram:{get:function(){return this.B},set:function(a){a instanceof Xo&&(this.B=a)}},name:{get:function(){return this.Qa},set:function(a){this.Qa=a}},isEnabled:{get:function(){return this.nd},set:function(a){this.nd=a}},isActive:{get:function(){return this.Uc},set:function(a){this.Uc=a}},transactionResult:{get:function(){return this.ix},set:function(a){this.ix=a}}}),Ve.prototype.stopTransaction=Ve.prototype.Kg,Ve.prototype.startTransaction=Ve.prototype.xa,Ve.className="Tool",m(Ge,Ve),Ge.prototype.initializeStandardTools=function(){},Ge.prototype.updateAdornments=function(a){var b=this.currentToolTip;if(b instanceof Eu&&this.Kr===a){var t=b.adornedObject;(null!==a?t.part===a:null===t)?this.showToolTip(b,t):this.hideToolTip()}},Ge.prototype.doMouseDown=function(){var a=this.diagram,b=a.lastInput;if(b.isTouchEvent&&this.gestureBehavior===He&&(b.bubbles=!1),b.isMultiTouch){if(this.cancelWaitAfter(),this.gestureBehavior===We)return void(b.bubbles=!0);if(this.gestureBehavior===He)return;if(a.currentTool.canStartMultiTouch())return void a.currentTool.standardPinchZoomStart()}for(var t=this.mouseDownTools.length,e=0;e<t;e++){var n=this.mouseDownTools.J(e);if(n.diagram=this.diagram,n.canStart())return a.doFocus(),a.currentTool=n,void(a.currentTool===n&&(n.isActive||n.doActivate(),n.doMouseDown()))}1===a.lastInput.button&&(this.mouseWheelBehavior===Xe?this.mouseWheelBehavior=qe:this.mouseWheelBehavior===qe&&(this.mouseWheelBehavior=Xe)),this.doActivate(),this.standardWaitAfter(this.holdDelay,b)},Ge.prototype.doMouseMove=function(){var a=this.diagram,b=a.lastInput;if(b.isMultiTouch){if(this.gestureBehavior===We)return void(b.bubbles=!0);if(this.gestureBehavior===He)return;if(a.currentTool.canStartMultiTouch())return void a.currentTool.standardPinchZoomMove()}if(this.isActive)for(var t=this.mouseMoveTools.length,e=0;e<t;e++){var n=this.mouseMoveTools.J(e);if(n.diagram=this.diagram,n.canStart())return a.doFocus(),a.currentTool=n,void(a.currentTool===n&&(n.isActive||n.doActivate(),n.doMouseMove()))}Ye(this,a),null===(a=b.event)||"mousemove"!==a.type&&"pointermove"!==a.type&&a.cancelable||(b.bubbles=!0)},Ge.prototype.doCurrentObjectChanged=function(a,b){null===(a=this.currentToolTip)||null!==b&&a instanceof Eu&&(b===a||b.Hg(a))||this.hideToolTip()},Ge.prototype.doWaitAfter=function(a){var b=this.diagram;b.ta&&(this.doMouseHover(),this.isActive||this.doToolTip(),a.isTouchEvent&&!b.lastInput.handled&&((a=a.copy()).button=2,a.buttons=2,b.lastInput=a,b.fk=!0,b.doMouseUp()))},Ge.prototype.doMouseHover=function(){var a=this.diagram,b=a.lastInput;null===b.targetObject&&(b.targetObject=a.Vb(b.documentPoint,null,null));var t=b.targetObject;if(null!==t)for(b.handled=!1;null!==t&&(null===(a=this.isActive?t.mouseHold:t.mouseHover)||(a(b,t),!b.handled));)t=t.panel;else null!==(t=this.isActive?a.mouseHold:a.mouseHover)&&t(b)},Ge.prototype.doToolTip=function(){var a=this.diagram,b=a.lastInput;if(null===b.targetObject&&(b.targetObject=a.Vb(b.documentPoint,null,null)),null!==(b=b.targetObject)){if(!((a=this.currentToolTip)instanceof Eu)||b!==a&&!b.Hg(a)){for(;null!==b;){if(null!==(a=b.toolTip))return void this.showToolTip(a,b);b=b.panel}this.hideToolTip()}}else null!==(b=a.toolTip)?this.showToolTip(b,null):this.hideToolTip()},Ge.prototype.showToolTip=function(a,b){var t=this.diagram;if(a!==this.currentToolTip&&this.hideToolTip(),a instanceof Eu){a.layerName="Tool",a.selectable=!1,a.scale=1/t.scale,a.category="ToolTip",null!==a.placeholder&&(a.placeholder.scale=t.scale);var e=a.diagram;null!==e&&e!==t&&e.remove(a),t.add(a),null!==b?a.adornedObject=b:a.data=t.model,a.Ta(),this.positionToolTip(a,b)}else a instanceof Gn&&a!==this.currentToolTip&&a.show(b,t,this);if(this.currentToolTip=a,-1!==this.gk&&(w.clearTimeout(this.gk),this.gk=-1),0<(a=this.toolTipDuration)&&1/0!==a){var n=this;this.gk=S((function(){n.hideToolTip()}),a)}},Ge.prototype.positionToolTip=function(a){if(null===a.placeholder){var b=this.diagram,t=b.lastInput.documentPoint.copy(),e=a.measuredBounds,n=b.viewportBounds;b.lastInput.isTouchEvent&&(t.x-=e.width),t.x+e.width>n.right&&(t.x-=e.width+5/b.scale),t.x<n.x&&(t.x=n.x),t.y=t.y+20/b.scale+e.height>n.bottom?t.y-(e.height+5/b.scale):t.y+20/b.scale,t.y<n.y&&(t.y=n.y),a.position=t}},Ge.prototype.hideToolTip=function(){-1!==this.gk&&(w.clearTimeout(this.gk),this.gk=-1);var a=this.diagram,b=this.currentToolTip;null!==b&&(b instanceof Eu?(a.remove(b),null!==this.Kr&&this.Kr.Jf(b.category),b.data=null,b.adornedObject=null):b instanceof Gn&&null!==b.hide&&b.hide(a,this),this.currentToolTip=null)},Ge.prototype.doMouseUp=function(){this.cancelWaitAfter();var a=this.diagram;if(this.isActive)for(var b=this.mouseUpTools.length,t=0;t<b;t++){var e=this.mouseUpTools.J(t);if(e.diagram=this.diagram,e.canStart())return a.doFocus(),a.currentTool=e,void(a.currentTool===e&&(e.isActive||e.doActivate(),e.doMouseUp()))}a.doFocus(),this.doDeactivate()},Ge.prototype.doMouseWheel=function(){this.standardMouseWheel()},Ge.prototype.doKeyDown=function(){var a=this.diagram;null!==a.commandHandler&&a.commandHandler.doKeyDown()},Ge.prototype.doKeyUp=function(){var a=this.diagram;null!==a.commandHandler&&a.commandHandler.doKeyUp()},Ge.prototype.findTool=function(a){for(var b=this.mouseDownTools.length,t=0;t<b;t++){var e=this.mouseDownTools.J(t);if(e.name===a)return e}for(b=this.mouseMoveTools.length,t=0;t<b;t++)if((e=this.mouseMoveTools.J(t)).name===a)return e;for(b=this.mouseUpTools.length,t=0;t<b;t++)if((e=this.mouseUpTools.J(t)).name===a)return e;return null},Ge.prototype.replaceTool=function(a,b){null!==b&&(b.diagram=this.diagram);for(var t=this.mouseDownTools.length,e=0;e<t;e++){var n=this.mouseDownTools.J(e);if(n.name===a)return null!==b?this.mouseDownTools.Qc(e,b):this.mouseDownTools.cb(e),n}for(t=this.mouseMoveTools.length,e=0;e<t;e++)if((n=this.mouseMoveTools.J(e)).name===a)return null!==b?this.mouseMoveTools.Qc(e,b):this.mouseMoveTools.cb(e),n;for(t=this.mouseUpTools.length,e=0;e<t;e++)if((n=this.mouseUpTools.J(e)).name===a)return null!==b?this.mouseUpTools.Qc(e,b):this.mouseUpTools.cb(e),n;return null},Ge.prototype.Xa=function(a,b,t){null!==b&&(b.name=a,b.diagram=this.diagram),this.findTool(a)?this.replaceTool(a,b):null!==b&&t.add(b)},v.Object.defineProperties(Ge.prototype,{mouseWheelBehavior:{get:function(){return this.Ka},set:function(a){this.Ka=a}},gestureBehavior:{get:function(){return this.I},set:function(a){this.I=a}},currentToolTip:{get:function(){return this.l},set:function(a){this.l=a,this.Kr=null!==a&&a instanceof Eu?a.adornedPart:null}},mouseDownTools:{get:function(){return this.Cc}},mouseMoveTools:{get:function(){return this.Vc}},mouseUpTools:{get:function(){return this.Md}},hoverDelay:{get:function(){return this.Ja},set:function(a){this.Ja=a}},holdDelay:{get:function(){return this.T},set:function(a){this.T=a}},dragSize:{get:function(){return this.v},set:function(a){this.v=a.G()}},toolTipDuration:{get:function(){return this.eb},set:function(a){this.eb=a}}}),Ge.prototype.replaceStandardTool=Ge.prototype.Xa;var Xe=new _(Ge,"WheelScroll",0),qe=new _(Ge,"WheelZoom",1),Ue=new _(Ge,"WheelNone",2),Ke=new _(Ge,"GestureZoom",3),He=new _(Ge,"GestureCancel",4),We=new _(Ge,"GestureNone",5);function Je(){Ve.call(this),this.name="Dragging",this.I=this.Vc=!0,this.v=this.eb=this.Ja=this.rg=null,this.Qn=this.Md=!1,this.gm=new St(NaN,NaN),this.gt=new St,this.Cc=!0,this.nl=100,this.Xg=[],this.lr=(new ft).freeze(),this.Ka=new Ks,this.zo=null,this.T="copy",this.Vh="",this.Wh="no-drop"}function Ze(a,b){if(a.dragsLink){var t=a.diagram;t.allowRelink&&(t.model.yk()&&1===b.count&&b.first()instanceof uc?(a.draggedLink=b.first(),a.draggedLink.canRelinkFrom()&&a.draggedLink.canRelinkTo()&&a.draggedLink.lk(),a.rg=t.toolManager.findTool("Relinking"),null===a.rg&&(a.rg=new Nn,a.rg.diagram=t)):(a.draggedLink=null,a.rg=null))}}function $e(a){var b=a.diagram,t=b.skipsUndoManager;b.skipsUndoManager=!0,sn(a,b.lastInput,null),b.skipsUndoManager=t,a.Xg.length=0}function Qe(){var a=gn;tn(a),on(a);var b=a.diagram;a.gm.u()&&(b.position=a.gm),b.Lf()}function _e(a,b){if(null===a.copiedParts){var t=a.diagram;if((!b||!t.isReadOnly&&!t.isModelReadOnly)&&null!==a.draggedParts){var e=t.undoManager;for(e.isEnabled&&e.isInTransaction?null!==e.currentTransaction&&0<e.currentTransaction.changes.count&&(t.undoManager.Kf(),t.xa("Drag")):on(a),t.skipsUndoManager=!b,t.partManager.addsToTemporaryLayer=!b,a.startPoint=t.firstInput.documentPoint,b=a.copiesEffectiveCollection?a.draggedParts.Mf():t.selection,b=t.rk(b,t,!0),t=new Mt,e=a.draggedParts.iterator;e.next();){var n=e.key;if(n.Oc()&&n.canCopy()){var o=b.H(n);null!==o&&(o.location=n.location,o.Ta(),t.add(o,a.Bd(o.location)))}}for(b=b.iterator;b.next();)(e=b.value)instanceof uc&&e.canCopy()&&t.add(e,a.Bd());a.copiedParts=t,Ze(a,t.Mf()),null!==a.draggedLink&&(b=(t=a.draggedLink).routeBounds,dc(t,a.startPoint.x-(b.x+b.width/2),a.startPoint.y-(b.y+b.height/2)))}}}function tn(a){var b=a.diagram;if(null!==a.copiedParts&&(b.eu(a.copiedParts.Mf(),!1),a.copiedParts=null,null!==a.draggedParts))for(var t=a.draggedParts.iterator;t.next();)t.key instanceof uc&&(t.value.point=new St(0,0));b.skipsUndoManager=!1,b.partManager.addsToTemporaryLayer=!1,a.startPoint=b.firstInput.documentPoint}function en(a){if(null!==a.draggedLink){if(a.dragsLink&&null!==a.rg){var b=a.rg;b.diagram.remove(b.temporaryFromNode),b.diagram.remove(b.temporaryToNode)}a.draggedLink=null,a.rg=null}}function nn(a,b,t){var e=a.diagram,n=a.startPoint,o=St.alloc();o.assign(e.lastInput.documentPoint),a.moveParts(b,o.ee(n),t),St.free(o),!0===e.Ie("temporaryPixelRatio")&&null===e.xh&&30<e.$x&&(Ho(e),e.Xq())}function on(a){if(null!==a.draggedParts){for(var b=a.diagram,t=a.draggedParts.iterator;t.next();){var e=t.key;e.Oc()&&(e.location=t.value.point)}for(t=a.draggedParts.iterator;t.next();)if((e=t.key)instanceof uc&&e.suspendsRouting){var n=t.value.point;a.draggedParts.add(e,a.Bd()),dc(e,-n.x,-n.y)}b.jd()}}function rn(a,b){var t=a.diagram;a.dragsLink&&(null!==a.draggedLink&&(a.draggedLink.fromNode=null,a.draggedLink.toNode=null),ln(a,!1));var e=a.findDragOverObject(b),n=t.lastInput;n.targetObject=e,a.doUpdateCursor(e);var o=t.skipsUndoManager,g=!1;try{if(t.skipsUndoManager=!0,g=sn(a,n,e),!a.isActive&&null===gn)return;var r=null!==e?e.part:null;if(null===r||t.handlesDragDropForTopLevelParts&&r.isTopLevel&&!(r instanceof oc)){var h=t.mouseDragOver;null!==h&&(h(n),g=!0)}if(!a.isActive&&null===gn)return;if(a.doDragOver(b,e),!a.isActive&&null===gn)return}finally{t.skipsUndoManager=o,g&&t.jd()}a.zo=e,t.isReadOnly||!t.allowMove&&!t.allowCopy||!t.allowHorizontalScroll&&!t.allowVerticalScroll||t.Dt(n.viewPoint)}function sn(a,b,t){var e=!1,n=a.Xg.length,o=0<n?a.Xg[0]:null;if(t===o)return!1;b.handled=!1;for(var g=0;g<n;g++){var r=a.Xg[g],h=r.mouseDragLeave;if(null!==h&&(h(b,r,t),e=!0,b.handled))break}if(a.Xg.length=0,!a.isActive&&null===gn||null===t)return e;for(b.handled=!1,n=t;null!==n;)a.Xg.push(n),n=an(n);for(n=a.Xg.length,t=0;t<n&&(null===(r=(g=a.Xg[t]).mouseDragEnter)||(r(b,g,o),e=!0,!b.handled));t++);return e}function an(a){var b=a.panel;return null!==b?b:a instanceof yu&&!(a instanceof oc)&&(null!==(a=a.containingGroup)&&a.handlesDragDropForMembers)?a:null}function hn(a,b,t){var e=a.rg;if(null===e)return null;var n=a.diagram.Fg(b,e.portGravity,(function(a){return e.findValidLinkablePort(a,t)}));a=St.alloc();var o=1/0,g=null;for(n=n.iterator;n.next();){var r=n.value;if(null!==r.part){var h=r.da(bi,a);(h=b.Ge(h))<o&&(g=r,o=h)}}return St.free(a),g}function ln(a,b){var t=a.draggedLink;if(null!==t&&!(2>t.pointsCount)){var e=a.diagram;if(!e.isReadOnly){var n=a.rg;if(null!==n){var o=null,g=null;null===t.fromNode&&(null!==(o=hn(a,t.i(0),!1))&&(g=o.part));var r=null,h=null;null===t.toNode&&(null!==(r=hn(a,t.i(t.pointsCount-1),!0))&&(h=r.part)),n.isValidLink(g,o,h,r)?b?(t.defaultFromPoint=t.i(0),t.defaultToPoint=t.i(t.pointsCount-1),t.suspendsRouting=!1,t.fromNode=g,null!==o&&(t.fromPortId=o.portId),t.toNode=h,null!==r&&(t.toPortId=r.portId),t.fromPort!==e.My&&e.R("LinkRelinked",t,e.My),t.toPort!==e.Ny&&e.R("LinkRelinked",t,e.Ny)):Cn(n,g,o,h,r):Cn(n,null,null,null,null)}}}}function un(a,b){var t=a.diagram;a.dragsLink&&ln(a,!0),$e(a);var e=a.findDragOverObject(b),n=t.lastInput;if(n.targetObject=e,null!==e){n.handled=!1;for(var o=e;null!==o;){var g=o.mouseDrop;if(null!==g&&(g(n,o),n.handled))break;cn(a,n,o),o=an(o)}}else null!==(o=t.mouseDrop)&&o(n);if(a.isActive||null!==gn){for(n=(a.copiedParts||a.draggedParts).iterator;n.next();)(o=n.key)instanceof zu&&o.linksConnected.each((function(a){a.suspendsRouting=!1}));if(a.doDropOnto(b,e),a.isActive||null!==gn){for(a=Jt.alloc(),b=t.selection.iterator;b.next();)(e=b.value)instanceof zu&&fn(t,e,a);Jt.free(a)}}}function cn(a,b,t){a=a.diagram,t=t.part,!a.handlesDragDropForTopLevelParts||!t.isTopLevel||t instanceof oc||null!==(t=a.mouseDrop)&&t(b)}function fn(a,b,t){var e=!1;if(b.getAvoidableRect(t),a.viewportBounds.Ee(t)&&(e=!0),0!==(a=a.Tv(t,(function(a){return a.part}),(function(a){return a instanceof uc}),!0,(function(a){return a instanceof uc}),e)).count)for(a=a.iterator;a.next();)!(t=a.value).Hd(b)&&t.isAvoiding&&t.Ua()}function dn(a,b,t,e){if(null===a.copiedParts){var n=a.diagram;if(!n.isReadOnly&&!n.isModelReadOnly){n.skipsUndoManager=!t,n.partManager.addsToTemporaryLayer=!t,a.startPoint=e.documentPoint,t=n.rk(b,n,!0);var o=Jt.alloc();n=e=1/0;for(var g=-1/0,r=-1/0,h=b.iterator;h.next();){var l=h.value;if(l.isVisible()){var c=l.location;l=c.x,c=c.y,isNaN(l)||isNaN(c)||(l<e&&(e=l),c<n&&(n=c),l>g&&(g=l),c>r&&(r=c))}}for(1/0===e?o.h(0,0,0,0):o.h(e,n,g-e,r-n),e=o.x+o.width/2,n=o.y+o.height/2,Jt.free(o),o=a.gt,g=new Mt,r=St.alloc(),h=b.iterator;h.next();)(l=h.value)instanceof uc&&l.canCopy()&&(null!==(c=t.H(l))&&(c.points=l.points,dc(c,o.x-e,o.y-n),c.suspendsRouting=!0,g.add(c,a.Bd())));for(b=b.iterator;b.next();)(l=b.value).Oc()&&l.canCopy()&&(null!==(h=t.H(l))&&(l=l.location,r.h(o.x-(e-l.x),o.y-(n-l.y)),h.location=r,h.Ta(),g.add(h,a.Bd(r))));St.free(r),a.copiedParts=g,Ze(a,g.Mf()),null!==a.draggedLink&&(b=(t=a.draggedLink).routeBounds,dc(t,a.startPoint.x-(b.x+b.width/2),a.startPoint.y-(b.y+b.height/2)))}}}Ge.className="ToolManager",Ge.WheelScroll=Xe,Ge.WheelZoom=qe,Ge.WheelNone=Ue,Ge.GestureZoom=Ke,Ge.GestureCancel=He,Ge.GestureNone=We,m(Je,Ve),Je.prototype.canStart=function(){if(!this.isEnabled)return!1;var a=this.diagram;if(a.isReadOnly&&!a.allowDragOut||!a.allowMove&&!a.allowCopy&&!a.allowDragOut||!a.allowSelect)return!1;var b=a.lastInput;return!(!b.left||a.currentTool!==this&&(!this.isBeyondDragSize()||b.isTouchEvent&&b.timestamp-a.firstInput.timestamp<this.nl))&&null!==this.findDraggablePart()},Je.prototype.findDraggablePart=function(){var a=this.diagram;if(null===(a=a.xm(a.firstInput.documentPoint,!1)))return null;for(;null!==a&&!a.canSelect();)a=a.containingGroup;return null!==a&&(a.canMove()||a.canCopy())?a:null},Je.prototype.standardMouseSelect=function(){var a=this.diagram;if(a.allowSelect){var b=a.xm(a.firstInput.documentPoint,!1);if(null!==b){for(;null!==b&&!b.canSelect();)b=b.containingGroup;this.currentPart=b,null===this.currentPart||this.currentPart.isSelected||(a.R("ChangingSelection",a.selection),b=a.lastInput,(J?b.meta:b.control)||b.shift||a.clearSelection(!0),this.currentPart.isSelected=!0,a.R("ChangedSelection",a.selection))}}},Je.prototype.doActivate=function(){var a=this.diagram;this.zo=null,null===this.currentPart&&this.standardMouseSelect();var b=this.currentPart;null!==b&&(b.canMove()||b.canCopy())&&(gn=null,this.isActive=!0,this.gm.set(a.position),Ze(this,a.selection),this.Xg.length=0,a.animationManager.Sc(),this.draggedParts=this.computeEffectiveCollection(a.selection,this.dragOptions),a.ku=!0,!0===a.Ie("temporaryPixelRatio")&&30<a.$x&&Ho(a),Or(a,this.draggedParts),this.xa("Drag"),this.startPoint=a.firstInput.documentPoint,a.isMouseCaptured=!0,a.allowDragOut&&(this.isDragOutStarted=!0,this.Qn=!1,gn=this,yn=this.diagram,this.doSimulatedDragOut()))},Je.prototype.computeEffectiveCollection=function(a,b){return this.diagram.commandHandler.computeEffectiveCollection(a,b)},Je.prototype.Bd=function(a){return void 0===a?new Fs(Dt):this.isGridSnapEnabled?new Fs(new St(Math.round(1e3*a.x)/1e3,Math.round(1e3*a.y)/1e3)):new Fs(a.copy())},Je.prototype.doDeactivate=function(){this.isActive=!1;var a=this.diagram;if(a.Lf(),$e(this),Fr(a,this.draggedParts),this.draggedParts=this.currentPart=this.zo=null,this.Qn=this.isDragOutStarted=!1,0<pn.count){for(var b=pn,t=b.length,e=0;e<t;e++){var n=b.J(e);en(n),tn(n),$e(n),n.diagram.Lf()}b.clear()}en(this),this.gm.h(NaN,NaN),gn=yn=null,tn(this),a.isMouseCaptured=!1,a.currentCursor="",a.ku=!1,this.Kg(),Wo(a,!0)},Je.prototype.doCancel=function(){tn(this),on(this);var a=this.diagram;this.gm.u()&&(a.position=this.gm),this.stopTool()},Je.prototype.doKeyDown=function(){var a=this.diagram,b=a.lastInput;this.isActive&&("Esc"===b.key?this.doCancel():b.key!==a.previousInput.key&&this.doMouseMove())},Je.prototype.doKeyUp=function(){this.isActive&&this.doMouseMove()},Je.prototype.moveParts=function(a,b,t){void 0===t&&(t=!1);var e=this.diagram;null!==e&&Ar(e,a,b,this.dragOptions,t)},Je.prototype.findDragOverObject=function(a){var b=this;return rr(this.diagram,a,null,(function(a){return null===a?a=!0:a=!!(null===(a=a.part)||a instanceof Eu||a.layer.isTemporary||b.draggedParts&&b.draggedParts.contains(a)||b.copiedParts&&b.copiedParts.contains(a)),!a}))},Je.prototype.doUpdateCursor=function(a){var b=this.diagram;this.zo!==a&&(!this.diagram.currentTool.isActive||this.mayCopy()?b.currentCursor=this.copyCursor:this.mayMove()?b.currentCursor=this.moveCursor:this.mayDragOut()&&(b.currentCursor=this.nodropCursor))},Je.prototype.doDragOver=function(){},Je.prototype.doDropOnto=function(){},Je.prototype.doMouseMove=function(){if(this.isActive){var a=this.diagram,b=a.lastInput;this.simulatedMouseMove(b.event,b.documentPoint,b.targetDiagram)||null===this.currentPart||null===this.draggedParts||(this.mayCopy()?(_e(this,!1),Or(a,this.copiedParts),nn(this,this.copiedParts,!1),Fr(a,this.copiedParts)):this.mayMove()?(tn(this),nn(this,this.draggedParts,!0)):this.mayDragOut()?(_e(this,!1),nn(this,this.copiedParts,!1)):tn(this),rn(this,a.lastInput.documentPoint))}},Je.prototype.doMouseUp=function(){if(this.isActive){var a=this.diagram,b=a.lastInput;if(!this.simulatedMouseUp(b.event,b.documentPoint,b.targetDiagram)){b=!1;var t=this.mayCopy();if(t&&null!==this.copiedParts?(tn(this),_e(this,!0),Or(a,this.copiedParts),nn(this,this.copiedParts,!1),Fr(a,this.copiedParts),null!==this.copiedParts&&(a.R("ChangingSelection",a.selection),a.clearSelection(!0),this.copiedParts.iteratorKeys.each((function(a){a.isSelected=!0})))):(b=!0,tn(this),this.mayMove()&&(nn(this,this.draggedParts,!0),rn(this,a.lastInput.documentPoint))),this.Qn=!0,un(this,a.lastInput.documentPoint),this.isActive){var e=t?this.copiedParts.Mf():this.draggedParts.Mf();this.copiedParts=null,b&&function(a){if(null!==a.draggedParts)for(var b=a.draggedParts.iterator;b.next();){var t=b.key;t instanceof zu&&(null===(t=t.containingGroup)||null===t.placeholder||a.draggedParts.contains(t)||t.placeholder.o())}}(this),a.Oa(),Fr(a,this.draggedParts),this.transactionResult=t?"Copy":"Move",a.R(t?"SelectionCopied":"SelectionMoved",e)}this.stopTool(),t&&a.R("ChangedSelection",a.selection)}}},Je.prototype.simulatedMouseMove=function(a,b,t){if(null===gn)return!1;var e=gn.diagram;t instanceof Xo||(t=null);var n=yn;return t!==n&&(null!==n&&n!==e&&(n.Lf(),gn.isDragOutStarted=!1,null!==(n=n.toolManager.findTool("Dragging"))&&n.doSimulatedDragLeave()),yn=t,null!==t&&t!==e&&(Qe(),null!==(n=t.toolManager.findTool("Dragging"))&&(pn.contains(n)||pn.add(n),n.doSimulatedDragEnter()))),!(null===t||t===e||!t.allowDrop||t.isReadOnly||!t.allowInsert)&&(null!==(e=t.toolManager.findTool("Dragging"))&&(null!==a&&(void 0!==a.targetTouches&&(0<a.targetTouches.length?a=a.targetTouches[0]:0<a.changedTouches.length&&(a=a.changedTouches[0])),b=t.getMouse(a)),t.lastInput.documentPoint=b,t.lastInput.viewPoint=t.gr(b),t.lastInput.down=!1,t.lastInput.up=!1,e.doSimulatedDragOver()),!0)},Je.prototype.simulatedMouseUp=function(a,b,t){if(null===gn)return!1;var e=yn,n=gn.diagram;if(null===t)return gn.doCancel(),!0;if(t!==e){var o=e.toolManager.findTool("Dragging");if(null!==e&&e!==n&&null!==o)return e.Lf(),gn.isDragOutStarted=!1,o.doSimulatedDragLeave(),!1;yn=t,null!==(e=t.toolManager.findTool("Dragging"))&&(Qe(),pn.contains(e)||pn.add(e),e.doSimulatedDragEnter())}return t!==this.diagram&&(null!==a?(void 0!==a.targetTouches&&(0<a.targetTouches.length?a=a.targetTouches[0]:0<a.changedTouches.length&&(a=a.changedTouches[0])),b=t.getMouse(a)):null===b&&(b=new St),t.lastInput.documentPoint=b,t.lastInput.viewPoint=t.gr(b),t.lastInput.down=!1,t.lastInput.up=!0,null!==(a=t.toolManager.findTool("Dragging"))&&a.doSimulatedDrop(),null!==(a=gn)&&(t=a.mayCopy(),a.transactionResult=t?"Copy":"Move",a.stopTool()),!0)},Je.prototype.mayCopy=function(){if(!this.isCopyEnabled)return!1;var a=this.diagram;if(a.isReadOnly||a.isModelReadOnly||!a.allowInsert||!a.allowCopy||(J?!a.lastInput.alt:!a.lastInput.control))return!1;for(a=a.selection.iterator;a.next();)if(a.value.canCopy())return!0;return!(null===this.draggedLink||!this.dragsLink||!this.draggedLink.canCopy())},Je.prototype.mayDragOut=function(){if(!this.isCopyEnabled)return!1;var a=this.diagram;if(!a.allowDragOut||!a.allowCopy||a.allowMove)return!1;for(a=a.selection.iterator;a.next();)if(a.value.canCopy())return!0;return!(null===this.draggedLink||!this.dragsLink||!this.draggedLink.canCopy())},Je.prototype.mayMove=function(){var a=this.diagram;if(a.isReadOnly||!a.allowMove)return!1;for(a=a.selection.iterator;a.next();)if(a.value.canMove())return!0;return!(null===this.draggedLink||!this.dragsLink||!this.draggedLink.canMove())},Je.prototype.computeBorder=function(a,b,t){return this.Qn||null===this.draggedParts||this.draggedParts.contains(a)?null:t.assign(b)},Je.prototype.lA=function(){return gn},Je.prototype.mayDragIn=function(){var a=this.diagram;if(!a.allowDrop||a.isReadOnly||a.isModelReadOnly||!a.allowInsert)return!1;return null!==gn&&gn.diagram.model.dataFormat===a.model.dataFormat},Je.prototype.doSimulatedDragEnter=function(){if(this.mayDragIn()){var a=this.diagram;a.animationManager.Sc(),yr(a),a.animationManager.Sc();null!==gn&&(gn.diagram.ku=!1),this.doUpdateCursor(a.grid)}},Je.prototype.doSimulatedDragLeave=function(){null!==gn&&gn.doSimulatedDragOut(),this.doCancel()},Je.prototype.doSimulatedDragOver=function(){var a=this.diagram;a.animationManager.qn=!0;var b=gn;if(null!==b&&null!==b.draggedParts){if(!this.mayDragIn())return;dn(this,b.draggedParts.Mf(),!1,a.firstInput),nn(this,this.copiedParts,!1),rn(this,a.lastInput.documentPoint)}a.animationManager.qn=!1},Je.prototype.doSimulatedDrop=function(){var a=this.diagram,b=gn;if(null!==b){var t=b.diagram;if(b.Qn=!0,tn(this),!this.mayDragIn())return;a.animationManager.qn=!0,a.R("ChangingSelection",a.selection),this.xa("Drop"),dn(this,b.draggedParts.Mf(),!0,a.lastInput),nn(this,this.copiedParts,!1),null!==this.copiedParts&&(a.clearSelection(!0),this.copiedParts.iteratorKeys.each((function(a){a.isSelected=!0}))),un(this,a.lastInput.documentPoint),a.Oa(),b=a.selection,null!==this.copiedParts?this.transactionResult="ExternalCopy":b=new ft,this.copiedParts=null,a.doFocus(),a.R("ExternalObjectsDropped",b,t),this.Kg(),a.R("ChangedSelection",a.selection)}a.animationManager.qn=!1},Je.prototype.doSimulatedDragOut=function(){var a=this.diagram;a.ku=!1,this.mayCopy()||this.mayMove()?a.currentCursor="":a.currentCursor=this.nodropCursor,this.zo=null},Je.prototype.computeMove=function(a,b,t,e){return null!==(t=this.diagram)?t.computeMove(a,b,this.dragOptions,e):new St},v.Object.defineProperties(Je.prototype,{isCopyEnabled:{get:function(){return this.Vc},set:function(a){this.Vc=a}},copiesEffectiveCollection:{get:function(){return this.I},set:function(a){this.I=a}},dragOptions:{get:function(){return this.Ka},set:function(a){this.Ka=a}},isGridSnapEnabled:{get:function(){return this.dragOptions.isGridSnapEnabled},set:function(a){this.dragOptions.isGridSnapEnabled=a}},isComplexRoutingRealtime:{get:function(){return this.Cc},set:function(a){this.Cc=a}},isGridSnapRealtime:{get:function(){return this.dragOptions.isGridSnapRealtime},set:function(a){this.dragOptions.isGridSnapRealtime=a}},gridSnapCellSize:{get:function(){return this.dragOptions.gridSnapCellSize},set:function(a){this.dragOptions.gridSnapCellSize.w(a)||(a=a.G(),this.dragOptions.gridSnapCellSize=a)}},gridSnapCellSpot:{get:function(){return this.dragOptions.gridSnapCellSpot},set:function(a){this.dragOptions.gridSnapCellSpot.w(a)||(a=a.G(),this.dragOptions.gridSnapCellSpot=a)}},gridSnapOrigin:{get:function(){return this.dragOptions.gridSnapOrigin},set:function(a){this.dragOptions.gridSnapOrigin.w(a)||(a=a.G(),this.dragOptions.gridSnapOrigin=a)}},dragsLink:{get:function(){return this.dragOptions.dragsLink},set:function(a){this.dragOptions.dragsLink=a}},dragsTree:{get:function(){return this.dragOptions.dragsTree},set:function(a){this.dragOptions.dragsTree=a}},copyCursor:{get:function(){return this.T},set:function(a){this.T=a}},moveCursor:{get:function(){return this.Vh},set:function(a){this.Vh=a}},nodropCursor:{get:function(){return this.Wh},set:function(a){this.Wh=a}},currentPart:{get:function(){return this.Ja},set:function(a){this.Ja=a}},copiedParts:{get:function(){return this.v},set:function(a){this.v=a}},draggedParts:{get:function(){return this.eb},set:function(a){this.eb=a}},draggingParts:{get:function(){return null!==this.copiedParts?this.copiedParts.Mf():null!==this.draggedParts?this.draggedParts.Mf():this.lr}},draggedLink:{get:function(){return this.diagram.draggedLink},set:function(a){this.diagram.draggedLink=a}},isDragOutStarted:{get:function(){return this.Md},set:function(a){this.Md=a}},startPoint:{get:function(){return this.gt},set:function(a){this.gt.w(a)||this.gt.assign(a)}},delay:{get:function(){return this.nl},set:function(a){this.nl=a}}}),Je.prototype.getDraggingSource=Je.prototype.lA;var pn=null,gn=null,yn=null;function mn(){Ve.call(this),this.Wh=100,this.Ka=!1,this.ni="pointer";var a=new uc,b=new pl;b.isPanelMain=!0,b.stroke="blue",a.add(b),(b=new pl).toArrow="Standard",b.fill="blue",b.stroke="blue",a.add(b),a.layerName="Tool",this.gx=a,a=new zu,(b=new pl).portId="",b.figure="Rectangle",b.fill=null,b.stroke="magenta",b.strokeWidth=2,b.desiredSize=Et,a.add(b),a.selectable=!1,a.layerName="Tool",this.ex=a,this.l=b,a=new zu,(b=new pl).portId="",b.figure="Rectangle",b.fill=null,b.stroke="magenta",b.strokeWidth=2,b.desiredSize=Et,a.add(b),a.selectable=!1,a.layerName="Tool",this.hx=a,this.v=b,this.Vh=this.Md=this.Cc=this.eb=this.Vc=null,this.Ja=!0,this.ez=new Mt,this.lr=this.Gi=this.bx=null}function vn(a,b,t,e){if(b===t)return!0;var n=b.fromNode;return!(null===n||!n.isLinkLabel||(e.add(n),!vn(a,n.labeledLink,t,e)))||!(null===(b=b.toNode)||!b.isLinkLabel||(e.add(b),!vn(a,b.labeledLink,t,e)))}function xn(a,b,t,e,n){if(b===t)return!0;if(null===b||null===t)return!1;for(var o=b.linksConnected;o.next();){var g=o.value;if(g!==e&&(!n||g.isTreeLink)&&g.toNode===b&&((g=g.fromNode)!==b&&xn(a,g,t,e,n)))return!0}return!1}function bn(a,b,t,e,n){if(t===e)return!0;if(null===t||null===e||b.contains(t))return!1;b.add(t);for(var o=t.linksConnected;o.next();){var g=o.value;if(g!==n&&g.toNode===t&&((g=g.fromNode)!==t&&bn(a,b,g,e,n)))return!0}return!1}function wn(a,b,t,e,n){if(t===e)return!0;if(null===t||null===e||b.contains(t))return!1;b.add(t);for(var o=t.linksConnected;o.next();){var g=o.value;if(g!==n){var r=g.fromNode;if(g=g.toNode,(r=r===t?g:r)!==t&&wn(a,b,r,e,n))return!0}}return!1}function kn(){mn.call(this),this.name="Linking",this.T={},this.I=null,this.K=Mn,this.bn=null}Je.className="DraggingTool",pn=new ut,G("draggingTool",(function(){return this.findTool("Dragging")}),(function(a){this.Xa("Dragging",a,this.mouseMoveTools)})),Ge.prototype.doCancel=function(){null!==gn&&gn.doCancel(),Ve.prototype.doCancel.call(this)},m(mn,Ve),mn.prototype.doStop=function(){this.diagram.Lf(),this.originalToPort=this.originalToNode=this.originalFromPort=this.originalFromNode=this.originalLink=null,this.validPortsCache.clear(),this.targetPort=null},mn.prototype.copyPortProperties=function(a,b,t,e,n){if(null!==a&&null!==b&&null!==t&&null!==e){var o=b.Cf(),g=Ut.alloc();g.width=b.naturalBounds.width*o,g.height=b.naturalBounds.height*o,e.desiredSize=g,Ut.free(g),n?(e.toSpot=b.toSpot,e.toEndSegmentLength=b.toEndSegmentLength):(e.fromSpot=b.fromSpot,e.fromEndSegmentLength=b.fromEndSegmentLength),t.locationSpot=bi,o=St.alloc(),t.location=b.da(bi,o),St.free(o),e.angle=b.kj(),null!==this.portTargeted&&this.portTargeted(a,b,t,e,n)}},mn.prototype.setNoTargetPortProperties=function(a,b,t){null!==b&&(b.desiredSize=Et,b.fromSpot=gi,b.toSpot=gi),null!==a&&(a.location=this.diagram.lastInput.documentPoint),null!==this.portTargeted&&this.portTargeted(null,null,a,b,t)},mn.prototype.doMouseDown=function(){this.isActive&&this.doMouseMove()},mn.prototype.doMouseMove=function(){if(this.isActive){var a=this.diagram;if(this.targetPort=this.findTargetPort(this.isForwards),null!==this.targetPort&&this.targetPort.part instanceof zu){var b=this.targetPort.part;this.isForwards?this.copyPortProperties(b,this.targetPort,this.temporaryToNode,this.temporaryToPort,!0):this.copyPortProperties(b,this.targetPort,this.temporaryFromNode,this.temporaryFromPort,!1)}else this.isForwards?this.setNoTargetPortProperties(this.temporaryToNode,this.temporaryToPort,!0):this.setNoTargetPortProperties(this.temporaryFromNode,this.temporaryFromPort,!1);(a.allowHorizontalScroll||a.allowVerticalScroll)&&a.Dt(a.lastInput.viewPoint)}},mn.prototype.findValidLinkablePort=function(a,b){if(null===a)return null;var t=a.part;if(!(t instanceof zu))return null;for(;null!==a;){var e=b?a.toLinkable:a.fromLinkable;if(!0===e&&(null!==a.portId||a instanceof zu)&&(b?this.isValidTo(t,a):this.isValidFrom(t,a)))return a;if(!1===e)break;a=a.panel}return null},mn.prototype.findTargetPort=function(a){var b=this.diagram,t=b.lastInput.documentPoint,e=this.portGravity;0>=e&&(e=.1);var n=this,o=b.Fg(t,e,(function(b){return n.findValidLinkablePort(b,a)}),null,!0);for(e=1/0,b=null,o=o.iterator;o.next();){var g=o.value,r=g.part;if(r instanceof zu){var h=g.da(bi,St.alloc()),l=t.x-h.x,c=t.y-h.y;St.free(h),(h=l*l+c*c)<e&&(null!==(l=this.validPortsCache.H(g))?l&&(b=g,e=h):a&&this.isValidLink(this.originalFromNode,this.originalFromPort,r,g)||!a&&this.isValidLink(r,g,this.originalToNode,this.originalToPort)?(this.validPortsCache.add(g,!0),b=g,e=h):this.validPortsCache.add(g,!1))}}return null!==b&&((t=b.part)instanceof zu&&(null===t.layer||t.layer.allowLink))?b:null},mn.prototype.isValidFrom=function(a,b){if(null===a||null===b)return this.isUnconnectedLinkValid;if(this.diagram.currentTool===this&&(null!==a.layer&&!a.layer.allowLink||!0!==b.fromLinkable))return!1;var t=b.fromMaxLinks;if(1/0>t){if(null!==this.originalLink&&a===this.originalFromNode&&b===this.originalFromPort)return!0;if(null===(b=b.portId)&&(b=""),a.Bq(b).count>=t)return!1}return!0},mn.prototype.isValidTo=function(a,b){if(null===a||null===b)return this.isUnconnectedLinkValid;if(this.diagram.currentTool===this&&(null!==a.layer&&!a.layer.allowLink||!0!==b.toLinkable))return!1;var t=b.toMaxLinks;if(1/0>t){if(null!==this.originalLink&&a===this.originalToNode&&b===this.originalToPort)return!0;if(null===(b=b.portId)&&(b=""),a.Fd(b).count>=t)return!1}return!0},mn.prototype.isInSameNode=function(a,b){return null!==a&&null!==b&&(a===b||(a=a.part,b=b.part,null!==a&&a===b))},mn.prototype.isLinked=function(a,b){if(null===a||null===b)return!1;var t=a.part;if(!(t instanceof zu))return!1;null===(a=a.portId)&&(a="");var e=b.part;if(!(e instanceof zu))return!1;for(null===(b=b.portId)&&(b=""),b=e.Fd(b);b.next();)if((e=b.value).fromNode===t&&e.fromPortId===a)return!0;return!1},mn.prototype.isValidLink=function(a,b,t,e){if(!this.isValidFrom(a,b)||!this.isValidTo(t,e)||!(null===b||null===e||(b.fromLinkableSelfNode&&e.toLinkableSelfNode||!this.isInSameNode(b,e))&&(b.fromLinkableDuplicates&&e.toLinkableDuplicates||!this.isLinked(b,e)))||null!==this.originalLink&&(null!==a&&this.isLabelDependentOnLink(a,this.originalLink)||null!==t&&this.isLabelDependentOnLink(t,this.originalLink))||null!==a&&null!==t&&(null===a.data&&null!==t.data||null!==a.data&&null===t.data)||!this.isValidCycle(a,t,this.originalLink))return!1;if(null!==a){var n=a.linkValidation;if(null!==n&&!n(a,b,t,e,this.originalLink))return!1}return!(null!==t&&null!==(n=t.linkValidation)&&!n(a,b,t,e,this.originalLink))&&(null===(n=this.linkValidation)||n(a,b,t,e,this.originalLink))},mn.prototype.isLabelDependentOnLink=function(a,b){if(null===a)return!1;var t=a.labeledLink;if(null===t)return!1;if(t===b)return!0;var e=new ft;return e.add(a),vn(this,t,b,e)},mn.prototype.isValidCycle=function(a,b,t){if(void 0===t&&(t=null),null===a||null===b)return this.isUnconnectedLinkValid;var e=this.diagram.validCycle;if(e!==ps){if(e===vs){if(null!==(e=t||this.temporaryLink)&&!e.isTreeLink)return!0;for(e=b.linksConnected;e.next();){var n=e.value;if(n!==t&&n.isTreeLink&&n.toNode===b)return!1}return!xn(this,a,b,t,!0)}if(e===xs){if(null!==(e=t||this.temporaryLink)&&!e.isTreeLink)return!0;for(e=a.linksConnected;e.next();)if((n=e.value)!==t&&n.isTreeLink&&n.fromNode===a)return!1;return!xn(this,a,b,t,!0)}if(e===gs)return a===b?a=!0:((e=new ft).add(b),a=bn(this,e,a,b,t)),!a;if(e===ys)return!xn(this,a,b,t,!1);if(e===ms)return a===b?a=!0:((e=new ft).add(b),a=wn(this,e,a,b,t)),!a}return!0},v.Object.defineProperties(mn.prototype,{portGravity:{get:function(){return this.Wh},set:function(a){0<=a&&(this.Wh=a)}},isUnconnectedLinkValid:{get:function(){return this.Ka},set:function(a){this.Ka=a}},linkingCursor:{get:function(){return this.ni},set:function(a){this.ni=a}},temporaryLink:{get:function(){return this.gx},set:function(a){this.gx=a}},temporaryFromNode:{get:function(){return this.ex},set:function(a){(this.ex=a)&&(this.l=a.port)}},temporaryFromPort:{get:function(){return this.l},set:function(a){if(null!==this.l){var b=this.l.panel;if(null!==b){var t=b.W.indexOf(this.l);b.cb(t),b.wb(t,a)}}this.l=a}},temporaryToNode:{get:function(){return this.hx},set:function(a){(this.hx=a)&&(this.v=a.port)}},temporaryToPort:{get:function(){return this.v},set:function(a){if(null!==this.v){var b=this.v.panel;if(null!==b){var t=b.W.indexOf(this.v);b.cb(t),b.wb(t,a)}}this.v=a}},originalLink:{get:function(){return this.Vc},set:function(a){this.Vc=a}},originalFromNode:{get:function(){return this.eb},set:function(a){this.eb=a}},originalFromPort:{get:function(){return this.Cc},set:function(a){this.Cc=a}},originalToNode:{get:function(){return this.Md},set:function(a){this.Md=a}},originalToPort:{get:function(){return this.Vh},set:function(a){this.Vh=a}},isForwards:{get:function(){return this.Ja},set:function(a){this.Ja=a}},validPortsCache:{get:function(){return this.ez}},targetPort:{get:function(){return this.bx},set:function(a){this.bx=a}},linkValidation:{get:function(){return this.Gi},set:function(a){this.Gi=a}},portTargeted:{get:function(){return this.lr},set:function(a){this.lr=a}}}),mn.className="LinkingBaseTool",m(kn,mn),kn.prototype.canStart=function(){if(!this.isEnabled)return!1;var a=this.diagram;return!(a.isReadOnly||a.isModelReadOnly||!a.allowLink||!a.model.Tt()||!a.lastInput.left||a.currentTool!==this&&!this.isBeyondDragSize())&&null!==this.findLinkablePort()},kn.prototype.findLinkablePort=function(){var a=this.diagram,b=this.startObject;if(null===b&&(b=a.Vb(a.firstInput.documentPoint,null,null)),null===b||!(b.part instanceof zu))return null;if((a=this.direction)===Mn||a===Sn){var t=this.findValidLinkablePort(b,!1);if(null!==t)return this.isForwards=!0,t}return a!==Mn&&a!==Pn||null===(b=this.findValidLinkablePort(b,!0))?null:(this.isForwards=!1,b)},kn.prototype.doActivate=function(){var a=this.diagram,b=this.findLinkablePort();null!==b&&(this.xa(this.name),a.isMouseCaptured=!0,a.currentCursor=this.linkingCursor,this.isForwards?(null===this.temporaryToNode||this.temporaryToNode.location.u()||(this.temporaryToNode.location=a.lastInput.documentPoint),this.originalFromPort=b,(b=this.originalFromPort.part)instanceof zu&&(this.originalFromNode=b),this.copyPortProperties(this.originalFromNode,this.originalFromPort,this.temporaryFromNode,this.temporaryFromPort,!1)):(null===this.temporaryFromNode||this.temporaryFromNode.location.u()||(this.temporaryFromNode.location=a.lastInput.documentPoint),this.originalToPort=b,(b=this.originalToPort.part)instanceof zu&&(this.originalToNode=b),this.copyPortProperties(this.originalToNode,this.originalToPort,this.temporaryToNode,this.temporaryToPort,!0)),a.add(this.temporaryFromNode),a.add(this.temporaryToNode),null!==this.temporaryLink&&(null!==this.temporaryFromNode&&(this.temporaryLink.fromNode=this.temporaryFromNode),null!==this.temporaryToNode&&(this.temporaryLink.toNode=this.temporaryToNode),this.temporaryLink.isTreeLink=this.isNewTreeLink(),this.temporaryLink.Ua(),a.add(this.temporaryLink)),this.isActive=!0)},kn.prototype.doDeactivate=function(){this.isActive=!1;var a=this.diagram;a.remove(this.temporaryLink),a.remove(this.temporaryFromNode),a.remove(this.temporaryToNode),a.isMouseCaptured=!1,a.currentCursor="",this.Kg()},kn.prototype.doStop=function(){mn.prototype.doStop.call(this),this.startObject=null},kn.prototype.doMouseUp=function(){var a=this.diagram;if(this.isActive){var b=this.transactionResult=null,t=null,e=null,n=null,o=null;try{var g=this.targetPort=this.findTargetPort(this.isForwards);if(null!==g){var r=g.part;r instanceof zu&&(this.isForwards?(null!==this.originalFromNode&&(b=this.originalFromNode,t=this.originalFromPort),e=r,n=g):(b=r,t=g,null!==this.originalToNode&&(e=this.originalToNode,n=this.originalToPort)))}else this.isForwards?null!==this.originalFromNode&&this.isUnconnectedLinkValid&&(b=this.originalFromNode,t=this.originalFromPort):null!==this.originalToNode&&this.isUnconnectedLinkValid&&(e=this.originalToNode,n=this.originalToPort);null!==b||null!==e?null!==(o=this.insertLink(b,t,e,n))?(null===g&&(this.isForwards?o.defaultToPoint=a.lastInput.documentPoint:o.defaultFromPoint=a.lastInput.documentPoint),a.allowSelect&&(a.R("ChangingSelection",a.selection),a.clearSelection(!0),o.isSelected=!0),this.transactionResult=this.name,a.R("LinkDrawn",o)):this.doNoLink(b,t,e,n):this.isForwards?this.doNoLink(this.originalFromNode,this.originalFromPort,null,null):this.doNoLink(null,null,this.originalToNode,this.originalToPort)}finally{this.stopTool(),o&&a.allowSelect&&a.R("ChangedSelection",a.selection)}}},kn.prototype.isNewTreeLink=function(){var a=this.archetypeLinkData;if(null===a)return!0;if(a instanceof uc)return a.isTreeLink;var b=this.diagram;return null===b||(a=b.partManager.getLinkCategoryForData(a),null===(b=b.partManager.findLinkTemplateForCategory(a))||b.isTreeLink)},kn.prototype.insertLink=function(a,b,t,e){return this.diagram.partManager.insertLink(a,b,t,e)},kn.prototype.doNoLink=function(){},v.Object.defineProperties(kn.prototype,{archetypeLinkData:{get:function(){return this.T},set:function(a){this.T=a}},archetypeLabelNodeData:{get:function(){return this.I},set:function(a){this.I=a}},direction:{get:function(){return this.K},set:function(a){this.K=a}},startObject:{get:function(){return this.bn},set:function(a){this.bn=a}}});var Mn=new _(kn,"Either",0),Sn=new _(kn,"ForwardsOnly",0),Pn=new _(kn,"BackwardsOnly",0);function Nn(){mn.call(this),this.name="Relinking";var a=new pl;a.figure="Diamond",a.desiredSize=Vt,a.fill="lightblue",a.stroke="dodgerblue",a.cursor=this.linkingCursor,a.segmentIndex=0,this.T=a,(a=new pl).figure="Diamond",a.desiredSize=Vt,a.fill="lightblue",a.stroke="dodgerblue",a.cursor=this.linkingCursor,a.segmentIndex=-1,this.bn=a,this.I=null,this.Ix=new Jt}function Cn(a,b,t,e,n){null!==b?(a.copyPortProperties(b,t,a.temporaryFromNode,a.temporaryFromPort,!1),a.diagram.add(a.temporaryFromNode)):a.diagram.remove(a.temporaryFromNode),null!==e?(a.copyPortProperties(e,n,a.temporaryToNode,a.temporaryToPort,!0),a.diagram.add(a.temporaryToNode)):a.diagram.remove(a.temporaryToNode)}function Tn(){Ve.call(this),this.name="LinkReshaping";var a=new pl;a.figure="Rectangle",a.desiredSize=zt,a.fill="lightblue",a.stroke="dodgerblue",this.v=a,(a=new pl).figure="Diamond",a.desiredSize=Vt,a.fill="lightblue",a.stroke="dodgerblue",a.cursor="move",this.I=a,this.T=3,this.tu=this.l=null,this.Jx=new St,this.Is=new ut}function Ln(a,b,t,e,n,o){return o?Math.abs(b.y-t.y)<a.resegmentingDistance&&Math.abs(t.y-e.y)<a.resegmentingDistance&&Math.abs(e.y-n.y)<a.resegmentingDistance:Math.abs(b.x-t.x)<a.resegmentingDistance&&Math.abs(t.x-e.x)<a.resegmentingDistance&&Math.abs(e.x-n.x)<a.resegmentingDistance}kn.className="LinkingTool",kn.Either=Mn,kn.ForwardsOnly=Sn,kn.BackwardsOnly=Pn,m(Nn,mn),Nn.prototype.updateAdornments=function(a){if(null!==a&&a instanceof uc){var b="RelinkFrom",t=null;if(a.isSelected&&!this.diagram.isReadOnly){var e=a.selectionObject;null!==e&&a.canRelinkFrom()&&a.actualBounds.u()&&a.isVisible()&&e.actualBounds.u()&&e.If()&&(null===(t=a.uk(b))&&(t=this.makeAdornment(e,!1),a.Fh(b,t)))}null===t&&a.Jf(b),b="RelinkTo",t=null,a.isSelected&&!this.diagram.isReadOnly&&(null!==(e=a.selectionObject)&&a.canRelinkTo()&&a.actualBounds.u()&&a.isVisible()&&e.actualBounds.u()&&e.If()&&(null===(t=a.uk(b))?(t=this.makeAdornment(e,!0),a.Fh(b,t)):t.o())),null===t&&a.Jf(b)}},Nn.prototype.makeAdornment=function(a,b){var t=new Eu;return t.type=Fh.Link,null!==(b=b?this.toHandleArchetype:this.fromHandleArchetype)&&t.add(b.copy()),t.adornedObject=a,t},Nn.prototype.canStart=function(){if(!this.isEnabled)return!1;var a=this.diagram;if(a.isReadOnly||a.isModelReadOnly||!a.allowRelink||!a.model.Tt()||!a.lastInput.left)return!1;var b=this.findToolHandleAt(a.firstInput.documentPoint,"RelinkFrom");return null===b&&(b=this.findToolHandleAt(a.firstInput.documentPoint,"RelinkTo")),null!==b},Nn.prototype.doActivate=function(){var a=this.diagram;if(null===this.originalLink){var b=this.handle;if(null===b&&(null===(b=this.findToolHandleAt(a.firstInput.documentPoint,"RelinkFrom"))&&(b=this.findToolHandleAt(a.firstInput.documentPoint,"RelinkTo"))),null===b)return;var t=b.part;if(!(t instanceof Eu&&t.adornedPart instanceof uc))return;this.handle=b,this.isForwards=null===t||"RelinkTo"===t.category,this.originalLink=t.adornedPart}this.xa(this.name),a.isMouseCaptured=!0,a.currentCursor=this.linkingCursor,this.originalFromPort=this.originalLink.fromPort,this.originalFromNode=this.originalLink.fromNode,this.originalToPort=this.originalLink.toPort,this.originalToNode=this.originalLink.toNode,this.Ix.set(this.originalLink.actualBounds),null!==this.originalLink&&0<this.originalLink.pointsCount&&(null===this.originalLink.fromNode&&(null!==this.temporaryFromPort&&(this.temporaryFromPort.desiredSize=Rt),null!==this.temporaryFromNode&&(this.temporaryFromNode.location=this.originalLink.i(0))),null===this.originalLink.toNode&&(null!==this.temporaryToPort&&(this.temporaryToPort.desiredSize=Rt),null!==this.temporaryToNode&&(this.temporaryToNode.location=this.originalLink.i(this.originalLink.pointsCount-1)))),this.copyPortProperties(this.originalFromNode,this.originalFromPort,this.temporaryFromNode,this.temporaryFromPort,!1),this.copyPortProperties(this.originalToNode,this.originalToPort,this.temporaryToNode,this.temporaryToPort,!0),a.add(this.temporaryFromNode),a.add(this.temporaryToNode),null!==this.temporaryLink&&(null!==this.temporaryFromNode&&(this.temporaryLink.fromNode=this.temporaryFromNode),null!==this.temporaryToNode&&(this.temporaryLink.toNode=this.temporaryToNode),this.copyLinkProperties(this.originalLink,this.temporaryLink),this.temporaryLink.Ua(),a.add(this.temporaryLink)),this.isActive=!0},Nn.prototype.copyLinkProperties=function(a,b){if(null!==a&&null!==b){b.adjusting=a.adjusting,b.corner=a.corner;var t=a.curve;t!==zc&&t!==Ec||(t=Ic),b.curve=t,b.curviness=a.curviness,b.isTreeLink=a.isTreeLink,b.points=a.points,b.routing=a.routing,b.smoothness=a.smoothness,b.fromSpot=a.fromSpot,b.fromEndSegmentLength=a.fromEndSegmentLength,b.fromShortLength=a.fromShortLength,b.toSpot=a.toSpot,b.toEndSegmentLength=a.toEndSegmentLength,b.toShortLength=a.toShortLength}},Nn.prototype.doDeactivate=function(){this.isActive=!1;var a=this.diagram;a.remove(this.temporaryLink),a.remove(this.temporaryFromNode),a.remove(this.temporaryToNode),a.isMouseCaptured=!1,a.currentCursor="",this.Kg()},Nn.prototype.doStop=function(){mn.prototype.doStop.call(this),this.handle=null},Nn.prototype.doMouseUp=function(){if(this.isActive){var a=this.diagram;this.transactionResult=null;var b=this.originalFromNode,t=this.originalFromPort,e=this.originalToNode,n=this.originalToPort,o=this.originalLink;if(this.targetPort=this.findTargetPort(this.isForwards),null!==this.targetPort){var g=this.targetPort.part;g instanceof zu&&(this.isForwards?(e=g,n=this.targetPort):(b=g,t=this.targetPort))}else this.isUnconnectedLinkValid?this.isForwards?n=e=null:t=b=null:o=null;null!==o?(this.reconnectLink(o,this.isForwards?e:b,this.isForwards?n:t,this.isForwards),null===this.targetPort&&(this.isForwards?o.defaultToPoint=a.lastInput.documentPoint:o.defaultFromPoint=a.lastInput.documentPoint,o.Ua()),a.allowSelect&&(o.isSelected=!0),this.transactionResult=this.name,a.R("LinkRelinked",o,this.isForwards?this.originalToPort:this.originalFromPort)):this.doNoRelink(this.originalLink,this.isForwards),this.originalLink.Lq(this.Ix)}this.stopTool()},Nn.prototype.reconnectLink=function(a,b,t,e){return t=null!==t&&null!==t.portId?t.portId:"",e?(a.toNode=b,a.toPortId=t):(a.fromNode=b,a.fromPortId=t),!0},Nn.prototype.doNoRelink=function(){},v.Object.defineProperties(Nn.prototype,{fromHandleArchetype:{get:function(){return this.T},set:function(a){this.T=a}},toHandleArchetype:{get:function(){return this.bn},set:function(a){this.bn=a}},handle:{get:function(){return this.I},set:function(a){if(null!==a&&!(a.part instanceof Eu))throw Error("new handle is not in an Adornment: "+a);this.I=a}}}),Nn.className="RelinkingTool",G("linkingTool",(function(){return this.findTool("Linking")}),(function(a){this.Xa("Linking",a,this.mouseMoveTools)})),G("relinkingTool",(function(){return this.findTool("Relinking")}),(function(a){this.Xa("Relinking",a,this.mouseDownTools)})),m(Tn,Ve),Tn.prototype.Xv=function(a){return a&&a.Ps&&0!==a.Ps.value?a.Ps:An},Tn.prototype.Vm=function(a,b){a.Ps=b},Tn.prototype.updateAdornments=function(a){if(null!==a&&a instanceof uc){var b=null;if(a.isSelected&&!this.diagram.isReadOnly){var t=a.path;null!==t&&a.canReshape()&&a.actualBounds.u()&&a.isVisible()&&t.actualBounds.u()&&t.If()&&(null===(b=a.uk(this.name))||b.Fx!==a.pointsCount||b.Tx!==a.resegmentable)&&(null!==(b=this.makeAdornment(t))&&(b.Fx=a.pointsCount,b.Tx=a.resegmentable,a.Fh(this.name,b)))}null===b&&a.Jf(this.name)}},Tn.prototype.makeAdornment=function(a){var b=a.part,t=b.pointsCount,e=b.isOrthogonal,n=null;if(null!==b.points&&1<t){(n=new Eu).type=Fh.Link,t=b.firstPickIndex;var o=b.lastPickIndex,g=e?1:0;if(b.resegmentable&&b.computeCurve()!==Rc)for(var r=t+g;r<o-g;r++){var h=this.makeResegmentHandle(a,r);null!==h&&(h.segmentIndex=r,h.segmentFraction=.5,h.fromMaxLinks=999,n.add(h))}for(g=t+1;g<o;g++)if(null!==(r=this.makeHandle(a,g))){if(r.segmentIndex=g,g!==t)if(g===t+1&&e){h=b.i(t);var l=b.i(t+1);oe.A(h.x,l.x)&&oe.A(h.y,l.y)&&(l=b.i(t-1)),oe.A(h.x,l.x)?(this.Vm(r,Dn),r.cursor="n-resize"):oe.A(h.y,l.y)&&(this.Vm(r,jn),r.cursor="w-resize")}else g===o-1&&e?(h=b.i(o-1),l=b.i(o),oe.A(h.x,l.x)&&oe.A(h.y,l.y)&&(h=b.i(o+1)),oe.A(h.x,l.x)?(this.Vm(r,Dn),r.cursor="n-resize"):oe.A(h.y,l.y)&&(this.Vm(r,jn),r.cursor="w-resize")):g!==o&&(this.Vm(r,On),r.cursor="move");n.add(r)}n.adornedObject=a}return n},Tn.prototype.makeHandle=function(){var a=this.handleArchetype;return null===a?null:a.copy()},Tn.prototype.makeResegmentHandle=function(){var a=this.midHandleArchetype;return null===a?null:a.copy()},Tn.prototype.canStart=function(){if(!this.isEnabled)return!1;var a=this.diagram;return!(a.isReadOnly||!a.allowReshape||!a.lastInput.left)&&null!==this.findToolHandleAt(a.firstInput.documentPoint,this.name)},Tn.prototype.doActivate=function(){var a=this.diagram;if(null===this.handle&&(this.handle=this.findToolHandleAt(a.firstInput.documentPoint,this.name)),null!==this.handle){var b=this.handle.part.adornedPart;if(b instanceof uc){if(this.tu=b,a.isMouseCaptured=!0,this.xa(this.name),b.resegmentable&&999===this.handle.fromMaxLinks){var t=b.points.copy(),e=this.getResegmentingPoint();if(t.wb(this.handle.segmentIndex+1,e),b.isOrthogonal&&t.wb(this.handle.segmentIndex+1,e),b.points=t,b.Mb(),b.updateAdornments(),this.handle=this.findToolHandleAt(a.firstInput.documentPoint,this.name),null===this.handle)return void this.doDeactivate()}this.Jx=b.i(this.handle.segmentIndex),this.Is=b.points.copy(),this.isActive=!0}}},Tn.prototype.doDeactivate=function(){this.Kg(),this.tu=this.handle=null,this.isActive=this.diagram.isMouseCaptured=!1},Tn.prototype.doCancel=function(){var a=this.adornedLink;null!==a&&(a.points=this.Is),this.stopTool()},Tn.prototype.getResegmentingPoint=function(){return this.handle.da(bi)},Tn.prototype.doMouseMove=function(){var a=this.diagram;this.isActive&&(a=this.computeReshape(a.lastInput.documentPoint),this.reshape(a))},Tn.prototype.doMouseUp=function(){var a=this.diagram;if(this.isActive){var b=this.computeReshape(a.lastInput.documentPoint);if(this.reshape(b),null!==(b=this.adornedLink)&&b.resegmentable){var t=this.handle.segmentIndex,e=b.i(t-1),n=b.i(t),o=b.i(t+1);if(b.isOrthogonal){if(t>b.firstPickIndex+1&&t<b.lastPickIndex-1){var g=b.i(t-2);if(Math.abs(e.x-n.x)<this.resegmentingDistance&&Math.abs(e.y-n.y)<this.resegmentingDistance&&(Ln(this,g,e,n,o,!0)||Ln(this,g,e,n,o,!1))){var r=b.points.copy();Ln(this,g,e,n,o,!0)?(r.Qc(t-2,new St(g.x,(o.y+g.y)/2)),r.Qc(t+1,new St(o.x,(o.y+g.y)/2))):(r.Qc(t-2,new St((o.x+g.x)/2,g.y)),r.Qc(t+1,new St((o.x+g.x)/2,o.y))),r.cb(t),r.cb(t-1),b.points=r,b.Mb()}else g=b.i(t+2),Math.abs(n.x-o.x)<this.resegmentingDistance&&Math.abs(n.y-o.y)<this.resegmentingDistance&&(Ln(this,e,n,o,g,!0)||Ln(this,e,n,o,g,!1))&&(r=b.points.copy(),Ln(this,e,n,o,g,!0)?(r.Qc(t-1,new St(e.x,(e.y+g.y)/2)),r.Qc(t+2,new St(g.x,(e.y+g.y)/2))):(r.Qc(t-1,new St((e.x+g.x)/2,e.y)),r.Qc(t+2,new St((e.x+g.x)/2,g.y))),r.cb(t+1),r.cb(t),b.points=r,b.Mb())}}else g=St.alloc(),oe.Ph(e.x,e.y,o.x,o.y,n.x,n.y,g)&&g.Ge(n)<this.resegmentingDistance*this.resegmentingDistance&&((e=b.points.copy()).cb(t),b.points=e,b.Mb()),St.free(g)}a.Oa(),this.transactionResult=this.name,a.R("LinkReshaped",this.adornedLink,this.Is)}this.stopTool()},Tn.prototype.reshape=function(a){var b=this.adornedLink;b.Sh();var t=this.handle.segmentIndex,e=this.Xv(this.handle);if(b.isOrthogonal)if(t===b.firstPickIndex+1)t=b.firstPickIndex+1,e===Dn?(b.L(t,b.i(t-1).x,a.y),b.L(t+1,b.i(t+2).x,a.y)):e===jn&&(b.L(t,a.x,b.i(t-1).y),b.L(t+1,a.x,b.i(t+2).y));else if(t===b.lastPickIndex-1)t=b.lastPickIndex-1,e===Dn?(b.L(t-1,b.i(t-2).x,a.y),b.L(t,b.i(t+1).x,a.y)):e===jn&&(b.L(t-1,a.x,b.i(t-2).y),b.L(t,a.x,b.i(t+1).y));else{e=t;var n=b.i(e),o=b.i(e-1),g=b.i(e+1);oe.A(o.x,n.x)&&oe.A(n.y,g.y)?(oe.A(o.x,b.i(e-2).x)&&!oe.A(o.y,b.i(e-2).y)?(b.m(e,a.x,o.y),t++,e++):b.L(e-1,a.x,o.y),oe.A(g.y,b.i(e+2).y)&&!oe.A(g.x,b.i(e+2).x)?b.m(e+1,g.x,a.y):b.L(e+1,g.x,a.y)):oe.A(o.y,n.y)&&oe.A(n.x,g.x)?(oe.A(o.y,b.i(e-2).y)&&!oe.A(o.x,b.i(e-2).x)?(b.m(e,o.x,a.y),t++,e++):b.L(e-1,o.x,a.y),oe.A(g.x,b.i(e+2).x)&&!oe.A(g.y,b.i(e+2).y)?b.m(e+1,a.x,g.y):b.L(e+1,a.x,g.y)):oe.A(o.x,n.x)&&oe.A(n.x,g.x)?(oe.A(o.x,b.i(e-2).x)&&!oe.A(o.y,b.i(e-2).y)?(b.m(e,a.x,o.y),t++,e++):b.L(e-1,a.x,o.y),oe.A(g.x,b.i(e+2).x)&&!oe.A(g.y,b.i(e+2).y)?b.m(e+1,a.x,g.y):b.L(e+1,a.x,g.y)):oe.A(o.y,n.y)&&oe.A(n.y,g.y)&&(oe.A(o.y,b.i(e-2).y)&&!oe.A(o.x,b.i(e-2).x)?(b.m(e,o.x,a.y),t++,e++):b.L(e-1,o.x,a.y),oe.A(g.y,b.i(e+2).y)&&!oe.A(g.x,b.i(e+2).x)?b.m(e+1,g.x,a.y):b.L(e+1,g.x,a.y)),b.L(t,a.x,a.y)}else b.L(t,a.x,a.y),e=b.fromNode,n=b.fromPort,null!==e&&(null!==(o=e.findVisibleNode())&&o!==e&&(n=(e=o).port)),1===t&&b.computeSpot(!0,n).nc()&&(o=n.da(bi,St.alloc()),e=b.getLinkPointFromPoint(e,n,o,a,!0,St.alloc()),b.L(0,e.x,e.y),St.free(o),St.free(e)),e=b.toNode,n=b.toPort,null!==e&&(null!==(o=e.findVisibleNode())&&o!==e&&(n=(e=o).port)),t===b.pointsCount-2&&b.computeSpot(!1,n).nc()&&(t=n.da(bi,St.alloc()),a=b.getLinkPointFromPoint(e,n,t,a,!1,St.alloc()),b.L(b.pointsCount-1,a.x,a.y),St.free(t),St.free(a));b.zf()},Tn.prototype.computeReshape=function(a){var b=this.adornedLink,t=this.handle.segmentIndex;switch(this.Xv(this.handle)){case On:return a;case Dn:return new St(b.i(t).x,a.y);case jn:return new St(a.x,b.i(t).y);default:case An:return b.i(t)}},v.Object.defineProperties(Tn.prototype,{handleArchetype:{get:function(){return this.v},set:function(a){this.v=a}},midHandleArchetype:{get:function(){return this.I},set:function(a){this.I=a}},handle:{get:function(){return this.l},set:function(a){if(null!==a&&!(a.part instanceof Eu))throw Error("new handle is not in an Adornment: "+a);this.l=a}},adornedLink:{get:function(){return this.tu}},resegmentingDistance:{get:function(){return this.T},set:function(a){this.T=a}},originalPoint:{get:function(){return this.Jx}},originalPoints:{get:function(){return this.Is}}}),Tn.prototype.setReshapingBehavior=Tn.prototype.Vm,Tn.prototype.getReshapingBehavior=Tn.prototype.Xv;var An=new _(Tn,"None",0),jn=new _(Tn,"Horizontal",1),Dn=new _(Tn,"Vertical",2),On=new _(Tn,"All",3);function Fn(){Ve.call(this),this.name="Resizing",this.hg=new Ut(1,1).freeze(),this.gg=new Ut(9999,9999).freeze(),this.Rg=new Ut(NaN,NaN).freeze(),this.I=!1,this.T=!0,this.ge=null;var a=new pl;a.alignmentFocus=bi,a.figure="Rectangle",a.desiredSize=zt,a.fill="lightblue",a.stroke="dodgerblue",a.strokeWidth=1,a.cursor="pointer",this.v=a,this.l=null,this.Hs=new St,this.Hx=new Ut,this.kp=new St,this.Ku=new Ut(0,0),this.Ju=new Ut(1/0,1/0),this.Iu=new Ut(1,1),this.Ex=!0}function Bn(){Ve.call(this),this.name="Rotating",this.Ka=45,this.Ja=2,this.kp=new St,this.ge=null;var a=new pl;a.figure="Ellipse",a.desiredSize=Vt,a.fill="lightblue",a.stroke="dodgerblue",a.strokeWidth=1,a.cursor="pointer",this.v=a,this.l=null,this.Gx=0,this.kv=new St(NaN,NaN),this.I=0,this.T=50}function In(){Ve.call(this),this.name="ClickSelecting"}function Rn(){Ve.call(this),this.name="Action",this.Uk=null}function En(){Ve.call(this),this.name="ClickCreating",this.yj=null,this.v=!0,this.l=!1,this.xx=new St(0,0)}function zn(){Ve.call(this),this.name="DragSelecting",this.nl=175,this.v=!1;var a=new yu;a.layerName="Tool",a.selectable=!1;var b=new pl;b.name="SHAPE",b.figure="Rectangle",b.fill=null,b.stroke="magenta",a.add(b),this.l=a}function Vn(){Ve.call(this),this.name="Panning",this.hv=new St,this.lz=new St,this.Qg=!1;var a=this;this.Mx=function(){var b=a.diagram;null!==b&&b.removeEventListener(w.document,"scroll",a.Mx,!1),a.stopTool()}}function Gn(){this.T=this.I=this.l=this.v=null}function Yn(a,b,t){this.text=a,this.gy=b,this.visible=t}function Xn(){Ve.call(this),this.name="ContextMenu",this.v=this.zu=this.l=null,this.Cx=new St,this.Au=null,this.Vu=!1;var a=this;this.uv=function(){a.stopTool()}}function qn(a){return a.preventDefault(),!1}function Un(a){var b=a.diagram;if(a.isActive){var t=a.currentContextMenu;if(null!==t){if(!(t instanceof Gn)){var e=b.Vb(b.lastInput.documentPoint,null,null);null!==e&&e.Hg(t)&&a.standardMouseClick(null,null)}a.stopTool(),a.canStart()&&(b.currentTool=a,a.doMouseUp())}}else a.canStart()&&(Kn(a,!0),a.isActive||a.stopTool())}function Kn(a,b,t){if(void 0===t&&(t=null),!a.Vu&&(a.Vu=!0,b&&a.standardMouseSelect(),b=a.standardMouseClick(),a.Vu=!1,!b)){if(a.isActive=!0,b=Hn,null===t&&(t=a.findObjectWithContextMenu()),null!==t){var e=t.contextMenu;null!==e?(a.currentObject=t instanceof ea?t:null,a.showContextMenu(e,a.currentObject)):null!==b&&a.showContextMenu(b,a.currentObject)}else null!==b&&a.showContextMenu(b,null);a.currentContextMenu instanceof Eu&&!a.currentContextMenu.visible&&a.stopTool()}}Tn.className="LinkReshapingTool",Tn.None=An,Tn.Horizontal=jn,Tn.Vertical=Dn,Tn.All=On,G("linkReshapingTool",(function(){return this.findTool("LinkReshaping")}),(function(a){this.Xa("LinkReshaping",a,this.mouseDownTools)})),m(Fn,Ve),Fn.prototype.updateAdornments=function(a){if(!(null===a||a instanceof uc)){if(a.isSelected&&!this.diagram.isReadOnly){var b=a.resizeObject,t=a.uk(this.name);if(null!==b&&a.canResize()&&a.actualBounds.u()&&a.isVisible()&&b.actualBounds.u()&&b.If()&&(null!==t&&t.adornedObject===b||(t=this.makeAdornment(b)),null!==t))return b=b.kj(),Au(a)&&this.updateResizeHandles(t,b),void a.Fh(this.name,t)}a.Jf(this.name)}},Fn.prototype.makeAdornment=function(a){var b=a.part.resizeAdornmentTemplate;if(null===b){(b=new Eu).type=Fh.Spot,b.locationSpot=bi;var t=new lc;t.isPanelMain=!0,b.add(t),b.add(this.makeHandle(a,yi)),b.add(this.makeHandle(a,vi)),b.add(this.makeHandle(a,Si)),b.add(this.makeHandle(a,ki)),b.add(this.makeHandle(a,dd)),b.add(this.makeHandle(a,Ki)),b.add(this.makeHandle(a,Hi)),b.add(this.makeHandle(a,Ui))}else if($h(b),null===(b=b.copy()))return null;return b.adornedObject=a,b},Fn.prototype.makeHandle=function(a,b){return null===(a=this.handleArchetype)?null:((a=a.copy()).alignment=b,a)},Fn.prototype.updateResizeHandles=function(a,b){if(null!==a)if(!a.alignment.Nb()&&("pointer"===a.cursor||0<a.cursor.indexOf("resize")))t:{var t=a.alignment;if(t.nc()&&(t=bi),0>=t.x)b=0>=t.y?b+225:1<=t.y?b+135:b+180;else if(1<=t.x)0>=t.y?b+=315:1<=t.y&&(b+=45);else if(0>=t.y)b+=270;else{if(!(1<=t.y))break t;b+=90}0>b?b+=360:360<=b&&(b-=360),a.cursor=22.5>b?"e-resize":67.5>b?"se-resize":112.5>b?"s-resize":157.5>b?"sw-resize":202.5>b?"w-resize":247.5>b?"nw-resize":292.5>b?"n-resize":337.5>b?"ne-resize":"e-resize"}else if(a instanceof Fh)for(a=a.elements;a.next();)this.updateResizeHandles(a.value,b)},Fn.prototype.canStart=function(){if(!this.isEnabled)return!1;var a=this.diagram;return!(a.isReadOnly||!a.allowResize||!a.lastInput.left)&&null!==this.findToolHandleAt(a.firstInput.documentPoint,this.name)},Fn.prototype.doActivate=function(){var a=this.diagram;null===this.handle&&(this.handle=this.findToolHandleAt(a.firstInput.documentPoint,this.name)),null!==this.handle&&(this.adornedObject=this.handle.part.adornedObject,null!==this.adornedObject&&(a.isMouseCaptured=!0,this.Ex=a.animationManager.isEnabled,a.animationManager.isEnabled=!1,this.xa(this.name),this.Hs.set(this.adornedObject.da(this.handle.alignment.kw())),this.kp.set(this.adornedObject.part.location),this.Hx.set(this.adornedObject.desiredSize),this.Iu=this.computeCellSize(),this.Ku=this.computeMinSize(),this.Ju=this.computeMaxSize(),this.isActive=!0))},Fn.prototype.doDeactivate=function(){var a=this.diagram;this.Kg(),this.ge=this.handle=null,this.isActive=a.isMouseCaptured=!1,a.animationManager.isEnabled=this.Ex},Fn.prototype.doCancel=function(){null!==this.adornedObject&&(this.adornedObject.desiredSize=this.originalDesiredSize,this.adornedObject.part.location=this.originalLocation),this.stopTool()},Fn.prototype.doMouseMove=function(){var a=this.diagram;if(this.isActive){var b=this.Ku,t=this.Ju,e=this.Iu,n=this.adornedObject.Lt(a.lastInput.documentPoint,St.alloc()),o=this.computeReshape();b=this.computeResize(n,this.handle.alignment,b,t,e,o),this.resize(b),a.jd(),St.free(n)}},Fn.prototype.doMouseUp=function(){var a=this.diagram;if(this.isActive){var b=this.Ku,t=this.Ju,e=this.Iu,n=this.adornedObject.Lt(a.lastInput.documentPoint,St.alloc()),o=this.computeReshape();b=this.computeResize(n,this.handle.alignment,b,t,e,o),this.resize(b),St.free(n),a.Oa(),this.transactionResult=this.name,a.R("PartResized",this.adornedObject,this.originalDesiredSize)}this.stopTool()},Fn.prototype.resize=function(a){var b=this.diagram,t=this.adornedObject;if(null!==t){if(t.desiredSize=a.size,(a=t.part).Ta(),t=t.da(this.handle.alignment.kw()),a instanceof oc){var e=new ut;if(e.add(a),!this.dragsMembers&&null===a.placeholder){var n=new Ks;n.dragsMembers=!1}b.moveParts(e,this.oppositePoint.copy().ee(t),!0,n)}else a.location=a.location.copy().ee(t).add(this.oppositePoint);b.jd()}},Fn.prototype.computeResize=function(a,b,t,e,n,o){b.nc()&&(b=bi);var g=this.adornedObject.naturalBounds,r=g.x,h=g.y,l=g.x+g.width,c=g.y+g.height,f=1;if(!o){f=g.width;var p=g.height;0>=f&&(f=1),0>=p&&(p=1),f=p/f}return p=St.alloc(),oe.Cq(a.x,a.y,r,h,n.width,n.height,p),a=g.copy(),0>=b.x?0>=b.y?(a.x=Math.max(p.x,l-e.width),a.x=Math.min(a.x,l-t.width),a.width=Math.max(l-a.x,t.width),a.y=Math.max(p.y,c-e.height),a.y=Math.min(a.y,c-t.height),a.height=Math.max(c-a.y,t.height),o||(1<=a.height/a.width?(a.height=Math.max(Math.min(f*a.width,e.height),t.height),a.width=a.height/f):(a.width=Math.max(Math.min(a.height/f,e.width),t.width),a.height=f*a.width),a.x=l-a.width,a.y=c-a.height)):1<=b.y?(a.x=Math.max(p.x,l-e.width),a.x=Math.min(a.x,l-t.width),a.width=Math.max(l-a.x,t.width),a.height=Math.max(Math.min(p.y-h,e.height),t.height),o||(1<=a.height/a.width?(a.height=Math.max(Math.min(f*a.width,e.height),t.height),a.width=a.height/f):(a.width=Math.max(Math.min(a.height/f,e.width),t.width),a.height=f*a.width),a.x=l-a.width)):(a.x=Math.max(p.x,l-e.width),a.x=Math.min(a.x,l-t.width),a.width=l-a.x,o||(a.height=Math.max(Math.min(f*a.width,e.height),t.height),a.width=a.height/f,a.y=h+.5*(c-h-a.height))):1<=b.x?0>=b.y?(a.width=Math.max(Math.min(p.x-r,e.width),t.width),a.y=Math.max(p.y,c-e.height),a.y=Math.min(a.y,c-t.height),a.height=Math.max(c-a.y,t.height),o||(1<=a.height/a.width?(a.height=Math.max(Math.min(f*a.width,e.height),t.height),a.width=a.height/f):(a.width=Math.max(Math.min(a.height/f,e.width),t.width),a.height=f*a.width),a.y=c-a.height)):1<=b.y?(a.width=Math.max(Math.min(p.x-r,e.width),t.width),a.height=Math.max(Math.min(p.y-h,e.height),t.height),o||(1<=a.height/a.width?(a.height=Math.max(Math.min(f*a.width,e.height),t.height),a.width=a.height/f):(a.width=Math.max(Math.min(a.height/f,e.width),t.width),a.height=f*a.width))):(a.width=Math.max(Math.min(p.x-r,e.width),t.width),o||(a.height=Math.max(Math.min(f*a.width,e.height),t.height),a.width=a.height/f,a.y=h+.5*(c-h-a.height))):0>=b.y?(a.y=Math.max(p.y,c-e.height),a.y=Math.min(a.y,c-t.height),a.height=c-a.y,o||(a.width=Math.max(Math.min(a.height/f,e.width),t.width),a.height=f*a.width,a.x=r+.5*(l-r-a.width))):1<=b.y&&(a.height=Math.max(Math.min(p.y-h,e.height),t.height),o||(a.width=Math.max(Math.min(a.height/f,e.width),t.width),a.height=f*a.width,a.x=r+.5*(l-r-a.width))),St.free(p),a},Fn.prototype.computeReshape=function(){var a=Is;return this.adornedObject instanceof pl&&(a=yl(this.adornedObject)),!(a===Rs||this.diagram.lastInput.shift)},Fn.prototype.computeMinSize=function(){var a=this.adornedObject.minSize.copy(),b=this.minSize;return!isNaN(b.width)&&b.width>a.width&&(a.width=b.width),!isNaN(b.height)&&b.height>a.height&&(a.height=b.height),a},Fn.prototype.computeMaxSize=function(){var a=this.adornedObject.maxSize.copy(),b=this.maxSize;return!isNaN(b.width)&&b.width<a.width&&(a.width=b.width),!isNaN(b.height)&&b.height<a.height&&(a.height=b.height),a},Fn.prototype.computeCellSize=function(){var a=new Ut(NaN,NaN),b=this.adornedObject.part;return null!==b&&(b=b.resizeCellSize,!isNaN(b.width)&&0<b.width&&(a.width=b.width),!isNaN(b.height)&&0<b.height&&(a.height=b.height)),b=this.cellSize,isNaN(a.width)&&!isNaN(b.width)&&0<b.width&&(a.width=b.width),isNaN(a.height)&&!isNaN(b.height)&&0<b.height&&(a.height=b.height),b=this.diagram,(isNaN(a.width)||isNaN(a.height))&&b&&(null!==(b=b.grid)&&b.visible&&this.isGridSnapEnabled&&(b=b.gridCellSize,isNaN(a.width)&&!isNaN(b.width)&&0<b.width&&(a.width=b.width),isNaN(a.height)&&!isNaN(b.height)&&0<b.height&&(a.height=b.height))),(isNaN(a.width)||0===a.width||1/0===a.width)&&(a.width=1),(isNaN(a.height)||0===a.height||1/0===a.height)&&(a.height=1),a},v.Object.defineProperties(Fn.prototype,{handleArchetype:{get:function(){return this.v},set:function(a){this.v=a}},handle:{get:function(){return this.l},set:function(a){if(null!==a&&!(a.part instanceof Eu))throw Error("new handle is not in an Adornment: "+a);this.l=a}},adornedObject:{get:function(){return this.ge},set:function(a){if(null!==a&&a.part instanceof Eu)throw Error("new handle must not be in an Adornment: "+a);this.ge=a}},minSize:{get:function(){return this.hg},set:function(a){if(!this.hg.w(a)){var b=a.width;isNaN(b)&&(b=0),a=a.height,isNaN(a)&&(a=0),this.hg.h(b,a)}}},maxSize:{get:function(){return this.gg},set:function(a){if(!this.gg.w(a)){var b=a.width;isNaN(b)&&(b=1/0),a=a.height,isNaN(a)&&(a=1/0),this.gg.h(b,a)}}},cellSize:{get:function(){return this.Rg},set:function(a){this.Rg.w(a)||this.Rg.assign(a)}},isGridSnapEnabled:{get:function(){return this.I},set:function(a){this.I=a}},dragsMembers:{get:function(){return this.T},set:function(a){this.T=a}},oppositePoint:{get:function(){return this.Hs},set:function(a){this.Hs.w(a)||this.Hs.assign(a)}},originalDesiredSize:{get:function(){return this.Hx}},originalLocation:{get:function(){return this.kp}}}),Fn.className="ResizingTool",G("resizingTool",(function(){return this.findTool("Resizing")}),(function(a){this.Xa("Resizing",a,this.mouseDownTools)})),m(Bn,Ve),Bn.prototype.updateAdornments=function(a){if(null!==a){if(a.Oh()){var b=a.rotateObject;if(b===a||b===a.path||b.isPanelMain)return}if(a.isSelected&&!this.diagram.isReadOnly&&(null!==(b=a.rotateObject)&&a.canRotate()&&a.actualBounds.u()&&a.isVisible()&&b.actualBounds.u()&&b.If())){var t=a.uk(this.name);if(null!==t&&t.adornedObject===b||(t=this.makeAdornment(b)),null!==t)return t.angle=b.kj(),null===t.placeholder&&(t.location=this.computeAdornmentLocation(b)),void a.Fh(this.name,t)}a.Jf(this.name)}},Bn.prototype.makeAdornment=function(a){var b=a.part.rotateAdornmentTemplate;if(null===b){(b=new Eu).type=Fh.Position,b.locationSpot=bi;var t=this.handleArchetype;null!==t&&b.add(t.copy())}else if($h(b),null===(b=b.copy()))return null;return b.adornedObject=a,b},Bn.prototype.canStart=function(){if(!this.isEnabled)return!1;var a=this.diagram;return!(a.isReadOnly||!a.allowRotate||!a.lastInput.left)&&null!==this.findToolHandleAt(a.firstInput.documentPoint,this.name)},Bn.prototype.doActivate=function(){var a=this.diagram;if(null===this.adornedObject){if(null===this.handle&&(this.handle=this.findToolHandleAt(a.firstInput.documentPoint,this.name)),null===this.handle)return;this.adornedObject=this.handle.part.adornedObject}null!==this.adornedObject&&(a.isMouseCaptured=!0,a.delaysLayout=!0,this.xa(this.name),this.Gx=this.adornedObject.angle,this.kv=this.computeRotationPoint(this.adornedObject),this.kp=this.adornedObject.part.location.copy(),this.isActive=!0)},Bn.prototype.computeRotationPoint=function(a){var b=a.part,t=b.locationObject;return b.rotationSpot.kb()?a.da(b.rotationSpot):a===b||a===t?t.da(b.locationSpot):a.da(bi)},Bn.prototype.computeAdornmentLocation=function(a){var b=this.rotationPoint;b.u()||(b=this.computeRotationPoint(a)),b=a.Lt(b);var t=this.handleAngle;0>t?t+=360:360<=t&&(t-=360),t=Math.round(45*Math.round(t/45));var e=this.handleDistance;return 0===t?b.x=a.naturalBounds.width+e:45===t?(b.x=a.naturalBounds.width+e,b.y=a.naturalBounds.height+e):90===t?b.y=a.naturalBounds.height+e:135===t?(b.x=-e,b.y=a.naturalBounds.height+e):180===t?b.x=-e:225===t?(b.x=-e,b.y=-e):270===t?b.y=-e:315===t&&(b.x=a.naturalBounds.width+e,b.y=-e),a.da(b)},Bn.prototype.doDeactivate=function(){var a=this.diagram;this.Kg(),this.ge=this.handle=null,this.kv=new St(NaN,NaN),this.isActive=a.isMouseCaptured=!1},Bn.prototype.doCancel=function(){this.diagram.delaysLayout=!1,this.rotate(this.originalAngle),this.stopTool()},Bn.prototype.doMouseMove=function(){var a=this.diagram;this.isActive&&(a=this.computeRotate(a.lastInput.documentPoint),this.rotate(a))},Bn.prototype.doMouseUp=function(){var a=this.diagram;if(this.isActive){a.delaysLayout=!1;var b=this.computeRotate(a.lastInput.documentPoint);this.rotate(b),a.Oa(),this.transactionResult=this.name,a.R("PartRotated",this.adornedObject,this.originalAngle)}this.stopTool()},Bn.prototype.rotate=function(a){var b=this.adornedObject;if(null!==b){b.angle=a,(b=b.part).Ta();var t=b.locationObject,e=b.rotateObject;(t===e||t.Hg(e))&&(t=this.kp.copy(),b.location=t.ee(this.rotationPoint).rotate(a-this.originalAngle).add(this.rotationPoint)),this.diagram.jd()}},Bn.prototype.computeRotate=function(a){a=this.rotationPoint.Sa(a)-this.handleAngle;var b=this.adornedObject.panel;null!==b&&(a-=b.kj()),360<=a?a-=360:0>a&&(a+=360),b=Math.min(Math.abs(this.snapAngleMultiple),180);var t=Math.min(Math.abs(this.snapAngleEpsilon),b/2);return!this.diagram.lastInput.shift&&0<b&&0<t&&(a%b<t?a=Math.floor(a/b)*b:a%b>b-t&&(a=(Math.floor(a/b)+1)*b)),360<=a?a-=360:0>a&&(a+=360),a},v.Object.defineProperties(Bn.prototype,{handleArchetype:{get:function(){return this.v},set:function(a){this.v=a}},handle:{get:function(){return this.l},set:function(a){if(null!==a&&!(a.part instanceof Eu))throw Error("new handle is not in an Adornment: "+a);this.l=a}},adornedObject:{get:function(){return this.ge},set:function(a){if(null!==a&&a.part instanceof Eu)throw Error("new handle must not be in an Adornment: "+a);this.ge=a}},snapAngleMultiple:{get:function(){return this.Ka},set:function(a){this.Ka=a}},snapAngleEpsilon:{get:function(){return this.Ja},set:function(a){this.Ja=a}},originalAngle:{get:function(){return this.Gx}},rotationPoint:{get:function(){return this.kv}},handleAngle:{get:function(){return this.I},set:function(a){this.I=a}},handleDistance:{get:function(){return this.T},set:function(a){this.T=a}}}),Bn.className="RotatingTool",G("rotatingTool",(function(){return this.findTool("Rotating")}),(function(a){this.Xa("Rotating",a,this.mouseDownTools)})),m(In,Ve),In.prototype.canStart=function(){return!(!this.isEnabled||this.isBeyondDragSize())},In.prototype.doMouseUp=function(){this.isActive&&(this.standardMouseSelect(),!this.standardMouseClick()&&this.diagram.lastInput.isTouchEvent&&this.diagram.toolManager.doToolTip()),this.stopTool()},In.className="ClickSelectingTool",m(Rn,Ve),Rn.prototype.canStart=function(){if(!this.isEnabled)return!1;var a=this.diagram,b=a.lastInput,t=a.Vb(b.documentPoint,(function(a){for(;null!==a.panel&&!a.isActionable;)a=a.panel;return a}));return null!==t&&(!!t.isActionable&&(this.Uk=t,a.Cj=a.Vb(b.documentPoint,null,null),!0))},Rn.prototype.doMouseDown=function(){if(this.isActive){var a=this.diagram.lastInput,b=this.Uk;null!==b&&(a.targetObject=b,null!==b.actionDown&&b.actionDown(a,b))}else this.canStart()&&this.doActivate()},Rn.prototype.doMouseMove=function(){if(this.isActive){var a=this.diagram.lastInput,b=this.Uk;null!==b&&(a.targetObject=b,null!==b.actionMove&&b.actionMove(a,b))}},Rn.prototype.doMouseUp=function(){if(this.isActive){var a=this.diagram.lastInput,b=this.Uk;if(null===b)return;a.targetObject=b,null!==b.actionUp&&b.actionUp(a,b),this.standardMouseClick((function(a){for(;null!==a.panel&&(!a.isActionable||a!==b);)a=a.panel;return a}),(function(a){return a===b}))}this.stopTool()},Rn.prototype.doCancel=function(){var a=this.diagram.lastInput,b=this.Uk;null!==b&&(a.targetObject=b,null!==b.actionCancel&&b.actionCancel(a,b),this.stopTool())},Rn.prototype.doStop=function(){this.Uk=null},Rn.className="ActionTool",m(En,Ve),En.prototype.canStart=function(){if(!this.isEnabled||null===this.archetypeNodeData)return!1;var a=this.diagram;if(a.isReadOnly||a.isModelReadOnly||!a.allowInsert||!a.lastInput.left||this.isBeyondDragSize())return!1;if(this.isDoubleClick){if(1===a.lastInput.clickCount&&(this.xx=a.lastInput.viewPoint.copy()),2!==a.lastInput.clickCount||this.isBeyondDragSize(this.xx))return!1}else if(1!==a.lastInput.clickCount)return!1;return a.currentTool===this||null===a.xm(a.lastInput.documentPoint,!0)},En.prototype.doMouseUp=function(){var a=this.diagram;this.isActive&&this.insertPart(a.lastInput.documentPoint),this.stopTool()},En.prototype.insertPart=function(a){var b=this.diagram,t=this.archetypeNodeData;if(null===t)return null;var e=null;try{if(b.R("ChangingSelection",b.selection),this.xa(this.name),t instanceof yu)t.Oc()&&($h(t),null!==(e=t.copy())&&b.add(e));else if(null!==t){var n=b.model.copyNodeData(t);j(n)&&(b.model.wf(n),e=b.zc(n))}if(null!==e){var o=St.allocAt(a.x,a.y);this.isGridSnapEnabled&&Dr(this.diagram,e,a,o),e.location=o,b.allowSelect&&(b.clearSelection(!0),e.isSelected=!0),St.free(o)}b.Oa(),this.transactionResult=this.name,b.R("PartCreated",e)}finally{this.Kg(),b.R("ChangedSelection",b.selection)}return e},v.Object.defineProperties(En.prototype,{archetypeNodeData:{get:function(){return this.yj},set:function(a){this.yj=a}},isDoubleClick:{get:function(){return this.v},set:function(a){this.v=a}},isGridSnapEnabled:{get:function(){return this.l},set:function(a){this.l=a}}}),En.className="ClickCreatingTool",m(zn,Ve),zn.prototype.canStart=function(){if(!this.isEnabled)return!1;var a=this.diagram;if(!a.allowSelect)return!1;var b=a.lastInput;return!(!b.left||a.currentTool!==this&&(!this.isBeyondDragSize()||b.timestamp-a.firstInput.timestamp<this.delay||null!==a.xm(b.documentPoint,!0)))},zn.prototype.doActivate=function(){var a=this.diagram;this.isActive=!0,a.isMouseCaptured=!0,a.skipsUndoManager=!0,a.add(this.box),this.doMouseMove()},zn.prototype.doDeactivate=function(){var a=this.diagram;a.Lf(),a.remove(this.box),a.skipsUndoManager=!1,this.isActive=a.isMouseCaptured=!1},zn.prototype.doMouseMove=function(){var a=this.diagram;if(this.isActive&&null!==this.box){var b=this.computeBoxBounds(),t=this.box.ab("SHAPE");null===t&&(t=this.box.rb());var e=Ut.alloc().h(b.width,b.height);b=St.allocAt(b.x,b.y),t.desiredSize=e,this.box.position=b,Ut.free(e),St.free(b),(a.allowHorizontalScroll||a.allowVerticalScroll)&&a.Dt(a.lastInput.viewPoint)}},zn.prototype.doMouseUp=function(){if(this.isActive){var a=this.diagram;a.remove(this.box);try{a.currentCursor="wait",a.R("ChangingSelection",a.selection),this.selectInRect(this.computeBoxBounds()),a.R("ChangedSelection",a.selection)}finally{a.currentCursor=""}}this.stopTool()},zn.prototype.computeBoxBounds=function(){var a=this.diagram;return new Jt(a.firstInput.documentPoint,a.lastInput.documentPoint)},zn.prototype.selectInRect=function(a){var b=this.diagram,t=b.lastInput;if(a=b.uy(a,this.isPartialInclusion),J?t.meta:t.control)if(t.shift)for(a=a.iterator;a.next();)(b=a.value).isSelected&&(b.isSelected=!1);else for(a=a.iterator;a.next();)(b=a.value).isSelected=!b.isSelected;else if(t.shift)for(a=a.iterator;a.next();)(b=a.value).isSelected||(b.isSelected=!0);else{for(t=new ut,b=b.selection.iterator;b.next();){var e=b.value;a.contains(e)||t.add(e)}for(b=t.iterator;b.next();)b.value.isSelected=!1;for(a=a.iterator;a.next();)(b=a.value).isSelected||(b.isSelected=!0)}},v.Object.defineProperties(zn.prototype,{delay:{get:function(){return this.nl},set:function(a){this.nl=a}},isPartialInclusion:{get:function(){return this.v},set:function(a){this.v=a}},box:{get:function(){return this.l},set:function(a){this.l=a}}}),zn.className="DragSelectingTool",m(Vn,Ve),Vn.prototype.canStart=function(){if(!this.isEnabled)return!1;var a=this.diagram;return!(!a.allowHorizontalScroll&&!a.allowVerticalScroll||!a.lastInput.left||a.currentTool!==this&&!this.isBeyondDragSize())},Vn.prototype.doActivate=function(){var a=this.diagram;this.Qg?(a.lastInput.bubbles=!0,a.addEventListener(w.document,"scroll",this.Mx,!1)):(a.currentCursor="move",a.isMouseCaptured=!0,this.hv.assign(a.position)),this.isActive=!0},Vn.prototype.doDeactivate=function(){var a=this.diagram;a.currentCursor="",this.isActive=a.isMouseCaptured=!1},Vn.prototype.doCancel=function(){var a=this.diagram;a.position=this.hv,a.isMouseCaptured=!1,this.stopTool()},Vn.prototype.doMouseMove=function(){this.move()},Vn.prototype.doMouseUp=function(){this.move(),this.stopTool()},Vn.prototype.move=function(){var a=this.diagram;if(this.isActive&&a)if(this.Qg)a.lastInput.bubbles=!0;else{var b=a.position,t=a.firstInput.documentPoint,e=a.lastInput.documentPoint,n=b.x+t.x-e.x;t=b.y+t.y-e.y,a.allowHorizontalScroll||(n=b.x),a.allowVerticalScroll||(t=b.y),a.position=this.lz.h(n,t)}},v.Object.defineProperties(Vn.prototype,{bubbles:{get:function(){return this.Qg},set:function(a){this.Qg=a}},originalPosition:{get:function(){return this.hv}}}),Vn.className="PanningTool",G("clickCreatingTool",(function(){return this.findTool("ClickCreating")}),(function(a){this.Xa("ClickCreating",a,this.mouseUpTools)})),G("clickSelectingTool",(function(){return this.findTool("ClickSelecting")}),(function(a){this.Xa("ClickSelecting",a,this.mouseUpTools)})),G("panningTool",(function(){return this.findTool("Panning")}),(function(a){this.Xa("Panning",a,this.mouseMoveTools)})),G("dragSelectingTool",(function(){return this.findTool("DragSelecting")}),(function(a){this.Xa("DragSelecting",a,this.mouseMoveTools)})),G("actionTool",(function(){return this.findTool("Action")}),(function(a){this.Xa("Action",a,this.mouseDownTools)})),v.Object.defineProperties(Gn.prototype,{mainElement:{get:function(){return this.I},set:function(a){this.I=a}},show:{get:function(){return this.v},set:function(a){this.v!==a&&(this.v=a)}},hide:{get:function(){return this.l},set:function(a){this.l!==a&&(this.l=a)}},valueFunction:{get:function(){return this.T},set:function(a){this.T=a}}}),Gn.className="HTMLInfo",Yn.className="ContextMenuButtonInfo",m(Xn,Ve),Xn.prototype.canStart=function(){if(!this.isEnabled)return!1;var a=this.diagram;return!(this.isBeyondDragSize()||!a.lastInput.right||1<a.lastInput.clickCount)&&!!(a.lastInput.isTouchEvent&&null!==this.defaultTouchContextMenu||null!==this.findObjectWithContextMenu())},Xn.prototype.doStart=function(){this.Cx.set(this.diagram.firstInput.documentPoint)},Xn.prototype.doStop=function(){this.hideContextMenu(),this.currentObject=null},Xn.prototype.findObjectWithContextMenu=function(a){void 0===a&&(a=null);var b=this.diagram,t=b.lastInput,e=null;if(a instanceof Xo||(e=a instanceof ea?a:b.Vb(t.documentPoint,null,(function(a){return!a.layer.isTemporary}))),null!==e){for(a=e;null!==a;){if(null!==a.contextMenu)return a;a=a.panel}if(b.lastInput.isTouchEvent&&this.defaultTouchContextMenu)return e.part}else if(null!==b.contextMenu)return b;return null},Xn.prototype.doActivate=function(){},Xn.prototype.doMouseDown=function(){if(Ve.prototype.doMouseDown.call(this),this.isActive&&this.currentContextMenu instanceof Eu){var a=this.diagram.toolManager.findTool("Action");null!==a&&a.canStart()&&(a.doActivate(),a.doMouseDown(),a.doDeactivate())}this.diagram.toolManager.mouseDownTools.contains(this)&&Un(this)},Xn.prototype.doMouseUp=function(){if(this.isActive&&this.currentContextMenu instanceof Eu){var a=this.diagram.toolManager.findTool("Action");null!==a&&a.canStart()&&(a.doActivate(),a.doCancel(),a.doDeactivate())}Un(this)},Xn.prototype.doMouseMove=function(){var a=this.diagram.toolManager.findTool("Action");null!==a&&a.doMouseMove(),this.isActive&&this.diagram.toolManager.doMouseMove()},Xn.prototype.showContextMenu=function(a,b){var t=this.diagram;if(a!==this.currentContextMenu&&this.hideContextMenu(),a instanceof Eu){a.layerName="Tool",a.selectable=!1,a.scale=1/t.scale,a.category=this.name,null!==a.placeholder&&(a.placeholder.scale=t.scale);var e=a.diagram;null!==e&&e!==t&&e.remove(a),t.add(a),null!==b?a.adornedObject=b:a.data=t.model,a.Ta(),this.positionContextMenu(a,b)}else a instanceof Gn&&a.show(b,t,this);this.currentContextMenu=a},Xn.prototype.positionContextMenu=function(a){if(null===a.placeholder){var b=this.diagram,t=b.lastInput.documentPoint.copy(),e=a.measuredBounds,n=b.viewportBounds;b.lastInput.isTouchEvent&&(t.x-=e.width),t.x+e.width>n.right&&(t.x-=e.width+5/b.scale),t.x<n.x&&(t.x=n.x),t.y+e.height>n.bottom&&(t.y-=e.height+5/b.scale),t.y<n.y&&(t.y=n.y),a.position=t}},Xn.prototype.hideContextMenu=function(){var a=this.diagram,b=this.currentContextMenu;null!==b&&(b instanceof Eu?(a.remove(b),null!==this.zu&&this.zu.Jf(b.category),b.data=null,b.adornedObject=null):b instanceof Gn&&(null!==b.hide?b.hide(a,this):null!==b.mainElement&&(b.mainElement.style.display="none")),this.currentContextMenu=null,this.standardMouseOver())},Xn.prototype.showDefaultContextMenu=function(){var a=this.diagram;null===this.Au&&(this.Au=function(a){var b=new ut;return b.add(new Yn("Copy",(function(a){a.commandHandler.copySelection()}),(function(a){return a.commandHandler.canCopySelection()}))),b.add(new Yn("Cut",(function(a){a.commandHandler.cutSelection()}),(function(a){return a.commandHandler.canCutSelection()}))),b.add(new Yn("Delete",(function(a){a.commandHandler.deleteSelection()}),(function(a){return a.commandHandler.canDeleteSelection()}))),b.add(new Yn("Paste",(function(b){b.commandHandler.pasteSelection(a.mouseDownPoint)}),(function(b){return b.commandHandler.canPasteSelection(a.mouseDownPoint)}))),b.add(new Yn("Select All",(function(a){a.commandHandler.selectAll()}),(function(a){return a.commandHandler.canSelectAll()}))),b.add(new Yn("Undo",(function(a){a.commandHandler.undo()}),(function(a){return a.commandHandler.canUndo()}))),b.add(new Yn("Redo",(function(a){a.commandHandler.redo()}),(function(a){return a.commandHandler.canRedo()}))),b.add(new Yn("Scroll To Part",(function(a){a.commandHandler.scrollToPart()}),(function(a){return a.commandHandler.canScrollToPart()}))),b.add(new Yn("Zoom To Fit",(function(a){a.commandHandler.zoomToFit()}),(function(a){return a.commandHandler.canZoomToFit()}))),b.add(new Yn("Reset Zoom",(function(a){a.commandHandler.resetZoom()}),(function(a){return a.commandHandler.canResetZoom()}))),b.add(new Yn("Group Selection",(function(a){a.commandHandler.groupSelection()}),(function(a){return a.commandHandler.canGroupSelection()}))),b.add(new Yn("Ungroup Selection",(function(a){a.commandHandler.ungroupSelection()}),(function(a){return a.commandHandler.canUngroupSelection()}))),b.add(new Yn("Edit Text",(function(a){a.commandHandler.editTextBlock()}),(function(a){return a.commandHandler.canEditTextBlock()}))),b}(this)),Zn.innerHTML="",Jn.addEventListener("click",this.uv,!1);var b=this,t=P("ul");t.className="goCXul",Zn.appendChild(t),t.innerHTML="";for(var e=this.Au.iterator;e.next();){var n=e.value,o=n.visible;if("function"==typeof n.gy&&("function"!=typeof o||o(a))){(o=P("li")).className="goCXli";var g=P("a");g.className="goCXa",g.href="#",g.fz=n.gy,g.addEventListener("click",(function(t){return this.fz(a),b.stopTool(),t.preventDefault(),!1}),!1),g.textContent=n.text,o.appendChild(g),t.appendChild(o)}}Zn.style.display="block",Jn.style.display="block"},Xn.prototype.hideDefaultContextMenu=function(){if(null!==this.currentContextMenu&&this.currentContextMenu===Hn){Zn.style.display="none",Jn.style.display="none";var a=this.diagram;null!==a&&a.removeEventListener(Jn,"click",this.uv,!1),this.currentContextMenu=null}},v.Object.defineProperties(Xn.prototype,{currentContextMenu:{get:function(){return this.l},set:function(a){this.l=a,this.zu=a instanceof Eu?a.adornedPart:null}},defaultTouchContextMenu:{get:function(){return!1===Wn&&null===Hn&&hs&&function(a){var b=new Gn;b.show=function(a,b,t){t.showDefaultContextMenu()},b.hide=function(a,b){b.hideDefaultContextMenu()},Hn=b,a.uv=function(){a.stopTool()},b=P("div");var t=P("div");b.style.cssText="top: 0px;z-index:10002;position: fixed;display: none;text-align: center;left: 25%;width: 50%;background-color: #F5F5F5;padding: 16px;border: 16px solid #444;border-radius: 10px;margin-top: 10px",t.style.cssText="z-index:10001;position: fixed;display: none;top: 0;left: 0;width: 100%;height: 100%;background-color: black;opacity: 0.8;";var e=P("style");w.document.getElementsByTagName("head")[0].appendChild(e),e.sheet.insertRule(".goCXul { list-style: none; }",0),e.sheet.insertRule(".goCXli {font:700 1.5em Helvetica, Arial, sans-serif;position: relative;min-width: 60px; }",0),e.sheet.insertRule(".goCXa {color: #444;display: inline-block;padding: 4px;text-decoration: none;margin: 2px;border: 1px solid gray;border-radius: 10px; }",0),null!==(e=a.diagram)&&(e.addEventListener(b,"contextmenu",qn,!1),e.addEventListener(b,"selectstart",qn,!1),e.addEventListener(t,"contextmenu",qn,!1)),b.className="goCXforeground",t.className="goCXbackground",w.document.body&&(w.document.body.appendChild(b),w.document.body.appendChild(t)),Zn=b,Jn=t,Wn=!0}(this),Hn},set:function(a){null===a&&(Wn=!0),Hn=a}},currentObject:{get:function(){return this.v},set:function(a){this.v=a}},mouseDownPoint:{get:function(){return this.Cx}}});var Hn=null,Wn=!1,Jn=null,Zn=null;function $n(){Ve.call(this),this.name="TextEditing",this.yh=new Sl,this.Ka=null,this.Ja=oo,this.Vi=null,this.ia=so,this.I=1,this.T=!0,this.v=null,this.l=new Gn,this.Eu=null,function(a,b){if(hs){var t=P("textarea");a.Eu=t,t.addEventListener("input",(function(){if(null!==a.textBlock){var b=a.Ly(this.value);this.style.width=20+b.measuredBounds.width*this.bB+"px",this.rows=b.lineCount}}),!1),t.addEventListener("keydown",(function(b){if(null!==a.textBlock){var t=b.key;"Enter"===t?(!1===a.textBlock.isMultiline&&b.preventDefault(),a.acceptText(eo)):"Tab"===t?(a.acceptText(io),b.preventDefault()):"Escape"===t&&(a.doCancel(),null!==a.diagram&&a.diagram.doFocus())}}),!1),t.addEventListener("focus",(function(){if(null!==a.currentTextEditor&&a.state!==so){var b=a.Eu;a.ia===ao&&(a.ia=ho),"function"==typeof b.select&&a.selectsTextOnActivate&&(b.select(),b.setSelectionRange(0,9999))}}),!1),t.addEventListener("blur",(function(){if(null!==a.currentTextEditor&&a.state!==so){var b=a.Eu;"function"==typeof b.focus&&b.focus(),"function"==typeof b.select&&a.selectsTextOnActivate&&(b.select(),b.setSelectionRange(0,9999))}}),!1),b.valueFunction=function(){return t.value},b.mainElement=t,b.show=function(a,b,e){if(a instanceof Sl&&e instanceof $n)if(e.state===uo)t.style.border="3px solid red",t.focus();else{var n=a.da(bi),o=b.position,r=b.scale,h=a.Cf()*r;h<e.minimumEditorScale&&(h=e.minimumEditorScale);var l=a.naturalBounds.width*h+6,c=a.naturalBounds.height*h+2,p=(n.x-o.x)*r;n=(n.y-o.y)*r,t.value=a.text,b.div.style.font=a.font,t.style.position="absolute",t.style.zIndex="100",t.style.font="inherit",t.style.fontSize=100*h+"%",t.style.lineHeight="normal",t.style.width=l+"px",t.style.left=(p-l/2|0)-1+"px",t.style.top=(n-c/2|0)-1+"px",t.style.textAlign=a.textAlign,t.style.margin="0",t.style.padding="1px",t.style.border="0",t.style.outline="none",t.style.whiteSpace="pre-wrap",t.style.overflow="hidden",t.rows=a.lineCount,t.bB=h,t.className="goTXarea",b.div.appendChild(t),t.focus(),e.selectsTextOnActivate&&(t.select(),t.setSelectionRange(0,9999))}},b.hide=function(a){a.div.removeChild(t)}}}(this,this.l)}function Qn(a){var b=a.textBlock,t=a.diagram,e=a.currentTextEditor;if(null!==b&&null!==e){var n=b.text,o="";null!==e.valueFunction&&(o=e.valueFunction()),a.isValidText(b,n,o)?(a.xa(a.name),a.ia=co,a.transactionResult=a.name,b.text=o,a.doSuccess(n,o),null!==t&&t.R("TextEdited",b,n),a.Kg(),a.stopTool(),null!==t&&t.doFocus()):(a.ia=uo,a.doError(n,o),e.show(b,t,a))}}Xn.className="ContextMenuTool",G("contextMenuTool",(function(){return this.findTool("ContextMenu")}),(function(a){this.Xa("ContextMenu",a,this.mouseUpTools)})),m($n,Ve),$n.prototype.canStart=function(){if(!this.isEnabled)return!1;var a=this.diagram;if(null===a||a.isReadOnly||fo&&fo!==this&&(fo.acceptText(to),fo&&fo!==this)||!a.lastInput.left||this.isBeyondDragSize())return!1;var b=a.Vb(a.lastInput.documentPoint);return!!(null!==b&&b instanceof Sl&&b.editable&&b.part.canEdit())&&!(null===(b=b.part)||this.starting===oo&&!b.isSelected||this.starting===ro&&2>a.lastInput.clickCount)},$n.prototype.doStart=function(){fo=this,null!==this.textBlock&&this.doActivate()},$n.prototype.doActivate=function(){if(!this.isActive){var a=this.diagram;if(null!==a){var b=this.textBlock;if(null===b&&(b=a.Vb(a.lastInput.documentPoint)),null!==b&&b instanceof Sl&&(this.textBlock=b,null!==b.part)){this.isActive=!0,this.ia=ao;var t=this.defaultTextEditor;null!==b.textEditor&&(t=b.textEditor),this.yh=this.textBlock.copy();var e=new Jt(this.textBlock.da(yi),this.textBlock.da(Si));a.Aw(e),t.show(b,a,this),this.currentTextEditor=t}}}},$n.prototype.doCancel=function(){this.stopTool()},$n.prototype.doMouseUp=function(){this.canStart()&&this.doActivate()},$n.prototype.doMouseDown=function(){this.isActive&&this.acceptText(to)},$n.prototype.acceptText=function(a){switch(a){case to:this.ia===co?this.currentTextEditor instanceof HTMLElement&&this.currentTextEditor.focus():this.ia!==ao&&this.ia!==uo&&this.ia!==ho||(this.ia=lo,Qn(this));break;case _n:case eo:case io:eo===a&&!0===this.textBlock.isMultiline||this.ia!==ao&&this.ia!==uo&&this.ia!==ho||(this.ia=lo,Qn(this))}},$n.prototype.doError=function(a,b){var t=this.textBlock;null!==t.errorFunction&&t.errorFunction(this,a,b)},$n.prototype.doSuccess=function(a,b){var t=this.textBlock;null!==t.textEdited&&t.textEdited(t,a,b)},$n.prototype.doDeactivate=function(){var a=this.diagram;null!==a&&(this.ia=so,this.textBlock=null,null!==this.currentTextEditor&&this.currentTextEditor.hide(a,this),this.isActive=!1)},$n.prototype.doStop=function(){fo=null},$n.prototype.isValidText=function(a,b,t){var e=this.textValidation;return!(null!==e&&!e(a,b,t))&&!(null!==(e=a.textValidation)&&!e(a,b,t))},$n.prototype.Ly=function(a){var b=this.yh;return b.text=a,b.measure(this.textBlock.Ci,1/0),b},v.Object.defineProperties($n.prototype,{textBlock:{get:function(){return this.Ka},set:function(a){this.Ka=a}},currentTextEditor:{get:function(){return this.v},set:function(a){this.v=a}},defaultTextEditor:{get:function(){return this.l},set:function(a){this.l=a}},starting:{get:function(){return this.Ja},set:function(a){this.Ja=a}},textValidation:{get:function(){return this.Vi},set:function(a){this.Vi=a}},minimumEditorScale:{get:function(){return this.I},set:function(a){this.I=a}},selectsTextOnActivate:{get:function(){return this.T},set:function(a){this.T=a}},state:{get:function(){return this.ia},set:function(a){this.ia!==a&&(this.ia=a)}}}),$n.prototype.measureTemporaryTextBlock=$n.prototype.Ly;var _n=new _($n,"LostFocus",0),to=new _($n,"MouseDown",1),io=new _($n,"Tab",2),eo=new _($n,"Enter",3),no=new _($n,"SingleClick",0),oo=new _($n,"SingleClickSelected",1),ro=new _($n,"DoubleClick",2),so=new _($n,"StateNone",0),ao=new _($n,"StateActive",1),ho=new _($n,"StateEditing",2),lo=new _($n,"StateValidating",3),uo=new _($n,"StateInvalid",4),co=new _($n,"StateValidated",5),fo=null;function po(){So||(ko(),So=!0),this.B=os,this.yl=this.ff=this.sc=this.ps=this.jc=!1,this.Rx=!0,this.zl=Po,this.qn=!1,this.xi=this.nd=!0,this.Yg=600,this.ox=this.Qx=!1,this.Re=new ft,this.Od=new To,this.Od.Wc=this,this.Vk=new ft,this.rv=new ft,this.mt=new ft}function th(a,b){go(a,b)&&(a.ff=!0)}function go(a,b){return!(!a.nd||!a.canStart(b))&&(a.Re.add(b),a.defaultAnimation.isAnimating&&a.Sc(),a.sc=!0)}function yo(a){if(a.nd&&a.sc){var b=a.Od,t=a.B,e=a.Re.contains("Model");e&&(a.yl=!0,a.zl===Po?(b.isViewportUnconstrained=!0,b.mc.clear(),b.add(t,"position",t.position.copy().offset(0,-200),t.position),b.add(t,"opacity",0,1)):a.zl===Co&&b.mc.clear(),a.Rx=!(a.zl!==No||!t.Ts.w(t.la)),t.R("InitialAnimationStarting",a)),e&&!a.xi||0===b.mc.count?(a.Re.clear(),a.sc=!1,a.ff=!1,b.mc.clear(),Lo(b,t),a.yl=!1,t.M()):(a.Re.clear(),t.Ce=!1,e=b.mc.get(t),t.autoScale!==cs&&null!==e&&(delete e.start.scale,delete e.end.scale),w.requestAnimationFrame((function(){!1===a.sc||b.jc||(t.Ie("temporaryPixelRatio")&&Ho(t),Jo(t),a.sc=!1,a.ff=!1,b.start(),vo(a),t.Oa(),Oo(b,0),yr(t,!0),xo(a),t.R("AnimationStarting",a))})))}}function mo(a,b,t,e){b instanceof uc&&(null!==b.fromNode||null!==b.toNode)||a.Od.add(b,"position",t,e,!1)}function vo(a){if(!a.ps){var b=a.B;a.Qx=b.skipsUndoManager,a.ox=b.skipsModelSourceBindings,b.skipsUndoManager=!0,b.skipsModelSourceBindings=!0,a.ps=!0}}function xo(a){var b=a.B;b.skipsUndoManager=a.Qx,b.skipsModelSourceBindings=a.ox,a.ps=!1}function bo(a,b,t){a.ff&&!b.w(t)&&(a.B.oj||(b=t.copy()),Ao(a.Od,a.B,"position",b,t))}function wo(a,b,t,e,n){null===a&&(a="rgba(0,0,0,0)"),null===b&&(b="rgba(0,0,0,0)"),Za(a),$a();var o=gh.l,g=gh.I,r=gh.v;a=gh.T,Za(b),$a();var h=gh.I,l=gh.v;return b=gh.T,"hsla("+(o=n(t,o,gh.l-o,e))+", "+(g=n(t,g,h-g,e))+"%, "+(r=n(t,r,l-r,e))+"%, "+(t=n(t,a,b-a,e))+")"}function ko(){function a(a,b,t,e,g,n){a.position=new St(e(g,b.x,t.x-b.x,n),e(g,b.y,t.y-b.y,n))}var b=new Mt;b.add("position:diagram",a),b.add("position",a),b.add("position:part",(function(a,b,t,e,g,n){g<n?a.dr(e(g,b.x,t.x-b.x,n),e(g,b.y,t.y-b.y,n),!1):a.position=new St(e(g,b.x,t.x-b.x,n),e(g,b.y,t.y-b.y,n))})),b.add("location",(function(a,b,t,e,g,n){g<n?a.dr(e(g,b.x,t.x-b.x,n),e(g,b.y,t.y-b.y,n),!0):a.location=new St(e(g,b.x,t.x-b.x,n),e(g,b.y,t.y-b.y,n))})),b.add("position:placeholder",(function(a,b,t,e,g,n){g<n?a.dr(e(g,b.x,t.x-b.x,n),e(g,b.y,t.y-b.y,n),!1):a.position=new St(e(g,b.x,t.x-b.x,n),e(g,b.y,t.y-b.y,n))})),b.add("position:nodeCollapse",(function(a,b,t,e,g,n){var o=a.actualBounds,r=t.actualBounds;t=r.x+r.width/2-o.width/2,o=r.y+r.height/2-o.height/2,g<n?a.dr(e(g,b.x,t-b.x,n),e(g,b.y,o-b.y,n),!1):a.position=new St(e(g,b.x,t-b.x,n),e(g,b.y,o-b.y,n))})),b.add("desiredSize",(function(a,b,t,e,g,n){a.desiredSize=new Jt(e(g,b.width,t.width-b.width,n),e(g,b.height,t.height-b.height,n))})),b.add("width",(function(a,b,t,e,g,n){a.width=e(g,b,t-b,n)})),b.add("height",(function(a,b,t,e,g,n){a.height=e(g,b,t-b,n)})),b.add("fill",(function(a,b,t,e,g,n){a.fill=wo(b,t,g,n,e)})),b.add("stroke",(function(a,b,t,e,g,n){a.stroke=wo(b,t,g,n,e)})),b.add("strokeWidth",(function(a,b,t,e,g,n){a.strokeWidth=e(g,b,t-b,n)})),b.add("strokeDashOffset",(function(a,b,t,e,g,n){a.strokeDashOffset=e(g,b,t-b,n)})),b.add("background",(function(a,b,t,e,g,n){a.background=wo(b,t,g,n,e)})),b.add("areaBackground",(function(a,b,t,e,g,n){a.areaBackground=wo(b,t,g,n,e)})),b.add("opacity",(function(a,b,t,e,g,n){a.opacity=e(g,b,t-b,n)})),b.add("scale",(function(a,b,t,e,g,n){a.scale=e(g,b,t-b,n)})),b.add("angle",(function(a,b,t,e,g,n){a.angle=e(g,b,t-b,n)})),Mo=b}$n.className="TextEditingTool",$n.LostFocus=_n,$n.MouseDown=to,$n.Tab=io,$n.Enter=eo,$n.SingleClick=no,$n.SingleClickSelected=oo,$n.DoubleClick=ro,$n.StateNone=so,$n.StateActive=ao,$n.StateEditing=ho,$n.StateValidating=lo,$n.StateInvalid=uo,$n.StateValidated=co,G("textEditingTool",(function(){return this.findTool("TextEditing")}),(function(a){this.Xa("TextEditing",a,this.mouseUpTools)})),po.prototype.ce=function(a){this.B=a},po.prototype.canStart=function(){return!0},(n=po.prototype).au=function(a){return this.Od.au(a)},n.cw=function(a){return this.Od.cw(a)},n.Sc=function(a){var b=this.Od;if(!0===this.sc&&(this.yl=this.ff=this.sc=!1,this.Re.clear(),0<b.mc.count&&this.B.Eb()),this.jc){if(b.um(!0),b.mc.clear(),Lo(b,null),!0===a)for(a=this.Vk.ma(),b=0;b<a.length;b++)a[b].um(!0)}else b.mc.clear(),Lo(b,this.B)},n.um=function(a){a===this.defaultAnimation&&this.defaultAnimation.mc.clear(),this.Vk.remove(a),0===this.Vk.count&&(this.jc=!1,this.B.Eb()),a===this.defaultAnimation&&(this.defaultAnimation.mc.clear(),this.B.R("AnimationFinished",this))},n.jk=function(a,b){this.ff&&(this.Re.contains("Expand Tree")||this.Re.contains("Expand SubGraph"))&&this.Od.jk(a,b)},n.hk=function(a,b){this.ff&&(this.Re.contains("Collapse Tree")||this.Re.contains("Collapse SubGraph"))&&(this.Od.hk(a,b),Ao(this.Od,b,"position",b.position,b.position))},v.Object.defineProperties(po.prototype,{animationReasons:{get:function(){return this.Re}},isEnabled:{get:function(){return this.nd},set:function(a){this.nd=a}},duration:{get:function(){return this.Yg},set:function(a){1>a&&T(a,">= 1",po,"duration"),this.Yg=a}},isAnimating:{get:function(){return this.jc}},isTicking:{get:function(){return this.ps}},isInitial:{get:function(){return this.xi},set:function(a){this.xi=a}},defaultAnimation:{get:function(){return this.Od}},activeAnimations:{get:function(){return this.Vk}},initialAnimationStyle:{get:function(){return this.zl},set:function(a){this.zl=a}}}),po.prototype.stopAnimation=po.prototype.Sc;var Mo=null,So=!1,Po=new _(po,"Default",1),No=new _(po,"AnimateLocations",2),Co=new _(po,"None",3);function To(){this.vv=this.Px=this.Wc=this.B=null,this.Hl=this.jc=this.l=!1,this.Wn=this.Cd=0,this.Ir=this.Hu=Fo,this.Gl=this.zp=!1,this.lv=1,this.jv=0,this.ud=this.Yg=NaN,this.tx=0,this.Xn=null,this.v=Dt,this.mc=new Mt,this.fv=new Mt,this.nm=new ft,this.gv=new ft,this.px=bs}function Lo(a,b){if(a.fv.clear(),a.Gl=!1,a.jv=0,a.ud=NaN,0<a.nm.count&&a.nm.clear(),0<a.gv.count&&a.gv.clear(),null!==b)for(a=b.links;a.next();)a.value.sg=null}function Ao(a,b,t,e,n,o){var g=a.mc;if(b instanceof Xo&&"position"===t&&(t="position:diagram"),g.contains(b)){var r=g.H(b),h=r.start,l=r.end;void 0===h[t]&&(h[t]=jo(e)),l[t]=jo(n)}else l={},(h={})[t]=jo(e),l[t]=jo(n),r=h.position,b instanceof ea&&r instanceof St&&!r.u()&&b.diagram.animationManager.Re.contains("Expand SubGraph")&&r.assign(l.position),r=new Io(h,l,o),g.add(b,r);(g=h[t])instanceof St&&!g.u()&&g.assign(a.v),o&&0===t.indexOf("position:")&&b instanceof yu?r.Ov.location=jo(b.location):o&&(r.Ov[t]=jo(e))}function jo(a){return a instanceof St||a instanceof Ut?a.copy():a}function Do(a,b){if(!a.Hl||b){var t=a.Wc;if(!1!==a.jc){var e=+new Date,n=e>a.Wn?a.ud:e-a.Cd;b&&((n=a.tx)<a.ud?(a.Cd=+new Date-n,a.Wn=a.Cd+a.ud):n=a.ud),vo(t),Oo(a,n),yr(a.B,!0),xo(t),e>a.Wn&&(a.zp&&!a.Gl?(a.Cd=+new Date,a.Wn=a.Cd+a.ud,a.Gl=!0):a.um(!1))}}}function Oo(a,b){for(var t=a.ud,e=a.mc.iterator,n=a.Gl;e.next();){var o=e.key;if(!(o instanceof ea&&null===o.diagram)){var g=e.value,r=n?g.end:g.start;g=n?g.start:g.end;var h,l=Mo;for(h in g)"position"===h&&(g["position:placeholder"]||g["position:nodeCollapse"])||null===l.get(h)||l.get(h)(o,r[h],g[h],a.Ir,b,t,a)}}}function Fo(a,b,t,e){return 1>(a/=e/2)?t/2*a*a+b:-t/2*(--a*(a-2)-1)+b}function Bo(a,b,t,e){return a===e?b+t:t*(1-Math.pow(2,-10*a/e))+b}function Io(a,b,t){this.start=a,this.end=b,this.Ov={},this.Iv=t,this.qw=!1}function Ro(a,b,t){this.qd=null,this.hf=a,this.Zp=t||Eo,this.$k=null,void 0!==b&&(this.$k=b,void 0===t&&(this.Zp=zo))}po.className="AnimationManager",po.defineAnimationEffect=function(a,b){So||(ko(),So=!0),Mo.add(a,b)},po.Default=Po,po.AnimateLocations=No,po.None=Co,To.prototype.suspend=function(){this.Hl=!0},To.prototype.advanceTo=function(a,b){b&&(this.Hl=!1),this.zp&&a>=this.ud&&(this.Gl=!0,a-=this.ud),this.tx=a,Do(this,!0),vo(this.Wc),yr(this.B),xo(this.Wc),this.B.Le()},(n=To.prototype).start=function(){if(0!==this.mc.count&&!this.jc){for(var a=this.B,b=this.mc.iterator;b.next();){var t=b.value.end,e=b.key;if(t["position:placeholder"]){var n=e.findVisibleNode();if(n instanceof oc&&null!==n.placeholder){var o=n.placeholder;n=o.da(yi),o=o.padding,n.x+=o.left,n.y+=o.top,t["position:placeholder"]=n}}null===a&&(e instanceof Xo?a=e:e instanceof ea&&(a=e.diagram))}null!==a&&(this.B=a,!1!==(b=this.Wc=a.animationManager).isEnabled&&(this.ud=isNaN(this.Yg)?b.duration:this.Yg,this.Ir=this.Hu,b.yl&&b.zl===Po&&this===b.defaultAnimation&&(this.Ir=Bo,this.ud=isNaN(this.Yg)?600===b.duration?900:b.duration:this.Yg),this.px=a.scrollMode,this.isViewportUnconstrained&&(a.Si=ws),vo(b),this.nm.each((function(b){b.data=null,a.add(b)})),xo(b),this.jc=!0,this.Cd=+new Date,this.Wn=this.Cd+this.ud,function(a,b){function t(){if(0<n.mt.count&&(e.addAll(n.mt),n.mt.clear(),n.jc=!0),!1!==n.jc&&0!==e.count){n.rv.addAll(e);for(var a=n.rv.iterator;a.next();){var b=a.value;if(!1!==b.jc){t:if(0<b.nm.count)var o=!0;else{for(o=b.mc.iterator;o.next();){var r=o.key;if(r instanceof ea&&null!==r.diagram||r instanceof Xo){o=!0;break t}}o=!1}o?Do(b,!1):b.Hl=!0}}n.rv.clear(),vo(n),yr(n.B),xo(n),w.requestAnimationFrame(t)}}var e=a.Vk,n=a;a.jc?a.mt.add(b):(a.jc=!0,e.add(b),w.requestAnimationFrame((function(){t()})))}(b,this)))}},n.sz=function(a,b){a.Oc()&&(this.nm.add(a),this.B=b)},n.add=function(a,b,t,e,n){if("position"!==b||!t.w(e)){if(null===this.B&&(a instanceof Xo?this.B=a:a instanceof ea&&null!==a.diagram&&(this.B=a.diagram)),a instanceof yu){if(!a.isAnimated)return;"position"===b&&(b="position:part")}Ao(this,a,b,t,e,n)}},n.au=function(a){return!!this.jc&&(null!==(a=this.mc.H(a))&&a.qw)},n.cw=function(a){return!!this.jc&&(null!==(a=this.mc.H(a))&&(a.start.position||a.start.location))},n.stop=function(){this.jc&&this.um(!0)},n.um=function(a){if(null!==this.vv&&this.vv.Gp.remove(this.Px),this.jc){var b=this.B,t=this.Wc;this.Hl=this.jc=t.yl=!1,vo(t);for(var e=this.mc,n=this.nm.iterator;n.next();)b.remove(n.value);for(n=this.gv.iterator;n.next();)n.value.o();n=this.zp,e=e.iterator;for(var o=Mo;e.next();){var r,g=e.key,h=e.value,l=n?h.end:h.start,c=n?h.start:h.end,f=h.Ov;for(r in c)if(null!==o.get(r)){var p=r;!h.Iv||"position:nodeCollapse"!==p&&"position:placeholder"!==p||(p="position"),o.get(p)(g,l[r],void 0!==f[r]?f[r]:h.Iv?l[r]:c[r],this.Ir,this.ud,this.ud,this)}h.Iv&&void 0!==f.location&&g instanceof yu&&(g.location=f.location),h.qw&&g instanceof yu&&g.Pb(!1)}if(t.defaultAnimation===this)for(r=this.B.links;r.next();)null===(n=r.value).sg?null!==(e=n.path)&&(n.kd=!1,n.o(),e.o()):(n.points=n.sg,n.sg=null);b.Wt.clear(),Wo(b,!1),b.Oa(),b.M(),yr(b,!0),this.isViewportUnconstrained&&(b.scrollMode=this.px),xo(t),this.jv++,!a&&this.lv>this.jv?(this.Gl=!1,this.start()):(this.Xn&&this.Xn(this),Lo(this,null),t.um(this),b.Eb())}},n.jk=function(a,b){var t=b.actualBounds,e=null;if(b instanceof oc&&(e=b.placeholder),null!==e?(t=e.da(yi),e=e.padding,t.x+=e.left,t.y+=e.top,this.add(a,"position",t,a.position,!1)):this.add(a,"position",new St(t.x+t.width/2,t.y+t.height/2),a.position,!1),this.add(a,"scale",.01,a.scale,!1),a instanceof oc)for(a=a.memberParts;a.next();)(e=a.value)instanceof zu&&this.jk(e,b)},n.hk=function(a,b){if(a.isVisible()){var t=null;if(b instanceof oc&&(t=b.placeholder),null!==t?this.add(a,"position:placeholder",a.position,t,!0):this.add(a,"position:nodeCollapse",a.position,b,!0),this.add(a,"scale",a.scale,.01,!0),(t=this.mc).contains(a)&&(t.H(a).qw=!0),a instanceof oc)for(a=a.memberParts;a.next();)(t=a.value)instanceof zu&&this.hk(t,b)}},n.pA=function(a){var b=this.fv.get(a);return null===b&&(b={},this.fv.add(a,b)),b},v.Object.defineProperties(To.prototype,{duration:{get:function(){return this.Yg},set:function(a){1>a&&T(a,">= 1",To,"duration"),this.Yg=a}},reversible:{get:function(){return this.zp},set:function(a){this.zp=a}},runCount:{get:function(){return this.lv},set:function(a){0<a?this.lv=a:N("Animation.runCount value must be a positive integer.")}},finished:{get:function(){return this.Xn},set:function(a){this.Xn!==a&&(this.Xn=a)}},easing:{get:function(){return this.Hu},set:function(a){this.Hu=a}},isViewportUnconstrained:{get:function(){return this.l},set:function(a){this.l=a}},isAnimating:{get:function(){return this.jc}}}),To.prototype.getTemporaryState=To.prototype.pA,To.prototype.stop=To.prototype.stop,To.prototype.add=To.prototype.add,To.prototype.addTemporaryPart=To.prototype.sz,To.className="Animation",To.EaseLinear=function(a,b,t,e){return t*a/e+b},To.EaseInOutQuad=Fo,To.EaseInQuad=function(a,b,t,e){return t*(a/=e)*a+b},To.EaseOutQuad=function(a,b,t,e){return-t*(a/=e)*(a-2)+b},To.EaseInExpo=function(a,b,t,e){return 0===a?b:t*Math.pow(2,10*(a/e-1))+b},To.EaseOutExpo=Bo,Io.className="AnimationState",Ro.prototype.copy=function(){var a=new Ro(this.hf);a.Zp=this.Zp;var b=this.$k;if(null!==b){var t={};void 0!==b.duration&&(t.oy=b.duration),void 0!==b.finished&&(t.oy=b.finished),void 0!==b.easing&&(t.oy=b.easing),a.$k=t}return a},v.Object.defineProperties(Ro.prototype,{propertyName:{get:function(){return this.hf},set:function(a){this.hf=a}},animationSettings:{get:function(){return this.$k},set:function(a){this.$k=a}},startCondition:{get:function(){return this.Zp},set:function(a){this.Zp=a}}});var Eo=new _(Ro,"Default",1),zo=new _(Ro,"Immediate",2),Vo=new _(Ro,"Bundled",3);function li(){pt(this),this.B=null,this.Da=new ut,this.Qa="",this.hb=1,this.v=!1,this.l=this.Ni=this.I=this.hi=this.gi=this.fi=this.ei=this.ci=this.di=this.bi=this.ji=this.ai=this.ii=this.$h=this.Zh=!0,this.lp=[]}function Go(a,b){var t=1;return 1!==a.hb&&(t=b.globalAlpha,b.globalAlpha=t*a.hb),t}function Yo(a,b,t){if(b=function(a,b,t){var e=t.zOrder;if(isNaN(e))return b;var n=(a=a.Da).count;if(1>=n)return b;if(0>b&&(b=a.indexOf(t)),0>b)return-1;for(var o=b-1,g=NaN;0<=o&&(g=a.J(o).zOrder,isNaN(g));)o--;for(var r=b+1,h=NaN;r<n&&(h=a.J(r).zOrder,isNaN(h));)r++;if(!isNaN(g)&&g>e)for(;;){if(-1===o||g<=e){if(++o===b)break;return a.cb(b),a.wb(o,t),o}for(g=NaN;0<=--o&&(g=a.J(o).zOrder,isNaN(g)););}else if(!isNaN(h)&&h<e)for(;;){if(r===n||h>=e){if(--r===b)break;return a.cb(b),a.wb(r,t),r}for(h=NaN;++r<n&&(h=a.J(r).zOrder,isNaN(h)););}return b}(a,b,t),t instanceof oc&&null!==t&&isNaN(t.zOrder)){if(0!==t.memberParts.count){for(var e=-1,n=a.Da.j,o=n.length,g=0;g<o;g++){var r=n[g];if(r===t&&(b=g,0<=e))break;if(0>e&&r.containingGroup===t&&(e=g,0<=b))break}!(0>e)&&e<b&&((n=a.Da).cb(b),n.wb(e,t))}null!==(t=t.containingGroup)&&Yo(a,-1,t)}}function Xo(a){if(1<arguments.length&&N("Diagram constructor can only take one optional argument, the DIV HTML element or its id."),Ls||(As(),Ls=!0),pt(this),os=this,Q=[],this.Sb=!0,this.Wc=new po,this.Wc.ce(this),this.pb=17,this.Fl=this.nv=!1,this.Ss="default",this.Ea=null,hs){var b=this,t=function(){b.removeEventListener(w.document,"DOMContentLoaded",t,!1),b.setRTL()};null!==w.document.body?this.setRTL():b.addEventListener(w.document,"DOMContentLoaded",t,!1)}this.La=new ut,this.ua=this.va=0,this.Xl=this.ta=null,this.Lx=new Mt,this.jf=this.Hb=null,this.xw(),this.Lj=null,this.ww(),this.hb=1,this.la=new St(NaN,NaN).freeze(),this.Ts=new St(NaN,NaN),this.Nn=this.ya=1,this.es=new St(NaN,NaN).freeze(),this.fs=NaN,this.xs=1e-4,this.vs=100,this.qb=new ee,this.vt=new St(NaN,NaN).freeze(),this.Zr=new Jt(NaN,NaN,NaN,NaN).freeze(),this.Ri=new ui(0,0,0,0).freeze(),this.Si=bs,this.at=!1,this.Us=this.Os=null,this.Pg=cs,this.Bj=Vi,this.$f=cs,this.oo=Vi,this.gs=this.ds=yi,this.Ec=!0,this.Dl=!1,this.vd=new ft,this.Wg=new Mt,this.pl=!0,this.nn=250,this.zj=-1,this.pn=new ui(16,16,16,16).freeze(),this.Fj=this.Ce=!1,this.Ij=!0,this.Yf=new Ae,this.Yf.diagram=this,this.pd=new Ae,this.pd.diagram=this,this.hh=new Ae,this.hh.diagram=this,this.ue=this.Qf=null,this.fk=!1,this.Pr=this.Qr=null,this.xj=w.PointerEvent&&(K||H||W)&&w.navigator&&!1!==w.navigator.msPointerEnabled,Wr(this),this.Ch=new ft,this.qs=!0,this.pt=ks,this.Ru=!1,this.rt=ps,this.Ka=null,rs.add("Model",_f),this.Jr=this.Mr=this.nt=null,this.Mn=this.Hr="auto",this.ig=this.As=this.kg=this.lg=this.ng=this.Sf=this.Wf=this.Rf=null,this.cs=!1,this.Tf=this.xg=this.mg=this.jg=null,this.Bs=!1,this.Ms={},this.$j=[null,null],this.Br=null,this.Nr=this.et=this.pv=this.wg=!1,this.Yu=!0,this.wi=this.kc=!1,this.bc=null;var e=this;this.Cc=function(a){var b=e.partManager;if(a.model===b.diagram.model&&b.diagram.Z){b.diagram.Z=!1;try{var t=a.change;""===a.modelChange&&t===Fe&&b.updateDataBindings(a.object,a.propertyName)}finally{b.diagram.Z=!0}}},this.Vc=function(a){e.partManager.doModelChanged(a)},this.xv=!0,this.Ud=-2,this.Oi=new Mt,this.Ls=new ut,this.bg=!1,this.$h=this.Zh=this.nr=this.nd=!0,this.pr=!1,this.vr=this.tr=this.hi=this.gi=this.fi=this.ei=this.ci=this.di=this.bi=this.sr=this.ji=this.ai=this.ii=this.qr=!0,this.ag=this.Uu=!1,this.ur=this.rr=this.vl=this.ul=!0,this.$s=this.Ws=16,this.Vs=this.Ip=!1,this.Jp=this.Ys=null,this.Xs=this.Zs=0,this.ib=new ui(5).freeze(),this.ov=(new ft).freeze(),this.ws=999999999,this.Ou=(new ft).freeze(),this.vi=this.ui=this.ti=!0,this.Ze=this.ne=!1,this.lc=null,this.Og=!0,this.oe=!1,this.Bx=new ft,this.Pu=new ft,this.Hc=null,this.Ul=1,this.qv=0,this.Jc={scale:1,position:new St,bounds:new Jt,Ev:new Ut,iw:new Ut,fw:!1},this.Sx=new Jt(NaN,NaN,NaN,NaN).freeze(),this.pm=new Ut(NaN,NaN).freeze(),this.On=new Jt(NaN,NaN,NaN,NaN).freeze(),this.rs=!1,this.Fo=this.mo=this.ep=this.Cu=this.Bu=this.Du=this.dg=this.fh=this.ef=this.Tr=null,Ko(this),this.Jb=null,this.lo=!1,this.Cj=null,this.partManager=new _f,this.toolManager=new Ge,this.toolManager.initializeStandardTools(),this.currentTool=this.defaultTool=this.toolManager,this.Sr=null,this.il=new Ks,this.Gs=this.Fs=null,this.aq=!1,this.commandHandler=Uo(),this.model=Ed(),this.wg=!0,Zo(this),this.layout=new wf,this.wg=!1,this.ux=this.Gu=null,this.Tb=1,this.xh=null,this.Ro=1,this.Xo=0,this.ev=[0,0,0,0,0],this.Yo=0,this.wd=1,this.Qj=0,this.Ao=new St,this.ot=500,this.on=new St,this.pe=!1,this.Mk=this.Nk=this.Lk=this.Kk=this.Fk=this.Hk=this.Gk=this.Dk=this.Ek=this.Ww=this.Mw=this.Nw=this.Ow=null,this.Xq=function(){},this.preventDefault=null,this.qo=!1,this.si=new js,this.bq=!1,void 0!==a&&Os(this,a),this.Yn=null,this.Zn=It,this.Sb=!1}function qo(a,b){a.animationManager.Sc(!0),a.ov=(new ft).freeze(),a.Ou=(new ft).freeze();var t=a.skipsUndoManager;null!==a.model&&(a.skipsUndoManager=!0);var e=null;null!==a.Jb&&(null!==(e=a.Jb.part)&&a.remove(e));var n=[],o=a.La.length;if(b){for(b=0;b<o;b++)for(var g=a.La.j[b].parts;g.next();){var r=g.value;r!==e&&null===r.data&&n.push(r)}for(b=0;b<n.length;b++)a.remove(n[b])}for(b=0;b<o;b++)a.La.j[b].clear();return a.partManager.clear(),a.vd.clear(),a.Wg.clear(),a.Ch.clear(),a.Cj=null,$=[],null!==e&&(a.add(e),a.partManager.parts.remove(e)),null!==a.model&&(a.skipsUndoManager=t),n}function Uo(){return null}function Ko(a){a.ef=new Mt;var b=new zu,t=new Sl;t.bind(new Ud("text","",z)),b.add(t),a.Du=b,a.ef.add("",b),b=new zu,(t=new Sl).stroke="brown",t.bind(new Ud("text","",z)),b.add(t),a.ef.add("Comment",b),(b=new zu).selectable=!1,b.avoidable=!1,(t=new pl).figure="Ellipse",t.fill="black",t.stroke=null,t.desiredSize=new Ut(3,3).ca(),b.add(t),a.ef.add("LinkLabel",b),a.fh=new Mt,(b=new oc).selectionObjectName="GROUPPANEL",b.type=Fh.Vertical,(t=new Sl).font="bold 12pt sans-serif",t.bind(new Ud("text","",z)),b.add(t),(t=new Fh(Fh.Auto)).name="GROUPPANEL";var e=new pl;e.figure="Rectangle",e.fill="rgba(128,128,128,0.2)",e.stroke="black",t.add(e),(e=new lc).padding=new ui(5,5,5,5).ca(),t.add(e),b.add(t),a.Bu=b,a.fh.add("",b),a.dg=new Mt,b=new uc,(t=new pl).isPanelMain=!0,b.add(t),(t=new pl).toArrow="Standard",t.fill="black",t.stroke=null,t.strokeWidth=0,b.add(t),a.Cu=b,a.dg.add("",b),b=new uc,(t=new pl).isPanelMain=!0,t.stroke="brown",b.add(t),a.dg.add("Comment",b),(b=new Eu).type=Fh.Auto,(t=new pl).fill=null,t.stroke="dodgerblue",t.strokeWidth=3,b.add(t),(t=new lc).margin=new ui(1.5,1.5,1.5,1.5).ca(),b.add(t),a.ep=b,a.mo=b,(b=new Eu).type=Fh.Link,(t=new pl).isPanelMain=!0,t.fill=null,t.stroke="dodgerblue",t.strokeWidth=3,b.add(t),a.Fo=b}function Ho(a){30<a.Xo&&(a.xh=1)}function Wo(a,b){null!==a.xh&&(a.xh=null,b&&a.Xq(),nt&&nt.ny||(a.Xo=0,a.ev=[0,0,0,0,0],a.Yo=0))}function Jo(a){if(null!==a.ta){var b=a.Ea;if(0!==b.clientWidth&&0!==b.clientHeight){a.nv||a.setScrollWidth();var t=a.Ze?a.pb:0,e=a.ne?a.pb:0,n=a.Tb;a.Tb=a.computePixelRatio(),a.Tb!==n&&(a.Dl=!0,a.Eb()),b.clientWidth===a.va+t&&b.clientHeight===a.ua+e||(a.ui=!0,a.Ec=!0,null!==(b=a.layout)&&b.isViewportSized&&a.autoScale===cs&&(a.Fj=!0,b.C()),a.kc||a.Eb())}}}function Zo(a){var b=new li;b.name="Background",a.rm(b),(b=new li).name="",a.rm(b),(b=new li).name="Foreground",a.rm(b),(b=new li).name="Adornment",b.isTemporary=!0,b.isInDocumentBounds=!1,a.rm(b),(b=new li).name="Tool",b.isTemporary=!0,b.isInDocumentBounds=!0,a.rm(b),(b=new li).name="Grid",b.allowSelect=!1,b.pickable=!1,b.isTemporary=!0,b.isInDocumentBounds=!1,a.Vx(b,a.wm("Background"))}function $o(a){a.Jb=new Fh(Fh.Grid),a.Jb.name="GRID";var b=new pl;b.figure="LineH",b.stroke="lightgray",b.strokeWidth=.5,b.interval=1,a.Jb.add(b),(b=new pl).figure="LineH",b.stroke="gray",b.strokeWidth=.5,b.interval=5,a.Jb.add(b),(b=new pl).figure="LineH",b.stroke="gray",b.strokeWidth=1,b.interval=10,a.Jb.add(b),(b=new pl).figure="LineV",b.stroke="lightgray",b.strokeWidth=.5,b.interval=1,a.Jb.add(b),(b=new pl).figure="LineV",b.stroke="gray",b.strokeWidth=.5,b.interval=5,a.Jb.add(b),(b=new pl).figure="LineV",b.stroke="gray",b.strokeWidth=1,b.interval=10,a.Jb.add(b),(b=new yu).add(a.Jb),b.layerName="Grid",b.zOrder=0,b.isInDocumentBounds=!1,b.isAnimated=!1,b.pickable=!1,b.locationObjectName="GRID",a.add(b),a.partManager.parts.remove(b),a.Jb.visible=!1}function Qo(){this.B.Vs?this.B.Vs=!1:this.B.isEnabled?this.B.jy(this):Cr(this.B)}function _o(a){this.B.isEnabled?(this.B.Zs=a.target.scrollTop,this.B.Xs=a.target.scrollLeft):Cr(this.B)}function ir(a){if(a.fixedBounds.u()){var b=a.fixedBounds.copy();return b.qq(a.ib),b}for(var t=!0,e=a.La.j,n=e.length,o=0;o<n;o++){var g=e[o];if(g.visible&&g.isInDocumentBounds)for(var r=(g=g.Da.j).length,h=0;h<r;h++){var l=g[h];l.isInDocumentBounds&&l.isVisible()&&((l=l.actualBounds).u()&&(t?(t=!1,b=l.copy()):b.Tc(l)))}}return t&&(b=new Jt(0,0,0,0)),b.qq(a.ib),b}function er(a,b){if((b||a.oe)&&!a.Sb&&null!==a.ta&&a.documentBounds.u()){if(b){var t=a.initialPosition;if(t.u())return void(a.position=t);(t=St.alloc()).sj(a.documentBounds,a.initialDocumentSpot);var e=a.viewportBounds;e=Jt.allocAt(0,0,e.width,e.height);var n=St.alloc();n.sj(e,a.initialViewportSpot),n.h(t.x-n.x,t.y-n.y),a.position=n,Jt.free(e),St.free(n),St.free(t)}a.Sb=!0,t=a.Pg,b&&a.$f!==cs&&(t=a.$f),e=t!==cs?nr(a,t):a.scale,t=a.viewportBounds.copy(),n=a.va/e;var o=a.ua/e,g=a.Bj,r=a.oo;b&&!g.kb()&&(r.kb()||r.Nb())&&(g=r.Nb()?bi:r),or(a,a.documentBounds,n,o,g,b),b=a.scale,a.scale=e,a.Sb=!1,(e=a.viewportBounds).Na(t)||a.Tq(t,e,b,!1),Mr(a),gr(a,!0,!1)}}function nr(a,b){var t=a.Nn;if(null===a.ta)return t;a.Ta();var e=a.documentBounds;if(!e.u())return t;var n=e.width;e=e.height;var o=a.va+(a.Ze?a.pb:0),g=a.ua+(a.ne?a.pb:0),r=o/n,h=g/e;return b===fs?((b=Math.min(h,r))>t&&(b=t),b<a.minScale&&(b=a.minScale),b>a.maxScale&&(b=a.maxScale),b):b===ds?((b=h>r?(g-a.pb)/e:(o-a.pb)/n)>t&&(b=t),b<a.minScale&&(b=a.minScale),b>a.maxScale&&(b=a.maxScale),b):a.scale}function or(a,b,t,e,n,o){var g=St.allocAt(a.la.x,a.la.y),r=g.x,h=g.y;if(null!==a.Yn){var l=St.alloc();r=(l=a.Yn.da(yi,l)).x-a.Zn.x/a.scale,h=l.y-a.Zn.y/a.scale,n=gi,St.free(l)}(o||a.scrollMode===bs)&&(n.kb()&&(t>b.width&&(r=b.x+(n.x*b.width+n.offsetX)-(n.x*t-n.offsetX)),e>b.height&&(h=b.y+(n.y*b.height+n.offsetY)-(n.y*e-n.offsetY))),n=a.Ri,o=t-b.width,t<b.width+n.left+n.right?(r=Math.min(r+t/2,b.right+Math.max(o,n.right)-t/2),r=Math.max(r,b.left-Math.max(o,n.left)+t/2),r-=t/2):r>b.left?r=b.left:r<b.right-t&&(r=b.right-t),t=e-b.height,e<b.height+n.top+n.bottom?(h=Math.min(h+e/2,b.bottom+Math.max(t,n.bottom)-e/2),h=Math.max(h,b.top-Math.max(t,n.top)+e/2),h-=e/2):h>b.top?h=b.top:h<b.bottom-e&&(h=b.bottom-e)),g.x=isFinite(r)?r:-a.ib.left,g.y=isFinite(h)?h:-a.ib.top,null!==a.positionComputation&&(b=a.positionComputation(a,g),g.x=b.x,g.y=b.y),a.Wc.sc&&bo(a.Wc,a.la,g),a.la.h(g.x,g.y),St.free(g)}function rr(a,b,t,e){for(void 0===t&&(t=null),void 0===e&&(e=null),mr(a),a=a.La.iteratorBackwards;a.next();){var n=a.value;if(n.visible&&!n.isTemporary&&null!==(n=n.Vb(b,t,e)))return n}return null}function sr(a,b,t){var e=a.pd;return a.pd=a.hh,a.hh=e,e.diagram=a,e.event=b,t?dr(a,b,e):(e.viewPoint=a.pd.viewPoint,e.documentPoint=a.pd.documentPoint),a=0,b.ctrlKey&&(a+=1),b.altKey&&(a+=2),b.shiftKey&&(a+=4),b.metaKey&&(a+=8),e.modifiers=a,e.button=b.button,void 0===b.buttons||U||(e.buttons=b.buttons),J&&0===b.button&&b.ctrlKey&&(e.button=2),e.down=!1,e.up=!1,e.clickCount=1,e.delta=0,e.handled=!1,e.bubbles=!1,e.timestamp=b.timeStamp,e.isMultiTouch=!1,e.targetDiagram=ar(b),e.targetObject=null,e}function ar(a){var b=a.target.B;if(!b){var t=a.path;t||"function"!=typeof a.composedPath||(t=a.composedPath()),t&&t[0]&&(b=t[0].B)}return b||null}function lr(a,b,t,e){var n=cr(a,b,!0,!1,!0,e);return dr(a,t,n),n.targetDiagram=ar(b),n.targetObject=null,e||n.clone(a.Yf),n}function ur(a,b,t,e){if(e=cr(a,b,!1,!1,!1,e),null!==t){var n=w.document.elementFromPoint(t.clientX,t.clientY);null!==n&&void 0!==n.shadowRoot&&null!==n.shadowRoot&&(n=n.shadowRoot.elementFromPoint(t.clientX,t.clientY)),n&&n.B?(b=t,t=n.B):(b=void 0!==b.targetTouches?b.targetTouches[0]:b,t=a),e.targetDiagram=t,dr(a,b,e)}else null!==a.pd?(e.documentPoint=a.pd.documentPoint,e.viewPoint=a.pd.viewPoint,e.targetDiagram=a.pd.targetDiagram):null!==a.Yf&&(e.documentPoint=a.Yf.documentPoint,e.viewPoint=a.Yf.viewPoint,e.targetDiagram=a.Yf.targetDiagram);return e.targetObject=null,e}function cr(a,b,t,e,n,o){var g=a.pd;a.pd=a.hh,a.hh=g,g.diagram=a,g.clickCount=1;var r=g.delta=0;return b.ctrlKey&&(r+=1),b.altKey&&(r+=2),b.shiftKey&&(r+=4),b.metaKey&&(r+=8),g.modifiers=r,g.button=0,g.buttons=1,g.event=b,g.timestamp=b.timeStamp,a.xj&&b instanceof w.PointerEvent&&"touch"!==b.pointerType&&(g.button=b.button,void 0===b.buttons||U||(g.buttons=b.buttons),J&&0===b.button&&b.ctrlKey&&(g.button=2)),g.down=t,g.up=e,g.handled=!1,g.bubbles=n,g.isMultiTouch=o,g}function fr(a,b){return!!a.bubbles||(void 0!==b.stopPropagation&&b.stopPropagation(),!1!==b.cancelable&&b.preventDefault(),b.cancelBubble=!0,!1)}function dr(a,b,t){var e=a.ta,n=a.va,o=a.ua,g=0,r=0;null!==e&&(e=e.getBoundingClientRect(),g=b.clientX-n/e.width*e.left,r=b.clientY-o/e.height*e.top),t.viewPoint.h(g,r),null!==a.qb?(b=St.allocAt(g,r),a.qb.Gd(b),t.documentPoint.assign(b),St.free(b)):t.documentPoint.h(g,r)}function pr(a,b,t,e){if(void 0!==b.targetTouches){if(2>b.targetTouches.length)return;b=b.targetTouches[t]}else{if(null===a.$j[0])return;b=a.$j[t]}null!==(t=a.ta)&&(t=t.getBoundingClientRect(),e.h(b.clientX-a.va/t.width*t.left,b.clientY-a.ua/t.height*t.top))}function gr(a,b,t){a.animationManager.defaultAnimation.isAnimating||a.Sb||!a.ui||Cr(a)||(b&&mr(a),t&&er(a,!1))}function yr(a,b){if(!a.kc&&(a.Ce=!1,null!==a.Ea||a.pm.u())){a.kc=!0;var t=a.animationManager,e=a.Ls;if(!t.isAnimating&&0!==e.length){for(var n=e.j,o=n.length,g=0;g<o;g++){var r=n[g];ka(r,!1),r.o()}e.clear()}0<(e=a.Pu).count&&(e.each((function(a){a.Vw()})),e.clear()),n=e=!1,t.isAnimating&&(n=!0,e=a.skipsUndoManager,a.skipsUndoManager=!0),t.sc||Jo(a),gr(a,!1,!0),null!==a.Jb&&(a.Jb.visible&&!a.lo&&(Er(a),a.lo=!0),!a.Jb.visible&&a.lo&&(a.lo=!1)),mr(a),o=!1,a.oe&&!a.Og||(a.oe?Kr(a,!a.Fj):(a.xa("Initial Layout"),!1===t.isEnabled&&t.Sc(),Kr(a,!1)),o=!0),a.Fj=!1,mr(a),a.et||function(a){a.kc||mr(a),a.Ta()}(a),gr(a,!0,!1),g=!1,o?((t=Jt.alloc()).assign(a.viewportBounds),a.oe||(g=a.oe=!0,a.skipsUndoManager||(a.undoManager.isPendingClear=!0),a.undoManager.isPendingUnmodified=!0,function(a){var b=a.ya;if(a.$f!==cs)a.scale=nr(a,a.$f);else if(a.Pg!==cs)a.scale=nr(a,a.Pg);else{var t=a.initialScale;isFinite(t)&&0<t&&(a.scale=t)}a.ya!==b&&(Mr(a),gr(a,!0,!1)),er(a,!0),b=a.La.j,a.Ld(b,b.length,a),a.R("InitialLayoutCompleted"),a.Ts.assign(a.la),Er(a)}(a)),a.R("LayoutCompleted"),t.w(a.viewportBounds)||gr(a,!0,!1),Jt.free(t)):t.yl&&t.Rx&&(a.$f!==cs?a.scale=nr(a,a.$f):a.Pg!==cs?a.scale=nr(a,a.Pg):(t=a.initialScale,isFinite(t)&&0<t&&(a.scale=t)),er(a,!0)),mr(a),o&&g&&a.Wa("Initial Layout"),a.Fv(),b||a.cc(a.Hb),n&&(a.skipsUndoManager=e),a.kc=!1}}function mr(a){if((a.kc||!a.animationManager.isTicking)&&0!==a.vd.count){for(var b=0;23>b;b++){var t=a.vd.iterator;if(null===t||0===a.vd.count)break;a.vd=new ft,a.Vw(t,a.vd)}a.nodes.each((function(a){a instanceof oc&&0!=(65536&a.P)!=!1&&(a.P=65536^a.P)}))}}function vr(a,b){for(var t=I(),e=I(),n=b.memberParts;n.next();){var o=n.value;o.isVisible()&&(o instanceof oc?(wa(o)||Ma(o)||Cu(o))&&vr(a,o):o instanceof uc?o.fromNode===b||o.toNode===b?e.push(o):t.push(o):(o.measure(1/0,1/0),o.arrange()))}for(a=t.length,n=0;n<a;n++)(o=t[n]).measure(1/0,1/0),o.arrange();for(R(t),b.measure(1/0,1/0),b.arrange(),a=e.length,b=0;b<a;b++)(t=e[b]).measure(1/0,1/0),t.arrange();R(e)}function xr(a,b,t,e,n,o,g,r,h,l){if(null!==a.Ea){null===a.ta&&N("No canvas specified"),void 0===g&&(g=null),void 0===r&&(r=null),void 0===h&&(h=!1),void 0===l&&(l=!1),Pr(a),a.Hb.uc(!0),Sr(a),a.wi=!0;var c=a.ya;a.ya=n;var f=a.La.j,p=f.length;try{var d=new Jt(o.x,o.y,e.width/n,e.height/n),q=d.copy();q.qq(t),Er(a,q),mr(a),a.Ld(f,p,a,d),b.setTransform(1,0,0,1,0,0),b.clearRect(0,0,e.width,e.height),null!==r&&""!==r&&(b.fillStyle=r,b.fillRect(0,0,e.width,e.height));var u=a.Tb;b.scale(u,u);var y=ee.alloc();if(y.reset(),y.translate(t.left,t.top),y.scale(n),0===o.x&&0===o.y||y.translate(-o.x,-o.y),b.setTransform(y.m11,y.m12,y.m21,y.m22,y.dx,y.dy),ee.free(y),wr(a,b),b.globalAlpha=a.hb,null!==g){var m=new ft,v=g.iterator;for(v.reset();v.next();){var x=v.value;!1===l&&"Grid"===x.layer.name||null===x||m.add(x)}var w=function(t){if(t.visible&&0!==t.hb&&(h||!t.isTemporary)){var e=t.Da.j,n=e.length;if(0!==n){var o=Go(t,b),g=t.lp;g.length=0;for(var r=a.scale,l=Jt.alloc(),c=0;c<n;c++){var f=e[c];m.contains(f)&&t.cj(b,f,a,g,r,l,!1)}Jt.free(l),b.globalAlpha=o}}}}else if(!h&&l){var k=a.grid.part,M=k.layer;w=function(t){t===M?k.cc(b,a):t.cc(b,a,h)}}else w=function(t){t.cc(b,a,h)};for(t=0;t<p;t++)w(f[t]);a.wi=!1,a.si&&Ds(a.si,a)&&a.Tr()}finally{a.ya=c,a.Hb.uc(!0),Sr(a),a.Ld(f,p,a),Er(a)}}}function wr(a,b){null!==(a=a.jf)&&(void 0!==a.imageSmoothingEnabled&&b.Uy(!!a.imageSmoothingEnabled),null!=(a=a.defaultFont)&&(b.font=a))}function kr(a,b){var t,e=a instanceof Fh,n=a instanceof Xo;for(t in b){""===t&&N("Setting properties requires non-empty property names");var o=a,g=t;if(e||n){var r=t.indexOf(".");if(0<r){var h=t.substring(0,r);e?o=a.ab(h):null==(o=a[h])&&(o=a.toolManager[h]),j(o)?g=t.substr(r+1):N("Unable to find object named: "+h+" in "+a.toString()+" when trying to set property: "+t)}}if("_"!==g[0]&&!V(o,g)){if(n&&"ModelChanged"===g){a.Yx(b[g]);continue}if(n&&"Changed"===g){a.Gh(b[g]);continue}if(n&&V(a.toolManager,g))o=a.toolManager;else{if(n&&Jr(a,g)){a.ik(g,b[g]);continue}if(a instanceof vd&&"Changed"===g){a.Gh(b[g]);continue}N('Trying to set undefined property "'+g+'" on object: '+o.toString())}}o[g]=b[t],"_"===g[0]&&o instanceof ea&&o.Ux(g)}}function Mr(a){!1===a.ui&&(a.ui=!0)}function Sr(a){!1===a.vi&&(a.vi=!0)}function Pr(a){!1!==a.Dl&&(a.Dl=!1,Nr(a,a.va,a.ua))}function Nr(a,b,t){var e=a.Tb;a.ta.resize(b*e,t*e,b,t)&&(a.Ec=!0,a.Hb.uc(!0))}function Cr(a){var b=a.ta;if(null===b)return!0;var t=a.Ea,e=a.va,n=a.ua,o=a.viewportBounds.copy();if(!o.u())return!0;var g=!1,r=a.Ze?a.pb:0,h=a.ne?a.pb:0,l=t.clientWidth||e+r,c=t.clientHeight||n+h;if(l===e+r&&c===n+h||(a.Ze=!1,a.ne=!1,h=r=0,a.va=l,a.ua=c,g=a.Dl=!0),!(g||a.Ze||a.ne||a.ul||a.vl))return!0;a.ui=!1;var f=a.viewportBounds,p=a.documentBounds,d=0,q=0,u=0,y=0;t=f.width;var m=f.height,v=a.Ri;a.contentAlignment.kb()?(p.width>t&&(d=v.left,q=v.right),p.height>m&&(u=v.top,y=v.bottom)):(d=v.left,q=v.right,u=v.top,y=v.bottom),v=p.width+d+q;var x=p.height+u+y;d=p.x-d;var w=f.x;q=p.right+q;var k=f.right+r;u=p.y-u;var M=f.y;p=p.bottom+y,f=f.bottom+h;var S="1px",P="1px";if(l=v>l/(y=a.scale),c=x>c/y,a.scrollMode===bs&&(l||c)&&(l&&a.hasHorizontalScrollbar&&a.allowHorizontalScroll&&(l=1,d+1<w&&(l=Math.max((w-d)*y+a.va,l)),q>k+1&&(l=Math.max((q-k)*y+a.va,l)),t+r+1<v&&(l=Math.max((v-t)*y+a.va,l)),S=l.toString()+"px"),c&&a.hasVerticalScrollbar&&a.allowVerticalScroll&&(l=1,u+1<M&&(l=Math.max((M-u)*y+a.ua,l)),p>f+1&&(l=Math.max((p-f)*y+a.ua,l)),m+h+1<x&&(l=Math.max((x-m)*y+a.ua,l)),P=l.toString()+"px")),c="1px"!==P,(l="1px"!==S)&&c||!l&&!c||(c&&(k-=a.pb),l&&(f-=a.pb),v<t+r||!a.hasHorizontalScrollbar||!a.allowHorizontalScroll||(r=1,d+1<w&&(r=Math.max((w-d)*y+a.va,r)),q>k+1&&(r=Math.max((q-k)*y+a.va,r)),t+1<v&&(r=Math.max((v-t)*y+a.va,r)),S=r.toString()+"px"),l="1px"!==S,r=a.ua,l!==a.ne&&(r=l?a.ua-a.pb:a.ua+a.pb),x<m+h||!a.hasVerticalScrollbar||!a.allowVerticalScroll||(h=1,u+1<M&&(h=Math.max((M-u)*y+r,h)),p>f+1&&(h=Math.max((p-f)*y+r,h)),m+1<x&&(h=Math.max((x-m)*y+r,h)),P=h.toString()+"px"),c="1px"!==P),a.Ip&&l===a.ne&&c===a.Ze)return e===a.va&&n===a.ua||a.jd(),!1;if(l!==a.ne&&(a.ua="1px"===S?a.ua+a.pb:Math.max(a.ua-a.pb,1),g=!0),a.ne=l,a.Jp.style.width=S,c!==a.Ze&&(a.va="1px"===P?a.va+a.pb:Math.max(a.va-a.pb,1),g=!0,a.Fl&&(h=St.alloc(),c?(b.style.left=a.pb+"px",a.position=h.h(a.la.x+a.pb/a.scale,a.la.y)):(b.style.left="0px",a.position=h.h(a.la.x-a.pb/a.scale,a.la.y)),St.free(h))),a.Ze=c,a.Jp.style.height=P,a.Vs=!0,g&&(a.Dl=!0),h=(b=a.Ys).scrollLeft,a.hasHorizontalScrollbar&&a.allowHorizontalScroll&&(t+1<v?h=(a.position.x-d)*y:d+1<w?h=b.scrollWidth-b.clientWidth:q>k+1&&(h=a.position.x*y)),a.Fl)switch(a.Ss){case"negative":h=-(b.scrollWidth-h-b.clientWidth);break;case"reverse":h=b.scrollWidth-h-b.clientWidth}return b.scrollLeft=h,a.hasVerticalScrollbar&&a.allowVerticalScroll&&(m+1<x?b.scrollTop=(a.position.y-u)*y:u+1<M?b.scrollTop=b.scrollHeight-b.clientHeight:p>f+1&&(b.scrollTop=a.position.y*y)),l=a.va,c=a.ua,b.style.width=l+(a.Ze?a.pb:0)+"px",b.style.height=c+(a.ne?a.pb:0)+"px",e===l&&n===c&&!a.animationManager.sc||(a.Tq(o,a.viewportBounds,y,g),!1)}function Tr(a,b,t){var e=b.layer;null!==e&&e.diagram===a&&(b.isSelected=!1,b.isHighlighted=!1,b.C(2),t&&b.sk(),0<=(t=e.Mc(-1,b,!1))&&a.bb(Ie,"parts",e,b,null,t,null),null!==(a=b.layerChanged)&&a(b,e,null))}function Lr(a,b,t,e,n,o){if(!b.contains(t)&&(void 0===o&&(o=!1),!e||o||t.canMove()||t.canCopy()))if(void 0===n&&(n=jr(a)),t instanceof zu){if(b.add(t,a.Bd(n,t,t.location)),t instanceof oc&&(null!==t.placeholder||n.dragsMembers))for(o=t.memberParts;o.next();)Lr(a,b,o.value,e,n,n.groupsAlwaysMove);for(o=t.linksConnected;o.next();){var g=o.value;if(!b.contains(g)){var r=g.fromNode,h=g.toNode;null!==r&&b.contains(r)&&null!==h&&b.contains(h)&&Lr(a,b,g,e,n)}}if(n.dragsTree)for(t=t.Uv();t.next();)Lr(a,b,t.value,e,n)}else if(t instanceof uc)for(b.add(t,a.Bd(n,t)),t=t.labelNodes;t.next();)Lr(a,b,t.value,e,n);else t instanceof Eu||b.add(t,a.Bd(n,t,t.location))}function Ar(a,b,t,e,n){if(null!==b&&0!==b.count){var o=St.alloc(),g=St.alloc();g.assign(t),isNaN(g.x)&&(g.x=0),isNaN(g.y)&&(g.y=0),(t=a.aq)||Or(a,b);for(var r=I(),h=I(),l=b.iterator,c=St.alloc();l.next();){var f=l.key,p=l.value;if(f.Oc()){var d=Br(a,f,b);null!==d?r.push(new Us(f,p,d)):n&&!f.canMove()||(d=p.point,o.assign(d),a.computeMove(f,o.add(g),e,c),f.location=c,void 0===p.shifted&&(p.shifted=new St),p.shifted.assign(c.ee(d)))}else l.key instanceof uc&&h.push(l.ka)}for(St.free(c),n=r.length,l=0;l<n;l++)f=r[l],o.assign(f.info.point),void 0===f.Yv.shifted&&(f.Yv.shifted=new St),f.node.location=o.add(f.Yv.shifted);for(n=St.alloc(),l=St.alloc(),f=h.length,p=0;p<f;p++){var q=h[p];if((d=q.key)instanceof uc)if(d.suspendsRouting){d.sg=null,c=d.fromNode;var u=d.toNode;if(null!==a.draggedLink&&e.dragsLink)if(u=q.value.point,null===d.dragComputation)b.add(d,a.Bd(e,d,g)),dc(d,g.x-u.x,g.y-u.y);else{q=St.allocAt(0,0),(c=d.i(0))&&c.u()&&q.assign(c);var y=c=St.alloc().assign(q).add(g);e.isGridSnapEnabled&&(e.isGridSnapRealtime||a.lastInput.up)&&Dr(a,d,c,y=St.alloc(),e),c.assign(d.dragComputation(d,c,y)).ee(q),b.add(d,a.Bd(e,d,c)),dc(d,c.x-u.x,c.y-u.y),St.free(q),St.free(c),y!==c&&St.free(y)}else null!==c&&(n.assign(c.location),null!==(y=b.H(c))&&n.ee(y.point)),null!==u&&(l.assign(u.location),null!==(y=b.H(u))&&l.ee(y.point)),null!==c&&null!==u?n.Na(l)?(c=q.value.point,(u=o).assign(n),u.ee(c),b.add(d,a.Bd(e,d,n)),dc(d,u.x,u.y)):(d.suspendsRouting=!1,d.Ua()):(q=q.value.point,c=null!==c?n:null!==u?l:g,b.add(d,a.Bd(e,d,c)),dc(d,c.x-q.x,c.y-q.y))}else null!==d.fromNode&&null!==d.toNode||(c=q.value.point,b.add(d,a.Bd(e,d,g)),dc(d,g.x-c.x,g.y-c.y))}St.free(o),St.free(g),St.free(n),St.free(l),R(r),R(h),t||(mr(a),Fr(a,b))}}function jr(a){var b=a.toolManager.findTool("Dragging");return null!==b?b.dragOptions:a.il}function Dr(a,b,t,e,n){if(void 0===n&&(n=jr(a)),e.assign(t),null!==b){var o=a.grid;a=(b=n.gridSnapCellSize).width,b=b.height;var g=n.gridSnapOrigin,r=g.x;if(g=g.y,n=n.gridSnapCellSpot,null!==o){var h=o.gridCellSize;isNaN(a)&&(a=h.width),isNaN(b)&&(b=h.height),o=o.gridOrigin,isNaN(r)&&(r=o.x),isNaN(g)&&(g=o.y)}(o=St.allocAt(0,0)).Qk(0,0,a,b,n),oe.Cq(t.x,t.y,r+o.x,g+o.y,a,b,e),St.free(o)}}function Or(a,b){if(null!==b)for(a.aq=!0,a=b.iterator;a.next();)(b=a.key)instanceof uc&&(b.suspendsRouting=!0)}function Fr(a,b){if(null!==b){for(b=b.iterator;b.next();){var t=b.key;t instanceof uc&&(t.suspendsRouting=!1,vc(t)&&t.Ua())}a.aq=!1}}function Br(a,b,t){if(null!==(b=b.containingGroup)){if(null!==(a=Br(a,b,t)))return a;if(null!==(a=t.H(b)))return a}return null}function Ir(a,b,t){if(null!==b.diagram&&b.diagram!==a&&N("Cannot share a Layer with another Diagram: "+b+" of "+b.diagram),null===t?null!==b.diagram&&N("Cannot add an existing Layer to this Diagram again: "+b):(t.diagram!==a&&N("Existing Layer must be in this Diagram: "+t+" not in "+t.diagram),b===t&&N("Cannot move a Layer before or after itself: "+b)),b.diagram!==a){b=b.name,t=(a=a.La).count;for(var e=0;e<t;e++)a.J(e).name===b&&N("Cannot add Layer with the name '"+b+"'; a Layer with the same name is already present in this Diagram.")}}function Rr(a,b,t){var e=a.animationManager;if(a.Sb||a.kc)a.ya=t,e.ff&&e.Od.add(e.B,"scale",b,a.ya);else if(null===a.ta)a.ya=t;else{a.Sb=!0;var n=a.viewportBounds.copy(),o=a.va,g=a.ua;n.width=a.va/b,n.height=a.ua/b;var r=a.zoomPoint.x,h=a.zoomPoint.y,l=a.contentAlignment;isNaN(r)&&(l.Pc()?l.Gf(Ni)?r=0:l.Gf(Ci)&&(r=o-1):r=l.kb()?l.x*(o-1):o/2),isNaN(h)&&(l.Pc()?l.Gf(Pi)?h=0:l.Gf(Ti)&&(h=g-1):h=l.kb()?l.y*(g-1):g/2),null===a.scaleComputation||a.animationManager.isAnimating||(t=a.scaleComputation(a,t)),t<a.minScale&&(t=a.minScale),t>a.maxScale&&(t=a.maxScale),o=St.allocAt(a.la.x+r/b-r/t,a.la.y+h/b-h/t),a.position=o,St.free(o),a.ya=t,a.Tq(n,a.viewportBounds,b,!1),a.Sb=!1,er(a,!1),e.ff&&e.Od.add(e.B,"scale",b,a.ya),a.M(),Mr(a)}}function Er(a,b){void 0===b&&(b=null);var t=a.Jb;if(null!==t&&t.visible){for(var e=Ut.alloc(),n=1,o=1,g=t.W.j,r=g.length,h=0;h<r;h++){var l=g[h],c=Math.abs(l.interval);2>c||(Eh(l.figure)?o=o*c/oe.vy(o,c):n=n*c/oe.vy(n,c))}if(g=t.gridCellSize,e.h(o*g.width,n*g.height),null!==b)n=b.width,o=b.height,a=b.x,g=b.y;else{if(b=Jt.alloc(),a=a.viewportBounds,b.h(a.x,a.y,a.width,a.height),!b.u())return void Jt.free(b);n=b.width,o=b.height,a=b.x,g=b.y,Jt.free(b)}t.width=n+2*e.width,t.height=o+2*e.height,b=St.alloc(),oe.Cq(a,g,0,0,e.width,e.height,b),b.offset(-e.width,-e.height),Ut.free(e),t.part.location=b,St.free(b)}}function zr(a){var b=a.isModified;a.xv!==b&&(a.xv=b,a.R("Modified"))}function Vr(a,b){for(var t=(b=b.W.j).length,e=0;e<t;e++)Gr(a,b[e])}function Gr(a,b){if(b instanceof $l){var t=b.element;if(null!==t&&t instanceof HTMLImageElement){var e=b.Zg;if(null!==e&&(e.tl instanceof Event&&null!==b.Dc&&b.Dc(b,e.tl),!0===e.ls&&(null!==b.sf&&b.sf(b,e.mv),null!==b.diagram&&b.diagram.Ls.add(b))),t=t.getAttribute("src"),null===(e=a.Oi.H(t)))(e=[]).push(b),a.Oi.add(t,e);else{for(a=0;a<e.length;a++)if(e[a]===b)return;e.push(b)}}}}function Yr(a,b){if(b instanceof $l){var t=b.element;if(null!==t&&t instanceof HTMLImageElement){t=t.getAttribute("src");var e=a.Oi.H(t);if(null!==e)for(var n=0;n<e.length;n++)if(e[n]===b){e.splice(n,1),0===e.length&&(a.Oi.remove(t),Ql(t));break}}}}function Xr(a,b){a.ti=!1;var t=a.On;t.w(b)||(b=b.G(),a.On=b,er(a,!1),a.R("DocumentBoundsChanged",null,t.copy()),Mr(a))}function qr(a,b){for(var t=a.Ch.iterator;t.next();)Ur(a,t.value,b);null!==a.layout&&(b?a.layout.isValidLayout=!1:a.layout.C())}function Ur(a,b,t){if(null!==b){for(var e=b.Rl.iterator;e.next();)Ur(a,e.value,t);null!==b.layout&&(t?b.layout.isValidLayout=!1:b.layout.C())}}function Kr(a,b){if(a.Og&&!a.Nr){var t=a.Z;a.Z=!0;var e=a.undoManager.transactionLevel,n=a.layout,o=a.animationManager;try{0===e&&(a.undoManager.isInternalTransaction=!0,a.xa("Layout")),1>=e&&!o.isAnimating&&!o.sc&&(b||th(o,"Layout")),a.Og=!1;for(var g=a.Ch.iterator;g.next();)Hr(a,g.value,b,e);n.isValidLayout||(!b||n.isRealtime||null===n.isRealtime||0===e?(n.doLayout(a),mr(a),n.isValidLayout=!0):a.Og=!0)}finally{b=a.undoManager.isInternalTransaction,0===e&&(a.Wa("Layout"),a.undoManager.isInternalTransaction=!1),!b||0!==e&&1!==e||yo(o),a.Z=t}}}function Hr(a,b,t,e){if(null!==b){for(var n=b.Rl.iterator;n.next();)Hr(a,n.value,t,e);null===(n=b.layout)||n.isValidLayout||(!t||n.isRealtime||0===e?(b.Qh=!b.location.u(),n.doLayout(b),b.C(32),vr(a,b),n.isValidLayout=!0):a.Og=!0)}}function Wr(a){function b(a){var b=a.toLowerCase(),n=new ut;t.add(a,n),t.add(b,n),e.add(a,a),e.add(b,a)}var t=new Mt,e=new Mt;b("InitialAnimationStarting"),b("AnimationStarting"),b("AnimationFinished"),b("BackgroundSingleClicked"),b("BackgroundDoubleClicked"),b("BackgroundContextClicked"),b("ClipboardChanged"),b("ClipboardPasted"),b("DocumentBoundsChanged"),b("ExternalObjectsDropped"),b("GainedFocus"),b("InitialLayoutCompleted"),b("LayoutCompleted"),b("LinkDrawn"),b("LinkRelinked"),b("LinkReshaped"),b("LostFocus"),b("Modified"),b("ObjectSingleClicked"),b("ObjectDoubleClicked"),b("ObjectContextClicked"),b("PartCreated"),b("PartResized"),b("PartRotated"),b("SelectionMoved"),b("SelectionCopied"),b("SelectionDeleting"),b("SelectionDeleted"),b("SelectionGrouped"),b("SelectionUngrouped"),b("ChangingSelection"),b("ChangedSelection"),b("SubGraphCollapsed"),b("SubGraphExpanded"),b("TextEdited"),b("TreeCollapsed"),b("TreeExpanded"),b("ViewportBoundsChanged"),b("InvalidateDraw"),a.Qr=t,a.Pr=e}function Jr(a,b){var t=a.Pr.H(b);return null!==t?t:a.Pr.H(b.toLowerCase())}function Zr(a,b){var t=a.Qr.H(b);return null!==t||null!==(t=a.Qr.H(b.toLowerCase()))?t:void N("Unknown DiagramEvent name: "+b)}function $r(a){if(a.animationManager.isTicking)return!1;var b=a.currentTool;return b!==a.toolManager.findTool("Dragging")||(!a.aq||b.isComplexRoutingRealtime)}function Qr(a,b,t,e){if(null===a.Hc&&(a.Hc=new ef),a.Hc.Qt||a.Hc.group!==t||a.Hc.Xy!==e){if(null===t){(b=a.computeOccupiedArea()).Kc(100,100),a.Hc.initialize(b),b=Jt.alloc();for(var n=a.nodes;n.next();){var o=n.value,g=o.layer;null!==g&&g.visible&&!g.isTemporary&&_r(a,o,e,b)}Jt.free(b)}else{for(0<t.memberParts.count&&((b=a.computePartsBounds(t.memberParts,!1)).Kc(20,20),a.Hc.initialize(b)),b=Jt.alloc(),n=t.memberParts;n.next();)(o=n.value)instanceof zu&&_r(a,o,e,b);Jt.free(b)}a.Hc.group=t,a.Hc.Xy=e,a.Hc.Qt=!1}else b&&rf(a.Hc);return a.Hc}function _r(a,b,t,e){if(b!==t)if(b.isVisible()&&b.avoidable&&!b.isLinkLabel){b=b.getAvoidableRect(e),a=a.Hc;var n=b.x,o=b.y;if(nf(a,n,o))for(t=(o-a.Ad)/a.gc|0,e=Math.min((n+b.width-a.zd)/a.fc|0,a.Yi),b=Math.min((o+b.height-a.Ad)/a.gc|0,a.Zi),n=(n-a.zd)/a.fc|0;n<=e;n++)if((o=a.Rb[n]).fill)o.fill(cf,t,b+1);else for(var g=t;g<=b;g++)o[g]=cf}else if(b instanceof oc)for(b=b.memberParts;b.next();)(n=b.value)instanceof zu&&_r(a,n,t,e)}function ts(a,b){null!==a.Hc&&!a.Hc.Qt&&(void 0===b&&(b=null),null===b||b.avoidable&&!b.isLinkLabel)&&(a.Hc.Qt=!0)}function is(a){-1===a.zj&&(a.zj=S((function(){if(-1!==a.zj&&(a.Lf(),null!==a.lastInput.event)){var b=a.computeAutoScrollPosition(a.on);b.Na(a.position)||(a.position=b,a.lastInput.documentPoint=a.lu(a.on),a.doMouseMove(),a.ti=!0,Xr(a,a.documentBounds.copy().Tc(a.computeBounds())),a.Ec=!0,a.jd(),is(a))}}),a.nn))}function es(a,b,t){function e(){var a=+new Date;for(o=!0,g.reset();g.next();)if(!g.value[0].Nl){o=!1;break}o||a-l>h?b(t,n,r):w.requestAnimationFrame(e)}for(var n=t.callback,o=!0,g=a.Oi.iterator;g.next();)if(!g.value[0].Nl){o=!1;break}if("function"!=typeof n||o)return b(t,n,a);var r=a,h=t.callbackTimeout||300,l=+new Date;return w.requestAnimationFrame((function(){e()})),null}function ns(a,b,t,e){if(a.animationManager.Sc(),a.jd(),null===a.ta)return null;"object"!=typeof b&&N("properties argument must be an Object.");var n=b.size||null,o=b.scale||null;void 0!==b.scale&&isNaN(b.scale)&&(o="NaN");var g=b.maxSize;void 0===b.maxSize&&(g="SVG"===t?new Ut(1/0,1/0):new Ut(2e3,2e3));var r=b.position||null,h=b.parts||null,l=void 0===b.padding?1:b.padding,c=b.background||null,f=b.omitTemporary;void 0===f&&(f=!0);var p=b.document||document,d=b.elementFinished||null,q=b.showTemporary;void 0===q&&(q=!f),void 0===(b=b.showGrid)&&(b=q),null!==n&&isNaN(n.width)&&isNaN(n.height)&&(n=null),"number"==typeof l?l=new ui(l):l instanceof ui||N("MakeImage padding must be a Margin or a number."),l.left=Math.max(l.left,0),l.right=Math.max(l.right,0),l.top=Math.max(l.top,0),l.bottom=Math.max(l.bottom,0),a.Hb.uc(!0);var u=(f=new Va(null,p)).context;if(!(n||o||h||r))return f.width=a.va+Math.ceil(l.left+l.right),f.height=a.ua+Math.ceil(l.top+l.bottom),"SVG"===t?null===e?null:(e.resize(f.width,f.height,f.width,f.height),e.ownerDocument=p,e.zq=d,xr(a,e.context,l,new Ut(f.width,f.height),a.ya,a.la,h,c,q,b),e.context):(a.pl=!1,xr(a,u,l,new Ut(f.width,f.height),a.ya,a.la,h,c,q,b),a.pl=!0,f.context);var y=a.Nn,m=a.documentBounds.copy();if(m.Jw(a.ib),q)for(var v=a.La.j,x=v.length,w=0;w<x;w++){var k=v[w];if(k.visible&&k.isTemporary)for(var M=(k=k.Da.j).length,S=0;S<M;S++){var P=k[S];P.isInDocumentBounds&&P.isVisible()&&((P=P.actualBounds).u()&&m.Tc(P))}}if(v=new St(m.x,m.y),null!==h){for(x=!0,(w=h.iterator).reset();w.next();)if((k=w.value)instanceof yu&&((null===(M=k.layer)||M.visible)&&(null===M||q||!M.isTemporary)&&k.isVisible()&&(k=k.actualBounds).u()))if(x){x=!1;var C=k.copy()}else C.Tc(k);x&&(C=new Jt(0,0,0,0)),m.width=C.width,m.height=C.height,v.x=C.x,v.y=C.y}return null!==r&&r.u()&&(v=r,o||(o=y)),C=r=0,null!==l&&(r=l.left+l.right,C=l.top+l.bottom),x=w=0,null!==n&&(w=n.width,x=n.height,isFinite(w)&&(w=Math.max(0,w-r)),isFinite(x)&&(x=Math.max(0,x-C))),null!==n&&null!==o?("NaN"===o&&(o=y),n.u()?(n=w,m=x):isNaN(x)?(n=w,m=m.height*o):(n=m.width*o,m=x)):null!==n?n.u()?(o=Math.min(w/m.width,x/m.height),n=w,m=x):isNaN(x)?(o=w/m.width,n=w,m=m.height*o):(o=x/m.height,n=m.width*o,m=x):null!==o?"NaN"===o&&g.u()?(o=Math.min((g.width-r)/m.width,(g.height-C)/m.height))>y?(o=y,n=m.width,m=m.height):(n=g.width,m=g.height):(n=m.width*o,m=m.height*o):(o=y,n=m.width,m=m.height),null!==l?(n+=r,m+=C):l=new ui(0),null!==g&&(y=g.width,g=g.height,isNaN(y)&&(y=2e3),isNaN(g)&&(g=2e3),isFinite(y)&&(n=Math.min(n,y)),isFinite(g)&&(m=Math.min(m,g))),f.width=Math.ceil(n),f.height=Math.ceil(m),"SVG"===t?null===e?null:(e.resize(f.width,f.height,f.width,f.height),e.ownerDocument=p,e.zq=d,xr(a,e.context,l,new Ut(Math.ceil(n),Math.ceil(m)),o,v,h,c,q,b),e.context):(a.pl=!1,xr(a,u,l,new Ut(Math.ceil(n),Math.ceil(m)),o,v,h,c,q,b),a.pl=!0,f.context)}Ro.className="AnimationTrigger",Ro.Default=Eo,Ro.Immediate=zo,Ro.Bundled=Vo,(n=li.prototype).clear=function(){this.Da.clear(),this.lp.length=0},n.ce=function(a){this.B=a},n.toString=function(a){void 0===a&&(a=0);var b='Layer "'+this.name+'"';if(0>=a)return b;for(var t=0,e=0,n=0,o=0,g=0,r=this.Da.iterator;r.next();){var h=r.value;h instanceof oc?n++:h instanceof zu?e++:h instanceof uc?o++:h instanceof Eu?g++:t++}if(r="",0<t&&(r+=t+" Parts "),0<e&&(r+=e+" Nodes "),0<n&&(r+=n+" Groups "),0<o&&(r+=o+" Links "),0<g&&(r+=g+" Adornments "),1<a)for(a=this.Da.iterator;a.next();)r+="\n    "+(t=a.value).toString(),null!==(e=t.data)&&yt(e)&&(r+=" #"+yt(e)),t instanceof zu?r+=" "+z(e):t instanceof uc&&(r+=" "+z(t.fromNode)+" "+z(t.toNode));return b+" "+this.Da.count+": "+r},n.Vb=function(a,b,t){if(void 0===b&&(b=null),void 0===t&&(t=null),!1===this.Ni)return null;var e=!1;null!==this.diagram&&this.diagram.viewportBounds.$(a)&&(e=!0);for(var n=St.alloc(),o=this.Da.j,g=o.length;g--;){var r=o[g];if((!0!==e||!1!==Au(r))&&r.isVisible()&&(n.assign(a),Tt(n,r.Ed),null!==(r=r.Vb(n,b,t))&&(null!==b&&(r=b(r)),null!==r&&(null===t||t(r)))))return St.free(n),r}return St.free(n),null},n.gj=function(a,b,t,e){if(void 0===b&&(b=null),void 0===t&&(t=null),e instanceof ut||e instanceof ft||(e=new ft),!1===this.Ni)return e;var n=!1;null!==this.diagram&&this.diagram.viewportBounds.$(a)&&(n=!0);for(var o=St.alloc(),g=this.Da.j,r=g.length;r--;){var h=g[r];if((!0!==n||!1!==Au(h))&&h.isVisible()){o.assign(a),Tt(o,h.Ed);var l=h;h.gj(o,b,t,e)&&(null!==b&&(l=b(l)),null===l||null!==t&&!t(l)||e.add(l))}}return St.free(o),e},n.Bf=function(a,b,t,e,n){if(void 0===b&&(b=null),void 0===t&&(t=null),void 0===e&&(e=!1),n instanceof ut||n instanceof ft||(n=new ft),!1===this.Ni)return n;var o=!1;null!==this.diagram&&this.diagram.viewportBounds.Ee(a)&&(o=!0);for(var g=this.Da.j,r=g.length;r--;){var h=g[r];if((!0!==o||!1!==Au(h))&&h.isVisible()){var l=h;h.Bf(a,b,t,e,n)&&(null!==b&&(l=b(l)),null===l||null!==t&&!t(l)||n.add(l))}}return n},n.Tv=function(a,b,t,e,n,o,g){if(!1===this.Ni)return n;for(var r=this.Da.j,h=r.length;h--;){var l=r[h];if((!0!==g||!1!==Au(l))&&o(l)&&l.isVisible()){var c=l;l.Bf(a,b,t,e,n)&&(null!==b&&(c=b(c)),null===c||null!==t&&!t(c)||n.add(c))}}return n},n.Fg=function(a,b,t,e,n,o){if(void 0===t&&(t=null),void 0===e&&(e=null),void 0===n&&(n=!0),!1!==n&&!0!==n&&((n instanceof ut||n instanceof ft)&&(o=n),n=!0),o instanceof ut||o instanceof ft||(o=new ft),!1===this.Ni)return o;var g=!1;null!==this.diagram&&this.diagram.viewportBounds.$(a)&&(g=!0);for(var r=St.alloc(),h=St.alloc(),l=this.Da.j,c=l.length;c--;){var f=l[c];if((!0!==g||!1!==Au(f))&&f.isVisible()){r.assign(a),Tt(r,f.Ed),h.h(a.x+b,a.y),Tt(h,f.Ed);var p=f;f.Fg(r,h,t,e,n,o)&&(null!==t&&(p=t(p)),null===p||null!==e&&!e(p)||o.add(p))}}return St.free(r),St.free(h),o},n.Ld=function(a,b){if(this.visible){var t=this.Da.j,e=t.length;if(0!==e){a=I();for(var n=I(),o=0;o<e;o++){var g=t[o];if(g.Ax=o,g instanceof uc){if(!1===g.kd)continue}else if(g instanceof Eu&&null!==g.adornedPart)continue;ei(g.actualBounds,b)?(g.Ld(!0),a.push(g)):(g.Ld(!1),null!==g.adornments&&0<g.adornments.count&&n.push(g))}for(b=0;b<a.length;b++)for(mu(t=a[b]),t=t.adornments;t.next();)(e=t.value).measure(1/0,1/0),e.arrange(),e.Ld(!0);for(b=0;b<n.length;b++)mu(n[b]);R(a),R(n)}}},n.cc=function(a,b,t){if(this.visible&&0!==this.hb&&(void 0===t&&(t=!0),t||!this.isTemporary)){var e=(t=this.Da.j).length;if(0!==e){var n=Go(this,a),o=this.lp;o.length=0;for(var g=b.scale,r=Jt.alloc(),h=0;h<e;h++)this.cj(a,t[h],b,o,g,r,!0);Jt.free(r),a.globalAlpha=n}}},n.cj=function(a,b,t,e,n,o,g){if(!g||Au(b)){if(null!==e&&b instanceof uc&&(b.isOrthogonal&&e.push(b),!1===b.kd))return;for(g=!1,e=b.containingGroup;null!==e;)g?null!==e.Ya&&o.Ey(e.Ya):null!==e.Ya&&(g=!0,o.assign(e.Ya)),e=e.containingGroup;var r=b.actualBounds;if(e=!1,g&&b.isVisible()){if(!o.Nc(r))return;e=!o.Ee(r)}e&&(a.save(),a.beginPath(),a.rect(o.x,o.y,o.width,o.height),a.clip()),r.width*n>t.Ro||r.height*n>t.Ro?b.cc(a,t):(n=b.actualBounds,o=b.naturalBounds,0===n.width||0===n.height||isNaN(n.x)||isNaN(n.y)||!b.isVisible()||(t=b.transform,null!==b.areaBackground&&(la(b,a,b.areaBackground,!0,!0,o,n),a.fillRect(n.x,n.y,n.width,n.height)),null===b.areaBackground&&null===b.background&&(la(b,a,"rgba(0,0,0,0.3)",!0,!1,o,n),a.fillRect(n.x,n.y,n.width,n.height)),null!==b.background&&(a.transform(t.m11,t.m12,t.m21,t.m22,t.dx,t.dy),la(b,a,b.background,!0,!1,o,n),a.fillRect(0,0,o.width/2,o.height/2),t.St()||(b=1/(t.m11*t.m22-t.m12*t.m21),a.transform(t.m22*b,-t.m12*b,-t.m21*b,t.m11*b,b*(t.m21*t.dy-t.m22*t.dx),b*(t.m12*t.dx-t.m11*t.dy)))))),e&&(a.restore(),a.uc(!0))}},n.g=function(a,b,t,e,n){var o=this.diagram;null!==o&&o.bb(Fe,a,this,b,t,e,n)},n.nj=function(a,b,t){var e=this.Da;if(b.Di=this,a>=e.count)a=e.count;else if(e.J(a)===b)return-1;return e.wb(a,b),b.Iq(t),null!==(e=this.diagram)&&(t?e.M():e.nj(b)),Yo(this,a,b),a},n.Mc=function(a,b,t){if(!t&&b.layer!==this&&null!==b.layer)return b.layer.Mc(a,b,t);var e=this.Da;if(0>a||a>=e.length){if(0>(a=e.indexOf(b)))return-1}else if(e.J(a)!==b&&0>(a=e.indexOf(b)))return-1;return b.Jq(t),e.cb(a),null!==(e=this.diagram)&&(t?e.M():e.Mc(b)),b.Di=null,a},v.Object.defineProperties(li.prototype,{parts:{get:function(){return this.Da.iterator}},partsBackwards:{get:function(){return this.Da.iteratorBackwards}},diagram:{get:function(){return this.B}},name:{get:function(){return this.Qa},set:function(a){var b=this.Qa;if(b!==a){var t=this.diagram;if(null!==t)for(""===b&&N("Cannot rename default Layer to: "+a),t=t.layers;t.next();)t.value.name===a&&N("Layer.name is already present in this diagram: "+a);for(this.Qa=a,this.g("name",b,a),a=this.Da.iterator;a.next();)a.value.layerName=this.Qa}}},opacity:{get:function(){return this.hb},set:function(a){var b=this.hb;b!==a&&((0>a||1<a)&&T(a,"0 <= value <= 1",li,"opacity"),this.hb=a,this.g("opacity",b,a),null!==(a=this.diagram)&&a.M())}},isTemporary:{get:function(){return this.v},set:function(a){var b=this.v;b!==a&&(this.v=a,this.isInDocumentBounds=!1,this.g("isTemporary",b,a))}},visible:{get:function(){return this.I},set:function(a){var b=this.I;if(b!==a){for(this.I=a,this.g("visible",b,a),b=this.Da.iterator;b.next();)b.value.Pb(a);null!==(a=this.diagram)&&a.M()}}},pickable:{get:function(){return this.Ni},set:function(a){var b=this.Ni;b!==a&&(this.Ni=a,this.g("pickable",b,a))}},isInDocumentBounds:{get:function(){return this.l},set:function(a){this.l!==a&&(this.l=a,null!==this.diagram&&this.diagram.Oa())}},allowCopy:{get:function(){return this.Zh},set:function(a){var b=this.Zh;b!==a&&(this.Zh=a,this.g("allowCopy",b,a))}},allowDelete:{get:function(){return this.$h},set:function(a){var b=this.$h;b!==a&&(this.$h=a,this.g("allowDelete",b,a))}},allowTextEdit:{get:function(){return this.ii},set:function(a){var b=this.ii;b!==a&&(this.ii=a,this.g("allowTextEdit",b,a))}},allowGroup:{get:function(){return this.ai},set:function(a){var b=this.ai;b!==a&&(this.ai=a,this.g("allowGroup",b,a))}},allowUngroup:{get:function(){return this.ji},set:function(a){var b=this.ji;b!==a&&(this.ji=a,this.g("allowUngroup",b,a))}},allowLink:{get:function(){return this.bi},set:function(a){var b=this.bi;b!==a&&(this.bi=a,this.g("allowLink",b,a))}},allowRelink:{get:function(){return this.di},set:function(a){var b=this.di;b!==a&&(this.di=a,this.g("allowRelink",b,a))}},allowMove:{get:function(){return this.ci},set:function(a){var b=this.ci;b!==a&&(this.ci=a,this.g("allowMove",b,a))}},allowReshape:{get:function(){return this.ei},set:function(a){var b=this.ei;b!==a&&(this.ei=a,this.g("allowReshape",b,a))}},allowResize:{get:function(){return this.fi},set:function(a){var b=this.fi;b!==a&&(this.fi=a,this.g("allowResize",b,a))}},allowRotate:{get:function(){return this.gi},set:function(a){var b=this.gi;b!==a&&(this.gi=a,this.g("allowRotate",b,a))}},allowSelect:{get:function(){return this.hi},set:function(a){var b=this.hi;b!==a&&(this.hi=a,this.g("allowSelect",b,a))}}}),li.prototype.findObjectsNear=li.prototype.Fg,li.prototype.findObjectsIn=li.prototype.Bf,li.prototype.findObjectsAt=li.prototype.gj,li.prototype.findObjectAt=li.prototype.Vb,li.className="Layer",Xo.prototype.clear=function(){this.animationManager.Sc(),this.model.clear(),ls=null,us="",qo(this,!1),this.Oa(),this.Ta(),this.M()},Xo.prototype.reset=function(){this.clear(),this.Sb=!0,this.Wc=new po,this.Wc.ce(this),this.pb=17,this.Fl=this.nv=!1,this.Ss="default",this.La=new ut,this.Lx=new Mt,this.jf=null,this.xw(),this.Lj=null,this.ww(),this.hb=1,this.la=new St(NaN,NaN).freeze(),this.Ts=new St(NaN,NaN),this.Nn=this.ya=1,this.es=new St(NaN,NaN).freeze(),this.fs=NaN,this.xs=1e-4,this.vs=100,this.qb=new ee,this.vt=new St(NaN,NaN).freeze(),this.Zr=new Jt(NaN,NaN,NaN,NaN).freeze(),this.Ri=new ui(0,0,0,0).freeze(),this.Si=bs,this.at=!1,this.Us=this.Os=null,this.Pg=cs,this.Bj=Vi,this.$f=cs,this.oo=Vi,this.gs=this.ds=yi,this.Ec=!0,this.Dl=!1,this.vd=new ft,this.Wg=new Mt,this.pl=!0,this.nn=250,this.zj=-1,this.pn=new ui(16,16,16,16).freeze(),this.Fj=this.Ce=!1,this.Ij=!0,this.Yf=new Ae,this.Yf.diagram=this,this.pd=new Ae,this.pd.diagram=this,this.hh=new Ae,this.hh.diagram=this,this.ue=this.Qf=null,this.fk=!1,this.Pr=this.Qr=null,this.xj=w.PointerEvent&&(K||H||W)&&w.navigator&&!1!==w.navigator.msPointerEnabled,Wr(this),this.Ch=new ft,this.qs=!0,this.pt=ks,this.Ru=!1,this.rt=ps,this.Jr=this.Mr=this.nt=null,this.Mn=this.Hr="auto",this.ig=this.As=this.kg=this.lg=this.ng=this.Sf=this.Wf=this.Rf=null,this.cs=!1,this.Tf=this.xg=this.mg=this.jg=null,this.Bs=!1,this.Ms={},this.$j=[null,null],this.Br=null,this.Nr=this.et=this.pv=this.wg=!1,this.Yu=!0,this.wi=this.kc=!1,this.xv=!0,this.Ud=-2,this.Oi=new Mt,this.Ls=new ut,this.bg=!1,this.$h=this.Zh=this.nr=this.nd=!0,this.pr=!1,this.vr=this.tr=this.hi=this.gi=this.fi=this.ei=this.ci=this.di=this.bi=this.sr=this.ji=this.ai=this.ii=this.qr=!0,this.ag=this.Uu=!1,this.ur=this.rr=this.vl=this.ul=!0,this.$s=this.Ws=16,this.Vs=this.Ip=!1,this.Xs=this.Zs=0,this.ib=new ui(5).freeze(),this.ov=(new ft).freeze(),this.ws=999999999,this.Ou=(new ft).freeze(),this.vi=this.ui=this.ti=!0,this.Ze=this.ne=!1,this.lc=null,this.Og=!0,this.oe=!1,this.Bx=new ft,this.Pu=new ft,this.Hc=null,this.Ul=1,this.qv=0,this.Jc={scale:1,position:new St,bounds:new Jt,Ev:new Ut,iw:new Ut,fw:!1},this.Sx=new Jt(NaN,NaN,NaN,NaN).freeze(),this.pm=new Ut(NaN,NaN).freeze(),this.On=new Jt(NaN,NaN,NaN,NaN).freeze(),this.rs=!1,this.Fo=this.mo=this.ep=this.Cu=this.Bu=this.Du=this.dg=this.fh=this.ef=null,Ko(this),this.Jb=null,this.lo=!1,this.Cj=null,this.partManager=new _f,this.toolManager=new Ge,this.toolManager.initializeStandardTools(),this.currentTool=this.defaultTool=this.toolManager,this.Sr=null,this.il=new Ks,this.Gs=this.Fs=null,this.aq=!1,this.commandHandler=Uo(),this.wg=!0,Zo(this),this.layout=new wf,this.wg=!1,this.model=Ed(),this.model.undoManager=new Ee,this.oe=!1,this.Ij=!0,this.Ce=!1,this.Tb=1,this.xh=null,this.Ro=1,this.Xo=0,this.ev=[0,0,0,0,0],this.Yo=0,this.wd=1,this.Qj=0,this.Ao=new St,this.ot=500,this.on=new St,this.bq=this.qo=this.pe=!1,this.Yn=null,this.Zn=It,this.Sb=!1,this.M()},Xo.prototype.setRTL=function(a){null===(a=void 0===a?this.div:a)&&(a=w.document.body);var b=P("div");b.dir="rtl",b.style.cssText="font-size: 14px; width: 1px; height: 1px; position: absolute; top: -1000px; overflow: scroll;",b.textContent="A",a.appendChild(b);var t="reverse";0<b.scrollLeft?t="default":(b.scrollLeft=1,0===b.scrollLeft&&(t="negative")),a.removeChild(b),this.Ss=t},Xo.prototype.setScrollWidth=function(a){null===(a=void 0===a?this.div:a)&&(a=w.document.body);var b=0;if(hs){var t=as;b=ss,null===t&&((t=as=P("p")).style.width="100%",t.style.height="200px",t.style.boxSizing="content-box",(b=ss=P("div")).style.position="absolute",b.style.visibility="hidden",b.style.width="200px",b.style.height="150px",b.style.boxSizing="content-box",b.appendChild(t)),b.style.overflow="hidden",a.appendChild(b);var e=t.offsetWidth;b.style.overflow="scroll",e===(t=t.offsetWidth)&&(t=b.clientWidth),a.removeChild(b),0!==(b=e-t)||Z||(b=11)}this.pb=b,this.nv=!0},Xo.prototype.jb=function(a){a.classType===Xo&&(this.autoScale=a)},Xo.prototype.toString=function(a){void 0===a&&(a=0);var b="";if(this.div&&this.div.id&&(b=this.div.id),b='Diagram "'+b+'"',0>=a)return b;for(var t=this.La.iterator;t.next();)b+="\n  "+t.value.toString(a-1);return b},Xo.prototype.addEventListener=function(a,b,t,e){a.addEventListener(b,t,{capture:e,passive:!1})},Xo.prototype.removeEventListener=function(a,b,t,e){a.removeEventListener(b,t,{capture:e})},Xo.prototype.computePixelRatio=function(){return null!==this.xh?this.xh:w.devicePixelRatio||1},Xo.prototype.doMouseMove=function(){this.currentTool.doMouseMove()},Xo.prototype.doMouseDown=function(){this.currentTool.doMouseDown()},Xo.prototype.doMouseUp=function(){this.currentTool.doMouseUp()},Xo.prototype.doMouseWheel=function(){this.currentTool.doMouseWheel()},Xo.prototype.doKeyDown=function(){this.currentTool.doKeyDown()},Xo.prototype.doKeyUp=function(){this.currentTool.doKeyUp()},Xo.prototype.doFocus=function(){this.focus()},Xo.prototype.focus=function(){if(this.ta)if(this.scrollsPageOnFocus)this.ta.focus();else{var a=w.scrollX||w.pageXOffset,b=w.scrollY||w.pageYOffset;this.ta.focus(),w.scrollTo(a,b)}},Xo.prototype.Bz=function(){this.B.R("GainedFocus")},Xo.prototype.Az=function(){this.B.R("LostFocus")},Xo.prototype.jy=function(a){if(null!==this.ta){this.Ip=!0;var b=this.documentBounds,t=this.viewportBounds,e=this.Ri,n=b.x-e.left,o=b.y-e.top,g=b.width+e.left+e.right,r=b.height+e.top+e.bottom,h=b.right+e.right;e=b.bottom+e.bottom;var l=t.x;b=t.y;var c=t.width,f=t.height,p=t.right,d=t.bottom;t=this.scale;var q=a.scrollLeft;if(this.Fl)switch(this.Ss){case"negative":q=q+a.scrollWidth-a.clientWidth;break;case"reverse":q=a.scrollWidth-q-a.clientWidth}var u=q;c<g||f<r?(q=St.allocAt(this.position.x,this.position.y),this.allowHorizontalScroll&&this.Xs!==u&&(q.x=u/t+n,this.Xs=u),this.allowVerticalScroll&&this.Zs!==a.scrollTop&&(q.y=a.scrollTop/t+o,this.Zs=a.scrollTop),this.position=q,St.free(q),this.ui=this.Ip=!1):(q=St.alloc(),a.iz&&this.allowHorizontalScroll&&(n<l&&(this.position=q.h(u+n,this.position.y)),h>p&&(this.position=q.h(-(this.Ys.scrollWidth-this.va)+u-this.va/t+h,this.position.y))),a.jz&&this.allowVerticalScroll&&(o<b&&(this.position=q.h(this.position.x,a.scrollTop+o)),e>d&&(this.position=q.h(this.position.x,-(this.Ys.scrollHeight-this.ua)+a.scrollTop-this.ua/t+e))),St.free(q),Sr(this),this.ui=this.Ip=!1,b=this.documentBounds,t=this.viewportBounds,h=b.right,p=t.right,e=b.bottom,d=t.bottom,n=b.x,l=t.x,o=b.y,b=t.y,c>=g&&n>=l&&h<=p&&(this.Jp.style.width="1px"),f>=r&&o>=b&&e<=d&&(this.Jp.style.height="1px"))}},Xo.prototype.computeBounds=function(){return 0<this.vd.count&&mr(this),ir(this)},Xo.prototype.computePartsBounds=function(a,b){void 0===b&&(b=!1);var t=null;if(D(a))for(var e=0;e<a.length;e++){var n=a[e];!b&&n instanceof uc||(n.Ta(),null===t?t=n.actualBounds.copy():t.Tc(n.actualBounds))}else for(a=a.iterator;a.next();)e=a.value,!b&&e instanceof uc||(e.Ta(),null===t?t=e.actualBounds.copy():t.Tc(e.actualBounds));return null===t?new Jt(NaN,NaN,0,0):t},Xo.prototype.zoomToFit=function(){var a=this.Si;this.Si=bs,this.scale=nr(this,fs),a!==bs&&(er(this,!1),or(this,this.documentBounds,this.va/this.ya,this.ua/this.ya,this.Bj,!1)),this.Si=a},(n=Xo.prototype).jB=function(a,b){void 0===b&&(b=fs);var t=a.width,e=a.height;if(!(0===t||0===e||isNaN(t)&&isNaN(e))){var n=1;if(b===fs||b===ds)if(isNaN(t))n=this.viewportBounds.height*this.scale/e;else if(isNaN(e))n=this.viewportBounds.width*this.scale/t;else{n=this.va;var o=this.ua;n=b===ds?o/e>n/t?(o-(this.ne?this.pb:0))/e:(n-(this.Ze?this.pb:0))/t:Math.min(o/e,n/t)}this.scale=n,this.position=new St(a.x,a.y)}},n.uz=function(a,b){this.Ta();var t=this.documentBounds,e=this.viewportBounds;this.position=new St(t.x+(a.x*t.width+a.offsetX)-(b.x*e.width-b.offsetX),t.y+(a.y*t.height+a.offsetY)-(b.y*e.height-b.offsetY))},n.kA=function(a){if(a instanceof ea){this.Yn=a;var b=St.alloc();this.Zn=this.gr(a.da(yi,b)),St.free(b)}else this.Yn=null,this.Zn=It},n.xm=function(a,b){if(void 0===b&&(b=!0),b){if((a=rr(this,a,(function(a){return a.part}),(function(a){return a.canSelect()})))instanceof yu)return a}else if((a=rr(this,a,(function(a){return a.part})))instanceof yu)return a;return null},n.Vb=function(a,b,t){void 0===b&&(b=null),void 0===t&&(t=null),mr(this);for(var e=this.La.iteratorBackwards;e.next();){var n=e.value;if(n.visible&&null!==(n=n.Vb(a,b,t)))return n}return null},n.Zz=function(a,b,t){return void 0===b&&(b=!0),function(a,b,t,e,n){for(void 0===t&&(t=null),void 0===e&&(e=null),n instanceof ut||n instanceof ft||(n=new ft),mr(a),a=a.La.iteratorBackwards;a.next();){var o=a.value;o.visible&&!o.isTemporary&&o.gj(b,t,e,n)}return n}(this,a,(function(a){return a.part}),b?function(a){return a instanceof yu&&a.canSelect()}:null,t)},n.gj=function(a,b,t,e){void 0===b&&(b=null),void 0===t&&(t=null),e instanceof ut||e instanceof ft||(e=new ft),mr(this);for(var n=this.La.iteratorBackwards;n.next();){var o=n.value;o.visible&&o.gj(a,b,t,e)}return e},n.uy=function(a,b,t,e){return void 0===b&&(b=!1),void 0===t&&(t=!0),function(a,b,t,e,n){var o=null;for(void 0===o&&(o=null),void 0===t&&(t=null),void 0===e&&(e=!1),n instanceof ut||n instanceof ft||(n=new ft),mr(a),a=a.La.iteratorBackwards;a.next();){var g=a.value;g.visible&&!g.isTemporary&&g.Bf(b,o,t,e,n)}return n}(this,a,(function(a){return a instanceof yu&&(!t||a.canSelect())}),b,e)},n.Bf=function(a,b,t,e,n){void 0===b&&(b=null),void 0===t&&(t=null),void 0===e&&(e=!1),n instanceof ut||n instanceof ft||(n=new ft),mr(this);for(var o=this.La.iteratorBackwards;o.next();){var g=o.value;g.visible&&g.Bf(a,b,t,e,n)}return n},n.Tv=function(a,b,t,e,n,o){var g=new ft;mr(this);for(var r=this.La.iteratorBackwards;r.next();){var h=r.value;h.visible&&h.Tv(a,b,t,e,g,n,o)}return g},n.$z=function(a,b,t,e,n){return void 0===t&&(t=!0),void 0===e&&(e=!0),function(a,b,t,e,n,o){var g=null;void 0===g&&(g=null),void 0===e&&(e=null),void 0===n&&(n=!0),!1!==n&&!0!==n&&((n instanceof ut||n instanceof ft)&&(o=n),n=!0);for(o instanceof ut||o instanceof ft||(o=new ft),mr(a),a=a.La.iteratorBackwards;a.next();){var r=a.value;r.visible&&!r.isTemporary&&r.Fg(b,t,g,e,n,o)}return o}(this,a,b,(function(a){return a instanceof yu&&(!e||a.canSelect())}),t,n)},n.Fg=function(a,b,t,e,n,o){void 0===t&&(t=null),void 0===e&&(e=null),void 0===n&&(n=!0),!1!==n&&!0!==n&&((n instanceof ut||n instanceof ft)&&(o=n),n=!0),o instanceof ut||o instanceof ft||(o=new ft),mr(this);for(var g=this.La.iteratorBackwards;g.next();){var r=g.value;r.visible&&r.Fg(a,b,t,e,n,o)}return o},Xo.prototype.acceptEvent=function(a){return sr(this,a,a instanceof MouseEvent)},Xo.prototype.BA=function(a){var b=this.B;if(!this.B.isEnabled)return!1;var t=sr(b,a,!1);switch(t.key=String.fromCharCode(a.which),t.down=!0,a.which){case 8:t.key="Backspace";break;case 33:t.key="PageUp";break;case 34:t.key="PageDown";break;case 35:t.key="End";break;case 36:t.key="Home";break;case 37:t.key="Left";break;case 38:t.key="Up";break;case 39:t.key="Right";break;case 40:t.key="Down";break;case 45:t.key="Insert";break;case 46:t.key="Del";break;case 48:t.key="0";break;case 187:case 61:case 107:t.key="Add";break;case 189:case 173:case 109:t.key="Subtract";break;case 27:t.key="Esc"}return b.doKeyDown(),fr(t,a)},Xo.prototype.CA=function(a){var b=this.B;if(!b.isEnabled)return!1;var t=sr(b,a,!1);switch(t.key=String.fromCharCode(a.which),t.up=!0,a.which){case 8:t.key="Backspace";break;case 33:t.key="PageUp";break;case 34:t.key="PageDown";break;case 35:t.key="End";break;case 36:t.key="Home";break;case 37:t.key="Left";break;case 38:t.key="Up";break;case 39:t.key="Right";break;case 40:t.key="Down";break;case 45:t.key="Insert";break;case 46:t.key="Del"}return b.doKeyUp(),fr(t,a)},Xo.prototype.Oz=function(a){var b=this.B;if(!b.isEnabled)return!1;var t=sr(b,a,!0);return null!==b.mouseEnter&&b.mouseEnter(t),fr(t,a)},Xo.prototype.Pz=function(a){var b=this.B;if(!b.isEnabled)return!1;var t=sr(b,a,!0);return null!==b.mouseLeave&&b.mouseLeave(t),fr(t,a)},Xo.prototype.getMouse=function(a){var b=this.ta;if(null===b)return new St(0,0);var t=b.getBoundingClientRect();return b=a.clientX-this.va/t.width*t.left,a=a.clientY-this.ua/t.height*t.top,null!==this.qb?Tt(new St(b,a),this.qb):new St(b,a)},(n=Xo.prototype).Oa=function(){this.ti||(this.ti=!0,this.Eb(!0))},n.Le=function(){this.Sb||this.kc||(this.M(),Mr(this),Sr(this),this.Oa(),this.jd())},n.AA=function(){return this.Ce},n.Jz=function(a){void 0===a&&(a=null);var b=this.animationManager,t=b.isEnabled;b.Sc(),b.isEnabled=!1,yr(this),this.oe=!1,this.Ts=new St(NaN,NaN),b.isEnabled=t,this.kc=!0;var e=this;null!==a&&S((function(){e.kc=!1,th(b,"Model"),a()}),1)},n.Eb=function(a){if(void 0===a&&(a=!1),!0!==this.Ce&&!(this.Sb||!1===a&&this.kc)){this.Ce=!0;var b=this;w.requestAnimationFrame((function(){b.Ce&&b.jd()}))}},n.jd=function(){this.Ij&&!this.Ce||(this.Ij&&(this.Ij=!1),yr(this))},n.Vw=function(a,b){for(a.reset();a.next();){var t=a.value;!t.Oc()||t instanceof oc||(t.qj()?(t.measure(1/0,1/0),t.arrange()):b.add(t))}for(a.reset();a.next();)(t=a.value)instanceof oc&&t.isVisible()&&vr(this,t);for(a.reset();a.next();)(t=a.value)instanceof uc&&t.isVisible()&&(t.qj()?(t.measure(1/0,1/0),t.arrange()):b.add(t));for(a.reset();a.next();)(t=a.value)instanceof Eu&&t.isVisible()&&(t.qj()?(t.measure(1/0,1/0),t.arrange()):b.add(t))},n.Ld=function(a,b,t,e){if(this.vi||this.animationManager.isAnimating){void 0===e&&(e=t.viewportBounds);for(var n=0;n<b;n++)a[n].Ld(t,e)}},n.cc=function(a,b){if(void 0===b&&(b=null),null!==this.Ea){null===this.ta&&N("No canvas specified");var t=this.animationManager;if(!t.sc&&(!t.isAnimating||t.isTicking)){var e=new Date;if(Pr(this),"0"!==this.Ea.style.opacity){var n=a!==this.Hb,o=this.La.j,g=o.length,r=this;if(this.Ld(o,g,r),n)a.uc(!0),Sr(this);else if(!this.Ec&&null===b&&!t.isAnimating)return;g=this.la;var h=this.ya,l=Math.round(g.x*h)/h,c=Math.round(g.y*h)/h;for((t=this.qb).reset(),1!==h&&t.scale(h),0===g.x&&0===g.y||t.translate(-l,-c),h=this.Tb,a.setTransform(1,0,0,1,0,0),a.scale(h,h),a.clearRect(0,0,this.va,this.ua),1!==this.hb&&(a.globalAlpha=this.hb),wr(this,a),l=null!==b?function(t){var e=b;if(t.visible&&0!==t.hb){var n=t.Da.j,o=n.length;if(0!==o){var g=Go(t,a),h=t.lp;h.length=0;for(var l=r.scale,c=Jt.alloc(),f=0;f<o;f++){var d=n[f];e.contains(d)||t.cj(a,d,r,h,l,c,!0)}Jt.free(c),a.globalAlpha=g}}}:function(b){b.cc(a,r)},g=o.length,c=0;c<g;c++)a.setTransform(1,0,0,1,0,0),a.scale(h,h),a.transform(t.m11,t.m12,t.m21,t.m22,t.dx,t.dy),l(o[c]);if(o=!1,this.si?Ds(this.si,this)&&(o=this.Tr()):o=!0,o&&(ee.prototype.Gd=ee.prototype.ay),n?(this.Hb.uc(!0),Sr(this)):this.Ec=this.vi=!1,o=+new Date-+e,n=nt&&nt.ny,e=this.ev,n||null===this.xh){for(e[this.Yo]=o,this.Yo=(this.Yo+1)%e.length,t=o=0;t<e.length;t++)o+=e[t];this.Xo=o/e.length}if(1!==this.hb&&(a.globalAlpha=1),n)for(a.setTransform(1,0,0,1,0,0),n=0;n<e.length;n++)a.fillText(e[n].toString(),20,150+20*n)}}}},n.Ie=function(a){return this.jf[a]},n.Vy=function(a,b){"minDrawingLength"===a&&(this.Ro=b),this.jf[a]=b,this.Le()},n.xw=function(){this.jf=new et,this.jf.drawShadows=!0,this.jf.textGreeking=!0,this.jf.viewportOptimizations=!(Z||K||H),this.jf.temporaryPixelRatio=!0,this.jf.pictureRatioOptimization=!0,this.Ro=this.jf.minDrawingLength=1},n.zm=function(a){return this.Lj[a]},n.YA=function(a,b){this.Lj[a]=b},n.ww=function(){this.Lj=new et,this.Lj.extraTouchArea=10,this.Lj.extraTouchThreshold=10,this.Lj.hasGestureZoom=!0},n.Fw=function(a){kr(this,a)},n.Fv=function(){if(0===this.undoManager.transactionLevel&&0!==this.Wg.count){for(;0<this.Wg.count;){var a=this.Wg;for(this.Wg=new Mt,a=a.iterator;a.next();){var b=a.key;b.Lq(a.value),b.dc()}}this.M()}},n.M=function(a){if(void 0===a&&(a=null),null===a)this.Ec=!0,this.Eb();else{var b=this.viewportBounds;null!==a&&a.u()&&b.Nc(a)&&(this.Ec=!0,this.Eb())}this.R("InvalidateDraw")},n.Gy=function(a,b){if(!0!==this.Ec){this.Ec=!0;var t=!0===this.Ie("temporaryPixelRatio");if(!0===this.Ie("viewportOptimizations")&&this.scrollMode!==ws&&this.Ri.ej(0,0,0,0)&&b.width===a.width&&b.height===a.height){var e=this.scale,n=Math.max(a.x,b.x),o=Math.max(a.y,b.y);if(e=Jt.allocAt(n,o,Math.max(0,Math.min(a.x+a.width,b.x+b.width)-n)*e,Math.max(0,Math.min(a.y+a.height,b.y+b.height)-o)*e),!this.bq&&0<e.width&&0<e.height){if(!(this.kc||(this.Ce=!1,null===this.Ea||(this.kc=!0,this.Fv(),this.documentBounds.u()||Xr(this,this.computeBounds()),n=this.ta,null===n||n instanceof Fa)))){var g=this.Tb;o=this.va*g;var r=this.ua*g,h=this.scale*g,l=Math.round(Math.round(b.x*h)-Math.round(a.x*h));b=Math.round(Math.round(b.y*h)-Math.round(a.y*h)),h=this.Gu,a=this.ux,h.width!==o&&(h.width=o),h.height!==r&&(h.height=r),a.clearRect(0,0,o,r),h=190*g;var c=70*g,f=Math.max(l,0),p=Math.max(b,0),d=Math.floor(o-f),q=Math.floor(r-p);a.drawImage(n.Ga,f,p,d,q,0,0,d,q),Ds(this.si,this)&&a.clearRect(0,0,h,c),n=I(),a=I(),q=Math.abs(l),d=Math.abs(b);var u=0===f?0:o-q;f=St.allocAt(u,0),q=St.allocAt(q+u,r),a.push(new Jt(Math.min(f.x,q.x),Math.min(f.y,q.y),Math.abs(f.x-q.x),Math.abs(f.y-q.y)));var y=this.qb;if(y.reset(),y.scale(g,g),1!==this.ya&&y.scale(this.ya),(0!==(g=this.la).x||0!==g.y)&&isFinite(g.x)&&isFinite(g.y)&&y.translate(-g.x,-g.y),Tt(f,y),Tt(q,y),n.push(new Jt(Math.min(f.x,q.x),Math.min(f.y,q.y),Math.abs(f.x-q.x),Math.abs(f.y-q.y))),u=0===p?0:r-d,f.h(0,u),q.h(o,d+u),a.push(new Jt(Math.min(f.x,q.x),Math.min(f.y,q.y),Math.abs(f.x-q.x),Math.abs(f.y-q.y))),Tt(f,y),Tt(q,y),n.push(new Jt(Math.min(f.x,q.x),Math.min(f.y,q.y),Math.abs(f.x-q.x),Math.abs(f.y-q.y))),Ds(this.si,this)&&(o=0<l?0:-l,r=0<b?0:-b,f.h(o,r),q.h(h+o,c+r),a.push(new Jt(Math.min(f.x,q.x),Math.min(f.y,q.y),Math.abs(f.x-q.x),Math.abs(f.y-q.y))),Tt(f,y),Tt(q,y),n.push(new Jt(Math.min(f.x,q.x),Math.min(f.y,q.y),Math.abs(f.x-q.x),Math.abs(f.y-q.y)))),St.free(f),St.free(q),gr(this,!1,!0),null===this.Ea&&N("No div specified"),null===this.ta&&N("No canvas specified"),!this.animationManager.sc&&(o=this.Hb,this.Ec)){for(Pr(this),r=this.Tb,o.setTransform(1,0,0,1,0,0),o.clearRect(0,0,this.va*r,this.ua*r),o.drawImage(this.Gu.Ga,0<l?0:Math.round(-l),0<b?0:Math.round(-b)),l=this.la,g=this.ya,h=Math.round(l.x*g)/g,c=Math.round(l.y*g)/g,(b=this.qb).reset(),1!==g&&b.scale(g),0===l.x&&0===l.y||b.translate(-h,-c),o.save(),o.beginPath(),l=a.length,g=0;g<l;g++)0!==(h=a[g]).width&&0!==h.height&&o.rect(Math.floor(h.x),Math.floor(h.y),Math.ceil(h.width),Math.ceil(h.height));for(o.clip(),o.setTransform(1,0,0,1,0,0),o.scale(r,r),o.transform(b.m11,b.m12,b.m21,b.m22,b.dx,b.dy),l=(b=this.La.j).length,this.Ld(b,l,this),wr(this,o),o.globalAlpha=this.hb,r=0;r<l;r++)if(h=n,(g=b[r]).visible&&0!==g.hb){c=Go(g,o),(p=g.lp).length=0,f=this.scale,d=Jt.alloc(),y=(q=g.Da.j).length,u=h.length;for(var m=0;m<y;m++){var v=q[m],x=bu(v,v.actualBounds);t:{for(var w=2/f,k=4/f,M=0;M<u;M++){var S=h[M];if(0!==S.width&&0!==S.height&&x.aw(S.x-w,S.y-w,S.width+k,S.height+k)){x=!0;break t}}x=!1}x&&g.cj(o,v,this,p,f,d,!0)}Jt.free(d),o.globalAlpha=c}o.restore(),o.uc(!0),this.si&&Ds(this.si,this)&&this.Tr(),this.Ec=this.vi=!1,this.Xq()}R(n),R(a),this.kc=!1}}else this.jd();Jt.free(e),t&&(Ho(this),this.jd(),Wo(this,!0))}else t?(Ho(this),this.jd(),Wo(this,!0)):this.jd()}},n.add=function(a){var b=a.diagram;if(b!==this&&(null!==b&&N("Cannot add part "+a.toString()+" to "+this.toString()+". It is already a part of "+b.toString()),null===(b=this.wm(a.layerName))&&(b=this.wm("")),null===b&&N('Cannot add a Part when unable find a Layer named "'+a.layerName+'" and there is no default Layer'),a.layer!==b)){var t=b.nj(99999999,a,a.diagram===this);0<=t&&this.bb(Be,"parts",b,null,a,null,t),b.isTemporary||this.Oa(),a.C(1),null!==(t=a.layerChanged)&&t(a,null,b)}},n.nj=function(a){this.partManager.nj(a);var b=this;Vh(a,(function(a){Vr(b,a)})),(a instanceof Eu||a instanceof oc&&null!==a.placeholder)&&a.o(),null!==a.data&&Vh(a,(function(a){rd(b.partManager,a)})),!0!==Ma(a)&&!0!==Cu(a)||this.vd.add(a),Pu(a,!0,this),Bu(a)?(a.actualBounds.u()&&this.M(bu(a,a.actualBounds)),this.Oa()):a.isVisible()&&a.actualBounds.u()&&this.M(bu(a,a.actualBounds)),this.Eb()},n.Mc=function(a){a.lk(),this.partManager.Mc(a);var b=this;null!==a.data&&Vh(a,(function(a){sd(b.partManager,a,b)})),this.vd.remove(a),Bu(a)?(a.actualBounds.u()&&this.M(bu(a,a.actualBounds)),this.Oa()):a.isVisible()&&a.actualBounds.u()&&this.M(bu(a,a.actualBounds)),this.Eb()},n.remove=function(a){Tr(this,a,!0)},n.eu=function(a,b){if(void 0===b&&(b=!1),D(a))for(var t=a.length,e=0;e<t;e++){var n=a[e];b&&!n.canDelete()||this.remove(n)}else for((t=new ft).addAll(a),a=t.iterator;a.next();)t=a.value,b&&!t.canDelete()||this.remove(t)},n.rk=function(a,b,t){return void 0===t&&(t=!1),this.partManager.rk(a,b,t)},Xo.prototype.moveParts=function(a,b,t,e){if(void 0===t&&(t=!1),void 0===e&&(e=jr(this)),null!==this.toolManager){var n=new Mt;if(null!==a)if(D(a))for(var o=0;o<a.length;o++)Lr(this,n,a[o],t,e);else for(a=a.iterator;a.next();)Lr(this,n,a.value,t,e);else{for(a=this.parts;a.next();)Lr(this,n,a.value,t,e);for(a=this.nodes;a.next();)Lr(this,n,a.value,t,e);for(a=this.links;a.next();)Lr(this,n,a.value,t,e)}Ar(this,n,b,e,t)}},Xo.prototype.computeMove=function(a,b,t,e){if(void 0===e&&(e=new St),e.assign(b),null===a)return e;var n=b,o=t.isGridSnapEnabled;o&&(t.isGridSnapRealtime||this.lastInput.up)&&Dr(this,a,b,n=St.alloc(),t),t=null!==a.dragComputation?a.dragComputation(a,b,n):n;var g=a.minLocation,r=g.x;isNaN(r)&&(r=o?Math.round(1e3*a.location.x)/1e3:a.location.x),g=g.y,isNaN(g)&&(g=o?Math.round(1e3*a.location.y)/1e3:a.location.y);var h=a.maxLocation,l=h.x;return isNaN(l)&&(l=o?Math.round(1e3*a.location.x)/1e3:a.location.x),h=h.y,isNaN(h)&&(h=o?Math.round(1e3*a.location.y)/1e3:a.location.y),e.h(Math.max(r,Math.min(t.x,l)),Math.max(g,Math.min(t.y,h))),n!==b&&St.free(n),e},(n=Xo.prototype).Bd=function(a,b,t){if(void 0===t)return new Fs(Dt);var e=a.isGridSnapEnabled;return a.groupsSnapMembers||null===b.containingGroup||(e=!1),new Fs(e?new St(Math.round(1e3*t.x)/1e3,Math.round(1e3*t.y)/1e3):t.copy())},n.rm=function(a){Ir(this,a,null),a.ce(this);var b=this.La,t=b.count-1;if(!a.isTemporary)for(;0<=t&&b.J(t).isTemporary;)t--;b.wb(t+1,a),null!==this.bc&&this.bb(Be,"layers",this,null,a,null,t+1),this.M(),this.Oa()},n.Vx=function(a,b){Ir(this,a,b),a.ce(this);var t=this.La,e=t.indexOf(a);0<=e&&(t.remove(a),null!==this.bc&&this.bb(Ie,"layers",this,a,null,e,null));var n,o=t.count;for(n=0;n<o;n++)if(t.J(n)===b){t.wb(n,a);break}null!==this.bc&&this.bb(Be,"layers",this,null,a,null,n),this.M(),0>e&&this.Oa()},n.oz=function(a,b){Ir(this,a,b),a.ce(this);var t=this.La,e=t.indexOf(a);0<=e&&(t.remove(a),null!==this.bc&&this.bb(Ie,"layers",this,a,null,e,null));var n,o=t.count;for(n=0;n<o;n++)if(t.J(n)===b){t.wb(n+1,a);break}null!==this.bc&&this.bb(Be,"layers",this,null,a,null,n+1),this.M(),0>e&&this.Oa()},n.RA=function(a){if(a.diagram!==this&&N("Cannot remove a Layer from another Diagram: "+a+" of "+a.diagram),""!==a.name){var b=this.La,t=b.indexOf(a);if(b.remove(a)){for(b=a.Da.copy().iterator;b.next();){var e=b.value,n=e.layerName;n!==a.name?e.layerName=n:e.layerName=""}null!==this.bc&&this.bb(Ie,"layers",this,a,null,t,null),this.M(),this.Oa()}}},n.wm=function(a){for(var b=this.layers;b.next();){var t=b.value;if(t.name===a)return t}return null},n.Yx=function(a){null===this.ue&&(this.ue=new ut),this.ue.add(a),this.model.Gh(a)},n.TA=function(a){null!==this.ue&&(this.ue.remove(a),0===this.ue.count&&(this.ue=null)),this.model.Pk(a)},n.Gh=function(a){null===this.Qf&&(this.Qf=new ut),this.Qf.add(a)},n.Pk=function(a){null!==this.Qf&&(this.Qf.remove(a),0===this.Qf.count&&(this.Qf=null))},n.xt=function(a){if(this.skipsUndoManager||this.model.skipsUndoManager||this.model.undoManager.Zv(a),a.change!==Oe&&(this.isModified=!0),null!==this.Qf)for(var b=this.Qf,t=b.length,e=0;e<t;e++)b.J(e)(a)},n.bb=function(a,b,t,e,n,o,g){void 0===o&&(o=null),void 0===g&&(g=null);var r=new De;r.diagram=this,r.change=a,r.propertyName=b,r.object=t,r.oldValue=e,r.oldParam=o,r.newValue=n,r.newParam=g,this.xt(r)},n.g=function(a,b,t,e,n){this.bb(Fe,a,this,b,t,e,n)},Xo.prototype.changeState=function(a,b){if(null!==a&&a.diagram===this){var t=this.skipsModelSourceBindings;try{this.skipsModelSourceBindings=!0;var e=a.change;if(e===Fe){var n=a.object;if(Yd(n,a.propertyName,a.H(b)),n instanceof ea){var o=n.part;null!==o&&o.Mb()}this.isModified=!0}else if(e===Be){var g=a.object,r=a.newParam,h=a.newValue;if(g instanceof Fh){if("number"==typeof r&&h instanceof ea){b?g.Mc(r):g.wb(r,h);var l=g.part;null!==l&&l.Mb()}else if("number"==typeof r&&h instanceof al)if(b)h.isRow?g.uw(r):g.sw(r);else{var c=h.isRow?g.getRowDefinition(h.index):g.getColumnDefinition(h.index);c.Bt(h)}}else if(g instanceof li){var f=!0===a.oldParam;"number"==typeof r&&h instanceof yu&&(b?(h.isSelected=!1,h.isHighlighted=!1,h.Mb(),g.Mc(f?r:-1,h,f)):g.nj(r,h,f))}else g instanceof Xo?"number"==typeof r&&h instanceof li&&(b?this.La.cb(r):(h.ce(this),this.La.wb(r,h))):N("unknown ChangedEvent.Insert object: "+a.toString());this.isModified=!0}else if(e===Ie){var p=a.object,d=a.oldParam,q=a.oldValue;if(p instanceof Fh)"number"==typeof d&&q instanceof ea?b?p.wb(d,q):p.Mc(d):"number"==typeof d&&q instanceof al&&(b?(c=q.isRow?p.getRowDefinition(q.index):p.getColumnDefinition(q.index)).Bt(q):q.isRow?p.uw(d):p.sw(d));else if(p instanceof li){var u=!0===a.newParam;"number"==typeof d&&q instanceof yu&&(b?0>p.Da.indexOf(q)&&p.nj(d,q,u):(q.isSelected=!1,q.isHighlighted=!1,q.Mb(),p.Mc(u?d:-1,q,u)))}else p instanceof Xo?"number"==typeof d&&q instanceof li&&(b?(q.ce(this),this.La.wb(d,q)):this.La.cb(d)):N("unknown ChangedEvent.Remove object: "+a.toString());this.isModified=!0}else e!==Oe&&N("unknown ChangedEvent: "+a.toString())}finally{this.skipsModelSourceBindings=t}}},Xo.prototype.xa=function(a){return this.undoManager.xa(a)},Xo.prototype.Wa=function(a){return this.undoManager.Wa(a)},Xo.prototype.Kf=function(){return this.undoManager.Kf()},Xo.prototype.commit=function(a,b){void 0===b&&(b="");var t=this.skipsUndoManager;null===b&&(this.skipsUndoManager=!0,b=""),this.undoManager.xa(b);var e=!1;try{a(this),e=!0}finally{e?this.undoManager.Wa(b):this.undoManager.Kf(),this.skipsUndoManager=t}},Xo.prototype.updateAllTargetBindings=function(a){this.partManager.updateAllTargetBindings(a)},Xo.prototype.ir=function(){this.partManager.ir()},Xo.prototype.Tq=function(a,b,t,e){if(!a.w(b)){void 0===e&&(e=!1),e||Mr(this),Sr(this);var n=this.layout;null===n||!n.isViewportSized||this.autoScale!==cs||e||a.width===b.width&&a.height===b.height||n.C(),n=this.currentTool,!0===this.ag&&n instanceof Ge&&(this.lastInput.documentPoint=this.lu(this.lastInput.viewPoint),Ye(n,this)),this.Sb||this.Gy(a,b),Er(this),this.Jc.scale=t,this.Jc.position.x=a.x,this.Jc.position.y=a.y,this.Jc.bounds.assign(a),this.Jc.Ev.width=Math.round(a.width*t),this.Jc.Ev.height=Math.round(a.height*t),this.Jc.iw.width=this.va,this.Jc.iw.height=this.ua,this.Jc.fw=e,this.R("ViewportBoundsChanged",this.Jc,a),this.isVirtualized&&this.links.each((function(a){a.isAvoiding&&a.actualBounds.Nc(b)&&a.Ua()}))}},Xo.prototype.clearSelection=function(a){void 0===a&&(a=!1);var b=this.selection;if(0!==b.count){a||this.R("ChangingSelection",b);for(var t=b.ma(),e=t.length,n=0;n<e;n++)t[n].isSelected=!1;b.ea(),b.clear(),b.freeze(),a||this.R("ChangedSelection",b)}},Xo.prototype.select=function(a){null!==a&&a.layer.diagram===this&&(!a.isSelected||1<this.selection.count)&&(this.R("ChangingSelection",this.selection),this.clearSelection(!0),a.isSelected=!0,this.R("ChangedSelection",this.selection))},Xo.prototype.XA=function(a){if(this.R("ChangingSelection",this.selection),this.clearSelection(!0),D(a))for(var b=a.length,t=0;t<b;t++){var e=a[t];e instanceof yu||N("Diagram.selectCollection given something that is not a Part: "+e),e.isSelected=!0}else for(a=a.iterator;a.next();)(b=a.value)instanceof yu||N("Diagram.selectCollection given something that is not a Part: "+b),b.isSelected=!0;this.R("ChangedSelection",this.selection)},Xo.prototype.clearHighlighteds=function(){var a=this.highlighteds;if(0<a.count){for(var b=a.ma(),t=b.length,e=0;e<t;e++)b[e].isHighlighted=!1;a.ea(),a.clear(),a.freeze()}},(n=Xo.prototype).uA=function(a){null!==a&&a.layer.diagram===this&&(!a.isHighlighted||1<this.highlighteds.count)&&(this.clearHighlighteds(),a.isHighlighted=!0)},n.vA=function(a){a=(new ft).addAll(a);for(var b=this.highlighteds.copy().Yq(a).iterator;b.next();)b.value.isHighlighted=!1;for(a=a.iterator;a.next();)(b=a.value)instanceof yu||N("Diagram.highlightCollection given something that is not a Part: "+b),b.isHighlighted=!0},n.scroll=function(a,b,t){void 0===t&&(t=1);var e="up"===b||"down"===b,n=0;if("pixel"===a)n=t;else if("line"===a)n=t*(e?this.scrollVerticalLineChange:this.scrollHorizontalLineChange);else if("page"===a)a=e?this.viewportBounds.height:this.viewportBounds.width,0!==(a*=this.scale)&&(n=t*Math.max(a-(e?this.scrollVerticalLineChange:this.scrollHorizontalLineChange),0));else{if("document"===a)return n=this.documentBounds,t=this.viewportBounds,e=St.alloc(),"up"===b?this.position=e.h(t.x,n.y):"left"===b?this.position=e.h(n.x,t.y):"down"===b?this.position=e.h(t.x,n.bottom-t.height):"right"===b&&(this.position=e.h(n.right-t.width,t.y)),void St.free(e);N("scrolling unit must be 'pixel', 'line', 'page', or 'document', not: "+a)}n/=this.scale,t=this.position.copy(),"up"===b?t.y=this.position.y-n:"down"===b?t.y=this.position.y+n:"left"===b?t.x=this.position.x-n:"right"===b?t.x=this.position.x+n:N("scrolling direction must be 'up', 'down', 'left', or 'right', not: "+b),this.position=t},n.Aw=function(a){var b=this.viewportBounds;b.Ee(a)||((a=a.center).x-=b.width/2,a.y-=b.height/2,this.position=a)},n.yt=function(a){var b=this.viewportBounds;(a=a.center).x-=b.width/2,a.y-=b.height/2,this.position=a},n.gr=function(a){var b=this.qb;b.reset(),1!==this.ya&&b.scale(this.ya);var t=this.la;return(0!==t.x||0!==t.y)&&isFinite(t.x)&&isFinite(t.y)&&b.translate(-t.x,-t.y),a.copy().transform(this.qb)},n.fB=function(a){var b=this.qb,t=a.x,e=a.y,n=t+a.width,o=e+a.height,g=b.m11,r=b.m12,h=b.m21,l=b.m22,c=b.dx,f=b.dy,p=t*g+e*h+c;b=t*r+e*l+f;var d=n*g+e*h+c;return a=n*r+e*l+f,e=t*g+o*h+c,t=t*r+o*l+f,g=n*g+o*h+c,n=n*r+o*l+f,o=Math.min(p,d),p=Math.max(p,d),d=Math.min(b,a),b=Math.max(b,a),o=Math.min(o,e),p=Math.max(p,e),d=Math.min(d,t),b=Math.max(b,t),o=Math.min(o,g),p=Math.max(p,g),new Jt(o,d=Math.min(d,n),p-o,(b=Math.max(b,n))-d)},n.lu=function(a){var b=this.qb;b.reset(),1!==this.ya&&b.scale(this.ya);var t=this.la;return(0!==t.x||0!==t.y)&&isFinite(t.x)&&isFinite(t.y)&&b.translate(-t.x,-t.y),Tt(a.copy(),this.qb)},Xo.prototype.doModelChanged=function(a){var b=this;if(a.model===this.model){var t=a.change,e=a.propertyName;if(t===Oe&&"S"===e[0])if("StartingFirstTransaction"===e){var n=this;(a=this.toolManager).mouseDownTools.each((function(a){a.diagram=n})),a.mouseMoveTools.each((function(a){a.diagram=n})),a.mouseUpTools.each((function(a){a.diagram=n})),this.kc||this.oe||(this.Fj=!0,this.Ij&&(this.Ce=!0))}else"StartingUndo"===e||"StartingRedo"===e?((a=this.animationManager).defaultAnimation.isAnimating&&!this.skipsUndoManager&&a.Sc(),this.R("ChangingSelection",this.selection)):"StartedTransaction"===e&&((a=this.animationManager).defaultAnimation.isAnimating&&!this.skipsUndoManager&&a.Sc());else if(this.Z){this.Z=!1;try{if(""===a.modelChange&&t===Oe){"FinishedUndo"!==e&&"FinishedRedo"!==e||(this.R("ChangedSelection",this.selection),mr(this));var o=this.animationManager;"RolledBackTransaction"===e&&o.Sc(),this.Fj=!0,this.jd(),0!==this.undoManager.transactionLevel&&1!==this.undoManager.transactionLevel||yo(o),"CommittedTransaction"===e&&this.undoManager.isJustDiscarded&&(this.Ud=Math.min(this.Ud,this.undoManager.historyIndex-1)),"CommittedTransaction"!==e&&"RolledBackTransaction"!==e||!this.undoManager.isPendingUnmodified||setTimeout((function(){b.isModified=!1}),1);var g=a.isTransactionFinished;if(g&&(zr(this),this.Wt.clear(),function(a){for(a=a.Vk.iterator;a.next();)a.value.Hl=!1}(this.animationManager)),!this.Bs&&g&&this.lastInput.targetDiagram){this.Bs=!0;var r=this;S((function(){r.currentTool.standardMouseOver(),r.Bs=!1}),10)}}}finally{this.Z=!0}}}},Xo.prototype.Kd=function(){this.partManager.Kd()},Xo.prototype.hk=function(a,b){this.Wc.hk(a,b)},Xo.prototype.jk=function(a,b){this.Wc.jk(a,b)},Xo.prototype.findPartForKey=function(a){return this.partManager.findPartForKey(a)},Xo.prototype.Db=function(a){return this.partManager.Db(a)},Xo.prototype.findLinkForKey=function(a){return this.partManager.findLinkForKey(a)},(n=Xo.prototype).zc=function(a){return this.partManager.zc(a)},n.fj=function(a){return this.partManager.fj(a)},n.yc=function(a){return this.partManager.yc(a)},n.Ht=function(a){for(var b=[],t=0;t<arguments.length;++t)b[t]=arguments[t];return this.partManager.Ht.apply(this.partManager,b instanceof Array?b:h(r(b)))},n.Gt=function(a){for(var b=[],t=0;t<arguments.length;++t)b[t]=arguments[t];return this.partManager.Gt.apply(this.partManager,b instanceof Array?b:h(r(b)))},n.Ta=function(){this.ti&&Xr(this,this.computeBounds())},n.dA=function(){for(var a=new ft,b=this.nodes;b.next();){var t=b.value;t.isTopLevel&&a.add(t)}for(b=this.links;b.next();)(t=b.value).isTopLevel&&a.add(t);return a.iterator},n.cA=function(){return this.Ch.iterator},n.EA=function(a){mr(this),a&&qr(this,!0),this.Fj=!0,yr(this)},n.jA=function(){for(var a=new ut,b=this.nodes;b.next();){var t=b.value;t.isTopLevel&&null===t.ij()&&a.add(t)}return a.iterator},n.ik=function(a,b){null!==(a=Zr(this,a))&&a.add(b)},n.Jm=function(a,b){null!==(a=Zr(this,a))&&a.remove(b)},n.R=function(a,b,t){var e=Zr(this,a),n=new je;if(n.diagram=this,null!==(a=Jr(this,a))&&(n.name=a),void 0!==b&&(n.subject=b),void 0!==t&&(n.parameter=t),1===(b=e.length))e.J(0)(n);else if(0!==b)for(e=e.ma(),t=0;t<b;t++)(0,e[t])(n)},n.Ak=function(a,b){return void 0===b&&(b=null),Qr(this,!1,null,b).Ak(a.x,a.y,a.width,a.height)},Xo.prototype.computeOccupiedArea=function(){return this.isVirtualized?this.viewportBounds.copy():this.ti?ir(this):this.documentBounds.copy()},Xo.prototype.Dt=function(a){this.on.assign(a),this.computeAutoScrollPosition(this.on).Na(this.position)?this.Lf():is(this)},Xo.prototype.Lf=function(){-1!==this.zj&&(w.clearTimeout(this.zj),this.zj=-1)},Xo.prototype.computeAutoScrollPosition=function(a){var b=this.position,t=this.pn;if(0>=t.top&&0>=t.left&&0>=t.right&&0>=t.bottom)return b;var e=this.viewportBounds,n=this.scale;e=Jt.allocAt(0,0,e.width*n,e.height*n);var o=St.allocAt(0,0);if(a.x>=e.x&&a.x<e.x+t.left&&this.allowHorizontalScroll){var g=Math.max(this.scrollHorizontalLineChange,1);g|=0,o.x-=g,a.x<e.x+t.left/2&&(o.x-=g),a.x<e.x+t.left/4&&(o.x-=4*g)}else a.x<=e.x+e.width&&a.x>e.x+e.width-t.right&&this.allowHorizontalScroll&&(g=Math.max(this.scrollHorizontalLineChange,1),g|=0,o.x+=g,a.x>e.x+e.width-t.right/2&&(o.x+=g),a.x>e.x+e.width-t.right/4&&(o.x+=4*g));return a.y>=e.y&&a.y<e.y+t.top&&this.allowVerticalScroll?(g=Math.max(this.scrollVerticalLineChange,1),g|=0,o.y-=g,a.y<e.y+t.top/2&&(o.y-=g),a.y<e.y+t.top/4&&(o.y-=4*g)):a.y<=e.y+e.height&&a.y>e.y+e.height-t.bottom&&this.allowVerticalScroll&&(g=Math.max(this.scrollVerticalLineChange,1),g|=0,o.y+=g,a.y>e.y+e.height-t.bottom/2&&(o.y+=g),a.y>e.y+e.height-t.bottom/4&&(o.y+=4*g)),o.Na(Dt)||(b=new St(b.x+o.x/n,b.y+o.y/n)),Jt.free(e),St.free(o),b},(n=Xo.prototype).Yt=function(){return null},n.gw=function(){return null},n.rz=function(a,b){this.Lx.add(a,b)},n.GA=function(a){return hs?(void 0===a&&(a=new et),a.returnType="Image",this.Jy(a)):null},n.Jy=function(a){return void 0===a&&(a=new et),es(this,this.HA,a)},n.HA=function(a,b,t){var e=ns(t,a,"canvas",null);if(null===e)return null;var n=null;if(null!==(t=e.Y.canvas))switch(n=a.returnType,n=void 0===n?"string":n.toLowerCase(),n){case Cs+"data":n=e.getImageData(0,0,t.width,t.height);break;case Cs:(e=(a.document||document).createElement("img")).src=t.toDataURL(a.type,a.details),n=e;break;case"blob":return"function"!=typeof b&&N('Error: Diagram.makeImageData called with "returnType: toBlob", but no required "callback" function property defined.'),"function"==typeof t.toBlob?(t.toBlob(b,a.type,a.details),"toBlob"):"function"==typeof t.msToBlob?(b(t.msToBlob()),"msToBlob"):(b(null),null);default:n=t.toDataURL(a.type,a.details)}return"function"==typeof b?(b(n),null):n},v.Object.defineProperties(Xo.prototype,{div:{get:function(){return this.Ea},set:function(a){if(this.Ea!==a){Q=[];var b=this.Ea;null!==b?(b.B=void 0,b.goDiagram=void 0,b.innerHTML="",null!==this.ta&&(b=this.ta.Ga,this.xj?(this.removeEventListener(b,"pointermove",this.Lk,!1),this.removeEventListener(b,"pointerdown",this.Kk,!1),this.removeEventListener(b,"pointerup",this.Nk,!1),this.removeEventListener(b,"pointerout",this.Mk,!1)):(this.removeEventListener(b,"touchstart",this.Ow,!1),this.removeEventListener(b,"touchmove",this.Nw,!1),this.removeEventListener(b,"touchend",this.Mw,!1)),this.ta.ly()),this.Xl&&(this.Xl.disconnect(),this.Xl=null),null!==(b=this.toolManager)&&(b.mouseDownTools.each((function(a){a.cancelWaitAfter()})),b.mouseMoveTools.each((function(a){a.cancelWaitAfter()})),b.mouseUpTools.each((function(a){a.cancelWaitAfter()}))),b.cancelWaitAfter(),this.currentTool.doCancel(),this.Hb=this.ta=null,this.removeEventListener(w,"resize",this.Ww,!1),this.xj||(this.removeEventListener(w,"mousemove",this.Ek,!0),this.removeEventListener(w,"mousedown",this.Dk,!0),this.removeEventListener(w,"mouseup",this.Gk,!0),this.removeEventListener(w,"mouseout",this.Fk,!0)),this.removeEventListener(w,"wheel",this.Hk,!0),os===this&&(os=null)):this.oe=!1,this.Ea=null,null!==a&&((b=a.B)&&(b.div=null),Os(this,a),this.Le())}}},$x:{get:function(){return this.Xo}},oj:{get:function(){return this.oe}},draggedLink:{get:function(){return this.Sr},set:function(a){this.Sr!==a&&(this.Sr=a,null!==a&&(this.Fs=a.fromPort,this.Gs=a.toPort))}},My:{get:function(){return this.Fs},set:function(a){this.Fs=a}},Ny:{get:function(){return this.Gs},set:function(a){this.Gs=a}},animationManager:{get:function(){return this.Wc}},undoManager:{get:function(){return this.bc.undoManager}},skipsUndoManager:{get:function(){return this.wg},set:function(a){this.wg=a,this.bc.skipsUndoManager=a}},delaysLayout:{get:function(){return this.Nr},set:function(a){this.Nr=a}},opacity:{get:function(){return this.hb},set:function(a){var b=this.hb;b!==a&&((0>a||1<a)&&T(a,"0 <= value <= 1",Xo,"opacity"),this.hb=a,this.g("opacity",b,a),this.M())}},validCycle:{get:function(){return this.rt},set:function(a){var b=this.rt;b!==a&&(this.rt=a,this.g("validCycle",b,a))}},layers:{get:function(){return this.La.iterator}},isModelReadOnly:{get:function(){var a=this.bc;return null!==a&&a.isReadOnly},set:function(a){var b=this.bc;null!==b&&(b.isReadOnly=a)}},isReadOnly:{get:function(){return this.bg},set:function(a){var b=this.bg;b!==a&&(this.bg=a,this.g("isReadOnly",b,a))}},isEnabled:{get:function(){return this.nd},set:function(a){var b=this.nd;b!==a&&(this.nd=a,this.g("isEnabled",b,a))}},allowClipboard:{get:function(){return this.nr},set:function(a){var b=this.nr;b!==a&&(this.nr=a,this.g("allowClipboard",b,a))}},allowCopy:{get:function(){return this.Zh},set:function(a){var b=this.Zh;b!==a&&(this.Zh=a,this.g("allowCopy",b,a))}},allowDelete:{get:function(){return this.$h},set:function(a){var b=this.$h;b!==a&&(this.$h=a,this.g("allowDelete",b,a))}},allowDragOut:{get:function(){return this.pr},set:function(a){var b=this.pr;b!==a&&(this.pr=a,this.g("allowDragOut",b,a))}},allowDrop:{get:function(){return this.qr},set:function(a){var b=this.qr;b!==a&&(this.qr=a,this.g("allowDrop",b,a))}},allowTextEdit:{get:function(){return this.ii},set:function(a){var b=this.ii;b!==a&&(this.ii=a,this.g("allowTextEdit",b,a))}},allowGroup:{get:function(){return this.ai},set:function(a){var b=this.ai;b!==a&&(this.ai=a,this.g("allowGroup",b,a))}},allowUngroup:{get:function(){return this.ji},set:function(a){var b=this.ji;b!==a&&(this.ji=a,this.g("allowUngroup",b,a))}},allowInsert:{get:function(){return this.sr},set:function(a){var b=this.sr;b!==a&&(this.sr=a,this.g("allowInsert",b,a))}},allowLink:{get:function(){return this.bi},set:function(a){var b=this.bi;b!==a&&(this.bi=a,this.g("allowLink",b,a))}},allowRelink:{get:function(){return this.di},set:function(a){var b=this.di;b!==a&&(this.di=a,this.g("allowRelink",b,a))}},allowMove:{get:function(){return this.ci},set:function(a){var b=this.ci;b!==a&&(this.ci=a,this.g("allowMove",b,a))}},allowReshape:{get:function(){return this.ei},set:function(a){var b=this.ei;b!==a&&(this.ei=a,this.g("allowReshape",b,a))}},allowResize:{get:function(){return this.fi},set:function(a){var b=this.fi;b!==a&&(this.fi=a,this.g("allowResize",b,a))}},allowRotate:{get:function(){return this.gi},set:function(a){var b=this.gi;b!==a&&(this.gi=a,this.g("allowRotate",b,a))}},allowSelect:{get:function(){return this.hi},set:function(a){var b=this.hi;b!==a&&(this.hi=a,this.g("allowSelect",b,a))}},allowUndo:{get:function(){return this.tr},set:function(a){var b=this.tr;b!==a&&(this.tr=a,this.g("allowUndo",b,a))}},allowZoom:{get:function(){return this.vr},set:function(a){var b=this.vr;b!==a&&(this.vr=a,this.g("allowZoom",b,a))}},hasVerticalScrollbar:{get:function(){return this.vl},set:function(a){var b=this.vl;b!==a&&(this.vl=a,Mr(this),this.M(),this.g("hasVerticalScrollbar",b,a),er(this,!1))}},hasHorizontalScrollbar:{get:function(){return this.ul},set:function(a){var b=this.ul;b!==a&&(this.ul=a,Mr(this),this.M(),this.g("hasHorizontalScrollbar",b,a),er(this,!1))}},allowHorizontalScroll:{get:function(){return this.rr},set:function(a){var b=this.rr;b!==a&&(this.rr=a,this.g("allowHorizontalScroll",b,a),er(this,!1))}},allowVerticalScroll:{get:function(){return this.ur},set:function(a){var b=this.ur;b!==a&&(this.ur=a,this.g("allowVerticalScroll",b,a),er(this,!1))}},scrollHorizontalLineChange:{get:function(){return this.Ws},set:function(a){var b=this.Ws;b!==a&&(0>a&&T(a,">= 0",Xo,"scrollHorizontalLineChange"),this.Ws=a,this.g("scrollHorizontalLineChange",b,a))}},scrollVerticalLineChange:{get:function(){return this.$s},set:function(a){var b=this.$s;b!==a&&(0>a&&T(a,">= 0",Xo,"scrollVerticalLineChange"),this.$s=a,this.g("scrollVerticalLineChange",b,a))}},lastInput:{get:function(){return this.hh},set:function(a){this.hh=a}},previousInput:{get:function(){return this.pd},set:function(a){this.pd=a}},firstInput:{get:function(){return this.Yf},set:function(a){this.Yf=a}},currentCursor:{get:function(){return this.Hr},set:function(a){if(""===a&&(a=this.Mn),this.Hr!==a){var b=this.ta,t=this.Ea;if(null!==b){this.Hr=a;var e=b.style.cursor;b.style.cursor=a,t.style.cursor=a,b.style.cursor===e&&(b.style.cursor="-webkit-"+a,t.style.cursor="-webkit-"+a,b.style.cursor===e&&(b.style.cursor="-moz-"+a,t.style.cursor="-moz-"+a,b.style.cursor===e&&(b.style.cursor=a,t.style.cursor=a)))}}}},defaultCursor:{get:function(){return this.Mn},set:function(a){""===a&&(a="auto");var b=this.Mn;b!==a&&(this.Mn=a,this.g("defaultCursor",b,a))}},click:{get:function(){return this.Rf},set:function(a){var b=this.Rf;b!==a&&(this.Rf=a,this.g("click",b,a))}},doubleClick:{get:function(){return this.Wf},set:function(a){var b=this.Wf;b!==a&&(this.Wf=a,this.g("doubleClick",b,a))}},contextClick:{get:function(){return this.Sf},set:function(a){var b=this.Sf;b!==a&&(this.Sf=a,this.g("contextClick",b,a))}},mouseOver:{get:function(){return this.ng},set:function(a){var b=this.ng;b!==a&&(this.ng=a,this.g("mouseOver",b,a))}},mouseHover:{get:function(){return this.lg},set:function(a){var b=this.lg;b!==a&&(this.lg=a,this.g("mouseHover",b,a))}},mouseHold:{get:function(){return this.kg},set:function(a){var b=this.kg;b!==a&&(this.kg=a,this.g("mouseHold",b,a))}},mouseDragOver:{get:function(){return this.As},set:function(a){var b=this.As;b!==a&&(this.As=a,this.g("mouseDragOver",b,a))}},mouseDrop:{get:function(){return this.ig},set:function(a){var b=this.ig;b!==a&&(this.ig=a,this.g("mouseDrop",b,a))}},handlesDragDropForTopLevelParts:{get:function(){return this.cs},set:function(a){var b=this.cs;b!==a&&(this.cs=a,this.g("handlesDragDropForTopLevelParts",b,a))}},mouseEnter:{get:function(){return this.jg},set:function(a){var b=this.jg;b!==a&&(this.jg=a,this.g("mouseEnter",b,a))}},mouseLeave:{get:function(){return this.mg},set:function(a){var b=this.mg;b!==a&&(this.mg=a,this.g("mouseLeave",b,a))}},toolTip:{get:function(){return this.xg},set:function(a){var b=this.xg;b!==a&&(this.xg=a,this.g("toolTip",b,a))}},contextMenu:{get:function(){return this.Tf},set:function(a){var b=this.Tf;b!==a&&(this.Tf=a,this.g("contextMenu",b,a))}},commandHandler:{get:function(){return this.Br},set:function(a){this.Br!==a&&(this.Br=a,a.ce(this))}},toolManager:{get:function(){return this.nt},set:function(a){this.nt!==a&&(this.nt=a,a.diagram=this)}},defaultTool:{get:function(){return this.Mr},set:function(a){var b=this.Mr;b!==a&&(this.Mr=a,a.diagram=this,this.currentTool===b&&(this.currentTool=a))}},currentTool:{get:function(){return this.Jr},set:function(a){var b=this.Jr;null!==b&&(b.isActive&&b.doDeactivate(),b.cancelWaitAfter(),b.doStop()),null===a&&(a=this.defaultTool),null!==a&&(this.Jr=a,a.diagram=this,a.doStart())}},selection:{get:function(){return this.ov}},maxSelectionCount:{get:function(){return this.ws},set:function(a){var b=this.ws;if(b!==a)if(0<=a&&!isNaN(a)){if(this.ws=a,this.g("maxSelectionCount",b,a),!this.undoManager.isUndoingRedoing&&0<(a=this.selection.count-a)){this.R("ChangingSelection",this.selection),b=this.selection.ma();for(var t=0;t<a;t++)b[t].isSelected=!1;this.R("ChangedSelection",this.selection)}}else T(a,">= 0",Xo,"maxSelectionCount")}},nodeSelectionAdornmentTemplate:{get:function(){return this.ep},set:function(a){var b=this.ep;b!==a&&(this.ep=a,this.g("nodeSelectionAdornmentTemplate",b,a))}},groupSelectionAdornmentTemplate:{get:function(){return this.mo},set:function(a){var b=this.mo;b!==a&&(this.mo=a,this.g("groupSelectionAdornmentTemplate",b,a))}},linkSelectionAdornmentTemplate:{get:function(){return this.Fo},set:function(a){var b=this.Fo;b!==a&&(this.Fo=a,this.g("linkSelectionAdornmentTemplate",b,a))}},highlighteds:{get:function(){return this.Ou}},isModified:{get:function(){var a=this.undoManager;return a.isEnabled?null!==a.currentTransaction||this.qo&&this.Ud!==a.historyIndex:this.qo},set:function(a){if(this.qo!==a){this.qo=a;var b=this.undoManager;!a&&b.isEnabled&&(this.Ud=b.historyIndex),a||zr(this)}}},model:{get:function(){return this.bc},set:function(a){var b=this.bc;if(b!==a){this.currentTool.doCancel(),null!==b&&b.undoManager!==a.undoManager&&b.undoManager.isInTransaction&&N("Do not replace a Diagram.model while a transaction is in progress."),this.animationManager.Sc(!0);var t=qo(this,!0);this.oe=!1,this.Ij=!0,this.Ud=-2,this.Ce=!1;var e=this.kc;this.kc=!0,th(this.animationManager,"Model"),null!==b&&(null!==this.ue&&this.ue.each((function(a){b.Pk(a)})),b.Pk(this.Vc)),this.bc=a,this.partManager=function(a){return null!==(a=rs.get(a))?new a:new _f}(this.bc.type);for(var n=0;n<t.length;n++)this.add(t[n]);a.Gh(this.Cc),this.partManager.addAllModeledParts(),a.Pk(this.Cc),a.Gh(this.Vc),null!==this.ue&&this.ue.each((function(b){a.Gh(b)})),this.kc=e,this.Sb||this.M(),null!==b&&a.undoManager.copyProperties(b.undoManager)}}},Z:{get:function(){return this.Yu},set:function(a){this.Yu=a}},Wt:{get:function(){return this.Bx}},skipsModelSourceBindings:{get:function(){return this.pv},set:function(a){this.pv=a}},ku:{get:function(){return this.et},set:function(a){this.et=a}},nodeTemplate:{get:function(){return this.ef.H("")},set:function(a){var b=this.ef.H("");b!==a&&(this.ef.add("",a),this.g("nodeTemplate",b,a),this.undoManager.isUndoingRedoing||this.Kd())}},nodeTemplateMap:{get:function(){return this.ef},set:function(a){var b=this.ef;b!==a&&(this.ef=a,this.g("nodeTemplateMap",b,a),this.undoManager.isUndoingRedoing||this.Kd())}},groupTemplate:{get:function(){return this.fh.H("")},set:function(a){var b=this.fh.H("");b!==a&&(this.fh.add("",a),this.g("groupTemplate",b,a),this.undoManager.isUndoingRedoing||this.Kd())}},groupTemplateMap:{get:function(){return this.fh},set:function(a){var b=this.fh;b!==a&&(this.fh=a,this.g("groupTemplateMap",b,a),this.undoManager.isUndoingRedoing||this.Kd())}},linkTemplate:{get:function(){return this.dg.H("")},set:function(a){var b=this.dg.H("");b!==a&&(this.dg.add("",a),this.g("linkTemplate",b,a),this.undoManager.isUndoingRedoing||this.Kd())}},linkTemplateMap:{get:function(){return this.dg},set:function(a){var b=this.dg;b!==a&&(this.dg=a,this.g("linkTemplateMap",b,a),this.undoManager.isUndoingRedoing||this.Kd())}},isMouseCaptured:{get:function(){return this.Uu},set:function(a){var b=this.ta;null!==b&&((b=b.Ga)instanceof SVGElement||(a?(this.lastInput.bubbles=!1,this.xj?(this.removeEventListener(b,"pointermove",this.Lk,!1),this.removeEventListener(b,"pointerdown",this.Kk,!1),this.removeEventListener(b,"pointerup",this.Nk,!1),this.removeEventListener(b,"pointerout",this.Mk,!1),this.addEventListener(w,"pointermove",this.Lk,!0),this.addEventListener(w,"pointerdown",this.Kk,!0),this.addEventListener(w,"pointerup",this.Nk,!0),this.addEventListener(w,"pointerout",this.Mk,!0)):(this.removeEventListener(b,"mousemove",this.Ek,!1),this.removeEventListener(b,"mousedown",this.Dk,!1),this.removeEventListener(b,"mouseup",this.Gk,!1),this.removeEventListener(b,"mouseout",this.Fk,!1),this.addEventListener(w,"mousemove",this.Ek,!0),this.addEventListener(w,"mousedown",this.Dk,!0),this.addEventListener(w,"mouseup",this.Gk,!0),this.addEventListener(w,"mouseout",this.Fk,!0)),this.removeEventListener(b,"wheel",this.Hk,!1),this.addEventListener(w,"wheel",this.Hk,!0),this.addEventListener(w,"selectstart",this.preventDefault,!1)):(this.xj?(this.removeEventListener(w,"pointermove",this.Lk,!0),this.removeEventListener(w,"pointerdown",this.Kk,!0),this.removeEventListener(w,"pointerup",this.Nk,!0),this.removeEventListener(w,"pointerout",this.Mk,!0),this.addEventListener(b,"pointermove",this.Lk,!1),this.addEventListener(b,"pointerdown",this.Kk,!1),this.addEventListener(b,"pointerup",this.Nk,!1),this.addEventListener(b,"pointerout",this.Mk,!1)):(this.removeEventListener(w,"mousemove",this.Ek,!0),this.removeEventListener(w,"mousedown",this.Dk,!0),this.removeEventListener(w,"mouseup",this.Gk,!0),this.removeEventListener(w,"mouseout",this.Fk,!0),this.addEventListener(b,"mousemove",this.Ek,!1),this.addEventListener(b,"mousedown",this.Dk,!1),this.addEventListener(b,"mouseup",this.Gk,!1),this.addEventListener(b,"mouseout",this.Fk,!1)),this.removeEventListener(w,"wheel",this.Hk,!0),this.removeEventListener(w,"selectstart",this.preventDefault,!1),this.addEventListener(b,"wheel",this.Hk,!1)),this.Uu=a))}},position:{get:function(){return this.la},set:function(a){var b=St.alloc().assign(this.la);if(!b.w(a)){var t=this.viewportBounds.copy();this.la.assign(a),bo(this.animationManager,b,this.la),this.Sb||null===this.ta&&!this.pm.u()||(this.Sb=!0,a=this.scale,or(this,this.On,this.va/a,this.ua/a,this.Bj,!1),this.Sb=!1),this.Sb||this.Tq(t,this.viewportBounds,this.ya,!1)}St.free(b)}},initialPosition:{get:function(){return this.es},set:function(a){this.es.w(a)||(this.es=a.G())}},initialScale:{get:function(){return this.fs},set:function(a){this.fs!==a&&(this.fs=a)}},grid:{get:function(){return null===this.Jb&&$o(this),this.Jb},set:function(a){var b=this.Jb;if(b!==a){null===b&&($o(this),b=this.Jb),a.type!==Fh.Grid&&N("Diagram.grid must be a Panel of type Panel.Grid");var t=b.panel;null!==t&&t.remove(b),this.Jb=a,a.name="GRID",null!==t&&t.add(a),Er(this),this.M(),this.g("grid",b,a)}}},viewportBounds:{get:function(){var a=this.Sx,b=this.la,t=this.ya;return null===this.ta?(this.pm.u()&&a.h(b.x,b.y,this.va/t,this.ua/t),a):(a.h(b.x,b.y,Math.max(this.va,0)/t,Math.max(this.ua,0)/t),a)}},viewSize:{get:function(){return this.pm},set:function(a){var b=this.viewSize;b.w(a)||(this.pm=a=a.G(),this.va=a.width,this.ua=a.height,this.Oa(),this.g("viewSize",b,a))}},fixedBounds:{get:function(){return this.Zr},set:function(a){var b=this.Zr;b.w(a)||(-1/0!==a.width&&1/0!==a.height&&-1/0!==a.height||N("fixedBounds width/height must not be Infinity"),this.Zr=a=a.G(),this.Oa(),this.g("fixedBounds",b,a))}},scrollMargin:{get:function(){return this.Ri},set:function(a){"number"==typeof a&&(a=new ui(a));var b=this.Ri;b.w(a)||(this.Ri=a=a.G(),this.g("scrollMargin",b,a),this.Xq())}},scrollMode:{get:function(){return this.Si},set:function(a){var b=this.Si;b!==a&&(this.Si=a,a===bs&&er(this,!1),this.g("scrollMode",b,a),this.M())}},scrollsPageOnFocus:{get:function(){return this.at},set:function(a){var b=this.at;b!==a&&(this.at=a,this.g("scrollsPageOnFocus",b,a))}},positionComputation:{get:function(){return this.Os},set:function(a){var b=this.Os;b!==a&&(this.Os=a,er(this,!1),this.g("positionComputation",b,a))}},scaleComputation:{get:function(){return this.Us},set:function(a){var b=this.Us;b!==a&&(this.Us=a,Rr(this,this.scale,this.scale),this.g("scaleComputation",b,a))}},documentBounds:{get:function(){return this.On}},isVirtualized:{get:function(){return this.rs},set:function(a){var b=this.rs;b!==a&&(this.rs=a,this.g("isVirtualized",b,a))}},scale:{get:function(){return this.ya},set:function(a){var b=this.ya;b!==a&&Rr(this,b,a)}},defaultScale:{get:function(){return this.Nn},set:function(a){this.Nn=a}},autoScale:{get:function(){return this.Pg},set:function(a){var b=this.Pg;b!==a&&(this.Pg=a,this.g("autoScale",b,a),a!==cs&&er(this,!1))}},initialAutoScale:{get:function(){return this.$f},set:function(a){var b=this.$f;b!==a&&(this.$f=a,this.g("initialAutoScale",b,a))}},initialViewportSpot:{get:function(){return this.gs},set:function(a){var b=this.gs;b!==a&&(a.kb()||N("initialViewportSpot must be a specific Spot: "+a),this.gs=a,this.g("initialViewportSpot",b,a))}},initialDocumentSpot:{get:function(){return this.ds},set:function(a){var b=this.ds;b!==a&&(a.kb()||N("initialViewportSpot must be a specific Spot: "+a),this.ds=a,this.g("initialDocumentSpot",b,a))}},minScale:{get:function(){return this.xs},set:function(a){var b=this.xs;b!==a&&(0<a?(this.xs=a,this.g("minScale",b,a),a>this.scale&&(this.scale=a)):T(a,"> 0",Xo,"minScale"))}},maxScale:{get:function(){return this.vs},set:function(a){var b=this.vs;b!==a&&(0<a?(this.vs=a,this.g("maxScale",b,a),a<this.scale&&(this.scale=a)):T(a,"> 0",Xo,"maxScale"))}},zoomPoint:{get:function(){return this.vt},set:function(a){this.vt.w(a)||(this.vt=a=a.G())}},contentAlignment:{get:function(){return this.Bj},set:function(a){var b=this.Bj;b.w(a)||(this.Bj=a=a.G(),this.g("contentAlignment",b,a),er(this,!1))}},initialContentAlignment:{get:function(){return this.oo},set:function(a){var b=this.oo;b.w(a)||(this.oo=a=a.G(),this.g("initialContentAlignment",b,a))}},padding:{get:function(){return this.ib},set:function(a){"number"==typeof a&&(a=new ui(a));var b=this.ib;b.w(a)||(this.ib=a=a.G(),this.Oa(),this.g("padding",b,a))}},partManager:{get:function(){return this.Ka},set:function(a){var b=this.Ka;b!==a&&(null!==a.diagram&&N("Cannot share PartManagers between Diagrams: "+a.toString()),null!==b&&b.ce(null),this.Ka=a,a.ce(this))}},nodes:{get:function(){return this.partManager.nodes.iterator}},links:{get:function(){return this.partManager.links.iterator}},parts:{get:function(){return this.partManager.parts.iterator}},layout:{get:function(){return this.lc},set:function(a){var b=this.lc;b!==a&&(this.lc=a,a.diagram=this,a.group=null,this.Og=!0,this.g("layout",b,a),this.Eb())}},isTreePathToChildren:{get:function(){return this.qs},set:function(a){var b=this.qs;if(b!==a&&(this.qs=a,this.g("isTreePathToChildren",b,a),!this.undoManager.isUndoingRedoing))for(a=this.nodes;a.next();)Hu(a.value)}},treeCollapsePolicy:{get:function(){return this.pt},set:function(a){var b=this.pt;b!==a&&(a!==ks&&a!==Ms&&a!==Ss&&N("Unknown Diagram.treeCollapsePolicy: "+a),this.pt=a,this.g("treeCollapsePolicy",b,a))}},Je:{get:function(){return this.Ru},set:function(a){this.Ru=a}},autoScrollInterval:{get:function(){return this.nn},set:function(a){var b=this.nn;b!==a&&(this.nn=a,this.g("autoScrollInterval",b,a))}},autoScrollRegion:{get:function(){return this.pn},set:function(a){"number"==typeof a&&(a=new ui(a));var b=this.pn;b.w(a)||(this.pn=a=a.G(),this.Oa(),this.g("autoScrollRegion",b,a))}}}),v.Object.defineProperties(Xo,{licenseKey:{get:function(){return Ps.Xb()},set:function(a){Ps.add(a)}},version:{get:function(){return Ns}}}),Xo.prototype.makeImageData=Xo.prototype.Jy,Xo.prototype.makeImage=Xo.prototype.GA,Xo.prototype.addRenderer=Xo.prototype.rz,Xo.prototype.makeSVG=Xo.prototype.gw,Xo.prototype.makeSvg=Xo.prototype.Yt,Xo.prototype.stopAutoScroll=Xo.prototype.Lf,Xo.prototype.doAutoScroll=Xo.prototype.Dt,Xo.prototype.isUnoccupied=Xo.prototype.Ak,Xo.prototype.raiseDiagramEvent=Xo.prototype.R,Xo.prototype.removeDiagramListener=Xo.prototype.Jm,Xo.prototype.addDiagramListener=Xo.prototype.ik,Xo.prototype.findTreeRoots=Xo.prototype.jA,Xo.prototype.layoutDiagram=Xo.prototype.EA,Xo.prototype.findTopLevelGroups=Xo.prototype.cA,Xo.prototype.findTopLevelNodesAndLinks=Xo.prototype.dA,Xo.prototype.ensureBounds=Xo.prototype.Ta,Xo.prototype.findLinksByExample=Xo.prototype.Gt,Xo.prototype.findNodesByExample=Xo.prototype.Ht,Xo.prototype.findLinkForData=Xo.prototype.yc,Xo.prototype.findNodeForData=Xo.prototype.fj,Xo.prototype.findPartForData=Xo.prototype.zc,Xo.prototype.findLinkForKey=Xo.prototype.findLinkForKey,Xo.prototype.findNodeForKey=Xo.prototype.Db,Xo.prototype.findPartForKey=Xo.prototype.findPartForKey,Xo.prototype.rebuildParts=Xo.prototype.Kd,Xo.prototype.transformViewToDoc=Xo.prototype.lu,Xo.prototype.transformRectDocToView=Xo.prototype.fB,Xo.prototype.transformDocToView=Xo.prototype.gr,Xo.prototype.centerRect=Xo.prototype.yt,Xo.prototype.scrollToRect=Xo.prototype.Aw,Xo.prototype.scroll=Xo.prototype.scroll,Xo.prototype.highlightCollection=Xo.prototype.vA,Xo.prototype.highlight=Xo.prototype.uA,Xo.prototype.selectCollection=Xo.prototype.XA,Xo.prototype.select=Xo.prototype.select,Xo.prototype.updateAllRelationshipsFromData=Xo.prototype.ir,Xo.prototype.updateAllTargetBindings=Xo.prototype.updateAllTargetBindings,Xo.prototype.commit=Xo.prototype.commit,Xo.prototype.rollbackTransaction=Xo.prototype.Kf,Xo.prototype.commitTransaction=Xo.prototype.Wa,Xo.prototype.startTransaction=Xo.prototype.xa,Xo.prototype.raiseChanged=Xo.prototype.g,Xo.prototype.raiseChangedEvent=Xo.prototype.bb,Xo.prototype.removeChangedListener=Xo.prototype.Pk,Xo.prototype.addChangedListener=Xo.prototype.Gh,Xo.prototype.removeModelChangedListener=Xo.prototype.TA,Xo.prototype.addModelChangedListener=Xo.prototype.Yx,Xo.prototype.findLayer=Xo.prototype.wm,Xo.prototype.removeLayer=Xo.prototype.RA,Xo.prototype.addLayerAfter=Xo.prototype.oz,Xo.prototype.addLayerBefore=Xo.prototype.Vx,Xo.prototype.addLayer=Xo.prototype.rm,Xo.prototype.moveParts=Xo.prototype.moveParts,Xo.prototype.copyParts=Xo.prototype.rk,Xo.prototype.removeParts=Xo.prototype.eu,Xo.prototype.remove=Xo.prototype.remove,Xo.prototype.add=Xo.prototype.add,Xo.prototype.clearDelayedGeometries=Xo.prototype.Fv,Xo.prototype.setProperties=Xo.prototype.Fw,Xo.prototype.resetInputOptions=Xo.prototype.ww,Xo.prototype.setInputOption=Xo.prototype.YA,Xo.prototype.getInputOption=Xo.prototype.zm,Xo.prototype.resetRenderingHints=Xo.prototype.xw,Xo.prototype.setRenderingHint=Xo.prototype.Vy,Xo.prototype.getRenderingHint=Xo.prototype.Ie,Xo.prototype.maybeUpdate=Xo.prototype.jd,Xo.prototype.requestUpdate=Xo.prototype.Eb,Xo.prototype.delayInitialization=Xo.prototype.Jz,Xo.prototype.isUpdateRequested=Xo.prototype.AA,Xo.prototype.redraw=Xo.prototype.Le,Xo.prototype.invalidateDocumentBounds=Xo.prototype.Oa,Xo.prototype.findObjectsNear=Xo.prototype.Fg,Xo.prototype.findPartsNear=Xo.prototype.$z,Xo.prototype.findObjectsIn=Xo.prototype.Bf,Xo.prototype.findPartsIn=Xo.prototype.uy,Xo.prototype.findObjectsAt=Xo.prototype.gj,Xo.prototype.findPartsAt=Xo.prototype.Zz,Xo.prototype.findObjectAt=Xo.prototype.Vb,Xo.prototype.findPartAt=Xo.prototype.xm,Xo.prototype.focusObject=Xo.prototype.kA,Xo.prototype.alignDocument=Xo.prototype.uz,Xo.prototype.zoomToRect=Xo.prototype.jB,Xo.prototype.zoomToFit=Xo.prototype.zoomToFit,Xo.prototype.diagramScroll=Xo.prototype.jy,Xo.prototype.focus=Xo.prototype.focus,Xo.prototype.reset=Xo.prototype.reset,Xo.useDOM=function(a){hs=!!a&&void 0!==w.document},Xo.isUsingDOM=function(){return hs};var os=null,rs=new Mt,ss=null,as=null,hs=void 0!==w.document,ls=null,us="",cs=new _(Xo,"None",0),fs=new _(Xo,"Uniform",1),ds=new _(Xo,"UniformToFill",2),ps=new _(Xo,"CycleAll",10),gs=new _(Xo,"CycleNotDirected",11),ys=new _(Xo,"CycleNotDirectedFast",12),ms=new _(Xo,"CycleNotUndirected",13),vs=new _(Xo,"CycleDestinationTree",14),xs=new _(Xo,"CycleSourceTree",15),bs=new _(Xo,"DocumentScroll",1),ws=new _(Xo,"InfiniteScroll",2),ks=new _(Xo,"TreeParentCollapsed",21),Ms=new _(Xo,"AllParentsCollapsed",22),Ss=new _(Xo,"AnyParentsCollapsed",23),Ps=new ut,Ns="2.1.39",Cs="image",Ts=null,Ls=!1;function As(){if(hs){var a=w.document.createElement("canvas"),b=a.getContext("2d"),t=X("7ca11abfd022028846");b[t]=X("398c3597c01238");for(var e=["5da73c80a36455d5038e4972187c3cae51fd22",k.Dx+"4ae6247590da4bb21c324ba3a84e385776",ee.xF+"fb236cdfda5de14c134ba1a95a2d4c7cc6f93c1387",oe.za],n=1;5>n;n++)b[X("7ca11abfd7330390")](X(e[n-1]),10,15*n);for(b[t]=X("39f046ebb36e4b"),t=1;5>t;t++)b[X("7ca11abfd7330390")](X(e[t-1]),10,15*t);4===e.length&&"5"===e[0][0]&&"7"===e[3][0]||(ee.prototype.Gd=ee.prototype.ay),Ts=a}}function js(){this.kz=null,this.l="zz@orderNum","63ad05bbe23a1786468a4c741b6d2"===this._tk?this.We=this.l=!0:this.We=null}function Ds(a,b){if(b.Hb.setTransform(b.Tb,0,0,b.Tb,0,0),null===a.We){b="f";var t=w[X("76a715b2f73f148a")][X("72ba13b5")];if(a.We=!0,hs){var e=Xo[X("76a115b6ed251eaf4692")];if(e)for(var n=Ps.iterator;n.next()&&!(6>(e=X(e=n.value).split(X("39e9"))).length);){var o=X(e[1]).split(".");if("7da71ca0"!==e[4])break;var g=X(k[X("6cae19")]).split(".");if(o[0]>g[0]||o[0]===g[0]&&o[1]>=g[1]){for(o=t[X("76ad18b4f73e")],g=t[X("73a612b6fb191d")](X("35e7"))+2;g<o;g++)b+=t[g];if(0>(o=b[X("73a612b6fb191d")](X(e[2])))&&X(e[2])!==X("7da71ca0ad381e90")&&(o=b[X("73a612b6fb191d")](X("76a715b2ef3e149757"))),0>o&&(o=b[X("73a612b6fb191d")](X("76a715b2ef3e149757"))),0>o&&(o=t[X("73a612b6fb191d")](X("7baa19a6f76c1988428554"))),a.We=!(0<=o&&o<b[X("73a612b6fb191d")](X("35"))||-1===b[X("73a612b6fb191d")](X("35"))),!a.We)break;if("#"!==(o=X(e[2]))[0])break;g=w.document.createElement("div");for(var r=e[0].replace(/[A-Za-z]/g,"");4>r.length;)r+="9";if(r=r.substr(r.length-4),e="",e+=["gsh","gsf"][parseInt(r.substr(0,1),10)%2],e+=["Header","Background","Display","Feedback"][parseInt(r.substr(0,1),10)%4],g[X("79a417a0f0181a8946")]=e,w.document[X("78a712aa")]){if(w.document[X("78a712aa")][X("7bb806b6ed32388c4a875b")](g),r=w.getComputedStyle(g).getPropertyValue(X("78a704b7e62456904c9b12701b6532a8")),w.document[X("78a712aa")][X("68ad1bbcf533388c4a875b")](g),!r)break;if(-1!==r.indexOf(parseInt(o[1]+o[2],16))&&-1!==r.indexOf(parseInt(o[3]+o[4],16))){a.We=!1;break}if(U||K||H||W)for(e="."+e,o=0;o<document.styleSheets.length;o++)for(var h in g=document.styleSheets[o].rules||document.styleSheets[o].cssRules)if(e===g[h].selectorText){a.We=!1;break}}else a.We=null,a.We=!1}}else{for(h=t[X("76ad18b4f73e")],n=t[X("73a612b6fb191d")](X("35e7"))+2;n<h;n++)b+=t[n];t=b[X("73a612b6fb191d")](X("7da71ca0ad381e90")),a.We=!(0<=t&&t<b[X("73a612b6fb191d")](X("35")))}}}return 0<a.We&&a!==a.kz}function Os(a,b){if(hs){if(null!=b||N("Diagram setup requires an argument DIV."),null!==a.Ea&&N("Diagram has already completed setup."),"string"==typeof b?a.Ea=w.document.getElementById(b):b instanceof HTMLDivElement?a.Ea=b:N("No DIV or DIV id supplied: "+b),null===a.Ea&&N("Invalid DIV id; could not get element with id: "+b),void 0!==a.Ea.B&&N("Invalid div id; div already has a Diagram associated with it."),!a.Xl&&w.ResizeObserver){var t=M((function(){a.Eb()}),250);a.Xl=new w.ResizeObserver((function(){t()})),a.Xl.observe(a.Ea)}"static"===w.getComputedStyle(a.Ea,null).position&&(a.Ea.style.position="relative");var e="rgba(2"+(b=5)+"5, 255, 255, 0)";b--,a.Ea.style["-webkit-tap-highlight-color"]=e,a.Ea.style["-ms-touch-action"]="none",a.Ea.innerHTML="",a.Ea.B=a,a.Ea.goDiagram=a,a.Ea.go=w.go;var n=a.bq?new Fa(a):new Va(a);if(void 0!==n.style&&(n.style.position="absolute",n.style.top="0px",n.style.left="0px","rtl"===w.getComputedStyle(a.Ea,null).getPropertyValue("direction")&&(a.Fl=!0),n.style.zIndex="2",n.style.userSelect="none",n.style.MozUserSelect="none"),a.ta=n,a.Hb=n.context,e=a.Hb,a.Tb=a.computePixelRatio(),a.va=a.Ea.clientWidth||1,a.ua=a.Ea.clientHeight||1,Nr(a,a.va,a.ua),a.Ea.insertBefore(n.Ga,a.Ea.firstChild),(n=new Va(null)).width=1,n.height=1,a.Gu=n,a.ux=n.context,hs){n=P("div");var o=P("div");n.style.position="absolute",n.style.overflow="auto",n.style.width=a.va+"px",n.style.height=a.ua+"px",n.style.zIndex="1",o.style.position="absolute",o.style.width="1px",o.style.height="1px",a.Ea.appendChild(n),n.appendChild(o),n.onscroll=Qo,n.addEventListener("mousedown",_o),n.addEventListener("touchstart",_o,{passive:!0}),n.B=a,n.iz=!0,n.jz=!0,a.Ys=n,a.Jp=o}a.Xq=M((function(){a.xh=null,a.M()}),300),a.Ww=M((function(){Jo(a)}),250),a.preventDefault=function(a){return a.preventDefault(),!1},a.Ek=function(b){if(a.isEnabled){a.ag=!0;var t=sr(a,b,!0);a.doMouseMove(),a.currentTool.isBeyondDragSize()&&(a.wd=0),fr(t,b)}},a.Dk=function(b){if(a.isEnabled)if(a.ag=!0,a.pe)b.preventDefault();else{var t=sr(a,b,!0);t.down=!0,t.clickCount=b.detail,(K||H)&&(b.timeStamp-a.Qj<a.ot&&!a.currentTool.isBeyondDragSize()?a.wd++:a.wd=1,a.Qj=b.timeStamp,t.clickCount=a.wd),t.clone(a.firstInput),a.doMouseDown(),1===b.button?b.preventDefault():fr(t,b)}},a.Gk=function(b){if(a.isEnabled)if(a.pe&&2===b.button)b.preventDefault();else if(a.pe&&0===b.button&&(a.pe=!1),a.fk)b.preventDefault();else{a.ag=!0;var t=sr(a,b,!0);t.up=!0,t.clickCount=b.detail,(K||H)&&(t.clickCount=a.wd),t.bubbles=b.bubbles,t.targetDiagram=ar(b),a.doMouseUp(),a.Lf(),fr(t,b)}},a.Hk=function(b){if(a.isEnabled){var t=sr(a,b,!0);t.bubbles=!0;var e=0,n=0;t.delta=0,void 0!==b.deltaX?(0!==b.deltaX&&(e=0<b.deltaX?1:-1),0!==b.deltaY&&(n=0<b.deltaY?1:-1),t.delta=Math.abs(b.deltaX)>Math.abs(b.deltaY)?-e:-n):void 0!==b.wheelDeltaX?(0!==b.wheelDeltaX&&(e=0<b.wheelDeltaX?-1:1),0!==b.wheelDeltaY&&(n=0<b.wheelDeltaY?-1:1),t.delta=Math.abs(b.wheelDeltaX)>Math.abs(b.wheelDeltaY)?-e:-n):void 0!==b.wheelDelta&&0!==b.wheelDelta&&(t.delta=0<b.wheelDelta?1:-1),a.doMouseWheel(),fr(t,b)}},a.Fk=function(b){a.isEnabled&&(a.ag=!1,sr(a,b,!0),(b=a.currentTool).cancelWaitAfter(),b.standardMouseOver())},a.Ow=function(b){if(a.isEnabled){a.fk=!1,a.pe=!0;var t=lr(a,b,b.targetTouches[0],1<b.touches.length),e=null;if(0<b.targetTouches.length?e=b.targetTouches[0]:0<b.changedTouches.length&&(e=b.changedTouches[0]),null!==e){var n=e.screenX;e=e.screenY;var o=a.Ao;b.timeStamp-a.Qj<a.ot&&!(25<Math.abs(o.x-n)||25<Math.abs(o.y-e))?a.wd++:a.wd=1,t.clickCount=a.wd,a.Qj=b.timeStamp,a.Ao.h(n,e)}a.doMouseDown(),fr(t,b)}},a.Nw=function(b){if(a.isEnabled){var t=null;0<b.targetTouches.length?t=b.targetTouches[0]:0<b.changedTouches.length&&(t=b.changedTouches[0]),t=ur(a,b,t,1<b.touches.length),a.doMouseMove(),fr(t,b)}},a.Mw=function(b){if(a.isEnabled)if(a.fk)b.preventDefault();else if(!(1<b.touches.length)){var t=null,e=null;0<b.targetTouches.length?e=b.targetTouches[0]:0<b.changedTouches.length&&(e=b.changedTouches[0]);var n=cr(a,b,!1,!0,!1,!1);null!==e&&(null!==(t=w.document.elementFromPoint(e.clientX,e.clientY))&&void 0!==t.shadowRoot&&null!==t&&null!==t.shadowRoot&&(t=t.shadowRoot.elementFromPoint(e.clientX,e.clientY)),null!==t&&t.B instanceof Xo&&t.B!==a&&dr(t.B,e,n),dr(a,e,n),n.clickCount=a.wd),null===t?n.targetDiagram=ar(b):t.B?n.targetDiagram=t.B:n.targetDiagram=null,n.targetObject=null,a.doMouseUp(),fr(n,b),a.pe=!1}},a.Kk=function(b){if(a.isEnabled){a.ag=!0;var t=a.Ms;void 0===t[b.pointerId]&&(t[b.pointerId]=b);var e=!1;if(null!==(t=a.$j)[0]&&t[0].pointerId===b.pointerId)t[0]=b;else if(null!==t[1]&&t[1].pointerId===b.pointerId)t[1]=b,e=!0;else if(null===t[0])t[0]=b;else{if(null!==t[1])return void b.preventDefault();t[1]=b,e=!0}"touch"!==b.pointerType&&"pen"!==b.pointerType||(a.fk=!1,a.pe=!0),t=lr(a,b,b,e),e=a.Ao;var n="touch"===b.pointerType||"pen"===b.pointerType?25:10;b.timeStamp-a.Qj<a.ot&&!(Math.abs(e.x-b.screenX)>n||Math.abs(e.y-b.screenY)>n)?a.wd++:a.wd=1,t.clickCount=a.wd,a.Qj=b.timeStamp,a.Ao.Jg(b.screenX,b.screenY),a.doMouseDown(),1===b.button?b.preventDefault():fr(t,b)}},a.Lk=function(b){if(a.isEnabled){a.ag=!0;var t=a.$j;if(null!==t[0]&&t[0].pointerId===b.pointerId)t[0]=b;else{if(null!==t[1]&&t[1].pointerId===b.pointerId)return void(t[1]=b);if(null!==t[0])return;t[0]=b}t[0].pointerId===b.pointerId&&((t=ur(a,b,b,null!==t[1])).targetDiagram=ar(b),a.doMouseMove(),fr(t,b))}},a.Nk=function(b){if(a.isEnabled){a.ag=!0;var t="touch"===b.pointerType||"pen"===b.pointerType,e=a.Ms;if(t&&a.fk)delete e[b.pointerId],b.preventDefault();else if(null!==(e=a.$j)[0]&&e[0].pointerId===b.pointerId){e[0]=null,e=cr(a,b,!1,!0,!0,!1);var n=w.document.elementFromPoint(b.clientX,b.clientY);null!==n&&n.B instanceof Xo&&n.B!==a&&dr(n.B,b,e),dr(a,b,e),e.clickCount=a.wd,null===n?e.targetDiagram=ar(b):n.B?e.targetDiagram=n.B:e.targetDiagram=null,e.targetObject=null,a.doMouseUp(),fr(e,b),t&&(a.pe=!1)}else null!==e[1]&&e[1].pointerId===b.pointerId&&(e[1]=null)}},a.Mk=function(b){if(a.isEnabled){a.ag=!1;var t=a.Ms;t[b.pointerId]&&delete t[b.pointerId],null!==(t=a.$j)[0]&&t[0].pointerId===b.pointerId&&(t[0]=null),null!==t[1]&&t[1].pointerId===b.pointerId&&(t[1]=null),"touch"!==b.pointerType&&"pen"!==b.pointerType&&((b=a.currentTool).cancelWaitAfter(),b.standardMouseOver())}},a.Tr=e.Y["d"+qs[1]+qs[2]+"wI"+Cs.slice(1,5)]["b"+Hd.slice(1,b)](e.Y,Ts,b,b),e.uc(!0),function(a){var b=a.ta.Ga;b instanceof HTMLCanvasElement&&(a.xj?(a.addEventListener(b,"pointerdown",a.Kk,!1),a.addEventListener(b,"pointermove",a.Lk,!1),a.addEventListener(b,"pointerup",a.Nk,!1),a.addEventListener(b,"pointerout",a.Mk,!1)):(a.addEventListener(b,"touchstart",a.Ow,!1),a.addEventListener(b,"touchmove",a.Nw,!1),a.addEventListener(b,"touchend",a.Mw,!1),a.addEventListener(b,"mousemove",a.Ek,!1),a.addEventListener(b,"mousedown",a.Dk,!1),a.addEventListener(b,"mouseup",a.Gk,!1),a.addEventListener(b,"mouseout",a.Fk,!1)),a.addEventListener(b,"mouseenter",a.Oz,!1),a.addEventListener(b,"mouseleave",a.Pz,!1),a.addEventListener(b,"wheel",a.Hk,!1),a.addEventListener(b,"keydown",a.BA,!1),a.addEventListener(b,"keyup",a.CA,!1),a.addEventListener(b,"blur",a.Az,!1),a.addEventListener(b,"focus",a.Bz,!1),a.addEventListener(b,"selectstart",(function(a){return a.preventDefault(),!1}),!1),a.addEventListener(b,"contextmenu",(function(a){return a.preventDefault(),!1}),!1),a.addEventListener(b,"gesturestart",(function(b){a.toolManager.gestureBehavior!==We&&(a.toolManager.gestureBehavior===He?b.preventDefault():a.pe&&a.lastInput.handled||(b.preventDefault(),a.Ul=a.scale,a.currentTool.doCancel()))}),!1),a.addEventListener(b,"gesturechange",(function(b){if(a.toolManager.gestureBehavior!==We)if(a.toolManager.gestureBehavior===He)b.preventDefault();else if(!a.pe||!a.lastInput.handled){b.preventDefault();var t=b.scale;if(null!==a.Ul){var e=a.ta.getBoundingClientRect();if(b=new St(b.pageX-w.scrollX-a.va/e.width*e.left,b.pageY-w.scrollY-a.ua/e.height*e.top),t=a.Ul*t,e=a.commandHandler,t!==a.scale&&e.canResetZoom(t)){var n=a.zoomPoint;a.zoomPoint=b,e.resetZoom(t),a.zoomPoint=n}}}}),!1),a.addEventListener(w,"resize",a.Ww,!1))}(a)}}function Fs(a){this.l=void 0===a?new St:a,this.v=new St}Xo.className="Diagram",Xo.fromDiv=function(a){var b=a;return"string"==typeof a&&(b=w.document.getElementById(a)),b instanceof HTMLDivElement&&b.B instanceof Xo?b.B:null},Xo.inherit=function(a,b){function t(){}if(Object.getPrototypeOf(a).prototype)throw Error("Used go.Diagram.inherit defining already defined class \n"+a);t.prototype=b.prototype,a.prototype=new t,a.prototype.constructor=a},Xo.None=cs,Xo.Uniform=fs,Xo.UniformToFill=ds,Xo.CycleAll=ps,Xo.CycleNotDirected=gs,Xo.CycleNotDirectedFast=ys,Xo.CycleNotUndirected=ms,Xo.CycleDestinationTree=vs,Xo.CycleSourceTree=xs,Xo.DocumentScroll=bs,Xo.InfiniteScroll=ws,Xo.TreeParentCollapsed=ks,Xo.AllParentsCollapsed=Ms,Xo.AnyParentsCollapsed=Ss,js.className="DiagramHelper",v.Object.defineProperties(Fs.prototype,{point:{get:function(){return this.l},set:function(a){this.l=a}},shifted:{get:function(){return this.v},set:function(a){this.v=a}}});var Bs,Is,Rs,Es,zs,Vs,Gs,Ys,Xs,dl,qs="DraggingInfo";function Us(a,b,t){this.node=a,this.info=b,this.Yv=t}function Ks(){this.reset()}function Hs(a){1<arguments.length&&N("Palette constructor can only take one optional argument, the DIV HTML element or its id."),Xo.call(this,a),Ws(this)}function Ws(a){a.allowDragOut=!0,a.allowMove=!1,a.isReadOnly=!0,a.contentAlignment=mi,a.layout=new Xf}function Js(a){1<arguments.length&&N("Overview constructor can only take one optional argument, the DIV HTML element or its id."),Xo.call(this,a);var b=this;this.animationManager.isEnabled=!1,this.Sb=!0,this.Ja=null,this.vl=this.ul=!1,this.v=this.I=!0,this.eb=0,this.T=!1,this.cm=null,this.Vy("drawShadows",!1);var t=new yu,e=new pl;e.stroke="magenta",e.strokeWidth=2,e.fill="transparent",e.name="BOXSHAPE",t.selectable=!0,t.selectionAdorned=!1,t.selectionObjectName="BOXSHAPE",t.locationObjectName="BOXSHAPE",t.resizeObjectName="BOXSHAPE",t.cursor="move",t.add(e),this.l=t,this.allowDelete=this.allowCopy=!1,this.allowSelect=!0,this.autoScrollRegion=new ui(0,0,0,0),this.la.h(0,0),this.toolManager.Xa("Dragging",new Qs,this.toolManager.mouseMoveTools),this.click=function(){var a=b.observed;if(null!==a){var t=a.viewportBounds,e=b.lastInput.documentPoint;a.position=new St(e.x-t.width/2,e.y-t.height/2)}},this.Wh=function(){b.Oa(),$s(b)},this.Vh=function(){null!==b.observed&&(b.Oa(),b.M())},this.Uc=function(){1>b.updateDelay?b.M():b.T||(b.T=!0,setTimeout((function(){b.T=!1;var a=b.ta,t=b.Hb;if(null!==a&&null!==t){if(Pr(b),null===b.cm){var e=new Va(null);e.width=a.width,e.height=a.height,b.cm=e}try{b.ta=b.cm,b.Hb=b.ta.context,b.Hb.uc(!0),b.Hb.setTransform(1,0,0,1,0,0),b.Hb.clearRect(0,0,b.ta.width,b.ta.height),Zs(b)}finally{b.ta=a,b.Hb=t}}b.M()}),b.updateDelay))},this.Md=function(){null!==b.observed&&$s(b)},this.autoScale=fs,this.Sb=!1}function Zs(a){var b=a.observed;if(null!==b){var t=a.drawsTemporaryLayers,e=a.drawsGrid&&t,n=b.grid;e&&null!==n&&n.visible&&!isNaN(n.width)&&!isNaN(n.height)&&(Er(b,n=Jt.alloc().assign(a.viewportBounds).Tc(b.viewportBounds)),Jt.free(n),mr(b));var o=a.qb;o.reset(),1!==a.scale&&o.scale(a.scale),0===a.position.x&&0===a.position.y||o.translate(-a.position.x,-a.position.y),(n=a.Hb).scale(a.Tb,a.Tb),n.transform(o.m11,o.m12,o.m21,o.m22,o.dx,o.dy),o=(b=b.La.j).length;for(var g=0;g<o;g++){var r=b[g],h=a;if(r.visible&&0!==r.opacity){var l=r.diagram.grid.part;if(!t&&r.isTemporary)e&&l.layer===r&&(r=Go(r,n),l.cc(n,h),n.globalAlpha=r);else{for(var c=Go(r,n),f=h.scale,p=Jt.alloc(),d=r.Da.j,q=d.length,u=0;u<q;u++){var y=d[u];(e||y!==l)&&r.cj(n,y,h,null,f,p,!1)}Jt.free(p),n.globalAlpha=c}}}}}function $s(a){var b=a.box;if(null!==b){var t=a.observed;if(null!==t){a.Ec=!0,t=t.viewportBounds;var e=b.selectionObject,n=Ut.alloc();n.h(t.width,t.height),e.desiredSize=n,Ut.free(n),a=2/a.scale,e instanceof pl&&(e.strokeWidth=a),b.location=new St(t.x-a/2,t.y-a/2),b.isSelected=!0}}}function Qs(){Je.call(this),this.l=null}function _s(){pt(this),this.B=os,this.eb=this.I=this.v=!0,this.T=this.Ja=this.Uc=this.Ka=!1,this.Ii=this.l=null,this.Md=1.05,this.Zu=NaN,this.zx=null,this.zv=NaN,this.yv=si,this.Cc=!0,this.tg=null,this.Vc=200}function ta(a,b,t){if(b.isVisible())return t;if(b instanceof Eu)ta(a,b.adornedPart,t);else if(b instanceof uc){var e=b.fromNode;null!==e&&ta(a,e,t),null!==(b=b.toNode)&&ta(a,b,t)}else b instanceof zu&&(null!==(e=b.labeledLink)&&ta(a,e,t),null!==(e=b.Gg())&&(e.isTreeExpanded||e.wasTreeExpanded||t.push(e),ta(a,e,t))),null!==(b=b.containingGroup)&&(b.isSubGraphExpanded||b.wasSubGraphExpanded||t.push(b),ta(a,b,t));return t}function ia(a){var b=I();for(a=a.iterator;a.next();){var t=a.value;t instanceof uc||b.push(t)}a=new ft,t=b.length;for(var e=0;e<t;e++){for(var n=b[e],o=!0,g=0;g<t;g++)if(n.Hd(b[g])){o=!1;break}o&&a.add(n)}return R(b),a}function ea(){pt(this),this.F=4225027,this.hb=1,this.qg=null,this.Qa="",this.ec=this.mb=null,this.la=new St(NaN,NaN).freeze(),this.Zc=Xt,this.hg=Rt,this.gg=Yt,this.qb=new ee,this.Yh=new ee,this.eg=new ee,this.ya=this.ol=1,this.Yb=0,this.Be=Es,this.jh=di,this.qc=new Jt(NaN,NaN,NaN,NaN).freeze(),this.yb=new Jt(NaN,NaN,NaN,NaN).freeze(),this.rc=new Jt(0,0,NaN,NaN).freeze(),this.O=this.qp=this.rp=null,this.Yk=this.zb=Vi,this.Dp=0,this.Ep=1,this.Sg=0,this.wn=1,this.Xp=null,this.Kp=-1/0,this.Yl=0,this.Zl=Dt,this.$l=Ic,this.ni="",this.fb=this.N=null,this.bl=-1,this.bm=this.Ya=this.mi=this.fm=null,this.Ps=Is,this.Gp=this.Ng=this.Zj=null}function na(a){null===a.N&&(a.N=new ja)}function oa(a,b,t){var e=a.hj();if(null!==e)for(var n=a.fb.iterator;n.next();){var o=n.value,g=null;if(null!==o.sourceName){if(null===(g=Kd(o,e,a)))continue;o.jr(a,g,t,null)}else if(o.isToModel){var r=b.diagram;null===r||r.skipsModelSourceBindings||o.jr(a,r.model.modelData,t,e)}else{if(null===(r=e.data))continue;var h=b.diagram;null===h||h.skipsModelSourceBindings||o.jr(a,r,t,e)}g===a&&(null!==(r=e.Ft(o.vj))&&o.Tw(r,g,t))}}function ra(a,b,t,e,n){var o=a.qc,g=a.eg;g.reset(),ca(a,g,b,t,e,n),a.eg=g,o.h(b,t,e,n),g.St()||g.Pw(o)}function sa(a,b,t,e){return!1!==a.pickable&&(e.multiply(a.transform),t?a.Nc(b,e):a.Ih(b,e))}function aa(a,b,t,e,n){if(a.yb.h(b,t,e,n),!a.desiredSize.u()){var o=a.qc;b=(t=a.jh).right+t.left;var g=t.top+t.bottom;switch(t=o.width+b,o=o.height+g,e+=b,n+=g,b=da(a,!0),t===e&&o===n&&(b=Is),b){case Is:(t>e||o>n)&&(ka(a,!0),a.measure(t>e?e:t,o>n?n:o,0,0));break;case Bs:ka(a,!0),a.measure(e,n,0,0);break;case zs:ka(a,!0),a.measure(e,o,0,0);break;case Vs:ka(a,!0),a.measure(t,n,0,0)}}}function ha(a,b,t){var e=a.yb,n=a.rc;null!==a.ec&&(la(a,b,a.ec,!0,!0,n,e),a.ec instanceof qa&&a.ec.type===sh?(b.beginPath(),b.rect(e.x,e.y,e.width,e.height),b.He(a.ec)):b.fillRect(e.x,e.y,e.width,e.height)),null!==a.mb&&(la(a,b,a.mb,!0,!1,n,e),a.mb instanceof qa&&a.mb.type===sh?(b.beginPath(),b.rect(e.x,e.y,e.width,e.height),b.He(a.mb)):b.fillRect(e.x,e.y,e.width,e.height)),a.dj(b,t)}function la(a,b,t,e,n,o,g){if(null!==t){var r=1,h=1;if("string"==typeof t)e?b.fillStyle=t:b.strokeStyle=t;else if(t.type===oh)e?b.fillStyle=t.color:b.strokeStyle=t.color;else{var l=0;if(a instanceof pl&&(l=a.strokeWidth),r=o.width,h=o.height,n?(r=g.width,h=g.height):e||(r+=l,h+=l),(o=b instanceof Ga)&&t.ie&&(t.type===ah||t.el===r&&t.xu===h))var c=t.ie;else{var f=0,p=0,d=0,q=0,u=0,y=0;if(y=u=0,n?(u=g.x,y=g.y):e||(u-=l/2,y-=l/2),f=t.start.x*r+t.start.offsetX,p=t.start.y*h+t.start.offsetY,d=t.end.x*r+t.end.offsetX,q=t.end.y*h+t.end.offsetY,f+=u,d+=u,p+=y,q+=y,t.type===rh)c=b.createLinearGradient(f,p,d,q);else if(t.type===sh)y=isNaN(t.endRadius)?Math.max(r,h)/2:t.endRadius,isNaN(t.startRadius)?(u=0,y=Math.max(r,h)/2):u=t.startRadius,c=b.createRadialGradient(f,p,u,d,q,y);else if(t.type===ah)try{c=b.createPattern(t.pattern,"repeat")}catch(t){c=null}if(t.type!==ah&&null!==(n=t.colorStops))for(n=n.iterator;n.next();)c.addColorStop(n.key,n.value);if(o&&(t.ie=c,null!==c&&(t.el=r,t.xu=h),null===c&&t.type===ah&&-1!==t.el)){t.el=-1;var m=a.diagram;null!==m&&-1===t.el&&S((function(){m.Le()}),600)}}e?b.fillStyle=c:b.strokeStyle=c}}}function ua(a){if(0!=(2048&a.F)==!0){var b=a.qb;if(b.reset(),!a.yb.u()||!a.qc.u())return void xa(a,!1);if(b.translate(a.yb.x-a.qc.x,a.yb.y-a.qc.y),1!==a.scale||0!==a.angle){var t=a.naturalBounds;ca(a,b,t.x,t.y,t.width,t.height)}xa(a,!1),ba(a,!0)}0!=(4096&a.F)==!0&&(null===(b=a.panel)?(a.Yh.set(a.qb),a.ol=a.scale,ba(a,!1)):null!==b.Ed&&((t=a.Yh).reset(),b.fe()?t.multiply(b.Yh):null!==b.panel&&t.multiply(b.panel.Yh),t.multiply(a.qb),a.ol=a.scale*b.ol,ba(a,!1)))}function ca(a,b,t,e,n,o){if(1!==a.scale&&b.scale(a.scale),0!==a.Yb){var g=bi;a.Hf()&&a.locationSpot.kb()&&(g=a.locationSpot);var r=St.alloc();if(a instanceof yu&&a.locationObject!==a)for(e=(t=a.locationObject).naturalBounds,r.Qk(e.x,e.y,e.width,e.height,g),t.eg.sa(r),r.offset(-t.measuredBounds.x,-t.measuredBounds.y),g=t.panel;null!==g&&g!==a;)g.eg.sa(r),r.offset(-g.measuredBounds.x,-g.measuredBounds.y),g=g.panel;else r.Qk(t,e,n,o,g);b.rotate(a.Yb,r.x,r.y),St.free(r)}}function fa(a){if(!1===Ma(a)){var b=a.panel;null!==b?b.o():a.Hf()&&(null!==(b=a.diagram)&&(b.vd.add(a),a instanceof zu&&a.td(),b.Eb())),ol(a,!0)}}function da(a,b){var t=a.stretch,e=a.panel;return null!==e&&e.type===Fh.Table?pa(a,e.getRowDefinition(a.row),e.getColumnDefinition(a.column),b):null!==e&&e.type===Fh.Auto&&e.rb()===a?ga(a,Bs,b):t===Es?null!==e?e.type===Fh.Spot&&e.rb()===a?ga(a,Bs,b):ga(a,(t=e.defaultStretch)===Es?Is:t,b):ga(a,Is,b):ga(a,t,b)}function pa(a,b,t,e){var n=a.stretch;if(n!==Es)return ga(a,n,e);var o=n=null;switch(b.stretch){case Vs:o=!0;break;case Bs:o=!0}switch(t.stretch){case zs:n=!0;break;case Bs:n=!0}return b=a.panel.defaultStretch,null===n&&(n=b===zs||b===Bs),null===o&&(o=b===Vs||b===Bs),ga(a,!0===n&&!0===o?Bs:!0===n?zs:!0===o?Vs:Is,e)}function ga(a,b,t){if(t)return b;if(b===Is)return Is;if((t=a.desiredSize).u())return Is;if(a=a.angle,!isNaN(t.width))if(90!==a&&270!==a){if(b===zs)return Is;if(b===Bs)return Vs}else{if(b===Vs)return Is;if(b===Bs)return zs}if(!isNaN(t.height))if(90!==a&&270!==a){if(b===Vs)return Is;if(b===Bs)return zs}else{if(b===zs)return Is;if(b===Bs)return Vs}return b}function ya(a,b){a.F=b?512|a.F:-513&a.F}function ma(a){return 0!=(1024&a.F)}function va(a,b){a.F=b?1024|a.F:-1025&a.F}function xa(a,b){a.F=b?2048|a.F:-2049&a.F}function ba(a,b){a.F=b?4096|a.F:-4097&a.F}function wa(a){return 0!=(8192&a.F)}function ka(a,b){a.F=b?8192|a.F:-8193&a.F}function Ma(a){return 0!=(16384&a.F)}function ol(a,b){a.F=b?16384|a.F:-16385&a.F}function Sa(a){var b=a.part;if(b instanceof zu&&(null!==a.portId||a===b.port)){var t=b.diagram;null===t||t.undoManager.isUndoingRedoing||Yu(b,a)}}function Pa(a){var b=a.diagram;null===b||b.undoManager.isUndoingRedoing||(a instanceof Fh?a instanceof zu?a.td():a.Ym(a,(function(a){Sa(a)})):Sa(a))}function Na(a,b){for(var t=1;t<arguments.length;++t);t=arguments;var e=null,n=null;if("function"==typeof a)n=a;else if("string"==typeof a){var o=Aa.H(a);"function"==typeof o?j(e=o(t=O(arguments)))||N('GraphObject.make invoked object builder "'+a+'", but it did not return an Object'):n=w.go[a]}if(null===e&&(null!=n&&n.constructor||N("GraphObject.make requires a class function or GoJS class name or name of an object builder, not: "+a),e=new n),n=1,e instanceof Xo&&1<t.length){o=e;var g=t[1];("string"==typeof g||g instanceof HTMLDivElement)&&(Os(o,g),n++)}for(;n<t.length;n++)void 0===(o=t[n])?N("Undefined value at argument "+n+" for object being constructed by GraphObject.make: "+e):Ca(e,o);return e}function Ca(a,b){if("string"==typeof b)if(a instanceof Sl)a.text=b;else if(a instanceof pl)a.figure=b;else if(a instanceof $l)a.source=b;else if(a instanceof Fh)null!==(b=sl.H(b))&&(a.type=b);else if(a instanceof qa){var t=tt(qa,b);null!==t?a.type=t:N("Unknown Brush type as an argument to GraphObject.make: "+b)}else a instanceof td?null!==(b=tt(td,b))&&(a.type=b):a instanceof we&&(null!==(b=tt(we,b))&&(a.type=b));else if(b instanceof ea)a instanceof Fh||N("A GraphObject can only be added to a Panel, not to: "+a),a.add(b);else if(b instanceof al){var e;b.isRow&&"function"==typeof a.getRowDefinition?e=a.getRowDefinition(b.index):b.isRow||"function"!=typeof a.getColumnDefinition||(e=a.getColumnDefinition(b.index)),e instanceof al?e.Bt(b):N("A RowColumnDefinition can only be added to an object that implements getRowDefinition/getColumnDefinition, not to: "+a)}else if(b instanceof _)"function"==typeof a.jb&&a.jb(b);else if(b instanceof xh)a.type=b;else if(b instanceof Ud)a instanceof ea||a instanceof al?a.bind(b):N("A Binding can only be applied to a GraphObject or RowColumnDefinition, not to: "+a);else if(b instanceof Ro)a instanceof ea?a.Qw(b):N("An AnimationTrigger can only be applied to a GraphObject, not to: "+a);else if(b instanceof be)a instanceof td?a.figures.add(b):N("A PathFigure can only be added to a Geometry, not to: "+a);else if(b instanceof we)a instanceof be?a.segments.add(b):N("A PathSegment can only be added to a PathFigure, not to: "+a);else if(b instanceof wf)a instanceof Xo||a instanceof oc?a.layout=b:N("A Layout can only be assigned to a Diagram or a Group, not to: "+a);else if(Array.isArray(b))for(t=0;t<b.length;t++)Ca(a,b[t]);else if("object"==typeof b&&null!==b)if(a instanceof qa){for(var n in t=new et,b)e=parseFloat(n),isNaN(e)?t[n]=b[n]:a.addColorStop(e,b[n]);kr(a,t)}else if(a instanceof al){for(t in void 0!==b.row?((null==(n=b.row)||1/0===n||isNaN(n)||0>n)&&N("Must specify non-negative integer row for RowColumnDefinition "+b+", not: "+n),a.isRow=!0,a.index=n):void 0!==b.column&&((null==(n=b.column)||1/0===n||isNaN(n)||0>n)&&N("Must specify non-negative integer column for RowColumnDefinition "+b+", not: "+n),a.isRow=!1,a.index=n),n=new et,b)"row"!==t&&"column"!==t&&(n[t]=b[t]);kr(a,n)}else kr(a,b);else N('Unknown initializer "'+b+'" for object being constructed by GraphObject.make: '+a)}function Ta(a,b){Aa.add(a,b)}function La(a,b,t){void 0===t&&(t=null);var e=a[1];if("function"==typeof t?t(e):"string"==typeof e)return a.splice(1,1),e;if(void 0===b)throw Error("no "+("function"==typeof t?"satisfactory":"string")+" argument for GraphObject builder "+a[0]);return b}Fs.className="DraggingInfo",Us.className="DraggingNodeInfoPair",Ks.prototype.reset=function(){this.isGridSnapEnabled=!1,this.isGridSnapRealtime=!0,this.gridSnapCellSize=new Ut(NaN,NaN).freeze(),this.gridSnapCellSpot=yi,this.gridSnapOrigin=new St(NaN,NaN).freeze(),this.groupsSnapMembers=this.dragsTree=this.dragsLink=!1,this.dragsMembers=this.groupsAlwaysMove=!0},Ks.className="DraggingOptions",m(Hs,Xo),Hs.prototype.reset=function(){Xo.prototype.reset.call(this),Ws(this)},Hs.className="Palette",m(Js,Xo),Js.prototype.computePixelRatio=function(){return 1},Js.prototype.cc=function(){if(null===this.Ea&&N("No div specified"),null===this.ta&&N("No canvas specified"),!(this.ta instanceof Fa)&&(mu(this.box),this.Ec)){var a=this.observed;if(null!==a&&!a.animationManager.isAnimating&&a.oj){Pr(this);var b=this.ta;(a=this.Hb).uc(!0),a.setTransform(1,0,0,1,0,0),a.clearRect(0,0,b.width,b.height),1>this.updateDelay?Zs(this):null!==this.cm&&(a.drawImage(this.cm.Ga,0,0),(b=this.qb).reset(),1!==this.scale&&b.scale(this.scale),0===this.position.x&&0===this.position.y||b.translate(-this.position.x,-this.position.y),a.scale(this.Tb,this.Tb),a.transform(b.m11,b.m12,b.m21,b.m22,b.dx,b.dy));for(var t=(b=this.La.j).length,e=0;e<t;e++)b[e].cc(a,this);this.Ec=this.vi=!1}}},Js.prototype.computeBounds=function(){var a=this.observed;if(null===a)return si;var b=a.documentBounds.copy();return b.Tc(a.viewportBounds),b},Js.prototype.Gy=function(){!0!==this.Ec&&(this.Ec=!0,this.Eb())},Js.prototype.Tq=function(a,b,t,e){this.Sb||(Sr(this),this.M(),Mr(this),this.Oa(),$s(this),this.Jc.scale=t,this.Jc.position.x=a.x,this.Jc.position.y=a.y,this.Jc.bounds.assign(a),this.Jc.fw=e,this.R("ViewportBoundsChanged",this.Jc,a))},v.Object.defineProperties(Js.prototype,{observed:{get:function(){return this.Ja},set:function(a){var b=this.Ja;if(a instanceof Js&&N("Overview.observed Diagram may not be an Overview itself: "+a),b!==a){if(null!==b&&(this.remove(this.box),b.Jm("ViewportBoundsChanged",this.Wh),b.Jm("DocumentBoundsChanged",this.Vh),b.Jm("InvalidateDraw",this.Uc),b.Jm("AnimationFinished",this.Md)),this.Ja=a,null!==a&&(a.ik("ViewportBoundsChanged",this.Wh),a.ik("DocumentBoundsChanged",this.Vh),a.ik("InvalidateDraw",this.Uc),a.ik("AnimationFinished",this.Md),this.add(this.box)),this.Oa(),null===a){this.cm=null;var t=this.ta,e=this.Hb;t&&e&&(e.setTransform(1,0,0,1,0,0),e.clearRect(0,0,t.width,t.height))}else this.Uc(null),$s(this),this.M();this.g("observed",b,a)}}},box:{get:function(){return this.l},set:function(a){var b=this.l;b!==a&&(this.l=a,this.remove(b),this.add(this.l),$s(this),this.g("box",b,a))}},drawsTemporaryLayers:{get:function(){return this.I},set:function(a){this.I!==a&&(this.I=a,this.Le())}},drawsGrid:{get:function(){return this.v},set:function(a){this.v!==a&&(this.v=a,this.Le())}},updateDelay:{get:function(){return this.eb},set:function(a){0>a&&(a=0),this.eb!==a&&(this.eb=a)}}}),Js.className="Overview",m(Qs,Je),Qs.prototype.canStart=function(){if(!this.isEnabled)return!1;var a=this.diagram;if(null===a||!a.allowMove||!a.allowSelect)return!1;var b=a.observed;if(null===b)return!1;var t=a.lastInput;return!(!t.left||a.currentTool!==this&&(!this.isBeyondDragSize()||t.isTouchEvent&&t.timestamp-a.firstInput.timestamp<this.delay))&&(null===this.findDraggablePart()&&(t=b.viewportBounds,this.l=new St(t.width/2,t.height/2),a=a.firstInput.documentPoint,b.position=new St(a.x-this.l.x,a.y-this.l.y)),!0)},Qs.prototype.doActivate=function(){this.l=null,Je.prototype.doActivate.call(this)},Qs.prototype.doUpdateCursor=function(){var a=this.diagram,b=a.box;null!==b&&b.cursor&&(a.currentCursor=b.cursor)},Qs.prototype.moveParts=function(){var a=this.diagram,b=a.observed;if(null!==b){var t=a.box;if(null!==t){if(null===this.l){var e=a.firstInput.documentPoint;t=t.location,this.l=new St(e.x-t.x,e.y-t.y)}a=a.lastInput.documentPoint,b.position=new St(a.x-this.l.x,a.y-this.l.y)}}},Qs.className="OverviewDraggingTool",_s.prototype.toString=function(){return"CommandHandler"},_s.prototype.ce=function(a){this.B=a},_s.prototype.doKeyDown=function(){var a=this.diagram,b=a.lastInput,t=J?b.meta:b.control,e=b.shift,n=b.alt,o=b.key;!t||"C"!==o&&"Insert"!==o?t&&"X"===o||e&&"Del"===o?this.canCutSelection()&&this.cutSelection():t&&"V"===o||e&&"Insert"===o?this.canPasteSelection()&&this.pasteSelection():t&&"Y"===o||n&&e&&"Backspace"===o?this.canRedo()&&this.redo():t&&"Z"===o||n&&"Backspace"===o?this.canUndo()&&this.undo():"Del"===o||"Backspace"===o?this.canDeleteSelection()&&this.deleteSelection():t&&"A"===o?this.canSelectAll()&&this.selectAll():"Esc"===o?this.canStopCommand()&&this.stopCommand():"Up"===o?a.allowVerticalScroll&&(t?a.scroll("pixel","up"):a.scroll("line","up")):"Down"===o?a.allowVerticalScroll&&(t?a.scroll("pixel","down"):a.scroll("line","down")):"Left"===o?a.allowHorizontalScroll&&(t?a.scroll("pixel","left"):a.scroll("line","left")):"Right"===o?a.allowHorizontalScroll&&(t?a.scroll("pixel","right"):a.scroll("line","right")):"PageUp"===o?e&&a.allowHorizontalScroll?a.scroll("page","left"):a.allowVerticalScroll&&a.scroll("page","up"):"PageDown"===o?e&&a.allowHorizontalScroll?a.scroll("page","right"):a.allowVerticalScroll&&a.scroll("page","down"):"Home"===o?t&&a.allowVerticalScroll?a.scroll("document","up"):!t&&a.allowHorizontalScroll&&a.scroll("document","left"):"End"===o?t&&a.allowVerticalScroll?a.scroll("document","down"):!t&&a.allowHorizontalScroll&&a.scroll("document","right"):" "===o?this.canScrollToPart()&&this.scrollToPart():"Subtract"===o?this.canDecreaseZoom()&&this.decreaseZoom():"Add"===o?this.canIncreaseZoom()&&this.increaseZoom():t&&"0"===o?this.canResetZoom()&&this.resetZoom():e&&"Z"===o?this.canZoomToFit()&&this.zoomToFit():t&&!e&&"G"===o?this.canGroupSelection()&&this.groupSelection():t&&e&&"G"===o?this.canUngroupSelection()&&this.ungroupSelection():b.event&&"F2"===b.event.key?this.canEditTextBlock()&&this.editTextBlock():b.event&&"ContextMenu"===b.event.key?this.canShowContextMenu()&&this.showContextMenu():b.bubbles=!0:this.canCopySelection()&&this.copySelection()},_s.prototype.doKeyUp=function(){this.diagram.lastInput.bubbles=!0},_s.prototype.stopCommand=function(){var a=this.diagram,b=a.currentTool;b instanceof Ge&&a.allowSelect&&a.clearSelection(),null!==b&&b.doCancel()},_s.prototype.canStopCommand=function(){return!0},_s.prototype.selectAll=function(){var a=this.diagram;a.M();try{a.currentCursor="wait",a.R("ChangingSelection",a.selection);for(var b=a.parts;b.next();)b.value.isSelected=!0;for(var t=a.nodes;t.next();)t.value.isSelected=!0;for(var e=a.links;e.next();)e.value.isSelected=!0}finally{a.R("ChangedSelection",a.selection),a.currentCursor=""}},_s.prototype.canSelectAll=function(){return this.diagram.allowSelect},_s.prototype.deleteSelection=function(){var a=this.diagram;try{a.currentCursor="wait",a.R("ChangingSelection",a.selection),a.xa("Delete"),a.R("SelectionDeleting",a.selection);for(var b=new ft,t=a.selection.iterator;t.next();)Iu(b,t.value,!0,this.deletesTree?1/0:0,!!this.deletesConnectedLinks&&null,(function(a){return a.canDelete()}));a.eu(b,!0),a.R("SelectionDeleted",b)}finally{a.Wa("Delete"),a.R("ChangedSelection",a.selection),a.currentCursor=""}},_s.prototype.canDeleteSelection=function(){var a=this.diagram;return!(a.isReadOnly||a.isModelReadOnly||!a.allowDelete||0===a.selection.count)},_s.prototype.copySelection=function(){var a=this.diagram,b=new ft;for(a=a.selection.iterator;a.next();)Iu(b,a.value,!0,this.copiesTree?1/0:0,this.copiesConnectedLinks,(function(a){return a.canCopy()}));this.copyToClipboard(b)},_s.prototype.canCopySelection=function(){var a=this.diagram;return!(!a.allowCopy||!a.allowClipboard||0===a.selection.count)},_s.prototype.cutSelection=function(){this.copySelection(),this.deleteSelection()},_s.prototype.canCutSelection=function(){var a=this.diagram;return!(a.isReadOnly||a.isModelReadOnly||!a.allowCopy||!a.allowDelete||!a.allowClipboard||0===a.selection.count)},_s.prototype.copyToClipboard=function(a){var b=this.diagram,t=null;if(null===a)ls=null,us="";else{t=b.model;var e=!1,n=!1,o=null;try{t.Cm()&&(e=t.qk,t.qk=this.copiesParentKey),t.yk()&&(n=t.pk,t.pk=this.copiesGroupKey),o=b.rk(a,null,!0)}finally{t.Cm()&&(t.qk=e),t.yk()&&(t.pk=n),(t=new ut).addAll(o),ls=t,us=b.model.dataFormat}}b.R("ClipboardChanged",t)},_s.prototype.pasteFromClipboard=function(){var a=new ft,b=ls;if(null===b)return a;var t=this.diagram;if(us!==t.model.dataFormat)return a;var e=t.model,n=!1,o=!1,g=null;try{e.Cm()&&(n=e.qk,e.qk=this.copiesParentKey),e.yk()&&(o=e.pk,e.pk=this.copiesGroupKey),g=t.rk(b,t,!1)}finally{for(e.Cm()&&(e.qk=n),e.yk()&&(e.pk=o),b=g.iterator;b.next();)t=b.value,e=b.key,t.location.u()||(e.location.u()?t.location=e.location:!t.position.u()&&e.position.u()&&(t.position=e.position)),a.add(t)}return a},_s.prototype.pasteSelection=function(a){void 0===a&&(a=null);var b=this.diagram;try{b.currentCursor="wait",b.R("ChangingSelection",b.selection),b.xa("Paste");var t=this.pasteFromClipboard();0<t.count&&b.clearSelection(!0);for(var e=t.iterator;e.next();)e.value.isSelected=!0;if(null!==a){var n=b.computePartsBounds(b.selection);if(n.u())Ar(b,this.computeEffectiveCollection(b.selection,b.il),new St(a.x-n.centerX,a.y-n.centerY),b.il,!1)}b.R("ClipboardPasted",t)}finally{b.Wa("Paste"),b.R("ChangedSelection",b.selection),b.currentCursor=""}},_s.prototype.canPasteSelection=function(){var a=this.diagram;return!(a.isReadOnly||a.isModelReadOnly||!a.allowInsert||!a.allowClipboard||null===ls||0===ls.count||us!==a.model.dataFormat)},_s.prototype.undo=function(){this.diagram.undoManager.undo()},_s.prototype.canUndo=function(){var a=this.diagram;return!a.isReadOnly&&!a.isModelReadOnly&&(a.allowUndo&&a.undoManager.canUndo())},_s.prototype.redo=function(){this.diagram.undoManager.redo()},_s.prototype.canRedo=function(){var a=this.diagram;return!a.isReadOnly&&!a.isModelReadOnly&&(a.allowUndo&&a.undoManager.canRedo())},_s.prototype.decreaseZoom=function(a){void 0===a&&(a=1/this.zoomFactor);var b=this.diagram;b.autoScale===cs&&((a=b.scale*a)<b.minScale||a>b.maxScale||(b.scale=a))},_s.prototype.canDecreaseZoom=function(a){void 0===a&&(a=1/this.zoomFactor);var b=this.diagram;return b.autoScale===cs&&(!((a=b.scale*a)<b.minScale||a>b.maxScale)&&b.allowZoom)},_s.prototype.increaseZoom=function(a){void 0===a&&(a=this.zoomFactor);var b=this.diagram;b.autoScale===cs&&((a=b.scale*a)<b.minScale||a>b.maxScale||(b.scale=a))},_s.prototype.canIncreaseZoom=function(a){void 0===a&&(a=this.zoomFactor);var b=this.diagram;return b.autoScale===cs&&(!((a=b.scale*a)<b.minScale||a>b.maxScale)&&b.allowZoom)},_s.prototype.resetZoom=function(a){void 0===a&&(a=this.defaultScale);var b=this.diagram;a<b.minScale||a>b.maxScale||(b.scale=a)},_s.prototype.canResetZoom=function(a){void 0===a&&(a=this.defaultScale);var b=this.diagram;return!(a<b.minScale||a>b.maxScale)&&b.allowZoom},_s.prototype.zoomToFit=function(){var a=this.diagram,b=a.animationManager;b.Sc(),a.Le();var t=a.position,e=a.scale;th(b,"Zoom To Fit"),this.isZoomToFitRestoreEnabled&&e===this.zv&&!isNaN(this.Zu)&&a.documentBounds.w(this.yv)?(a.scale=this.Zu,a.position=this.zx,this.zv=NaN,this.yv=si):(this.Zu=e,this.zx=t.copy(),a.zoomToFit(),this.zv=a.scale,this.yv=a.documentBounds.copy()),yo(b)},_s.prototype.canZoomToFit=function(){return this.diagram.allowZoom},_s.prototype.scrollToPart=function(a){void 0===a&&(a=null);var b=this.diagram;if(b.Ta(),null===a){try{null!==this.tg&&(this.tg.next()?a=this.tg.value:this.tg=null)}catch(t){this.tg=null}null===a&&(0<b.highlighteds.count?this.tg=b.highlighteds.iterator:0<b.selection.count&&(this.tg=b.selection.iterator),null!==this.tg&&this.tg.next()&&(a=this.tg.value))}if(null!==a){var t=b.animationManager;th(t,"Scroll To Part");var e=this.scrollToPartPause;if(0<e){var n=ta(this,a,[a]);if(1===n.length)b.xa(),b.yt(a.actualBounds),b.Wa("Scroll To Part");else{var o=function(){b.xa();for(var a=n.pop();0<n.length&&a instanceof zu&&a.isTreeExpanded&&(!(a instanceof oc)||a.isSubGraphExpanded);)a=n.pop();0<n.length?(a instanceof yu&&b.Aw(a.actualBounds),a instanceof zu&&!a.isTreeExpanded&&(a.isTreeExpanded=!0),a instanceof oc&&!a.isSubGraphExpanded&&(a.isSubGraphExpanded=!0)):(a instanceof yu&&b.yt(a.actualBounds),b.Jm("LayoutCompleted",g)),b.Wa("Scroll To Part")},g=function(){S(o,(t.isEnabled?t.duration:0)+e)};b.ik("LayoutCompleted",g),o()}}else{var r=b.position.copy();b.yt(a.actualBounds),r.Na(b.position)&&t.Sc()}}},_s.prototype.canScrollToPart=function(a){return void 0===a&&(a=null),(null===a||a instanceof yu)&&((0!==(a=this.diagram).selection.count||0!==a.highlighteds.count)&&(a.allowHorizontalScroll&&a.allowVerticalScroll))},_s.prototype.collapseTree=function(a){void 0===a&&(a=null);var b=this.diagram;try{b.xa("Collapse Tree"),th(b.animationManager,"Collapse Tree");var t=new ut;if(null!==a&&a.isTreeExpanded)a.collapseTree(),t.add(a);else if(null===a)for(var e=b.selection.iterator;e.next();){var n=e.value;n instanceof zu&&n.isTreeExpanded&&(n.collapseTree(),t.add(n))}b.R("TreeCollapsed",t)}finally{b.Wa("Collapse Tree")}},_s.prototype.canCollapseTree=function(a){void 0===a&&(a=null);var b=this.diagram;if(b.isReadOnly)return!1;if(null!==a){if(!(a instanceof zu&&a.isTreeExpanded))return!1;if(0<a.Dq().count)return!0}else for(a=b.selection.iterator;a.next();)if((b=a.value)instanceof zu&&b.isTreeExpanded&&0<b.Dq().count)return!0;return!1},_s.prototype.expandTree=function(a){void 0===a&&(a=null);var b=this.diagram;try{b.xa("Expand Tree"),th(b.animationManager,"Expand Tree");var t=new ut;if(null===a||a.isTreeExpanded){if(null===a)for(var e=b.selection.iterator;e.next();){var n=e.value;n instanceof zu&&!n.isTreeExpanded&&(n.expandTree(),t.add(n))}}else a.expandTree(),t.add(a);b.R("TreeExpanded",t)}finally{b.Wa("Expand Tree")}},_s.prototype.canExpandTree=function(a){void 0===a&&(a=null);var b=this.diagram;if(b.isReadOnly)return!1;if(null!==a){if(!(a instanceof zu)||a.isTreeExpanded)return!1;if(0<a.Dq().count)return!0}else for(a=b.selection.iterator;a.next();)if((b=a.value)instanceof zu&&!b.isTreeExpanded&&0<b.Dq().count)return!0;return!1},_s.prototype.groupSelection=function(){var a=this.diagram,b=a.model;if(b.zk()){var t=this.archetypeGroupData;if(null!==t){var e=null;try{a.currentCursor="wait",a.R("ChangingSelection",a.selection),a.xa("Group");for(var n=new ut,o=a.selection.iterator;o.next();){var g=o.value;g.Oc()&&g.canGroup()&&n.add(g)}for(var r=new ut,h=n.iterator;h.next();){var l=h.value;o=!1;for(var c=n.iterator;c.next();)if(l.Hd(c.value)){o=!0;break}o||r.add(l)}if(0<r.count){var f=r.first().containingGroup;if(null!==f)for(;null!==f;){n=!1;for(var p=r.iterator;p.next();)if(!p.value.Hd(f)){n=!0;break}if(!n)break;f=f.containingGroup}if(t instanceof oc)$h(t),null!==(e=t.copy())&&a.add(e);else if(b.dw(t)){var d=b.copyNodeData(t);j(d)&&(b.wf(d),e=a.fj(d))}if(null!==e){null!==f&&this.isValidMember(f,e)&&(e.containingGroup=f);for(var q=r.iterator;q.next();){var u=q.value;this.isValidMember(e,u)&&(u.containingGroup=e)}a.clearSelection(!0),e.isSelected=!0}}a.R("SelectionGrouped",e)}finally{a.Wa("Group"),a.R("ChangedSelection",a.selection),a.currentCursor=""}}}},_s.prototype.canGroupSelection=function(){var a=this.diagram;if(a.isReadOnly||a.isModelReadOnly||!a.allowInsert||!a.allowGroup||!a.model.zk()||null===this.archetypeGroupData)return!1;for(a=a.selection.iterator;a.next();){var b=a.value;if(b.Oc()&&b.canGroup())return!0}return!1},_s.prototype.isValidMember=function(a,b){if(null===b||a===b||b instanceof uc)return!1;if(null!==a){if(a===b||a.Hd(b))return!1;var t=a.memberValidation;if(null!==t&&!t(a,b)||null===a.data&&null!==b.data||null!==a.data&&null===b.data)return!1}return null===(t=this.memberValidation)||t(a,b)},_s.prototype.ungroupSelection=function(a){void 0===a&&(a=null);var b=this.diagram,t=b.model;if(t.zk())try{b.currentCursor="wait",b.R("ChangingSelection",b.selection),b.xa("Ungroup");var e=new ut;if(null!==a)e.add(a);else for(var n=b.selection.iterator;n.next();){var o=n.value;o instanceof oc&&o.canUngroup()&&e.add(o)}var g=new ut;if(0<e.count){b.clearSelection(!0);for(var r=e.iterator;r.next();){var h=r.value;h.expandSubGraph();var l=h.containingGroup,c=null!==l&&null!==l.data?t.ja(l.data):void 0;g.addAll(h.memberParts);for(var f=g.iterator;f.next();){var p=f.value;if(p.isSelected=!0,!(p instanceof uc)){var d=p.data;null!==d?t.cr(d,c):p.containingGroup=l}}b.remove(h)}}b.R("SelectionUngrouped",e,g)}finally{b.Wa("Ungroup"),b.R("ChangedSelection",b.selection),b.currentCursor=""}},_s.prototype.canUngroupSelection=function(a){void 0===a&&(a=null);var b=this.diagram;if(b.isReadOnly||b.isModelReadOnly||!b.allowDelete||!b.allowUngroup||!b.model.zk())return!1;if(null!==a){if(!(a instanceof oc))return!1;if(a.canUngroup())return!0}else for(a=b.selection.iterator;a.next();)if((b=a.value)instanceof oc&&b.canUngroup())return!0;return!1},_s.prototype.addTopLevelParts=function(a,b){var t=!0;for(a=ia(a).iterator;a.next();){var e=a.value;null!==e.containingGroup&&(!b||this.isValidMember(null,e)?e.containingGroup=null:t=!1)}return t},_s.prototype.collapseSubGraph=function(a){void 0===a&&(a=null);var b=this.diagram;try{b.xa("Collapse SubGraph"),th(b.animationManager,"Collapse SubGraph");var t=new ut;if(null!==a&&a.isSubGraphExpanded)a.collapseSubGraph(),t.add(a);else if(null===a)for(var e=b.selection.iterator;e.next();){var n=e.value;n instanceof oc&&n.isSubGraphExpanded&&(n.collapseSubGraph(),t.add(n))}b.R("SubGraphCollapsed",t)}finally{b.Wa("Collapse SubGraph")}},_s.prototype.canCollapseSubGraph=function(a){void 0===a&&(a=null);var b=this.diagram;if(b.isReadOnly)return!1;if(null!==a)return!!(a instanceof oc&&a.isSubGraphExpanded);for(a=b.selection.iterator;a.next();)if((b=a.value)instanceof oc&&b.isSubGraphExpanded)return!0;return!1},_s.prototype.expandSubGraph=function(a){void 0===a&&(a=null);var b=this.diagram;try{b.xa("Expand SubGraph"),th(b.animationManager,"Expand SubGraph");var t=new ut;if(null===a||a.isSubGraphExpanded){if(null===a)for(var e=b.selection.iterator;e.next();){var n=e.value;n instanceof oc&&!n.isSubGraphExpanded&&(n.expandSubGraph(),t.add(n))}}else a.expandSubGraph(),t.add(a);b.R("SubGraphExpanded",t)}finally{b.Wa("Expand SubGraph")}},_s.prototype.canExpandSubGraph=function(a){void 0===a&&(a=null);var b=this.diagram;if(b.isReadOnly)return!1;if(null!==a)return a instanceof oc&&!a.isSubGraphExpanded;for(a=b.selection.iterator;a.next();)if((b=a.value)instanceof oc&&!b.isSubGraphExpanded)return!0;return!1},_s.prototype.editTextBlock=function(a){void 0===a&&(a=null);var b=this.diagram,t=b.toolManager.findTool("TextEditing");if(null!==t){if(null===a){a=null;for(var e=b.selection.iterator;e.next();){var n=e.value;if(n.canEdit()){a=n;break}}if(null===a)return;a=a.vm((function(a){return a instanceof Sl&&a.editable}))}null!==a&&(b.currentTool=null,t.textBlock=a,b.currentTool=t)}},_s.prototype.canEditTextBlock=function(a){void 0===a&&(a=null);var b=this.diagram;if(b.isReadOnly||b.isModelReadOnly||!b.allowTextEdit||null===b.toolManager.findTool("TextEditing"))return!1;if(null!==a){if(!(a instanceof Sl))return!1;if(null!==(a=a.part)&&a.canEdit())return!0}else for(b=b.selection.iterator;b.next();)if((a=b.value).canEdit()&&null!==(a=a.vm((function(a){return a instanceof Sl&&a.editable}))))return!0;return!1},_s.prototype.showContextMenu=function(a){var b=this.diagram,t=b.toolManager.findTool("ContextMenu");if(null!==t&&(void 0===a&&(a=0<b.selection.count?b.selection.first():b),null!==(a=t.findObjectWithContextMenu(a)))){var e=b.lastInput,n=null;a instanceof ea?n=a.da(bi):b.viewportBounds.$(e.documentPoint)||(n=new St((n=b.viewportBounds).x+n.width/2,n.y+n.height/2)),null!==n&&(e.viewPoint=b.gr(n),e.documentPoint=n,e.left=!1,e.right=!0,e.up=!0),b.currentTool=t,Kn(t,!1,a)}},_s.prototype.canShowContextMenu=function(a){var b=this.diagram,t=b.toolManager.findTool("ContextMenu");return null!==t&&(void 0===a&&(a=0<b.selection.count?b.selection.first():b),null!==t.findObjectWithContextMenu(a))},_s.prototype.computeEffectiveCollection=function(a,b){var t=this.diagram,e=t.toolManager.findTool("Dragging"),n=t.currentTool===e;if(void 0===b&&(b=n?e.dragOptions:t.il),e=new Mt,null===a)return e;for(var o=a.iterator;o.next();)Lr(t,e,o.value,n,b);if(null!==t.draggedLink&&b.dragsLink)return e;for(o=a.iterator;o.next();)(a=o.value)instanceof uc&&(null===(b=a.fromNode)||e.contains(b)?null===(b=a.toNode)||e.contains(b)||e.remove(a):e.remove(a));return e},v.Object.defineProperties(_s.prototype,{diagram:{get:function(){return this.B}},copiesClipboardData:{get:function(){return this.v},set:function(a){this.v=a}},copiesConnectedLinks:{get:function(){return this.I},set:function(a){this.I=a}},deletesConnectedLinks:{get:function(){return this.eb},set:function(a){this.eb=a}},copiesTree:{get:function(){return this.Ka},set:function(a){this.Ka=a}},deletesTree:{get:function(){return this.Uc},set:function(a){this.Uc=a}},copiesParentKey:{get:function(){return this.Ja},set:function(a){this.Ja=a}},copiesGroupKey:{get:function(){return this.T},set:function(a){this.T=a}},archetypeGroupData:{get:function(){return this.l},set:function(a){this.l=a}},memberValidation:{get:function(){return this.Ii},set:function(a){this.Ii=a}},defaultScale:{get:function(){return this.diagram.defaultScale},set:function(a){this.diagram.defaultScale=a}},zoomFactor:{get:function(){return this.Md},set:function(a){1<a||N("zoomFactor must be larger than 1.0, not: "+a),this.Md=a}},isZoomToFitRestoreEnabled:{get:function(){return this.Cc},set:function(a){this.Cc=a}},scrollToPartPause:{get:function(){return this.Vc},set:function(a){this.Vc=a}}}),_s.className="CommandHandler",Uo=function(){return new _s},ea.prototype.cloneProtected=function(a){a.F=6144|this.F,a.hb=this.hb,a.Qa=this.Qa,a.mb=this.mb,a.ec=this.ec,a.Ng=this.Ng,a.la.assign(this.la),a.Zc=this.Zc.G(),a.hg=this.hg.G(),a.gg=this.gg.G(),a.eg=this.eg.copy(),a.ya=this.ya,a.Yb=this.Yb,a.Be=this.Be,a.jh=this.jh.G(),a.qc.assign(this.qc),a.yb.assign(this.yb),a.rc.assign(this.rc),a.qp=this.qp,null!==this.O&&(a.O=this.O.copy()),a.zb=this.zb.G(),a.Yk=this.Yk.G(),a.Dp=this.Dp,a.Ep=this.Ep,a.Sg=this.Sg,a.wn=this.wn,a.Xp=this.Xp,a.Kp=this.Kp,a.Yl=this.Yl,a.Zl=this.Zl.G(),a.$l=this.$l,a.ni=this.ni,null!==this.N&&(a.N=this.N.copy()),a.fb=this.fb,a.bl=this.bl,null!==this.mi&&(a.mi=O(this.mi)),null!==this.Ya&&(a.Ya=this.Ya.copy()),a.bm=this.bm},ea.prototype.Ux=function(a){var b=this.mi;if(D(b)){for(var t=0;t<b.length;t++)if(b[t]===a)return}else this.mi=b=[];b.push(a)},ea.prototype.Af=function(a){a.rp=null,a.Zj=null,a.o()},ea.prototype.clone=function(){var a=new this.constructor;if(this.cloneProtected(a),null!==this.mi)for(var b=0;b<this.mi.length;b++){var t=this.mi[b];a[t]=this[t]}return a},ea.prototype.copy=function(){return this.clone()},(n=ea.prototype).jb=function(a){a.classType===uc?0===a.name.indexOf("Orient")?this.segmentOrientation=a:N("Unknown Link enum value for GraphObject.segmentOrientation property: "+a):a.classType===ea&&(this.stretch=a)},n.toString=function(){return E(this.constructor)+"#"+yt(this)},n.Lc=function(){if(null===this.O){var a=new bf;a.bh=gi,a.Bh=gi,a.$g=10,a.zh=10,a.ah=0,a.Ah=0,this.O=a}},n.bb=function(a,b,t,e,n,o,g){var r=this.part;if(null!==r&&(r.Ok(a,b,t,e,n,o,g),t===this&&a===Fe&&ma(this)&&oa(this,r,b),o=this.diagram,null===this.Ng||null===o||!o.oj||o.undoManager.isUndoingRedoing||o.currentTool!==o.toolManager||o.animationManager.qn||null!==(a=this.Ng.get(b))&&o.animationManager.isEnabled&&!o.animationManager.isTicking&&(null===this.Gp&&(this.Gp=new Mt),g=0===o.undoManager.transactionLevel,a.startCondition===zo?g=!0:a.startCondition===Vo&&(g=!1),g?(function(a,b){null!==(a=a.$k)&&(a.duration&&(b.duration=a.duration),a.finished&&(b.finished=a.finished),a.easing&&(b.easing=a.easing))}(a,o=new To),null!==(g=this.Gp.get(a))&&g.stop(),this.Gp.add(a,o),o.vv=this,o.Px=a,o.add(this,b,e,n),o.start()):(go(o.animationManager,"Trigger"),o.animationManager.defaultAnimation.add(this,b,e,n))),this instanceof Fh&&t===r&&0!=(16777216&r.F)&&null!==r.data))for(e=(t=this.W.j).length,n=0;n<e;n++)(r=t[n])instanceof Fh&&Vh(r,(function(a){null!==a.data&&0!=(16777216&a.F)&&a.Ca(b)}))},n.Ft=function(a){return this.bl===a?this:null},n.g=function(a,b,t){this.bb(Fe,a,this,b,t)},n.ty=function(a,b,t){if(!1===this.pickable)return!1;var e=this.naturalBounds;return b=a.Ge(b),t?Lt(a.x,a.y,0,0,0,e.height)<=b||Lt(a.x,a.y,0,e.height,e.width,e.height)<=b||Lt(a.x,a.y,e.width,e.height,e.width,0)<=b||Lt(a.x,a.y,e.width,0,0,0)<=b:a.rd(0,0)<=b&&a.rd(0,e.height)<=b&&a.rd(e.width,0)<=b&&a.rd(e.width,e.height)<=b},n.fe=function(){return!0},n.$=function(a){var b=St.alloc();b.assign(a),this.transform.sa(b);var t=this.actualBounds;if(!t.u())return St.free(b),!1;var e=this.diagram;if(null!==e&&e.pe){var n=e.zm("extraTouchThreshold"),o=e.zm("extraTouchArea"),g=o/2,r=this.naturalBounds,h=1/(e=this.Cf()*e.scale);if(r.width*e<n&&r.height*e<n)return a=oi(t.x-g*h,t.y-g*h,t.width+o*h,t.height+o*h,b.x,b.y),St.free(b),a}return n=!1,(this instanceof Eu||this instanceof pl?oi(t.x-5,t.y-5,t.width+10,t.height+10,b.x,b.y):t.$(b))&&(n=!(this.Ya&&!this.Ya.$(b))&&(!(null===this.ec||!t.$(b))||(!(null===this.mb||!this.rc.$(a))||this.Jh(a)))),St.free(b),n},n.Jh=function(a){var b=this.naturalBounds;return oi(0,0,b.width,b.height,a.x,a.y)},n.Ee=function(a){if(0===this.angle)return this.actualBounds.Ee(a);var b=this.naturalBounds;b=Jt.allocAt(0,0,b.width,b.height);var t=this.transform,e=!1,n=St.allocAt(a.x,a.y);return b.$(t.Gd(n))&&(n.h(a.x,a.bottom),b.$(t.Gd(n))&&(n.h(a.right,a.bottom),b.$(t.Gd(n))&&(n.h(a.right,a.y),b.$(t.Gd(n))&&(e=!0)))),St.free(n),Jt.free(b),e},n.Ih=function(a,b){if(void 0===b)return a.Ee(this.actualBounds);var t=this.naturalBounds,e=!1,n=St.allocAt(0,0);return a.$(b.sa(n))&&(n.h(0,t.height),a.$(b.sa(n))&&(n.h(t.width,t.height),a.$(b.sa(n))&&(n.h(t.width,0),a.$(b.sa(n))&&(e=!0)))),St.free(n),e},n.Nc=function(a,b){if(void 0===b&&(b=this.transform,0===this.angle))return a.Nc(this.actualBounds);var t=this.naturalBounds,e=St.allocAt(0,0),n=St.allocAt(0,t.height),o=St.allocAt(t.width,t.height),g=St.allocAt(t.width,0),r=!1;if(a.$(b.sa(e))||a.$(b.sa(n))||a.$(b.sa(o))||a.$(b.sa(g)))r=!0;else{t=Jt.allocAt(0,0,t.width,t.height);var h=St.allocAt(a.x,a.y);t.$(b.Gd(h))?r=!0:(h.h(a.x,a.bottom),t.$(b.Gd(h))?r=!0:(h.h(a.right,a.bottom),t.$(b.Gd(h))?r=!0:(h.h(a.right,a.y),t.$(b.Gd(h))&&(r=!0)))),St.free(h),Jt.free(t),!r&&(oe.Pt(a,e,n)||oe.Pt(a,n,o)||oe.Pt(a,o,g)||oe.Pt(a,g,e))&&(r=!0)}return St.free(e),St.free(n),St.free(o),St.free(g),r},n.da=function(a,b){if(void 0===b&&(b=new St),a instanceof $i){var t=this.naturalBounds;b.h(a.x*t.width+a.offsetX,a.y*t.height+a.offsetY)}else b.set(a);return this.Ed.sa(b),b},n.lj=function(a){void 0===a&&(a=new Jt);var b=this.naturalBounds,t=this.Ed,e=St.allocAt(0,0).transform(t);return a.h(e.x,e.y,0,0),e.h(b.width,0).transform(t),ni(a,e.x,e.y,0,0),e.h(b.width,b.height).transform(t),ni(a,e.x,e.y,0,0),e.h(0,b.height).transform(t),ni(a,e.x,e.y,0,0),St.free(e),a},n.kj=function(){var a=this.Ed;return 1===a.m11&&0===a.m12?a=0:0>(a=180*Math.atan2(a.m12,a.m11)/Math.PI)&&(a+=360),a},n.Cf=function(){if(0!=(4096&this.F)==!1)return this.ol;var a=this.ya;return null!==this.panel?a*this.panel.Cf():a},n.Lt=function(a,b){return void 0===b&&(b=new St),b.assign(a),this.Ed.Gd(b),b},n.Mt=function(a,b,t){return this.wk(a.x,a.y,b.x,b.y,t)},n.wk=function(a,b,t,e,n){var o=this.transform,g=1/(o.m11*o.m22-o.m12*o.m21),r=o.m22*g,h=-o.m12*g,l=-o.m21*g,c=o.m11*g,f=g*(o.m21*o.dy-o.m22*o.dx),p=g*(o.m12*o.dx-o.m11*o.dy);return null!==this.areaBackground?(o=this.actualBounds,oe.Ef(o.left,o.top,o.right,o.bottom,a,b,t,e,n)):(g=a*r+b*l+f,a=a*h+b*c+p,b=t*r+e*l+f,t=t*h+e*c+p,n.h(0,0),e=this.naturalBounds,t=oe.Ef(0,0,e.width,e.height,g,a,b,t,n),n.transform(o),t)},ea.prototype.measure=function(a,b,t,e){if(!1!==wa(this)){var n=this.jh,o=n.right+n.left;n=n.top+n.bottom,a=Math.max(a-o,0),b=Math.max(b-n,0),t=Math.max((t||0)-o,0),e=Math.max((e||0)-n,0),o=this.angle,n=this.desiredSize;var g=0;this instanceof pl&&(g=this.strokeWidth),90===o||270===o?(a=isFinite(n.height)?n.height+g:a,b=isFinite(n.width)?n.width+g:b):(a=isFinite(n.width)?n.width+g:a,b=isFinite(n.height)?n.height+g:b),n=t||0,g=e||0;var r=this instanceof Fh;switch(da(this,!0)){case Is:g=n=0,r&&(b=a=1/0);break;case Bs:isFinite(a)&&a>t&&(n=a),isFinite(b)&&b>e&&(g=b);break;case zs:isFinite(a)&&a>t&&(n=a),g=0,r&&(b=1/0);break;case Vs:isFinite(b)&&b>e&&(g=b),n=0,r&&(a=1/0)}r=this.maxSize;var h=this.minSize;n>r.width&&h.width<r.width&&(n=r.width),g>r.height&&h.height<r.height&&(g=r.height),t=Math.max(n/this.scale,h.width),e=Math.max(g/this.scale,h.height),r.width<t&&(t=Math.min(h.width,t)),r.height<e&&(e=Math.min(h.height,e)),a=Math.min(r.width,a),b=Math.min(r.height,b),a=Math.max(t,a),b=Math.max(e,b),90!==o&&270!==o||(o=a,a=b,b=o,o=t,t=e,e=o),this.qc.ea(),this.Fm(a,b,t,e),this.qc.freeze(),this.qc.u()||N("Non-real measuredBounds has been set. Object "+this+", measuredBounds: "+this.qc.toString()),ka(this,!1)}},ea.prototype.Fm=function(){},ea.prototype.Hf=function(){return!1},ea.prototype.arrange=function(a,b,t,e,n){this.El();var o=Jt.alloc();o.assign(this.yb),this.yb.ea(),!1===Ma(this)?this.yb.h(a,b,t,e):this.Hh(a,b,t,e),this.yb.freeze(),this.Ya=void 0===n?null:n,t=!1,void 0!==n?t=!0:(null===(n=this.panel)||n.type!==Fh.TableRow&&n.type!==Fh.TableColumn||(n=n.panel),null!==n&&(n=n.rc,e=this.measuredBounds,null!==this.areaBackground&&(e=this.yb),t=b+e.height,e=a+e.width,t=!(0<=a+.05&&e<=n.width+.05&&0<=b+.05&&t<=n.height+.05),this instanceof Sl&&(a=this.naturalBounds,this.us>a.height||this.ub>a.width))&&(t=!0)),this.F=t?256|this.F:-257&this.F,this.yb.u()||N("Non-real actualBounds has been set. Object "+this+", actualBounds: "+this.yb.toString()),this.Gm(o,this.yb),ol(this,!1),Jt.free(o)},(n=ea.prototype).Hh=function(){},n.Gm=function(a,b){var t=this.part;null!==t&&null!==t.diagram&&(t.selectionObject!==this&&t.resizeObject!==this&&t.rotateObject!==this||Lu(t,!0),this.M(),_t(a,b)||(t.Nh(),this.gp(t)))},n.gp=function(a){null!==this.portId&&(Lu(a,!0),a instanceof zu&&Yu(a,this))},n.cc=function(a,b){if(this.visible){var t=this instanceof Fh&&(this.type===Fh.TableRow||this.type===Fh.TableColumn),e=this.yb;if(t||0!==e.width&&0!==e.height&&!isNaN(e.x)&&!isNaN(e.y)){var n=this.opacity;if(0!==n){var o=1;if(1!==n&&(o=a.globalAlpha,a.globalAlpha=o*n),!this.my(a,b))if(t)ha(this,a,b);else{this instanceof uc&&this.Ck(!1),t=this.transform;var g=this.panel;0!=(4096&this.F)==!0&&ua(this);var r=this.part,h=!1,l=0;if(r&&b.Ie("drawShadows")&&(h=r.isShadowed)){var c=r.shadowOffset;l=Math.max(c.y,c.x)*b.scale*b.Tb}if(!(c=b.wi||!this.Hf())){var f,d=this.naturalBounds,p=(c=this.Yh).m11,y=c.m21,q=c.dx,u=c.m12,m=c.m22,v=c.dy,x=f=0;c=f*p+x*y+q;var w=f*u+x*m+v,k=(f=d.width+l)*p+(x=0)*y+q;f=f*u+x*m+v,x=Math.min(c,k);var M=Math.min(w,f),S=Math.max(c+0,k)-x,P=Math.max(w+0,f)-M;c=x,w=M,k=(f=d.width+l)*p+(x=d.height+l)*y+q,f=f*u+x*m+v,x=Math.min(c,k),M=Math.min(w,f),S=Math.max(c+S,k)-x,P=Math.max(w+P,f)-M,c=x,w=M,k=(f=0)*p+(x=d.height+l)*y+q,f=f*u+x*m+v,x=Math.min(c,k),M=Math.min(w,f),S=Math.max(c+S,k)-x,P=Math.max(w+P,f)-M,c=x,w=M,d=(l=b.viewportBounds).x,p=l.y,c=!(c>l.width+d||d>S+c||w>l.height+p||p>P+w)}if(c){if(c=0!=(256&this.F),a.clipInsteadOfFill&&(c=!1),this instanceof Sl&&(a.font=this.font),c){if(w=g.fe()?g.naturalBounds:g.actualBounds,null!==this.Ya?(S=(d=this.Ya).x,P=d.y,l=d.width,d=d.height):(S=Math.max(e.x,w.x),P=Math.max(e.y,w.y),l=Math.min(e.right,w.right)-S,d=Math.min(e.bottom,w.bottom)-P),S>e.width+e.x||e.x>w.width+w.x)return void(1!==n&&(a.globalAlpha=o));a.save(),a.beginPath(),a.rect(S,P,l,d),a.clip()}if(this.Hf()){if(!r.isVisible())return void(1!==n&&(a.globalAlpha=o));h&&(w=r.shadowOffset,a.Iw(w.x*b.scale*b.Tb,w.y*b.scale*b.Tb,r.shadowBlur),ul(a),a.shadowColor=r.shadowColor)}h&&!0===this.shadowVisible?ul(a):h&&!1===this.shadowVisible&&za(a),r=this.naturalBounds,null!==this.ec&&(la(this,a,this.ec,!0,!0,r,e),this.ec instanceof qa&&this.ec.type===sh?(a.beginPath(),a.rect(e.x,e.y,e.width,e.height),a.He(this.ec)):a.fillRect(e.x,e.y,e.width,e.height)),a.transform(t.m11,t.m12,t.m21,t.m22,t.dx,t.dy),h&&(null!==g&&0!=(512&g.F)||null!==g&&(g.type===Fh.Auto||g.type===Fh.Spot)&&g.rb()!==this)&&null===this.shadowVisible&&za(a),null!==this.mb&&(S=w=0,P=(l=this.naturalBounds).width,l=l.height,d=0,this instanceof pl&&(w=(l=this.na.bounds).x,S=l.y,P=l.width,l=l.height,d=this.strokeWidth),la(this,a,this.mb,!0,!1,r,e),this.mb instanceof qa&&this.mb.type===sh?(a.beginPath(),a.rect(w-d/2,S-d/2,P+d,l+d),a.He(this.mb)):a.fillRect(w-d/2,S-d/2,P+d,l+d)),h&&(null!==this.mb||null!==this.ec||null!==g&&0!=(512&g.F)||null!==g&&(g.type===Fh.Auto||g.type===Fh.Spot)&&g.rb()!==this)?(ya(this,!0),null===this.shadowVisible&&za(a)):ya(this,!1),this.dj(a,b),h&&0!=(512&this.F)==!0&&ul(a),this.Hf()&&h&&za(a),c?(a.restore(),this instanceof Fh?a.uc(!0):a.uc(!1)):t.St()||(b=1/(t.m11*t.m22-t.m12*t.m21),a.transform(t.m22*b,-t.m12*b,-t.m21*b,t.m11*b,b*(t.m21*t.dy-t.m22*t.dx),b*(t.m12*t.dx-t.m11*t.dy)))}}1!==n&&(a.globalAlpha=o)}}}},n.my=function(){return!1},n.dj=function(){},n.Hg=function(a){if(a instanceof Fh)t:{if(this!==a&&null!==a)for(var b=this.panel;null!==b;){if(b===a){a=!0;break t}b=b.panel}a=!1}else a=!1;return a},n.If=function(){if(!this.visible)return!1;var a=this.panel;return null===a||a.If()},n.Ig=function(){for(var a=this instanceof Fh?this:this.panel;null!==a&&a.isEnabled;)a=a.panel;return null===a},n.o=function(a){if(void 0===a&&(a=!1),!0!==wa(this)){ka(this,!0),ol(this,!0);var b=this.panel;null===b||a||b.o()}},n.Bm=function(){!0!==wa(this)&&(ka(this,!0),ol(this,!0))},n.El=function(){0!=(2048&this.F)==!1&&(xa(this,!0),ba(this,!0))},n.bw=function(){ba(this,!0)},n.M=function(){var a=this.part;null!==a&&a.M()},n.rj=function(a){this.qg=a},n.ju=function(){},n.Ew=function(a){return this.la.assign(a),fa(this),!0},n.dr=function(a,b){this.la.x===a&&this.la.y===b||(this.la.h(a,b),this.El())},n.bind=function(a){a.qd=this;var b=this.hj();null!==b&&Zh(b)&&N("Cannot add a Binding to a template that has already been copied: "+a),null===this.fb&&(this.fb=new ut),this.fb.add(a)},n.hj=function(){for(var a=this instanceof Fh?this:this.panel;null!==a;){if(null!==a.ki)return a;a=a.panel}return null},n.Fw=function(a){kr(this,a)},n.Qw=function(a){a.qd=this,null===this.Ng&&(this.Ng=new Mt),this.Ng.add(a.propertyName,a)},v.Object.defineProperties(ea.prototype,{shadowVisible:{get:function(){return this.bm},set:function(a){var b=this.bm;b!==a&&(this.bm=a,this.M(),this.g("shadowVisible",b,a))}},enabledChanged:{get:function(){return null!==this.N?this.N.Tn:null},set:function(a){na(this);var b=this.N.Tn;b!==a&&(this.N.Tn=a,this.g("enabledChanged",b,a))}},segmentOrientation:{get:function(){return this.$l},set:function(a){var b=this.$l;b!==a&&(this.$l=a,this.o(),this.g("segmentOrientation",b,a),a===Ic&&(this.angle=0))}},segmentIndex:{get:function(){return this.Kp},set:function(a){a=Math.round(a);var b=this.Kp;b!==a&&(this.Kp=a,this.o(),this.g("segmentIndex",b,a))}},segmentFraction:{get:function(){return this.Yl},set:function(a){isNaN(a)||0>a?a=0:1<a&&(a=1);var b=this.Yl;b!==a&&(this.Yl=a,this.o(),this.g("segmentFraction",b,a))}},segmentOffset:{get:function(){return this.Zl},set:function(a){var b=this.Zl;b.w(a)||(this.Zl=a=a.G(),this.o(),this.g("segmentOffset",b,a))}},stretch:{get:function(){return this.Be},set:function(a){var b=this.Be;b!==a&&(this.Be=a,this.o(),this.g("stretch",b,a))}},name:{get:function(){return this.Qa},set:function(a){var b=this.Qa;b!==a&&(this.Qa=a,null!==this.part&&(this.part.Vj=null),this.g("name",b,a))}},opacity:{get:function(){return this.hb},set:function(a){var b=this.hb;b!==a&&((0>a||1<a)&&T(a,"0 <= value <= 1",ea,"opacity"),this.hb=a,this.g("opacity",b,a),a=this.diagram,b=this.part,null!==a&&null!==b&&a.M(bu(b,b.actualBounds)))}},visible:{get:function(){return 0!=(1&this.F)},set:function(a){var b=0!=(1&this.F);b!==a&&(this.F^=1,this.g("visible",b,a),null!==(b=this.panel)?b.o():this.Hf()&&this.Pb(a),this.M(),Pa(this))}},pickable:{get:function(){return 0!=(2&this.F)},set:function(a){var b=0!=(2&this.F);b!==a&&(this.F^=2,this.g("pickable",b,a))}},fromLinkableDuplicates:{get:function(){return 0!=(4&this.F)},set:function(a){var b=0!=(4&this.F);b!==a&&(this.F^=4,this.g("fromLinkableDuplicates",b,a))}},fromLinkableSelfNode:{get:function(){return 0!=(8&this.F)},set:function(a){var b=0!=(8&this.F);b!==a&&(this.F^=8,this.g("fromLinkableSelfNode",b,a))}},toLinkableDuplicates:{get:function(){return 0!=(16&this.F)},set:function(a){var b=0!=(16&this.F);b!==a&&(this.F^=16,this.g("toLinkableDuplicates",b,a))}},toLinkableSelfNode:{get:function(){return 0!=(32&this.F)},set:function(a){var b=0!=(32&this.F);b!==a&&(this.F^=32,this.g("toLinkableSelfNode",b,a))}},isPanelMain:{get:function(){return 0!=(64&this.F)},set:function(a){var b=0!=(64&this.F);b!==a&&(this.F^=64,this.o(),this.g("isPanelMain",b,a))}},isActionable:{get:function(){return 0!=(128&this.F)},set:function(a){var b=0!=(128&this.F);b!==a&&(this.F^=128,this.g("isActionable",b,a))}},areaBackground:{get:function(){return this.ec},set:function(a){var b=this.ec;b!==a&&(null!==a&&nh(a,"GraphObject.areaBackground"),a instanceof qa&&a.freeze(),this.ec=a,this.M(),this.g("areaBackground",b,a))}},background:{get:function(){return this.mb},set:function(a){var b=this.mb;b!==a&&(null!==a&&nh(a,"GraphObject.background"),a instanceof qa&&a.freeze(),this.mb=a,this.M(),this.g("background",b,a))}},part:{get:function(){if(this.Hf())return this;if(null!==this.Zj)return this.Zj;var a;for(a=this.panel;a;){if(a instanceof yu)return this.Zj=a;a=a.panel}return null}},svg:{get:function(){return this.bq},set:function(a){this.bq=a}},panel:{get:function(){return this.qg}},layer:{get:function(){var a=this.part;return null!==a?a.layer:null}},diagram:{get:function(){var a=this.part;return null!==a?a.diagram:null}},position:{get:function(){return this.la},set:function(a){var b=a.x,t=a.y,e=this.la,n=e.x,o=e.y;(n===b||isNaN(n)&&isNaN(b))&&(o===t||isNaN(o)&&isNaN(t))?this.ju():(a=a.copy(),this.Ew(a,e)&&this.g("position",e.copy(),a.copy()))}},actualBounds:{get:function(){return this.yb}},scale:{get:function(){return this.ya},set:function(a){var b=this.ya;b!==a&&(0>=a&&N("GraphObject.scale for "+this+" must be greater than zero, not: "+a),this.ya=a,this.o(),this.g("scale",b,a))}},angle:{get:function(){return this.Yb},set:function(a){var b=this.Yb;b!==a&&(0>(a%=360)&&(a+=360),b!==a&&(this.Yb=a,Pa(this),this.o(),this.g("angle",b,a)))}},desiredSize:{get:function(){return this.Zc},set:function(a){var b=a.width,t=a.height,e=this.Zc,n=e.width,o=e.height;(n===b||isNaN(n)&&isNaN(b))&&(o===t||isNaN(o)&&isNaN(t))||(this.Zc=a=a.G(),this.o(),this instanceof pl&&this.dc(),this.g("desiredSize",e,a),ma(this)&&(null!==(a=this.part)&&(oa(this,a,"width"),oa(this,a,"height"))))}},width:{get:function(){return this.Zc.width},set:function(a){var b=this.Zc.width;b===a||isNaN(b)&&isNaN(a)||(b=this.Zc,this.Zc=a=new Ut(a,this.Zc.height).freeze(),this.o(),this instanceof pl&&this.dc(),this.g("desiredSize",b,a),ma(this)&&(null!==(a=this.part)&&oa(this,a,"width")))}},height:{get:function(){return this.Zc.height},set:function(a){var b=this.Zc.height;b===a||isNaN(b)&&isNaN(a)||(b=this.Zc,this.Zc=a=new Ut(this.Zc.width,a).freeze(),this.o(),this instanceof pl&&this.dc(),this.g("desiredSize",b,a),ma(this)&&(null!==(a=this.part)&&oa(this,a,"height")))}},minSize:{get:function(){return this.hg},set:function(a){var b=this.hg;b.w(a)||(a=a.copy(),isNaN(a.width)&&(a.width=0),isNaN(a.height)&&(a.height=0),a.freeze(),this.hg=a,this.o(),this.g("minSize",b,a))}},maxSize:{get:function(){return this.gg},set:function(a){var b=this.gg;b.w(a)||(a=a.copy(),isNaN(a.width)&&(a.width=1/0),isNaN(a.height)&&(a.height=1/0),a.freeze(),this.gg=a,this.o(),this.g("maxSize",b,a))}},measuredBounds:{get:function(){return this.qc}},naturalBounds:{get:function(){return this.rc}},margin:{get:function(){return this.jh},set:function(a){"number"==typeof a&&(a=new ui(a));var b=this.jh;b.w(a)||(this.jh=a=a.G(),this.o(),this.g("margin",b,a))}},transform:{get:function(){return 0!=(2048&this.F)==!0&&ua(this),this.qb}},Ed:{get:function(){return 0!=(4096&this.F)==!0&&ua(this),this.Yh}},alignment:{get:function(){return this.zb},set:function(a){var b=this.zb;b.w(a)||(a.nc()&&!a.Nb()&&N("GraphObject.alignment for "+this+" must be a real Spot or Spot.Default, not: "+a),this.zb=a=a.G(),fa(this),this.g("alignment",b,a))}},column:{get:function(){return this.Sg},set:function(a){a=Math.round(a);var b=this.Sg;b!==a&&(0>a&&T(a,">= 0",ea,"column"),this.Sg=a,this.o(),this.g("column",b,a))}},columnSpan:{get:function(){return this.wn},set:function(a){a=Math.round(a);var b=this.wn;b!==a&&(1>a&&T(a,">= 1",ea,"columnSpan"),this.wn=a,this.o(),this.g("columnSpan",b,a))}},row:{get:function(){return this.Dp},set:function(a){a=Math.round(a);var b=this.Dp;b!==a&&(0>a&&T(a,">= 0",ea,"row"),this.Dp=a,this.o(),this.g("row",b,a))}},rowSpan:{get:function(){return this.Ep},set:function(a){a=Math.round(a);var b=this.Ep;b!==a&&(1>a&&T(a,">= 1",ea,"rowSpan"),this.Ep=a,this.o(),this.g("rowSpan",b,a))}},spanAllocation:{get:function(){return this.Xp},set:function(a){var b=this.Xp;b!==a&&(this.Xp=a,this.o(),this.g("spanAllocation",b,a))}},alignmentFocus:{get:function(){return this.Yk},set:function(a){var b=this.Yk;b.w(a)||(this.Yk=a=a.G(),this.o(),this.g("alignmentFocus",b,a))}},portId:{get:function(){return this.qp},set:function(a){var b=this.qp;if(b!==a){var t=this.part;null===t||t instanceof zu||(N("Cannot set portID on a Link: "+a),t=null),null!==b&&null!==t&&Zu(t,this),this.qp=a,null!==a&&null!==t&&(t.Mh=!0,Ju(t,this)),this.g("portId",b,a)}}},toSpot:{get:function(){return null!==this.O?this.O.Bh:gi},set:function(a){this.Lc();var b=this.O.Bh;b.w(a)||(a=a.G(),this.O.Bh=a,this.g("toSpot",b,a),Sa(this))}},toEndSegmentLength:{get:function(){return null!==this.O?this.O.zh:10},set:function(a){this.Lc();var b=this.O.zh;b!==a&&(0>a&&T(a,">= 0",ea,"toEndSegmentLength"),this.O.zh=a,this.g("toEndSegmentLength",b,a),Sa(this))}},toShortLength:{get:function(){return null!==this.O?this.O.Ah:0},set:function(a){this.Lc();var b=this.O.Ah;b!==a&&(this.O.Ah=a,this.g("toShortLength",b,a),Sa(this))}},toLinkable:{get:function(){return null!==this.O?this.O.gq:null},set:function(a){this.Lc();var b=this.O.gq;b!==a&&(this.O.gq=a,this.g("toLinkable",b,a))}},toMaxLinks:{get:function(){return null!==this.O?this.O.hq:1/0},set:function(a){this.Lc();var b=this.O.hq;b!==a&&(0>a&&T(a,">= 0",ea,"toMaxLinks"),this.O.hq=a,this.g("toMaxLinks",b,a))}},fromSpot:{get:function(){return null!==this.O?this.O.bh:gi},set:function(a){this.Lc();var b=this.O.bh;b.w(a)||(a=a.G(),this.O.bh=a,this.g("fromSpot",b,a),Sa(this))}},fromEndSegmentLength:{get:function(){return null!==this.O?this.O.$g:10},set:function(a){this.Lc();var b=this.O.$g;b!==a&&(0>a&&T(a,">= 0",ea,"fromEndSegmentLength"),this.O.$g=a,this.g("fromEndSegmentLength",b,a),Sa(this))}},fromShortLength:{get:function(){return null!==this.O?this.O.ah:0},set:function(a){this.Lc();var b=this.O.ah;b!==a&&(this.O.ah=a,this.g("fromShortLength",b,a),Sa(this))}},fromLinkable:{get:function(){return null!==this.O?this.O.$n:null},set:function(a){this.Lc();var b=this.O.$n;b!==a&&(this.O.$n=a,this.g("fromLinkable",b,a))}},fromMaxLinks:{get:function(){return null!==this.O?this.O.ao:1/0},set:function(a){this.Lc();var b=this.O.ao;b!==a&&(0>a&&T(a,">= 0",ea,"fromMaxLinks"),this.O.ao=a,this.g("fromMaxLinks",b,a))}},cursor:{get:function(){return this.ni},set:function(a){var b=this.ni;b!==a&&(this.ni=a,this.g("cursor",b,a))}},click:{get:function(){return null!==this.N?this.N.Rf:null},set:function(a){na(this);var b=this.N.Rf;b!==a&&(this.N.Rf=a,this.g("click",b,a))}},doubleClick:{get:function(){return null!==this.N?this.N.Wf:null},set:function(a){na(this);var b=this.N.Wf;b!==a&&(this.N.Wf=a,this.g("doubleClick",b,a))}},contextClick:{get:function(){return null!==this.N?this.N.Sf:null},set:function(a){na(this);var b=this.N.Sf;b!==a&&(this.N.Sf=a,this.g("contextClick",b,a))}},mouseEnter:{get:function(){return null!==this.N?this.N.jg:null},set:function(a){na(this);var b=this.N.jg;b!==a&&(this.N.jg=a,this.g("mouseEnter",b,a))}},mouseLeave:{get:function(){return null!==this.N?this.N.mg:null},set:function(a){na(this);var b=this.N.mg;b!==a&&(this.N.mg=a,this.g("mouseLeave",b,a))}},mouseOver:{get:function(){return null!==this.N?this.N.ng:null},set:function(a){na(this);var b=this.N.ng;b!==a&&(this.N.ng=a,this.g("mouseOver",b,a))}},mouseHover:{get:function(){return null!==this.N?this.N.lg:null},set:function(a){na(this);var b=this.N.lg;b!==a&&(this.N.lg=a,this.g("mouseHover",b,a))}},mouseHold:{get:function(){return null!==this.N?this.N.kg:null},set:function(a){na(this);var b=this.N.kg;b!==a&&(this.N.kg=a,this.g("mouseHold",b,a))}},mouseDragEnter:{get:function(){return null!==this.N?this.N.Uo:null},set:function(a){na(this);var b=this.N.Uo;b!==a&&(this.N.Uo=a,this.g("mouseDragEnter",b,a))}},mouseDragLeave:{get:function(){return null!==this.N?this.N.Vo:null},set:function(a){na(this);var b=this.N.Vo;b!==a&&(this.N.Vo=a,this.g("mouseDragLeave",b,a))}},mouseDrop:{get:function(){return null!==this.N?this.N.ig:null},set:function(a){na(this);var b=this.N.ig;b!==a&&(this.N.ig=a,this.g("mouseDrop",b,a))}},actionDown:{get:function(){return null!==this.N?this.N.dn:null},set:function(a){na(this);var b=this.N.dn;b!==a&&(this.N.dn=a,this.g("actionDown",b,a))}},actionMove:{get:function(){return null!==this.N?this.N.en:null},set:function(a){na(this);var b=this.N.en;b!==a&&(this.N.en=a,this.g("actionMove",b,a))}},actionUp:{get:function(){return null!==this.N?this.N.fn:null},set:function(a){na(this);var b=this.N.fn;b!==a&&(this.N.fn=a,this.g("actionUp",b,a))}},actionCancel:{get:function(){return null!==this.N?this.N.cn:null},set:function(a){na(this);var b=this.N.cn;b!==a&&(this.N.cn=a,this.g("actionCancel",b,a))}},toolTip:{get:function(){return null!==this.N?this.N.xg:null},set:function(a){na(this);var b=this.N.xg;b!==a&&(this.N.xg=a,this.g("toolTip",b,a))}},contextMenu:{get:function(){return null!==this.N?this.N.Tf:null},set:function(a){na(this);var b=this.N.Tf;b!==a&&(this.N.Tf=a,this.g("contextMenu",b,a))}}}),ea.prototype.trigger=ea.prototype.Qw,ea.prototype.setProperties=ea.prototype.Fw,ea.prototype.findTemplateBinder=ea.prototype.hj,ea.prototype.bind=ea.prototype.bind,ea.prototype.isEnabledObject=ea.prototype.Ig,ea.prototype.isVisibleObject=ea.prototype.If,ea.prototype.isContainedBy=ea.prototype.Hg,ea.prototype.getNearestIntersectionPoint=ea.prototype.Mt,ea.prototype.getLocalPoint=ea.prototype.Lt,ea.prototype.getDocumentScale=ea.prototype.Cf,ea.prototype.getDocumentAngle=ea.prototype.kj,ea.prototype.getDocumentBounds=ea.prototype.lj,ea.prototype.getDocumentPoint=ea.prototype.da,ea.prototype.intersectsRect=ea.prototype.Nc,ea.prototype.containedInRect=ea.prototype.Ih,ea.prototype.containsRect=ea.prototype.Ee,ea.prototype.containsPoint=ea.prototype.$,ea.prototype.raiseChanged=ea.prototype.g,ea.prototype.raiseChangedEvent=ea.prototype.bb,ea.prototype.addCopyProperty=ea.prototype.Ux;var Aa=null;function ja(){this.Tn=this.Tf=this.xg=this.cn=this.fn=this.en=this.dn=this.ig=this.Vo=this.Uo=this.kg=this.lg=this.ng=this.mg=this.jg=this.Sf=this.Wf=this.Rf=null}function Da(){this.Ma=[1,0,0,1,0,0]}function Oa(a){this.type=a,this.r2=this.y2=this.x2=this.r1=this.y1=this.x1=0,this.ey=[],this.pattern=null}function Fa(a,b){this.ownerDocument=a=void 0===b?w.document:b,this.LA="http://www.w3.org/2000/svg",void 0!==a&&(this.Ga=this.xb("svg",{width:"1px",height:"1px",viewBox:"0 0 1 1"}),this.Ga.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns","http://www.w3.org/2000/svg"),this.Ga.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink")),this.zq=null,this.context=new Ba(this)}function Ba(a){this.Rk=a,this.svg=a.Ga,this.stack=[],this.Ac=[],this.fillStyle="#000000",this.font="10px sans-serif",this.globalAlpha=1,this.lineCap="butt",this.lineDashOffset=0,this.lineJoin="miter",this.lineWidth=1,this.miterLimit=10,this.shadowBlur=0,this.shadowColor="rgba(0, 0, 0, 0)",this.shadowOffsetY=this.shadowOffsetX=0,this.strokeStyle="#000000",this.textAlign="start",this.clipInsteadOfFill=!1,this.lf=this.Tp=this.Sp=0,this.Mq=null,this.path=[],this.Su=!1,this.uh=null,this.vh=0,this.ae=new Da,Ea(this,1,0,0,1,0,0);var b=mt++,t=this.xb("clipPath",{id:"mainClip"+b});t.appendChild(this.xb("rect",{x:0,y:0,width:a.width,height:a.height})),this.av=t,this.Rk.Ga.appendChild(t),this.Ac[0].setAttributeNS(null,"clip-path","url(#mainClip"+b+")"),this.NA={}}function Ia(a,b,t,e,n){1!==a.globalAlpha&&(t.opacity=a.globalAlpha),"fill"===b?(a.fillStyle instanceof Oa?t.fill=Ra(a,a.fillStyle):/^rgba\(/.test(a.fillStyle)?(a=/^\s*rgba\s*\(([^,\s]+)\s*,\s*([^,\s]+)\s*,\s*([^,\s]+)\s*,\s*([^,\s]+)\)\s*$/i.exec(a.fillStyle),t.fill="rgb("+a[1]+","+a[2]+","+a[3]+")",t["fill-opacity"]=a[4]):t.fill=a.fillStyle,t.stroke="none"):"stroke"===b&&(t.fill="none",a.strokeStyle instanceof Oa?t.stroke=Ra(a,a.strokeStyle):/^rgba\(/.test(a.strokeStyle)?(b=/^\s*rgba\s*\(([^,\s]+)\s*,\s*([^,\s]+)\s*,\s*([^,\s]+)\s*,\s*([^,\s]+)\)\s*$/i.exec(a.strokeStyle),t.stroke="rgb("+b[1]+","+b[2]+","+b[3]+")",t["stroke-opacity"]=b[4]):t.stroke=a.strokeStyle,t["stroke-width"]=a.lineWidth,t["stroke-linecap"]=a.lineCap,t["stroke-linejoin"]=a.lineJoin,t["stroke-miterlimit"]=a.miterLimit),e="matrix("+(e=e.Ma)[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+")",void 0!==n&&(e+=n),t.transform=e}function Ra(a,b){var t="GRAD"+mt++;if("linear"===b.type)var e=a.xb("linearGradient",{x1:b.x1,x2:b.x2,y1:b.y1,y2:b.y2,id:t,gradientUnits:"userSpaceOnUse"});else{if("radial"!==b.type)throw Error("invalid gradient");e=a.xb("radialGradient",{x1:b.x1,x2:b.x2,y1:b.y1,y2:b.y2,r1:b.r1,r2:b.r2,id:t})}var n=b.ey;b=n.length;for(var o=[],g=0;g<b;g++){var r=n[g],h=r.color;r={offset:r.offset,"stop-color":h},/^rgba\(/.test(h)&&(h=/^\s*rgba\s*\(([^,\s]+)\s*,\s*([^,\s]+)\s*,\s*([^,\s]+)\s*,\s*([^,\s]+)\)\s*$/i.exec(h),r["stop-color"]="rgb("+h[1]+","+h[2]+","+h[3]+")",r["stop-opacity"]=h[4]),o.push(r)}for(o.sort((function(a,b){return a.offset>b.offset?1:-1})),n=0;n<b;n++)e.appendChild(a.xb("stop",o[n]));return a.svg.appendChild(e),"url(#"+t+")"}function Ea(a,b,t,e,n,o,g){var r=new Da;r.Ma=[b,t,e,n,o,g],Ia(a,"g",b={},r),r=a.addElement("g",b),a.Ac.push(r)}function za(a){a.shadowOffsetX=0,a.shadowOffsetY=0,a.shadowBlur=0}function ul(a){a.shadowOffsetX=a.Sp,a.shadowOffsetY=a.Tp,a.shadowBlur=a.lf}function Va(a,b){this.ownerDocument=b=void 0===b?w.document:b,this.zq=null,(b=b.createElement("canvas")).tabIndex=0,this.Ga=b,this.Ga.innerHTML="This text is displayed if your browser does not support the Canvas HTML element.",this.context=new Ga(b),b.B=a}function Ga(a){a.getContext&&a.getContext("2d")||N("Browser does not support HTML Canvas Element"),this.Y=a.getContext("2d"),this.uu=this.wu=this.vu="",this.vn=!1,this.lf=this.Tp=this.Sp=0}ea.className="GraphObject",Aa=new Mt,Ta("Button",(function(){function a(a,b){return null!==a.diagram.Vb(a.documentPoint,(function(a){for(;null!==a.panel&&!a.isActionable;)a=a.panel;return a}),(function(a){return a===b}))}var b=Na(Fh,Fh.Auto,{isActionable:!0,enabledChanged:function(a,b){if(a instanceof Fh){var t=a.ab("ButtonBorder");null!==t&&(t.fill=b?a._buttonFillNormal:a._buttonFillDisabled)}},cursor:"pointer",_buttonFillNormal:"#F5F5F5",_buttonStrokeNormal:"#BDBDBD",_buttonFillOver:"#E0E0E0",_buttonStrokeOver:"#9E9E9E",_buttonFillPressed:"#BDBDBD",_buttonStrokePressed:"#9E9E9E",_buttonFillDisabled:"#E5E5E5"},Na(pl,{name:"ButtonBorder",figure:"RoundedRectangle",spot1:new $i(0,0,2.76142374915397,2.761423749153969),spot2:new $i(1,1,-2.76142374915397,-2.761423749153969),parameter1:2,parameter2:2,fill:"#F5F5F5",stroke:"#BDBDBD"}));return b.mouseEnter=function(a,b){if(b.Ig()&&b instanceof Fh&&(a=b.ab("ButtonBorder"))instanceof pl){var t=b._buttonFillOver;b._buttonFillNormal=a.fill,a.fill=t,t=b._buttonStrokeOver,b._buttonStrokeNormal=a.stroke,a.stroke=t}},b.mouseLeave=function(a,b){b.Ig()&&b instanceof Fh&&((a=b.ab("ButtonBorder"))instanceof pl&&(a.fill=b._buttonFillNormal,a.stroke=b._buttonStrokeNormal))},b.actionDown=function(a,b){if(b.Ig()&&b instanceof Fh&&null!==b._buttonFillPressed&&0===a.button){var t=b.ab("ButtonBorder");if(t instanceof pl){var e=(a=a.diagram).skipsUndoManager;a.skipsUndoManager=!0;var g=b._buttonFillPressed;b._buttonFillOver=t.fill,t.fill=g,g=b._buttonStrokePressed,b._buttonStrokeOver=t.stroke,t.stroke=g,a.skipsUndoManager=e}}},b.actionUp=function(b,t){if(t.Ig()&&t instanceof Fh&&null!==t._buttonFillPressed&&0===b.button){var e=t.ab("ButtonBorder");if(e instanceof pl){var n=b.diagram,g=n.skipsUndoManager;n.skipsUndoManager=!0,a(b,t)?(e.fill=t._buttonFillOver,e.stroke=t._buttonStrokeOver):(e.fill=t._buttonFillNormal,e.stroke=t._buttonStrokeNormal),n.skipsUndoManager=g}}},b.actionCancel=function(b,t){if(t.Ig()&&t instanceof Fh&&null!==t._buttonFillPressed){var e=t.ab("ButtonBorder");if(e instanceof pl){var n=b.diagram,g=n.skipsUndoManager;n.skipsUndoManager=!0,a(b,t)?(e.fill=t._buttonFillOver,e.stroke=t._buttonStrokeOver):(e.fill=t._buttonFillNormal,e.stroke=t._buttonStrokeNormal),n.skipsUndoManager=g}}},b.actionMove=function(b,t){if(t.Ig()&&t instanceof Fh&&null!==t._buttonFillPressed){var e=b.diagram;if(0===e.firstInput.button&&(e.currentTool.standardMouseOver(),a(b,t)&&(b=t.ab("ButtonBorder"))instanceof pl)){var n=e.skipsUndoManager;e.skipsUndoManager=!0;var g=t._buttonFillPressed;b.fill!==g&&(b.fill=g),g=t._buttonStrokePressed,b.stroke!==g&&(b.stroke=g),e.skipsUndoManager=n}}},b})),Ta("TreeExpanderButton",(function(){var a=Na("Button",{_treeExpandedFigure:"MinusLine",_treeCollapsedFigure:"PlusLine"},Na(pl,{name:"ButtonIcon",figure:"MinusLine",stroke:"#424242",strokeWidth:2,desiredSize:Vt},new Ud("figure","isTreeExpanded",(function(a,t){return t=t.panel,a?t._treeExpandedFigure:t._treeCollapsedFigure})).Sq()),{visible:!1},new Ud("visible","isTreeLeaf",(function(a){return!a})).Sq());return a.click=function(a,t){if((t=t.part)instanceof Eu&&(t=t.adornedPart),t instanceof zu){var b=t.diagram;if(null!==b){if(b=b.commandHandler,t.isTreeExpanded){if(!b.canCollapseTree(t))return}else if(!b.canExpandTree(t))return;a.handled=!0,t.isTreeExpanded?b.collapseTree(t):b.expandTree(t)}}},a})),Ta("SubGraphExpanderButton",(function(){var a=Na("Button",{_subGraphExpandedFigure:"MinusLine",_subGraphCollapsedFigure:"PlusLine"},Na(pl,{name:"ButtonIcon",figure:"MinusLine",stroke:"#424242",strokeWidth:2,desiredSize:Vt},new Ud("figure","isSubGraphExpanded",(function(a,t){return t=t.panel,a?t._subGraphExpandedFigure:t._subGraphCollapsedFigure})).Sq()));return a.click=function(a,t){if((t=t.part)instanceof Eu&&(t=t.adornedPart),t instanceof oc){var b=t.diagram;if(null!==b){if(b=b.commandHandler,t.isSubGraphExpanded){if(!b.canCollapseSubGraph(t))return}else if(!b.canExpandSubGraph(t))return;a.handled=!0,t.isSubGraphExpanded?b.collapseSubGraph(t):b.expandSubGraph(t)}}},a})),Ta("ToolTip",(function(){return Na(Eu,Fh.Auto,{isShadowed:!0,shadowColor:"rgba(0, 0, 0, .4)",shadowOffset:new St(0,3),shadowBlur:5},Na(pl,{name:"Border",figure:"RoundedRectangle",parameter1:1,parameter2:1,fill:"#F5F5F5",stroke:"#F0F0F0",spot1:new $i(0,0,4,6),spot2:new $i(1,1,-4,-4)}))})),Ta("ContextMenu",(function(){return Na(Eu,Fh.Vertical,{background:"#F5F5F5",isShadowed:!0,shadowColor:"rgba(0, 0, 0, .4)",shadowOffset:new St(0,3),shadowBlur:5},new Ud("background","",(function(a){return null!==a.adornedPart&&null!==a.placeholder?null:"#F5F5F5"})))})),Ta("ContextMenuButton",(function(){var a=Na("Button");a.stretch=zs;var b=a.ab("ButtonBorder");return b instanceof pl&&(b.figure="Rectangle",b.strokeWidth=0,b.spot1=new $i(0,0,2,3),b.spot2=new $i(1,1,-2,-2)),a})),Ta("PanelExpanderButton",(function(a){var b=La(a,"COLLAPSIBLE"),t=Na("Button",{_buttonExpandedFigure:"M0 0 M0 6 L4 2 8 6 M8 8",_buttonCollapsedFigure:"M0 0 M0 2 L4 6 8 2 M8 8",_buttonFillNormal:"rgba(0, 0, 0, 0)",_buttonStrokeNormal:null,_buttonFillOver:"rgba(0, 0, 0, .2)",_buttonStrokeOver:null,_buttonFillPressed:"rgba(0, 0, 0, .4)",_buttonStrokePressed:null},Na(pl,{name:"ButtonIcon",strokeWidth:2},new Ud("geometryString","visible",(function(a){return a?t._buttonExpandedFigure:t._buttonCollapsedFigure})).Sq(b)));return(a=t.ab("ButtonBorder"))instanceof pl&&(a.stroke=null,a.fill="rgba(0, 0, 0, 0)"),t.click=function(a,t){var e=t.diagram;if(null!==e&&!e.isReadOnly){var n=t.hj();null===n&&(n=t.part),null!==n&&(null!==(t=n.ab(b))&&(a.handled=!0,e.xa("Collapse/Expand Panel"),t.visible=!t.visible,e.Wa("Collapse/Expand Panel")))}},t})),Ta("CheckBoxButton",(function(a){var b=La(a);return(a=Na("Button",{desiredSize:new Ut(14,14)},Na(pl,{name:"ButtonIcon",geometryString:"M0 0 M0 8.85 L4.9 13.75 16.2 2.45 M16.2 16.2",strokeWidth:2,stretch:Bs,geometryStretch:Rs,visible:!1},""!==b?new Ud("visible",b).Ky():[]))).click=function(a,t){if(t instanceof Fh){var e=a.diagram;if(!(null===e||e.isReadOnly||""!==b&&e.model.isReadOnly)){a.handled=!0;var n=t.ab("ButtonIcon");e.xa("checkbox"),n.visible=!n.visible,"function"==typeof t._doClick&&t._doClick(a,t),e.Wa("checkbox")}}},a})),Ta("CheckBox",(function(a){a=Na("CheckBoxButton",a=La(a),{name:"Button",isActionable:!1,margin:new ui(0,1,0,0)});var b=Na(Fh,"Horizontal",a,{isActionable:!0,cursor:a.cursor,margin:1,_buttonFillNormal:a._buttonFillNormal,_buttonStrokeNormal:a._buttonStrokeNormal,_buttonFillOver:a._buttonFillOver,_buttonStrokeOver:a._buttonStrokeOver,_buttonFillPressed:a._buttonFillPressed,_buttonStrokePressed:a._buttonStrokePressed,_buttonFillDisabled:a._buttonFillDisabled,mouseEnter:a.mouseEnter,mouseLeave:a.mouseLeave,actionDown:a.actionDown,actionUp:a.actionUp,actionCancel:a.actionCancel,actionMove:a.actionMove,click:a.click,_buttonClick:a.click});return a.mouseEnter=null,a.mouseLeave=null,a.actionDown=null,a.actionUp=null,a.actionCancel=null,a.actionMove=null,a.click=null,b})),ea.None=Is=new _(ea,"None",0),ea.Default=Es=new _(ea,"Default",0),ea.Vertical=Vs=new _(ea,"Vertical",4),ea.Horizontal=zs=new _(ea,"Horizontal",5),ea.Fill=Bs=new _(ea,"Fill",3),ea.Uniform=Rs=new _(ea,"Uniform",1),ea.UniformToFill=Gs=new _(ea,"UniformToFill",2),ea.FlipVertical=Ys=new _(ea,"FlipVertical",1),ea.FlipHorizontal=Xs=new _(ea,"FlipHorizontal",2),ea.FlipBoth=dl=new _(ea,"FlipBoth",3),ea.make=Na,ea.getBuilders=function(){var b,a=new Mt;for(b in Aa)if(b!==b.toLowerCase()){var t=Aa.H(b);"function"==typeof t&&a.add(b,t)}return a.freeze(),a},ea.defineBuilder=Ta,ea.takeBuilderArgument=La,ja.prototype.copy=function(){var a=new ja;return a.Rf=this.Rf,a.Wf=this.Wf,a.Sf=this.Sf,a.jg=this.jg,a.mg=this.mg,a.ng=this.ng,a.lg=this.lg,a.kg=this.kg,a.Uo=this.Uo,a.Vo=this.Vo,a.ig=this.ig,a.dn=this.dn,a.en=this.en,a.fn=this.fn,a.cn=this.cn,a.xg=this.xg,a.Tf=this.Tf,a.Tn=this.Tn,a},ja.className="GraphObjectEventHandlers",Da.prototype.copy=function(){var a=new Da;return a.Ma[0]=this.Ma[0],a.Ma[1]=this.Ma[1],a.Ma[2]=this.Ma[2],a.Ma[3]=this.Ma[3],a.Ma[4]=this.Ma[4],a.Ma[5]=this.Ma[5],a},Da.prototype.translate=function(a,b){this.Ma[4]+=this.Ma[0]*a+this.Ma[2]*b,this.Ma[5]+=this.Ma[1]*a+this.Ma[3]*b},Da.prototype.scale=function(a,b){this.Ma[0]*=a,this.Ma[1]*=a,this.Ma[2]*=b,this.Ma[3]*=b},Da.className="STransform",Oa.prototype.addColorStop=function(a,b){this.ey.push({offset:a,color:b})},Oa.className="SGradient",Fa.prototype.resize=function(a,b,t,e){return(this.width!==a||this.height!==b)&&(this.style.width=t+"px",this.style.height=e+"px",this.Ga.setAttributeNS(null,"width",t+"px"),this.Ga.setAttributeNS(null,"height",e+"px"),this.Ga.setAttributeNS(null,"viewBox","0 0 "+t+" "+e),this.context.av.firstElementChild.setAttributeNS(null,"width",t+"px"),this.context.av.firstElementChild.setAttributeNS(null,"height",e+"px"),!0)},Fa.prototype.xb=function(a,b,t){if(a=this.ownerDocument.createElementNS(this.LA,a),j(b))for(var e in b)a.setAttributeNS("href"===e?"http://www.w3.org/1999/xlink":"",e,b[e]);return void 0!==t&&(a.textContent=t),a},Fa.prototype.getBoundingClientRect=function(){return this.Ga.getBoundingClientRect()},Fa.prototype.focus=function(){this.Ga.focus()},Fa.prototype.ly=function(){this.ownerDocument=null},v.Object.defineProperties(Fa.prototype,{width:{get:function(){return this.Ga.width.baseVal.value},set:function(a){this.Ga.width=a}},height:{get:function(){return this.Ga.height.baseVal.value},set:function(a){this.Ga.height=a}},style:{get:function(){return this.Ga.style}}}),Fa.className="SVGSurface",(n=Ba.prototype).reset=function(){this.stack=[],this.Ac=[],this.fillStyle="#000000",this.font="10px sans-serif",this.globalAlpha=1,this.lineCap="butt",this.lineDashOffset=0,this.lineJoin="miter",this.lineWidth=1,this.miterLimit=10,this.shadowBlur=0,this.shadowColor="rgba(0, 0, 0, 0)",this.shadowOffsetY=this.shadowOffsetX=0,this.strokeStyle="#000000",this.textAlign="start",this.clipInsteadOfFill=!1,this.lf=this.Tp=this.Sp=0,this.Mq=null,this.path=[],this.ae=new Da,Ea(this,1,0,0,1,0,0);var a=mt++,b=this.xb("clipPath",{id:"mainClip"+a});b.appendChild(this.xb("rect",{x:0,y:0,width:this.Rk.width,height:this.Rk.height})),this.av=b,this.Rk.Ga.appendChild(b),this.Ac[0].setAttributeNS(null,"clip-path","url(#mainClip"+a+")")},n.arc=function(a,b,t,e,n,o,g,r){var h=2*Math.PI,l=h-1e-6,c=t*Math.cos(e),f=t*Math.sin(e),p=a+c,d=b+f,q=o?0:1;e=o?e-n:n-e,(1e-6<Math.abs(g-p)||1e-6<Math.abs(r-d))&&this.path.push(["L",p,+d]),0>e&&(e=e%h+h),e>l?(this.path.push(["A",t,t,0,1,q,a-c,b-f]),this.path.push(["A",t,t,0,1,q,p,d])):1e-6<e&&this.path.push(["A",t,t,0,+(e>=Math.PI),q,a+t*Math.cos(n),b+t*Math.sin(n)])},n.beginPath=function(){this.path=[]},n.bezierCurveTo=function(a,b,t,e,n,o){this.path.push(["C",a,b,t,e,n,o])},n.clearRect=function(){},n.clip=function(){this.addPath("clipPath",this.path,this.ae),this.addPath("clipPath",this.path,new Da)},n.closePath=function(){this.path.push(["z"])},n.createLinearGradient=function(a,b,t,e){var n=new Oa("linear");return n.x1=a,n.y1=b,n.x2=t,n.y2=e,n},n.createPattern=function(a){var b="";a instanceof HTMLCanvasElement&&(b=a.toDataURL()),a instanceof HTMLImageElement&&(b=a.getAttribute("src"));var t=this.NA;if(t[b])return"url(#"+t[b]+")";var e="PATTERN"+mt++,n={x:0,y:0,width:a.width,height:a.height,href:b};return(a=this.xb("pattern",{width:a.width,height:a.height,id:e,patternUnits:"userSpaceOnUse"})).appendChild(this.xb(Cs,n)),this.svg.appendChild(a),t[b]=e,"url(#"+e+")"},n.createRadialGradient=function(a,b,t,e,n,o){var g=new Oa("radial");return g.x1=a,g.y1=b,g.r1=t,g.x2=e,g.y2=n,g.r2=o,g},n.drawImage=function(a,b,t,e,n,o,g,r,h){var l="";a instanceof HTMLCanvasElement&&(l=a.toDataURL()),a instanceof HTMLImageElement&&(l=a.getAttribute("src"));var c=a instanceof HTMLImageElement?a.naturalWidth:a.width,f=a instanceof HTMLImageElement?a.naturalHeight:a.height;void 0===e&&(o=b,g=t,r=e=c,h=n=f),e=e||0,n=n||0,o=o||0,g=g||0,r=r||0,h=h||0,a={x:0,y:0,width:c||e,height:f||n,href:l},oe.aa(e,r)&&oe.aa(n,h)?-1===l.toLowerCase().indexOf(".svg")&&-1===l.toLowerCase().indexOf("data:image/svg")&&(a.preserveAspectRatio="xMidYMid slice"):a.preserveAspectRatio="none",l="",h/=n,0===o&&0===g||(l+=" translate("+o+", "+g+")"),1===(r/=e)&&1===h||(l+=" scale("+r+", "+h+")"),0===b&&0===t||(l+=" translate("+-b+", "+-t+")"),0===b&&0===t&&e===c&&n===f||(o="CLIP"+mt++,(g=this.xb("clipPath",{id:o})).appendChild(this.xb("rect",{x:b,y:t,width:e,height:n})),this.svg.appendChild(g),a["clip-path"]="url(#"+o+")"),Ia(this,Cs,a,this.ae,l),this.addElement(Cs,a)},n.fill=function(){this.addPath("fill",this.path,this.ae)},n.He=function(){this.clipInsteadOfFill?this.clip():this.fill()},n.fillRect=function(a,b,t,e){Ia(this,"fill",a={x:(a=[a,b,t,e])[0],y:a[1],width:a[2],height:a[3]},this.ae),this.addElement("rect",a)},n.fillText=function(a,b,t){a=[a,b,t],"left"===(b=this.textAlign)?b="start":"right"===b?b="end":"center"===b&&(b="middle"),Ia(this,"fill",b={x:a[1],y:a[2],style:"font: "+this.font,"text-anchor":b},this.ae),this.addElement("text",b,a[0])},n.lineTo=function(a,b){this.path.push(["L",a,b])},n.moveTo=function(a,b){this.path.push(["M",a,b])},n.quadraticCurveTo=function(a,b,t,e){this.path.push(["Q",a,b,t,e])},n.rect=function(a,b,t,e){this.path.push(["M",a,b],["L",a+t,b],["L",a+t,b+e],["L",a,b+e],["z"])},n.restore=function(){this.ae=this.stack.pop(),this.path=this.stack.pop();var a=this.stack.pop();this.fillStyle=a.fillStyle,this.font=a.font,this.globalAlpha=a.globalAlpha,this.lineCap=a.lineCap,this.lineDashOffset=a.lineDashOffset,this.lineJoin=a.lineJoin,this.lineWidth=a.lineWidth,this.miterLimit=a.miterLimit,this.shadowBlur=a.shadowBlur,this.shadowColor=a.shadowColor,this.shadowOffsetX=a.shadowOffsetX,this.shadowOffsetY=a.shadowOffsetY,this.strokeStyle=a.strokeStyle,this.textAlign=a.textAlign},n.save=function(){this.stack.push({fillStyle:this.fillStyle,font:this.font,globalAlpha:this.globalAlpha,lineCap:this.lineCap,lineDashOffset:this.lineDashOffset,lineJoin:this.lineJoin,lineWidth:this.lineWidth,miterLimit:this.miterLimit,shadowBlur:this.shadowBlur,shadowColor:this.shadowColor,shadowOffsetX:this.shadowOffsetX,shadowOffsetY:this.shadowOffsetY,strokeStyle:this.strokeStyle,textAlign:this.textAlign});for(var a=[],b=0;b<this.path.length;b++)a.push(this.path[b]);this.stack.push(a),this.stack.push(this.ae.copy())},n.setTransform=function(a,b,t,e,n,o){1===a&&0===b&&0===t&&1===e&&0===n&&0===o||Ea(this,a,b,t,e,n,o)},n.scale=function(a,b){this.ae.scale(a,b)},n.translate=function(a,b){this.ae.translate(a,b)},n.transform=function(){},n.stroke=function(){this.addPath("stroke",this.path,this.ae)},n.uj=function(){this.clipInsteadOfFill||this.stroke()},n.xb=function(a,b,t){return this.Rk.xb(a,b,t)},n.addElement=function(a,b,t){return a=this.xb(a,b,t),0<this.Ac.length?this.Ac[this.Ac.length-1].appendChild(a):this.svg.appendChild(a),this.Mq=a},n.addPath=function(a,b,t){for(var e=[],n=0;n<b.length;n++){var o=O(b[n]),g=[o.shift()];if("A"===g[0])g.push(o.shift()+","+o.shift(),o.shift(),o.shift()+","+o.shift(),o.shift()+","+o.shift());else for(;o.length;)g.push(o.shift()+","+o.shift());e.push(g.join(" "))}b={d:e.join(" ")},"stroke"===a&&this.Su&&(b["stroke-dasharray"]=this.uh.toString(),b["stroke-dashoffset"]=this.vh),Ia(this,a,b,t),"clipPath"===a?(a="CLIP"+mt++,(t=this.xb("clipPath",{id:a})).appendChild(this.xb("path",b)),this.svg.appendChild(t),0<this.Ac.length&&this.Ac[this.Ac.length-1].setAttributeNS(null,"clip-path","url(#"+a+")")):this.addElement("path",b)},n.er=function(){if(0!==this.shadowOffsetX||0!==this.shadowOffsetY||0!==this.shadowBlur){var a="SHADOW"+mt++,b=this.addElement("filter",{id:a,x:"-100%",y:"-100%",width:"300%",height:"300%"},null),t=this.xb("feGaussianBlur",{in:"SourceAlpha",result:"blur",yB:this.shadowBlur/2}),e=this.xb("feFlood",{in:"blur",result:"flood","flood-color":this.shadowColor}),n=this.xb("feComposite",{in:"flood",in2:"blur",operator:"in",result:"comp"}),o=this.xb("feOffset",{in:"comp",result:"offsetBlur",dx:this.shadowOffsetX,dy:this.shadowOffsetY}),g=this.xb("feMerge",{});g.appendChild(this.xb("feMergeNode",{in:"offsetBlur"})),g.appendChild(this.xb("feMergeNode",{in:"SourceGraphic"})),b.appendChild(t),b.appendChild(e),b.appendChild(n),b.appendChild(o),b.appendChild(g),0<this.Ac.length&&this.Ac[this.Ac.length-1].setAttributeNS(null,"filter","url(#"+a+")")}},n.Iw=function(a,b,t){this.Sp=a,this.Tp=b,this.lf=t},n.Et=function(a,b){this.Su=!0,this.uh=a,this.vh=b},n.Ct=function(){this.Su=!1},n.uc=function(){},n.Uy=function(){},Ba.prototype.rotate=function(){},Ba.prototype.getImageData=function(){return null},Ba.prototype.measureText=function(){return null},Ba.className="SVGContext",Xo.prototype.Yt=function(a){var b=new Fa(this,w.document);void 0===a&&(a=new et);var t=this;return es(this,(function(a,e){return a=null!==(a=ns(t,a,"SVG",b))?a.svg:null,"function"==typeof e?(e(a),null):a}),a)},Xo.prototype.makeSvg=Xo.prototype.Yt,Xo.prototype.gw=function(a){return this.Yt(a)},Xo.prototype.makeSVG=Xo.prototype.gw,ea.prototype.my=function(a,b){if(!(a instanceof Ba))return!1;if(!this.visible)return!0;var t=null,e=a.Mq;if(this instanceof Fh&&(this.type===Fh.TableRow||this.type===Fh.TableColumn))return ha(this,a,b),!0;var n=this.yb;if(0===n.width||0===n.height||isNaN(n.x)||isNaN(n.y))return!0;var o=this.transform,g=this.panel;0!=(4096&this.F)==!0&&ua(this);var r=0!=(256&this.F),h=!1;if(this instanceof Sl&&(a.font=this.font),r){if(h=g.fe()?g.naturalBounds:g.actualBounds,null!==this.Ya){var l=this.Ya,c=l.x,f=l.y,p=l.width;l=l.height}else c=Math.max(n.x,h.x),f=Math.max(n.y,h.y),p=Math.min(n.right,h.right)-c,l=Math.min(n.bottom,h.bottom)-f;if(c>n.width+n.x||n.x>h.width+h.x||f>n.height+n.y||n.y>h.height+h.y)return!0;h=!0,Ea(a,1,0,0,1,0,0),a.save(),a.beginPath(),a.rect(c,f,p,l),a.clip()}if(this.Hf()&&!this.isVisible())return!0;if(a.ae.Ma=[1,0,0,1,0,0],(this instanceof Sl&&1<this.lineCount||this instanceof pl&&1<this.geometry.figures.length)&&Ea(a,1,0,0,1,0,0),c=!1,this.Hf()&&this.isShadowed&&b.Ie("drawShadows")&&(f=this.shadowOffset,a.Iw(f.x*b.scale*b.Tb,f.y*b.scale*b.Tb,this.shadowBlur),ul(a),a.shadowColor=this.shadowColor),f=!1,this.part&&b.Ie("drawShadows")&&(f=this.part.isShadowed),!0===this.shadowVisible?(ul(a),!1===c&&f&&(Ea(a,1,0,0,1,0,0),a.er(),c=!0)):!1===this.shadowVisible&&za(a),p=this.naturalBounds,null!==this.areaBackground&&(la(this,a,this.areaBackground,!0,!0,p,n),!1===c&&f&&(Ea(a,1,0,0,1,0,0),a.er(),c=!0),this.areaBackground instanceof qa&&this.areaBackground.type===sh?(a.beginPath(),a.rect(n.x,n.y,n.width,n.height),a.He(this.areaBackground)):a.fillRect(n.x,n.y,n.width,n.height)),this instanceof Fh?Ea(a,o.m11,o.m12,o.m21,o.m22,o.dx,o.dy):a.ae.Ma=[o.m11,o.m12,o.m21,o.m22,o.dx,o.dy],null!==this.background){!1===c&&f&&(Ea(a,1,0,0,1,0,0),a.er(),c=!0);var d=this.naturalBounds;l=o=0;var q=d.width;d=d.height;var u=0;this instanceof pl&&(o=(d=this.geometry.bounds).x,l=d.y,q=d.width,d=d.height,u=this.strokeWidth),la(this,a,this.background,!0,!1,p,n),this.background instanceof qa&&this.background.type===sh?(a.beginPath(),a.rect(o-u/2,l-u/2,q+u,d+u),a.He(this.background)):a.fillRect(o-u/2,l-u/2,q+u,d+u)}return f&&(null!==this.background||null!==this.areaBackground||null!==g&&0!=(512&g.F)||null!==g&&(g.type===Fh.Auto||g.type===Fh.Spot)&&g.rb()!==this)?(ya(this,!0),null===this.shadowVisible&&za(a)):ya(this,!1),this.dj(a,b),f&&0!=(512&this.F)==!0&&ul(a),this.Hf()&&f&&za(a),r&&(a.restore(),h&&a.Ac.pop()),this instanceof Fh&&(t=a.Ac.pop()),!0===c&&a.Ac.pop(),(this instanceof Sl&&1<this.lineCount||this instanceof pl&&1<this.geometry.figures.length)&&(t=a.Ac.pop()),null!==a.Rk.zq&&(null===t&&(e===a.Mq?(Ea(a,1,0,0,1,0,0),t=a.Ac.pop()):t=a.Mq),a.Rk.zq(this,t)),this.svg=t,!0},Va.prototype.resize=function(a,b,t,e){return(this.width!==a||this.height!==b)&&(this.width=a,this.height=b,this.style.width=t+"px",this.style.height=e+"px",!0)},Va.prototype.toDataURL=function(a,b){return this.Ga.toDataURL(a,b)},Va.prototype.getBoundingClientRect=function(){return this.Ga.getBoundingClientRect()},Va.prototype.focus=function(){this.Ga.focus()},Va.prototype.ly=function(){this.ownerDocument=this.Ga.B=null},v.Object.defineProperties(Va.prototype,{width:{get:function(){return this.Ga.width},set:function(a){this.Ga.width=a}},height:{get:function(){return this.Ga.height},set:function(a){this.Ga.height=a}},style:{get:function(){return this.Ga.style}}}),Va.className="CanvasSurface",(n=Ga.prototype).Uy=function(a){this.Y.imageSmoothingEnabled=a},n.arc=function(a,b,t,e,n,o){this.Y.arc(a,b,t,e,n,o)},n.beginPath=function(){this.Y.beginPath()},n.bezierCurveTo=function(a,b,t,e,n,o){this.Y.bezierCurveTo(a,b,t,e,n,o)},n.clearRect=function(a,b,t,e){this.Y.clearRect(a,b,t,e)},n.clip=function(){this.Y.clip()},n.closePath=function(){this.Y.closePath()},n.createLinearGradient=function(a,b,t,e){return this.Y.createLinearGradient(a,b,t,e)},n.createPattern=function(a,b){return this.Y.createPattern(a,b)},n.createRadialGradient=function(a,b,t,e,n,o){return this.Y.createRadialGradient(a,b,t,e,n,o)},n.drawImage=function(a,b,t,e,n,o,g,r,h){void 0===e?this.Y.drawImage(a,b,t):this.Y.drawImage(a,b,t,e,n,o,g,r,h)},n.fill=function(){this.Y.fill()},n.fillRect=function(a,b,t,e){this.Y.fillRect(a,b,t,e)},n.fillText=function(a,b,t){this.Y.fillText(a,b,t)},n.getImageData=function(a,b,t,e){return this.Y.getImageData(a,b,t,e)},n.lineTo=function(a,b){this.Y.lineTo(a,b)},n.measureText=function(a){return this.Y.measureText(a)},n.moveTo=function(a,b){this.Y.moveTo(a,b)},n.quadraticCurveTo=function(a,b,t,e){this.Y.quadraticCurveTo(a,b,t,e)},n.rect=function(a,b,t,e){this.Y.rect(a,b,t,e)},n.restore=function(){this.Y.restore()},Ga.prototype.rotate=function(a){this.Y.rotate(a)},(n=Ga.prototype).save=function(){this.Y.save()},n.setTransform=function(a,b,t,e,n,o){this.Y.setTransform(a,b,t,e,n,o)},n.scale=function(a,b){this.Y.scale(a,b)},n.stroke=function(){this.Y.stroke()},n.transform=function(a,b,t,e,n,o){1===a&&0===b&&0===t&&1===e&&0===n&&0===o||this.Y.transform(a,b,t,e,n,o)},n.translate=function(a,b){this.Y.translate(a,b)},n.He=function(a){if(a instanceof qa&&a.type===sh){var b=a.el;(a=a.xu)>b?(this.scale(b/a,1),this.translate((a-b)/2,0)):b>a&&(this.scale(1,a/b),this.translate(0,(b-a)/2)),this.vn?this.clip():this.fill(),a>b?(this.translate(-(a-b)/2,0),this.scale(1/(b/a),1)):b>a&&(this.translate(0,-(b-a)/2),this.scale(1,1/(a/b)))}else this.vn?this.clip():this.fill()},n.uj=function(){this.vn||this.stroke()},n.Iw=function(a,b,t){this.Sp=a,this.Tp=b,this.lf=t},n.Et=function(a,b){var t=this.Y;void 0!==t.setLineDash&&(t.setLineDash(a),t.lineDashOffset=b)},n.Ct=function(){var a=this.Y;void 0!==a.setLineDash&&(a.setLineDash(Ya),a.lineDashOffset=0)},n.uc=function(a){a&&(this.vu=""),this.uu=this.wu=""},v.Object.defineProperties(Ga.prototype,{fillStyle:{get:function(){return this.Y.fillStyle},set:function(a){this.uu!==a&&(this.uu=this.Y.fillStyle=a)}},font:{get:function(){return this.Y.font},set:function(a){this.vu!==a&&(this.vu=this.Y.font=a)}},globalAlpha:{get:function(){return this.Y.globalAlpha},set:function(a){this.Y.globalAlpha=a}},lineCap:{get:function(){return this.Y.lineCap},set:function(a){this.Y.lineCap=a}},lineDashOffset:{get:function(){return this.Y.lineDashOffset},set:function(a){this.Y.lineDashOffset=a}},lineJoin:{get:function(){return this.Y.lineJoin},set:function(a){this.Y.lineJoin=a}},lineWidth:{get:function(){return this.Y.lineWidth},set:function(a){this.Y.lineWidth=a}},miterLimit:{get:function(){return this.Y.miterLimit},set:function(a){this.Y.miterLimit=a}},shadowBlur:{get:function(){return this.Y.shadowBlur},set:function(a){this.Y.shadowBlur=a}},shadowColor:{get:function(){return this.Y.shadowColor},set:function(a){this.Y.shadowColor=a}},shadowOffsetX:{get:function(){return this.Y.shadowOffsetX},set:function(a){this.Y.shadowOffsetX=a}},shadowOffsetY:{get:function(){return this.Y.shadowOffsetY},set:function(a){this.Y.shadowOffsetY=a}},strokeStyle:{get:function(){return this.Y.strokeStyle},set:function(a){this.wu!==a&&(this.wu=this.Y.strokeStyle=a)}},textAlign:{get:function(){return this.Y.textAlign},set:function(a){this.Y.textAlign=a}},imageSmoothingEnabled:{get:function(){return this.Y.imageSmoothingEnabled},set:function(a){this.Y.imageSmoothingEnabled=a}},clipInsteadOfFill:{get:function(){return this.vn},set:function(a){this.vn=a}}});var Ya=Object.freeze([]);function Xa(){this.T=this.v=this.I=this.l=0}function qa(a){vh||(em(),vh=!0),pt(this),this.s=!1,void 0===a?(this.pa=oh,this.dl="black"):"string"==typeof a?(this.pa=oh,this.dl=a):(this.pa=a,this.dl="black"),(a=this.pa)===rh?(this.Cd=mi,this.ql=Mi):this.ql=this.Cd=a===sh?bi:gi,this.ht=0,this.Vr=NaN,this.ie=this.Ks=this.he=null,this.xu=this.el=0}function Ua(a,b,t){return b=void 0===b||"number"!=typeof b?.2:b,t=void 0===t?hh:t,Za(a),Ja(b,t)}function Ka(a,b,t){return b=void 0===b||"number"!=typeof b?.2:b,t=void 0===t?hh:t,Za(a),Ja(-b,t)}function Ha(a,b,t){Za(a),a=ph.l;var e=ph.I,n=ph.v,o=ph.T;return Za(b),void 0===t&&(t=.5),"rgba("+Math.round((ph.l-a)*t+a)+", "+Math.round((ph.I-e)*t+e)+", "+Math.round((ph.v-n)*t+n)+", "+Math.round((ph.T-o)*t+o)+")"}function Wa(a){return!!a&&(a instanceof qa?a.Hy():(Za(a),128>(299*ph.l+587*ph.I+114*ph.v)/1e3))}function Ja(a,b){switch(b){case hh:b=100*Qa(ph.l);var t=100*Qa(ph.I),e=100*Qa(ph.v);return yh.l=.4124564*b+.3575761*t+.1804375*e,yh.I=.2126729*b+.7151522*t+.072175*e,yh.v=.0193339*b+.119192*t+.9503041*e,yh.T=ph.T,b=ih(yh.l/fh[0]),t=ih(yh.I/fh[1]),e=ih(yh.v/fh[2]),mh.l=116*t-16,mh.I=500*(b-t),mh.v=200*(t-e),mh.T=yh.T,mh.l=Math.min(100,Math.max(0,mh.l+100*a)),b=(a=(mh.l+16)/116)-mh.v/200,yh.l=fh[0]*eh(mh.I/500+a),yh.I=fh[1]*(mh.l>ch*uh?Math.pow(a,3):mh.l/ch),yh.v=fh[2]*eh(b),yh.T=mh.T,a=-.969266*yh.l+1.8760108*yh.I+.041556*yh.v,b=.0556434*yh.l+-.2040259*yh.I+1.0572252*yh.v,ph.l=255*_a((3.2404542*yh.l+-1.5371385*yh.I+-.4985314*yh.v)/100),ph.I=255*_a(a/100),ph.v=255*_a(b/100),ph.T=yh.T,ph.l=Math.round(ph.l),255<ph.l?ph.l=255:0>ph.l&&(ph.l=0),ph.I=Math.round(ph.I),255<ph.I?ph.I=255:0>ph.I&&(ph.I=0),ph.v=Math.round(ph.v),255<ph.v?ph.v=255:0>ph.v&&(ph.v=0),"rgba("+ph.l+", "+ph.I+", "+ph.v+", "+ph.T+")";case lh:return $a(),gh.v=Math.min(100,Math.max(0,gh.v+100*a)),"hsla("+gh.l+", "+gh.I+"%, "+gh.v+"%, "+gh.T+")";default:return N("Unknown color space: "+b),"rgba(0, 0, 0, 1)"}}function Za(a){vh||(em(),vh=!0);var b=dh;if(null!==b){b.clearRect(0,0,1,1),b.fillStyle="#000000";var t=b.fillStyle;b.fillStyle=a,b.fillStyle!==t?(b.fillRect(0,0,1,1),a=b.getImageData(0,0,1,1).data,ph.l=a[0],ph.I=a[1],ph.v=a[2],ph.T=a[3]/255):(b.fillStyle="#FFFFFF",b.fillStyle=a,ph.l=0,ph.I=0,ph.v=0,ph.T=1)}}function $a(){var a=ph.l/255,b=ph.I/255,t=ph.v/255,e=Math.max(a,b,t),n=Math.min(a,b,t),o=e-n;if(n=(e+n)/2,0===o)var g=a=0;else{switch(e){case a:g=(b-t)/o%6;break;case b:g=(t-a)/o+2;break;case t:g=(a-b)/o+4}0>(g*=60)&&(g+=360),a=o/(1-Math.abs(2*n-1))}gh.l=Math.round(g),gh.I=Math.round(100*a),gh.v=Math.round(100*n),gh.T=ph.T}function Qa(a){return.04045>=(a/=255)?a/12.92:Math.pow((a+.055)/1.055,2.4)}function _a(a){return.0031308>=a?12.92*a:1.055*Math.pow(a,1/2.4)-.055}function ih(a){return a>uh?Math.pow(a,1/3):(ch*a+16)/116}function eh(a){var b=a*a*a;return b>uh?b:(116*a-16)/ch}function nh(a,b){"string"!=typeof a&&(a instanceof qa||N("Value for "+b+" must be a color string or a Brush, not "+a))}function em(){dh=hs?new Va(null).context:null}Ga.className="CanvasSurfaceContext",Xa.className="ColorNumbers",qa.prototype.copy=function(){var a=new qa;return a.pa=this.pa,a.dl=this.dl,a.Cd=this.Cd.G(),a.ql=this.ql.G(),a.ht=this.ht,a.Vr=this.Vr,null!==this.he&&(a.he=this.he.copy()),a.Ks=this.Ks,a},(n=qa.prototype).freeze=function(){return this.s=!0,null!==this.he&&this.he.freeze(),this},n.ea=function(){return Object.isFrozen(this)&&N("cannot thaw constant: "+this),this.s=!1,null!==this.he&&this.he.ea(),this},n.jb=function(a){a.classType===qa&&(this.type=a)},n.toString=function(){var a="Brush(";if(this.type===oh)a+=this.color;else if(a=this.type===rh?a+"Linear ":this.type===sh?a+"Radial ":this.type===ah?a+"Pattern ":a+"(unknown) ",a+=this.start+" "+this.end,null!==this.colorStops)for(var b=this.colorStops.iterator;b.next();)a+=" "+b.key+":"+b.value;return a+")"},n.addColorStop=function(a,b){return this.s&&C(this),("number"!=typeof a||!isFinite(a)||1<a||0>a)&&T(a,"0 <= loc <= 1",qa,"addColorStop:loc"),null===this.he&&(this.he=new Mt),this.he.add(a,b),this.pa===oh&&(this.type=rh),this.ie=null,this},n.FA=function(a,b){if(this.s&&C(this),a=void 0===a||"number"!=typeof a?.2:a,b=void 0===b?hh:b,this.type===oh)Za(this.color),this.color=Ja(a,b);else if((this.type===rh||this.type===sh)&&null!==this.colorStops)for(var t=this.colorStops.iterator;t.next();)Za(t.value),this.addColorStop(t.key,Ja(a,b));return this},n.Iz=function(a,b){if(this.s&&C(this),a=void 0===a||"number"!=typeof a?.2:a,b=void 0===b?hh:b,this.type===oh)Za(this.color),this.color=Ja(-a,b);else if((this.type===rh||this.type===sh)&&null!==this.colorStops)for(var t=this.colorStops.iterator;t.next();)Za(t.value),this.addColorStop(t.key,Ja(-a,b));return this},n.Hy=function(){if(this.type===oh)return Wa(this.color);if((this.type===rh||this.type===sh)&&null!==this.colorStops){var a=this.colorStops;if(this.type===sh)return Wa(a.first().value);if(null!==a.get(.5))return Wa(a.get(.5));if(2===a.count)return Wa(Ha((a=a.ma())[0].value,a[1].value));for(var b=a.iterator,t=-1,e=-1,n=1,o=1;b.next();){var g=b.key,r=Math.abs(.5-b.key);n>o&&r<n?(t=g,n=r):o>=n&&r<o&&(e=g,o=r)}return t>e&&(o=t,t=e,e=o,o=n),n=e-t,Wa(Ha(a.get(t),a.get(e),1-o/n))}return!1},v.Object.defineProperties(qa.prototype,{type:{get:function(){return this.pa},set:function(a){this.s&&C(this,a),this.pa=a,this.start.nc()&&(a===rh?this.start=mi:a===sh&&(this.start=bi)),this.end.nc()&&(a===rh?this.end=Mi:a===sh&&(this.end=bi)),this.ie=null}},color:{get:function(){return this.dl},set:function(a){this.s&&C(this,a),this.dl=a,this.ie=null}},start:{get:function(){return this.Cd},set:function(a){this.s&&C(this,a),this.Cd=a.G(),this.ie=null}},end:{get:function(){return this.ql},set:function(a){this.s&&C(this,a),this.ql=a.G(),this.ie=null}},startRadius:{get:function(){return this.ht},set:function(a){this.s&&C(this,a),0>a&&T(a,">= zero",qa,"startRadius"),this.ht=a,this.ie=null}},endRadius:{get:function(){return this.Vr},set:function(a){this.s&&C(this,a),0>a&&T(a,">= zero",qa,"endRadius"),this.Vr=a,this.ie=null}},colorStops:{get:function(){return this.he},set:function(a){this.s&&C(this,a),this.he=a,this.ie=null}},pattern:{get:function(){return this.Ks},set:function(a){this.s&&C(this,a),this.Ks=a,this.ie=null}}}),qa.prototype.isDark=qa.prototype.Hy,qa.prototype.darkenBy=qa.prototype.Iz,qa.prototype.lightenBy=qa.prototype.FA,qa.prototype.addColorStop=qa.prototype.addColorStop;var oh,rh,sh,ah,hh,lh,uh=216/24389,ch=24389/27,fh=[95.047,100,108.883],dh=null,ph=new Xa,gh=new Xa,yh=new Xa,mh=new Xa,vh=!1;function xh(){this.name="Base"}function bh(){this.name="Base"}function wh(){this.name="Base"}function kh(){this.name="Base"}function Mh(){this.name="Base"}function Sh(){this.name="Base"}function Ph(){this.name="Base",this.name="Table"}function Nh(){this.name="Base"}function Ch(){this.name="Base"}function Th(){this.name="Base"}function Lh(){this.name="Base"}function Ah(a,b,t,e){if(0>b)return a%b===t;if(a%b!==t)return!1;b=e.length;for(var n=0;n<b;n++)if(a%e[n]===t)return!1;return!0}function jh(){this.name="Base"}function Dh(a,b,t,e){if(!1!==wa(e)){var n=e.strokeWidth;0===n&&a instanceof Eu&&a.type===Fh.Link&&a.adornedObject instanceof pl&&(n=a.adornedObject.strokeWidth),n*=e.ya,a instanceof uc&&null!==a.na?ra(e,(a=a.na.bounds).x-n/2,a.y-n/2,a.width+n,a.height+n):a instanceof Eu&&null!==a.adornedPart.na?ra(e,(a=a.adornedPart.na.bounds).x-n/2,a.y-n/2,a.width+n,a.height+n):ra(e,-n/2,-n/2,b+n,t+n),ka(e,!1)}}function Oh(){this.name="Base"}function Fh(a){ea.call(this),this.pa=void 0===a?Fh.Position:a,null===this.pa&&N("Panel type not specified or PanelLayout not loaded: "+a),this.W=new ut,this.ib=di,this.pa===Fh.Grid&&(this.isAtomic=!0),this.Jn=Vi,this.Uf=Es,this.pa===Fh.Table&&Bh(this),this.lq=Rs,this.jo=Gt,this.ko=Dt,this.fo=0,this.eo=100,this.io=10,this.ho=0,this.ki=this.nb=this.eh=this.dh=this.Kj=null,this.xo=NaN,this.re=this.Ai=null,this.Il="category",this.Wd=null,this.yg=new Jt(NaN,NaN,NaN,NaN),this.yh=this.Fp=this.Ti=null,this.Mg=""}function Bh(a){a.Dj=di,a.Vg=1,a.ri=null,a.pi=null,a.Ug=1,a.Tg=null,a.oi=null,a.vb=[],a.sb=[],a.bk=fl,a.Aj=fl,a.Wi=0,a.Ei=0}function Ih(a,b,t,e){for(var n=e.length,o=a.actualBounds,g=a.naturalBounds,r=!0,h=0;h<n;h++){var l=e[h];if(void 0!==l)if(r)r=!1;else if(0!==l.actual){if(t){if(l.position>o.height)continue}else if(l.position>o.width)continue;var c=l.separatorStrokeWidth;isNaN(c)&&(c=t?a.Vg:a.Ug);var f=l.separatorStroke;if(null===f&&(f=t?a.ri:a.Tg),0!==c&&null!==f){la(a,b,f,!1,!1,g,o),f=!1;var p=l.separatorDashArray;null===p&&(p=t?a.pi:a.oi),null!==p&&(f=!0,b.Et(p,0)),b.beginPath(),p=l.position+c,t?p>o.height&&(c-=p-o.height):p>o.width&&(c-=p-o.width),l=l.position+c/2,b.lineWidth=c,c=a.ib,t?(l+=c.top,p=o.width-c.right,b.moveTo(c.left,l),b.lineTo(p,l)):(l+=c.left,p=o.height-c.bottom,b.moveTo(l,c.top),b.lineTo(l,p)),b.stroke(),f&&b.Ct()}}}}function Rh(a,b,t,e,n){for(var o=e.length,g=a.actualBounds,r=a.naturalBounds,h=0;h<o;h++){var l=e[h];if(void 0!==l&&null!==l.background&&l.coversSeparators!==n&&0!==l.actual){var c=t?g.height:g.width;if(!(l.position>c)){var f=l.wc(),p=l.separatorStrokeWidth;isNaN(p)&&(p=t?a.Vg:a.Ug);var d=l.separatorStroke;null===d&&(d=t?a.ri:a.Tg),null===d&&(p=0),f-=p,(p=l.position+p)+(f+=l.actual)>c&&(f=c-p),0>=f||(c=a.ib,la(a,b,l.background,!0,!1,r,g),t?b.fillRect(c.left,p+c.top,g.width-(c.left+c.right),f):b.fillRect(p+c.left,c.top,f,g.height-(c.top+c.bottom)))}}}}function Eh(a){return"LineV"===a||"BarV"===a}function zh(a){return null!==a.part?a.part.locationObject:null}function Vh(a,b){Gh(a,a,b)}function Gh(a,b,t){t(b);for(var e=(b=b.W.j).length,n=0;n<e;n++){var o=b[n];o instanceof Fh&&Gh(a,o,t)}}function Yh(a,b){Xh(a,a,b)}function Xh(a,b,t){if(t(b),b instanceof Fh)for(var e=(b=b.W.j).length,n=0;n<e;n++)Xh(a,b[n],t)}function qh(a,b,t){if(t(b))return b;if(b instanceof Fh)for(var e=(b=b.W.j).length,n=0;n<e;n++){var o=qh(a,b[n],t);if(null!==o)return o}return null}function Uh(a){for(var b=(a=a.W.j).length,t=0,e=0;e<b;e++){var n=a[e];n instanceof Fh?t=Math.max(t,Uh(n)):n instanceof pl&&(t=Math.max(t,n.wh/2*n.ek*n.Cf()))}return t}function Kh(a,b,t,e){for(var n=a.W.j,o=n.length;o--;){var g=n[o];if(g.visible){var r=g.actualBounds,h=a.naturalBounds;r.x>h.width||r.y>h.height||0>r.x+r.width||0>r.y+r.height||(g instanceof Fh&&Kh(g,b,t,e),null!==b&&(g=b(g)),null===g||null!==t&&!t(g)||e.add(g))}}}function Hh(a){var b=null;return a instanceof pl&&((b=a.spot1)===Vi&&(b=null),null!==(a=a.geometry)&&null===b&&(b=a.spot1)),null===b&&(b=yi),b}function Wh(a){var b=null;return a instanceof pl&&((b=a.spot2)===Vi&&(b=null),null!==(a=a.geometry)&&null===b&&(b=a.spot2)),null===b&&(b=Si),b}function Jh(a,b){a.F=b?16777216|a.F:-16777217&a.F}function Zh(a){return null!==(a=a.ki)&&a.s}function $h(a){var b=a.ki;if(null===b)null!==a.data&&N("Template cannot have .data be non-null: "+a),a.ki=b=new ut;else if(b.s)return;var t=new ut;Jh(a,!1),a.Ym(a,(function(a,e){var n=e.fb;if(null!==n)for(va(e,!1),n=n.iterator;n.next();){var o=n.value;o.mode===Jd&&va(e,!0);var g=o.sourceName;null!==g&&("/"===g&&Jh(a,!0),null!==(g=Kd(o,a,e))&&(t.add(g),null===g.fm&&(g.fm=new ut),g.fm.add(o))),b.add(o)}if(e instanceof Fh&&e.type===Fh.Table){if(0<e.vb.length)for(n=(a=e.vb).length,o=0;o<n;o++)if(void 0!==(g=a[o])&&null!==g.fb)for(var r=g.fb.iterator;r.next();){var h=r.value;h.qd=g,h.cq=2,h.lm=g.index,b.add(h)}if(0<e.sb.length)for(a=(e=e.sb).length,n=0;n<a;n++)if(void 0!==(o=e[n])&&null!==o.fb)for(g=o.fb.iterator;g.next();)(r=g.value).qd=o,r.cq=1,r.lm=o.index,b.add(r)}}));for(var e=t.iterator;e.next();){var n=e.value;if(null!==n.fm){va(n,!0);for(var o=n.fm.iterator;o.next();){var g=o.value;null===n.fb&&(n.fb=new ut),n.fb.add(g)}}n.fm=null}for(e=b.iterator;e.next();)if(null!==(o=(n=e.value).qd)){n.qd=null;var r=n.targetProperty,h=r.indexOf(".");0<h&&o instanceof Fh&&(g=r.substring(0,h),r=r.substr(h+1),null!==(h=o.ab(g))?(o=h,n.targetProperty=r):L('Warning: unable to find GraphObject named "'+g+'" for Binding: '+n.toString())),o instanceof al?(g=yt(o.panel),n.vj=void 0===g?-1:g,o.panel.bl=n.vj):o instanceof ea?(g=yt(o),n.vj=void 0===g?-1:g,o.bl=n.vj):N("Unknown type of binding target: "+o)}b.freeze(),a instanceof yu&&a.Oc()&&a.Ta()}function Qh(a){if(a.type===Fh.Spot||a.type===Fh.Auto)return Math.min(a.W.length,1);if(a.type===Fh.Link){for(var b=(a=a.W).length,t=0;t<b;t++){var e=a.J(t);if(!(e instanceof pl&&e.isPanelMain))break}return t}return a.type===Fh.Table&&0<a.W.length&&((a=a.W.J(0)).isPanelMain&&a instanceof Fh&&(a.type===Fh.TableRow||a.type===Fh.TableColumn))?1:0}function _h(a,b,t){if(!(null==b||0>t)){var e=function(a,b){if(null===b)return"";if("function"==typeof(a=a.Il))a=a(b);else{if("string"!=typeof a||"object"!=typeof b)return"";if(""===a)return"";a=Gd(b,a)}return void 0===a?"":"string"==typeof a?a:(N("Panel.getCategoryForItemData found a non-string category for "+b+": "+a),"")}(a,b),n=a.itemTemplateMap,o=null;null!==n&&(o=n.H(e)),null===o&&(nl||(nl=!0,L('No item template Panel found for category "'+e+'" on '+a),L("  Using default item template."),e=new Fh,(n=new Sl).bind(new Ud("text","",z)),e.add(n),rl=e),o=rl),null!==(e=o)&&($h(e),0!=(16777216&(e=e.copy()).F)&&(null!==(n=a.hj())&&Jh(n,!0)),"object"==typeof b&&(null===a.Wd&&(a.Wd=new Mt),a.Wd.add(b,e)),n=t+Qh(a),a.wb(n,e),e.nb=b,tl(a,n,t),e.nb=null,e.data=b)}}function tl(a,b,t){for(a=a.W;b<a.length;){var e=a.J(b);if(e instanceof Fh){var n=b,o=t;e.type===Fh.TableRow?e.row=n:e.type===Fh.TableColumn&&(e.column=n),e.itemIndex=o}b++,t++}}function il(a,b,t){var e=b.enabledChanged;if(null!==e&&e(b,t),b instanceof Fh){e=(b=b.W.j).length;for(var n=0;n<e;n++){var o=b[n];t&&o instanceof Fh&&!o.isEnabled||il(a,o,t)}}}function el(a,b){b.name=a,sl.add(a,b)}qa.className="Brush",qa.Solid=oh=new _(qa,"Solid",0),qa.Linear=rh=new _(qa,"Linear",1),qa.Radial=sh=new _(qa,"Radial",2),qa.Pattern=ah=new _(qa,"Pattern",4),qa.Lab=hh=new _(qa,"Lab",5),qa.HSL=lh=new _(qa,"HSL",6),qa.randomColor=function(a,b){void 0===a&&(a=128),void 0===b&&(b=Math.max(a,255));var t=Math.abs(b-a);b=Math.floor(a+Math.random()*t).toString(16);var e=Math.floor(a+Math.random()*t).toString(16);return a=Math.floor(a+Math.random()*t).toString(16),2>b.length&&(b="0"+b),2>e.length&&(e="0"+e),2>a.length&&(a="0"+a),"#"+b+e+a},qa.isValidColor=function(a){if("black"===a)return!0;if(""===a)return!1;vh||(em(),vh=!0);var b=dh;if(null===b)return!0;b.fillStyle="#000000";var t=b.fillStyle;return b.fillStyle=a,b.fillStyle!==t||(b.fillStyle="#FFFFFF",t=b.fillStyle,b.fillStyle=a,b.fillStyle!==t)},qa.lighten=function(a){return Ua(a)},qa.lightenBy=Ua,qa.darken=function(a){return Ka(a)},qa.darkenBy=Ka,qa.mix=Ha,qa.isDark=Wa,xh.prototype.measure=function(){},xh.prototype.IA=function(a,b,t,e,n){a.measure(b,t,e,n)},xh.prototype.arrange=function(){},xh.prototype.wz=function(a,b,t,e,n,o){a.arrange(b,t,e,n,o)},xh.prototype.cc=function(){},v.Object.defineProperties(xh.prototype,{classType:{get:function(){return Fh}}}),xh.prototype.arrangeElement=xh.prototype.wz,xh.prototype.measureElement=xh.prototype.IA,xh.className="PanelLayout",m(bh,xh),bh.prototype.measure=function(a,b,t,e,n,o,g){var r=e.length;a=zh(a);for(var h=0;h<r;h++){var l=e[h];if(l.visible||l===a){var c=l.margin,f=c.right+c.left;c=c.top+c.bottom,l.measure(b,t,o,g);var p=l.measuredBounds;f=Math.max(p.width+f,0),c=Math.max(p.height+c,0),p=l.position.x;var d=l.position.y;isFinite(p)||(p=0),isFinite(d)||(d=0),l instanceof pl&&l.isGeometryPositioned&&(p-=l=l.strokeWidth/2,d-=l),ni(n,p,d,f,c)}}},bh.prototype.arrange=function(a,b,t){var e=b.length,n=a.padding;for(a=t.x-n.left,t=t.y-n.top,n=0;n<e;n++){var o=b[n],g=o.measuredBounds,r=o.margin,h=o.position.x,l=o.position.y;if(h=isNaN(h)?-a:h-a,l=isNaN(l)?-t:l-t,o instanceof pl&&o.isGeometryPositioned){var c=o.strokeWidth/2;h-=c,l-=c}o.visible&&o.arrange(h+r.left,l+r.top,g.width,g.height)}},m(wh,xh),wh.prototype.measure=function(a,b,t,e,n,o,g){var r=e.length;b=I(),o=zh(a);for(var h=0;h<r;h++){var l=e[h];if(l.visible||l===o){var c=da(l,!1);if(c!==Is&&c!==zs)b.push(l);else{l.measure(1/0,t,0,g),c=l.margin,l=l.measuredBounds;var f=Math.max(l.height+c.top+c.bottom,0);n.width+=Math.max(l.width+c.right+c.left,0),n.height=Math.max(n.height,f)}}}for(e=b.length,a.desiredSize.height?t=Math.min(a.desiredSize.height,a.maxSize.height):0!==n.height&&(t=Math.min(n.height,a.maxSize.height)),a=0;a<e;a++)((h=b[a]).visible||h===o)&&(r=(c=h.margin).right+c.left,c=c.top+c.bottom,h.measure(1/0,t,0,g),h=h.measuredBounds,c=Math.max(h.height+c,0),n.width+=Math.max(h.width+r,0),n.height=Math.max(n.height,c));R(b)},wh.prototype.arrange=function(a,b,t){for(var e=b.length,n=a.padding,o=n.top,g=a.isOpposite,r=g?t.width:n.left,h=0;h<e;h++){var l=o,c=b[h];if(c.visible){var f=c.measuredBounds,p=c.margin,d=p.top+p.bottom,q=o+n.bottom,u=f.height,y=da(c,!1);(isNaN(c.desiredSize.height)&&y===Bs||y===Vs)&&(u=Math.max(t.height-d-q,0)),d=u+d+q,(q=c.alignment).Nb()&&(q=a.defaultAlignment),q.kb()||(q=bi),g&&(r-=f.width+p.left+p.right),c.arrange(r+q.offsetX+p.left,l+q.offsetY+p.top+(t.height*q.y-d*q.y),f.width,u),g||(r+=f.width+p.left+p.right)}}},m(kh,xh),kh.prototype.measure=function(a,b,t,e,n,o){var g=e.length;t=I();for(var r=zh(a),h=0;h<g;h++){var l=e[h];if(l.visible||l===r){var c=da(l,!1);if(c!==Is&&c!==Vs)t.push(l);else{var f=l.margin;c=f.right+f.left,f=f.top+f.bottom,l.measure(b,1/0,o,0),l=l.measuredBounds,Zt(n,Math.max(n.width,Math.max(l.width+c,0)),n.height+Math.max(l.height+f,0))}}}if(0!==(e=t.length)){for(a.desiredSize.width?b=Math.min(a.desiredSize.width,a.maxSize.width):0!==n.width&&(b=Math.min(n.width,a.maxSize.width)),a=0;a<e;a++)((h=t[a]).visible||h===r)&&(g=(l=h.margin).right+l.left,l=l.top+l.bottom,h.measure(b,1/0,o,0),h=h.measuredBounds,l=Math.max(h.height+l,0),n.width=Math.max(n.width,Math.max(h.width+g,0)),n.height+=l);R(t)}},kh.prototype.arrange=function(a,b,t){for(var e=b.length,n=a.padding,o=n.left,g=a.isOpposite,r=g?t.height:n.top,h=0;h<e;h++){var l=o,c=b[h];if(c.visible){var f=c.measuredBounds,p=c.margin,d=p.left+p.right,q=o+n.right,u=f.width,y=da(c,!1);(isNaN(c.desiredSize.width)&&y===Bs||y===zs)&&(u=Math.max(t.width-d-q,0)),d=u+d+q,(q=c.alignment).Nb()&&(q=a.defaultAlignment),q.kb()||(q=bi),g&&(r-=f.height+p.bottom+p.top),c.arrange(l+q.offsetX+p.left+(t.width*q.x-d*q.x),r+q.offsetY+p.top,u,f.height),g||(r+=f.height+p.bottom+p.top)}}},m(Mh,xh),Mh.prototype.measure=function(a,b,t,e,n,o,g){var r=e.length,h=a.rb(),l=h.margin,c=l.right+l.left,f=l.top+l.bottom;h.measure(b,t,o,g);var p=h.measuredBounds;o=p.width,g=p.height;for(var d=Math.max(o+c,0),q=Math.max(g+f,0),u=a.isClipping,y=Jt.allocAt(-l.left,-l.top,d,q),m=!0,v=zh(a),x=0;x<r;x++){var w=e[x];if(w!==h&&(w.visible||w===v)){switch(d=(l=w.margin).right+l.left,q=l.top+l.bottom,p=da(w,!1)){case Bs:b=o,t=g;break;case zs:b=o;break;case Vs:t=g}w.measure(b,t,0,0),p=w.measuredBounds,d=Math.max(p.width+d,0),q=Math.max(p.height+q,0);var k=w.alignment;k.Nb()&&(k=a.defaultAlignment),k.kb()||(k=bi);var M=w.alignmentFocus;M.Nb()&&(M=bi);var S=null;if(w instanceof Fh&&""!==w.Mg&&(w.arrange(0,0,p.width,p.height),(S=w.ab(w.Mg))===w&&(S=null)),null!==S){for(l=S.naturalBounds,p=S.margin,l=St.allocAt(M.x*l.width-M.offsetX-p.left,M.y*l.height-M.offsetY-p.top);S!==w;)S.transform.sa(l),S=S.panel;w=k.x*o+k.offsetX-l.x,p=k.y*g+k.offsetY-l.y,St.free(l)}else w=k.x*o+k.offsetX-(M.x*p.width+M.offsetX)-l.left,p=k.y*g+k.offsetY-(M.y*p.height+M.offsetY)-l.top;m?(m=!1,n.h(w,p,d,q)):ni(n,w,p,d,q)}}switch(m?n.assign(y):u?n.$v(y.x,y.y,y.width,y.height):ni(n,y.x,y.y,y.width,y.height),Jt.free(y),(p=h.stretch)===Es&&(p=da(h,!1)),p){case Is:return;case Bs:if(!isFinite(b)&&!isFinite(t))return;break;case zs:if(!isFinite(b))return;break;case Vs:if(!isFinite(t))return}for(o=(p=h.measuredBounds).width,g=p.height,d=Math.max(o+c,0),q=Math.max(g+f,0),l=h.margin,y=Jt.allocAt(-l.left,-l.top,d,q),b=0;b<r;b++)(t=e[b])===h||!t.visible&&t!==v||(d=(l=t.margin).right+l.left,q=l.top+l.bottom,p=t.measuredBounds,d=Math.max(p.width+d,0),q=Math.max(p.height+q,0),(c=t.alignment).Nb()&&(c=a.defaultAlignment),c.kb()||(c=bi),(t=t.alignmentFocus).Nb()&&(t=bi),m?(m=!1,n.h(c.x*o+c.offsetX-(t.x*p.width+t.offsetX)-l.left,c.y*g+c.offsetY-(t.y*p.height+t.offsetY)-l.top,d,q)):ni(n,c.x*o+c.offsetX-(t.x*p.width+t.offsetX)-l.left,c.y*g+c.offsetY-(t.y*p.height+t.offsetY)-l.top,d,q));m?n.assign(y):u?n.$v(y.x,y.y,y.width,y.height):ni(n,y.x,y.y,y.width,y.height),Jt.free(y)},Mh.prototype.arrange=function(a,b,t){var e=b.length,n=a.rb(),o=n.measuredBounds,g=o.width;o=o.height;var r=a.padding,h=r.left;r=r.top;var l=h-t.x,c=r-t.y;n.arrange(l,c,g,o);for(var f=0;f<e;f++){var p=b[f];if(p!==n){var d=p.measuredBounds,q=d.width;d=d.height,(c=p.alignment).Nb()&&(c=a.defaultAlignment),c.kb()||(c=bi);var u=p.alignmentFocus;if(u.Nb()&&(u=bi),l=null,p instanceof Fh&&""!==p.Mg&&((l=p.ab(p.Mg))===p&&(l=null)),null!==l){var y=l.naturalBounds;for(u=St.allocAt(u.x*y.width-u.offsetX,u.y*y.height-u.offsetY);l!==p;)l.transform.sa(u),l=l.panel;l=c.x*g+c.offsetX-u.x,c=c.y*o+c.offsetY-u.y,St.free(u)}else l=c.x*g+c.offsetX-(u.x*q+u.offsetX),c=c.y*o+c.offsetY-(u.y*d+u.offsetY);l-=t.x,c-=t.y,p.visible&&p.arrange(h+l,r+c,q,d)}}},m(Sh,xh),Sh.prototype.measure=function(a,b,t,e,n,o,g){var r=e.length,h=a.rb(),l=h.margin,c=b,f=t,p=l.right+l.left,d=l.top+l.bottom;h.measure(b,t,o,g),l=h.measuredBounds;var q=0,u=null;h instanceof pl&&(q=(u=h).strokeWidth*u.scale);var y=Math.max(l.width+p,0);l=Math.max(l.height+d,0);var m=Hh(h),v=m.x*y+m.offsetX;m=m.y*l+m.offsetY;var x=Wh(h),w=x.x*y+x.offsetX;for(x=x.y*l+x.offsetY,isFinite(b)&&(c=Math.max(Math.abs(v-w)-q,0)),isFinite(t)&&(f=Math.max(Math.abs(m-x)-q,0)),(q=Ut.alloc()).h(0,0),a=zh(a),x=0;x<r;x++)(m=e[x])===h||!m.visible&&m!==a||(y=(l=m.margin).right+l.left,v=l.top+l.bottom,m.measure(c,f,0,0),l=m.measuredBounds,y=Math.max(l.width+y,0),l=Math.max(l.height+v,0),q.h(Math.max(y,q.width),Math.max(l,q.height)));if(1===r)n.width=y,n.height=l,Ut.free(q);else{switch(m=Hh(h),r=e=0,(x=Wh(h)).x!==m.x&&x.y!==m.y&&(e=q.width/Math.abs(x.x-m.x),r=q.height/Math.abs(x.y-m.y)),Ut.free(q),q=0,null!==u&&(q=u.strokeWidth*u.scale,yl(u)===Rs&&(e=r=Math.max(e,r))),e+=Math.abs(m.offsetX)+Math.abs(x.offsetX)+q,r+=Math.abs(m.offsetY)+Math.abs(x.offsetY)+q,(u=h.stretch)===Es&&(u=da(h,!1)),u){case Is:g=o=0;break;case Bs:isFinite(b)&&(e=b),isFinite(t)&&(r=t);break;case zs:isFinite(b)&&(e=b),g=0;break;case Vs:o=0,isFinite(t)&&(r=t)}h.Bm(),h.measure(e,r,o,g),n.width=h.measuredBounds.width+p,n.height=h.measuredBounds.height+d}},Sh.prototype.arrange=function(a,b){var t=b.length,e=a.rb(),n=e.measuredBounds,o=Jt.alloc();o.h(0,0,1,1);var g=e.margin,r=g.left;g=g.top;var h=a.padding,l=h.left;h=h.top,e.arrange(l+r,h+g,n.width,n.height);var c=Hh(e),f=Wh(e),p=c.y*n.height+c.offsetY,d=f.x*n.width+f.offsetX;for(f=f.y*n.height+f.offsetY,o.x=c.x*n.width+c.offsetX,o.y=p,ni(o,d,f,0,0),o.x+=r+l,o.y+=g+h,n=0;n<t;n++)(r=b[n])!==e&&(l=r.measuredBounds,g=r.margin,h=Math.max(l.width+g.right+g.left,0),c=Math.max(l.height+g.top+g.bottom,0),(p=r.alignment).Nb()&&(p=a.defaultAlignment),p.kb()||(p=bi),h=o.width*p.x+p.offsetX-h*p.x+g.left+o.x,g=o.height*p.y+p.offsetY-c*p.y+g.top+o.y,r.visible&&(oi(o.x,o.y,o.width,o.height,h,g,l.width,l.height)?r.arrange(h,g,l.width,l.height):r.arrange(h,g,l.width,l.height,new Jt(o.x,o.y,o.width,o.height))));Jt.free(o)},m(Ph,xh),Ph.prototype.measure=function(a,b,t,e,n){for(var o=e.length,g=I(),r=I(),h=0;h<o;h++){var l=e[h],c=l instanceof Fh?l:null;if(null===c||c.type!==Fh.TableRow&&c.type!==Fh.TableColumn||!l.visible)g.push(l);else{r.push(c);for(var f=c.W.j,p=f.length,d=0;d<p;d++){var q=f[d];c.type===Fh.TableRow?q.row=l.row:c.type===Fh.TableColumn&&(q.column=l.column),g.push(q)}}}0===(o=g.length)&&(a.getRowDefinition(0),a.getColumnDefinition(0));for(var u=[],y=0;y<o;y++){var m=g[y];ka(m,!0),ol(m,!0),u[m.row]||(u[m.row]=[]),u[m.row][m.column]||(u[m.row][m.column]=[]),u[m.row][m.column].push(m)}R(g);var v=I(),x=I(),w=I(),k={count:0},M={count:0},S=b,P=t,N=a.vb;o=N.length;for(var C=0;C<o;C++){var T=N[C];void 0!==T&&(T.actual=0)}o=(N=a.sb).length;for(var L=0;L<o;L++)void 0!==(T=N[L])&&(T.actual=0);for(var A=u.length,j=0,D=0;D<A;D++)u[D]&&(j=Math.max(j,u[D].length));var O=Math.min(a.topIndex,A-1),F=Math.min(a.leftIndex,j-1),B=0;A=u.length;for(var E=zh(a),z=0;z<A;z++)if(u[z]){j=u[z].length;var V=a.getRowDefinition(z);V.actual=0;for(var G=V.ac=0;G<j;G++)if(u[z][G]){var Y=a.getColumnDefinition(G);void 0===v[G]&&(Y.actual=0,Y.ac=0,v[G]=!0);for(var X=u[z][G],U=X.length,K=0;K<U;K++){var H=X[K];if(H.visible||H===E){var W=1<H.rowSpan||1<H.columnSpan;W&&(z<O||G<F||x.push(H));var J=H.margin,Z=J.right+J.left,$=J.top+J.bottom,Q=pa(H,V,Y,!1),_=H.desiredSize,tt=!isNaN(_.height),it=!isNaN(_.width)&&tt;if(W||Q===Is||it||z<O||G<F||(void 0!==k[G]||Q!==Bs&&Q!==zs||(k[G]=-1,k.count++),void 0!==M[z]||Q!==Bs&&Q!==Vs||(M[z]=-1,M.count++),w.push(H)),H.measure(1/0,1/0,0,0),!(z<O||G<F)){var et=H.measuredBounds,nt=Math.max(et.width+Z,0),ot=Math.max(et.height+$,0);if(1===H.rowSpan&&(Q===Is||Q===zs)){var st=(T=a.getRowDefinition(z)).wc();(B=Math.max(ot-T.actual,0))+st>P&&(B=Math.max(P-st,0));var at=0===T.ha;T.ac=T.ac+B,T.actual=T.ha+B,P=Math.max(P-(B+(at?st:0)),0)}if(1===H.columnSpan&&(Q===Is||Q===Vs)){var ht=(T=a.getColumnDefinition(G)).wc();(B=Math.max(nt-T.actual,0))+ht>S&&(B=Math.max(S-ht,0));var lt=0===T.ha;T.ac=T.ac+B,T.actual=T.ha+B,S=Math.max(S-(B+(lt?ht:0)),0)}W&&H.Bm()}}}}}R(v);var ut=0,ct=0;o=a.columnCount;for(var ft=0;ft<o;ft++){var pt=a.sb[ft];void 0!==pt&&(ut+=pt.ac,0!==pt.ac&&(ut+=pt.wc()))}o=a.rowCount;for(var gt=0;gt<o;gt++){var yt=a.vb[gt];void 0!==yt&&(ct+=yt.ac,0!==yt.ac&&(ct+=yt.wc()))}S=Math.max(b-ut,0);var mt=P=Math.max(t-ct,0),vt=S;o=w.length;for(var xt=0;xt<o;xt++){var bt=w[xt],wt=a.getRowDefinition(bt.row),kt=a.getColumnDefinition(bt.column),Mt=bt.measuredBounds,St=bt.margin,Pt=St.right+St.left,Nt=St.top+St.bottom;k[bt.column]=0===kt.ac&&void 0!==k[bt.column]?Math.max(Mt.width+Pt,k[bt.column]):null,M[bt.row]=0===wt.ac&&void 0!==M[bt.row]?Math.max(Mt.height+Nt,M[bt.row]):null}var Ct,Tt=0,Lt=0;for(Ct in M)"count"!==Ct&&(Tt+=M[Ct]);for(Ct in k)"count"!==Ct&&(Lt+=k[Ct]);for(var At=Ut.alloc(),jt=0;jt<o;jt++){var Dt=w[jt];if(Dt.visible||Dt===E){var Ot=a.getRowDefinition(Dt.row),Ft=a.getColumnDefinition(Dt.column),Bt=0;isFinite(Ft.width)?Bt=Ft.width:(Bt=isFinite(S)&&null!==k[Dt.column]?0===Lt?Ft.actual+S:k[Dt.column]/Lt*vt:null!==k[Dt.column]?S:Ft.actual||S,Bt=Math.max(0,Bt-Ft.wc()));var It=0;switch(isFinite(Ot.height)?It=Ot.height:(It=isFinite(P)&&null!==M[Dt.row]?0===Tt?Ot.actual+P:M[Dt.row]/Tt*mt:null!==M[Dt.row]?P:Ot.actual||P,It=Math.max(0,It-Ot.wc())),At.h(Math.max(Ft.minimum,Math.min(Bt,Ft.maximum)),Math.max(Ot.minimum,Math.min(It,Ot.maximum))),Q=pa(Dt,Ot,Ft,!1)){case zs:At.height=Math.max(At.height,Ot.actual+P);break;case Vs:At.width=Math.max(At.width,Ft.actual+S)}var Rt=Dt.margin,Et=Rt.right+Rt.left,zt=Rt.top+Rt.bottom;Dt.Bm(),Dt.measure(At.width,At.height,Ft.minimum,Ot.minimum);var Vt=Dt.measuredBounds,Gt=Math.max(Vt.width+Et,0),Yt=Math.max(Vt.height+zt,0);isFinite(S)&&(Gt=Math.min(Gt,At.width)),isFinite(P)&&(Yt=Math.min(Yt,At.height));var Xt=0;Xt=Ot.actual,Ot.actual=Math.max(Ot.actual,Yt),Ot.ac=Math.max(Ot.ac,Yt),B=Ot.actual-Xt,P=Math.max(P-B,0),null===M[Dt.row]&&(mt=Math.max(mt-B,0)),Xt=Ft.actual,Ft.actual=Math.max(Ft.actual,Gt),Ft.ac=Math.max(Ft.ac,Gt),B=Ft.actual-Xt,S=Math.max(S-B,0),null===k[Dt.column]&&(vt=Math.max(vt-B,0))}}R(w);var qt=Ut.alloc(),Kt=I(),Ht=I();if(0!==(o=x.length))for(var Wt=0;Wt<A;Wt++)if(u[Wt]){j=u[Wt].length;var Jt=a.getRowDefinition(Wt);Kt[Wt]=Jt.actual;for(var Zt=0;Zt<j;Zt++)if(u[Wt][Zt]){var $t=a.getColumnDefinition(Zt);Ht[Zt]=$t.actual}}for(var Qt=0;Qt<o;Qt++){var _t=x[Qt];if(_t.visible||_t===E){var ti=a.getRowDefinition(_t.row),ii=a.getColumnDefinition(_t.column);switch(At.h(Math.max(ii.minimum,Math.min(b,ii.maximum)),Math.max(ti.minimum,Math.min(t,ti.maximum))),Q=pa(_t,ti,ii,!1)){case Bs:0!==Ht[ii.index]&&(At.width=Math.min(At.width,Ht[ii.index])),0!==Kt[ti.index]&&(At.height=Math.min(At.height,Kt[ti.index]));break;case zs:0!==Ht[ii.index]&&(At.width=Math.min(At.width,Ht[ii.index]));break;case Vs:0!==Kt[ti.index]&&(At.height=Math.min(At.height,Kt[ti.index]))}isFinite(ii.width)&&(At.width=ii.width),isFinite(ti.height)&&(At.height=ti.height),qt.h(0,0);for(var ei=ii.minimum,ni=ti.minimum,oi=1;oi<_t.rowSpan&&!(_t.row+oi>=a.rowCount);oi++)T=a.getRowDefinition(_t.row+oi),B=0,B=Q===Bs||Q===Vs?Math.max(T.minimum,0===Kt[_t.row+oi]?T.maximum:Math.min(Kt[_t.row+oi],T.maximum)):Math.max(T.minimum,isNaN(T.cd)?T.maximum:Math.min(T.cd,T.maximum)),qt.height+=B,ni+=T.minimum;for(var ri=1;ri<_t.columnSpan&&!(_t.column+ri>=a.columnCount);ri++)T=a.getColumnDefinition(_t.column+ri),B=0,B=Q===Bs||Q===zs?Math.max(T.minimum,0===Ht[_t.column+ri]?T.maximum:Math.min(Ht[_t.column+ri],T.maximum)):Math.max(T.minimum,isNaN(T.cd)?T.maximum:Math.min(T.cd,T.maximum)),qt.width+=B,ei+=T.minimum;At.width+=qt.width,At.height+=qt.height;var si=_t.margin,ai=si.right+si.left,hi=si.top+si.bottom;_t.measure(At.width,At.height,ei,ni);for(var ui=_t.measuredBounds,ci=Math.max(ui.width+ai,0),fi=Math.max(ui.height+hi,0),di=0,pi=0;pi<_t.rowSpan&&!(_t.row+pi>=a.rowCount);pi++)di+=(T=a.getRowDefinition(_t.row+pi)).total||0;if(di<fi){var gi=fi-di,yi=fi-di;if(null!==_t.spanAllocation)for(var mi=_t.spanAllocation,vi=0;vi<_t.rowSpan&&!(0>=gi)&&!(_t.row+vi>=a.rowCount);vi++){var xi=(T=a.getRowDefinition(_t.row+vi)).ha||0,bi=mi(_t,T,yi);T.actual=Math.min(T.maximum,xi+bi),T.ha!==xi&&(gi-=T.ha-xi)}for(;0<gi;){var wi=T.ha||0;if(isNaN(T.height)&&T.maximum>wi&&(T.actual=Math.min(T.maximum,wi+gi),T.ha!==wi&&(gi-=T.ha-wi)),0===T.index)break;T=a.getRowDefinition(T.index-1)}}for(var ki=0,Mi=0;Mi<_t.columnSpan&&!(_t.column+Mi>=a.columnCount);Mi++)ki+=(T=a.getColumnDefinition(_t.column+Mi)).total||0;if(ki<ci){var Si=ci-ki,Pi=ci-ki;if(null!==_t.spanAllocation)for(var Ni=_t.spanAllocation,Ci=0;Ci<_t.columnSpan&&!(0>=Si)&&!(_t.column+Ci>=a.columnCount);Ci++){var Ti=(T=a.getColumnDefinition(_t.column+Ci)).ha||0,Li=Ni(_t,T,Pi);T.actual=Math.min(T.maximum,Ti+Li),T.ha!==Ti&&(Si-=T.ha-Ti)}for(;0<Si;){var Ai=T.ha||0;if(isNaN(T.width)&&T.maximum>Ai&&(T.actual=Math.min(T.maximum,Ai+Si),T.ha!==Ai&&(Si-=T.ha-Ai)),0===T.index)break;T=a.getColumnDefinition(T.index-1)}}}}R(x),Ut.free(qt),Ut.free(At),void 0!==Kt&&R(Kt),void 0!==Ht&&R(Ht);var ji=0,Di=0,Oi=a.desiredSize,Fi=a.maxSize;Q=da(a,!0);var Bi=ct=ut=0,Ii=0;o=a.columnCount;for(var Ri=0;Ri<o;Ri++)void 0!==a.sb[Ri]&&(T=a.getColumnDefinition(Ri),isFinite(T.width)?(Bi+=T.width,Bi+=T.wc()):hl(T)===cl?(Bi+=T.ha,Bi+=T.wc()):0!==T.ha&&(ut+=T.ha,ut+=T.wc()));ji=isFinite(Oi.width)?Math.min(Oi.width,Fi.width):Q!==Is&&isFinite(b)?b:ut,ji=Math.max(ji,a.minSize.width),ji=Math.max(ji-Bi,0);for(var Ei=0===ut?1:Math.max(ji/ut,1),zi=0;zi<o;zi++)void 0!==a.sb[zi]&&(T=a.getColumnDefinition(zi),isFinite(T.width)||hl(T)===cl||(T.actual=T.ha*Ei),T.position=n.width,0!==T.ha&&(n.width+=T.ha,n.width+=T.wc()));o=a.rowCount;for(var Vi=0;Vi<o;Vi++)void 0!==a.vb[Vi]&&(T=a.getRowDefinition(Vi),isFinite(T.height)?(Ii+=T.height,Ii+=T.wc()):hl(T)===cl?(Ii+=T.ha,Ii+=T.wc()):0!==T.ha&&(ct+=T.ha,0!==T.ha&&(ct+=T.wc())));Di=isFinite(Oi.height)?Math.min(Oi.height,Fi.height):Q!==Is&&isFinite(t)?t:ct,Di=Math.max(Di,a.minSize.height),Di=Math.max(Di-Ii,0);for(var Gi=0===ct?1:Math.max(Di/ct,1),Yi=0;Yi<o;Yi++)void 0!==a.vb[Yi]&&(T=a.getRowDefinition(Yi),isFinite(T.height)||hl(T)===cl||(T.actual=T.ha*Gi),T.position=n.height,0!==T.ha&&(n.height+=T.ha,0!==T.ha&&(n.height+=T.wc())));o=r.length;for(var Xi=0;Xi<o;Xi++){var qi=r[Xi],Ui=0,Ki=0;qi.type===Fh.TableRow?(Ui=n.width,Ki=(T=a.getRowDefinition(qi.row)).actual):(Ui=(T=a.getColumnDefinition(qi.column)).actual,Ki=n.height),qi.measuredBounds.h(0,0,Ui,Ki),ka(qi,!1),u[qi.row]||(u[qi.row]=[]),u[qi.row][qi.column]||(u[qi.row][qi.column]=[]),u[qi.row][qi.column].push(qi)}R(r),a.Fp=u},Ph.prototype.arrange=function(a,b,t){var e=b.length,n=a.padding,o=n.left;n=n.top;for(var r,h,g=a.Fp,l=g.length,c=0,f=0;f<l;f++)g[f]&&(c=Math.max(c,g[f].length));for(f=Math.min(a.topIndex,l-1);f!==l&&(void 0===a.vb[f]||0===a.vb[f].ha);)f++;for(f=Math.min(f,l-1),f=-a.vb[f].position,r=Math.min(a.leftIndex,c-1);r!==c&&(void 0===a.sb[r]||0===a.sb[r].ha);)r++;r=Math.min(r,c-1);for(var p=-a.sb[r].position,d=Ut.alloc(),q=0;q<l;q++)if(g[q]){c=g[q].length;var u=a.getRowDefinition(q);h=u.position+f+n,0!==u.ha&&(h+=u.Hv());for(var y=0;y<c;y++)if(g[q][y]){var m=a.getColumnDefinition(y);r=m.position+p+o,0!==m.ha&&(r+=m.Hv());for(var v=g[q][y],x=v.length,w=0;w<x;w++){var k=v[w],M=k.measuredBounds,S=k instanceof Fh?k:null;if(null===S||S.type!==Fh.TableRow&&S.type!==Fh.TableColumn){d.h(0,0);for(var P=1;P<k.rowSpan&&!(q+P>=a.rowCount);P++)S=a.getRowDefinition(q+P),d.height+=S.total;for(P=1;P<k.columnSpan&&!(y+P>=a.columnCount);P++)S=a.getColumnDefinition(y+P),d.width+=S.total;var N=m.ha+d.width,C=u.ha+d.height;P=r,S=h;var T=N,L=C,A=r,j=h,D=N,O=C;r+N>t.width&&(D=Math.max(t.width-r,0)),h+C>t.height&&(O=Math.max(t.height-h,0));var F=k.alignment;if(F.Nb()){(F=a.defaultAlignment).kb()||(F=bi);var B=F.x,I=F.y,R=F.offsetX;F=F.offsetY;var E=m.alignment,z=u.alignment;E.kb()&&(B=E.x,R=E.offsetX),z.kb()&&(I=z.y,F=z.offsetY)}else B=F.x,I=F.y,R=F.offsetX,F=F.offsetY;(isNaN(B)||isNaN(I))&&(I=B=.5,F=R=0),E=M.width,z=M.height;var V=k.margin,G=V.left+V.right,Y=V.top+V.bottom,X=pa(k,u,m,!1);!isNaN(k.desiredSize.width)||X!==Bs&&X!==zs||(E=Math.max(N-G,0)),!isNaN(k.desiredSize.height)||X!==Bs&&X!==Vs||(z=Math.max(C-Y,0)),N=k.maxSize,C=k.minSize,E=Math.min(N.width,E),z=Math.min(N.height,z),E=Math.max(C.width,E),N=(z=Math.max(C.height,z))+Y,P+=T*B-(E+G)*B+R+V.left,S+=L*I-N*I+F+V.top,k.visible&&(oi(A,j,D,O,P,S,M.width,M.height)?k.arrange(P,S,E,z):k.arrange(P,S,E,z,new Jt(A,j,D,O)))}else k.El(),k.actualBounds.ea(),T=k.actualBounds,P=Jt.allocAt(T.x,T.y,T.width,T.height),T.x=S.type===Fh.TableRow?o:r,T.y=S.type===Fh.TableColumn?n:h,T.width=M.width,T.height=M.height,k.actualBounds.freeze(),ol(k,!1),_t(P,T)||null!==(M=k.part)&&(M.Nh(),k.gp(M)),Jt.free(P)}}}for(Ut.free(d),a=0;a<e;a++)null===(o=(t=b[a])instanceof Fh?t:null)||o.type!==Fh.TableRow&&o.type!==Fh.TableColumn||(o=t.actualBounds,t.naturalBounds.ea(),t.naturalBounds.h(0,0,o.width,o.height),t.naturalBounds.freeze())},m(Nh,xh),Nh.prototype.measure=function(){},Nh.prototype.arrange=function(){},m(Ch,xh),Ch.prototype.measure=function(){},Ch.prototype.arrange=function(){},m(Th,xh),Th.prototype.measure=function(a,b,t,e,n,o,g){1<e.length&&N("Viewbox Panel cannot contain more than one GraphObject."),(e=e[0]).ya=1,e.Bm(),e.measure(1/0,1/0,o,g);var r=e.measuredBounds,h=e.margin,l=h.right+h.left;if(h=h.top+h.bottom,isFinite(b)||isFinite(t)){var c=e.scale,f=r.width;r=r.height;var p=Math.max(b-l,0),d=Math.max(t-h,0),q=1;a.viewboxStretch===Rs?0!==f&&0!==r&&(q=Math.min(p/f,d/r)):0!==f&&0!==r&&(q=Math.max(p/f,d/r)),0===q&&(q=1e-4),e.ya*=q,c!==e.scale&&(ka(e,!0),e.measure(1/0,1/0,o,g))}r=e.measuredBounds,n.width=isFinite(b)?b:Math.max(r.width+l,0),n.height=isFinite(t)?t:Math.max(r.height+h,0)},Th.prototype.arrange=function(a,b,t){var e=(b=b[0]).measuredBounds,n=b.margin,o=Math.max(e.width+(n.right+n.left),0);n=Math.max(e.height+(n.top+n.bottom),0);var g=b.alignment;g.Nb()&&(g=a.defaultAlignment),g.kb()||(g=bi),b.arrange(t.width*g.x-o*g.x+g.offsetX,t.height*g.y-n*g.y+g.offsetY,e.width,e.height)},m(Lh,xh),Lh.prototype.measure=function(){},Lh.prototype.arrange=function(){},Lh.prototype.cc=function(a,b,t){0>=(t=a.Cf()*t.scale)&&(t=1);var e=a.gridCellSize,n=e.width;e=e.height;var o=a.naturalBounds,g=a.actualBounds,r=o.width,h=o.height,l=Math.ceil(r/n),c=Math.ceil(h/e),f=a.gridOrigin,p=f.x;f=f.y,b.save(),b.beginPath(),b.rect(0,0,r,h),b.clip();for(var d=[],q=a.W.j,u=q.length,y=0;y<u;y++){var m=q[y],v=[];if(d.push(v),m.visible){var x=m.interval;if(!(0>x)){m=Eh(m.figure);for(var w=0;w<u;w++)if(w!==y){var k=q[w];k.visible&&Eh(k.figure)===m&&((k=k.interval)>x&&v.push(k))}}}}for(u=(q=a.W.j).length,y=0;y<u;y++){var M=q[y];if(M.visible&&(v=M.interval||1,!(2>n*(m=Math.abs(v))*t))){if(x=M.segmentIndex,isFinite(x)&&!isNaN(x)||(x=0),0>x&&(x=m-Math.min(-x,m)),x=Math.round(x%m),w=1,1!==(m=M.opacity)){if(0===m)continue;w=b.globalAlpha,b.globalAlpha=w*m}k=d[y];var S=!1,P=M.strokeDashArray;if(null!==P&&(S=!0,b.Et(P,M.strokeDashOffset)),"LineV"===M.figure&&null!==M.stroke&&0<M.strokeWidth){for(b.lineWidth=M.strokeWidth,la(a,b,M.stroke,!1,!1,o,g),b.beginPath(),P=M=Math.floor((p-n)/n);P<=M+l;P++){var N=P*n+p;0<=N&&N<=r&&Ah(P,v,x,k)&&(b.moveTo(N,0),b.lineTo(N,h))}b.stroke()}else if("LineH"===M.figure&&null!==M.stroke&&0<M.strokeWidth){for(b.lineWidth=M.strokeWidth,la(a,b,M.stroke,!1,!1,o,g),b.beginPath(),P=M=Math.floor((f-e)/e);P<=M+c;P++)0<=(N=P*e+f)&&N<=h&&Ah(P,v,x,k)&&(b.moveTo(0,N),b.lineTo(r,N));b.stroke()}else if("BarV"===M.figure&&null!==M.fill)for(la(a,b,M.fill,!0,!1,o,g),M=M.width,isNaN(M)&&(M=n),N=P=Math.floor((p-n)/n);N<=P+l;N++){var C=N*n+p;0<=C+M&&C<=r&&Ah(N,v,x,k)&&b.fillRect(C,0,M,h)}else if("BarH"===M.figure&&null!==M.fill)for(la(a,b,M.fill,!0,!1,o,g),M=M.height,isNaN(M)&&(M=e),N=P=Math.floor((f-e)/e);N<=P+c;N++)0<=(C=N*e+f)+M&&C<=h&&Ah(N,v,x,k)&&b.fillRect(0,C,r,M);S&&b.Ct(),1!==m&&(b.globalAlpha=w)}}b.restore(),b.uc(!1)},m(jh,xh),jh.prototype.measure=function(a,b,t,e,n){if(t=e.length,a instanceof Eu||a instanceof uc){var o=null,g=null,r=null;if(a instanceof uc&&(g=o=a),a instanceof Eu&&(o=(r=a).adornedPart),o instanceof uc){var h=o;if(0===t)Zt(a.naturalBounds,0,0),a.measuredBounds.h(0,0,0,0);else{var l=a instanceof Eu?null:o.path,c=o.routeBounds;(b=a.yg).h(0,0,c.width,c.height);var f=h.points;o=o.pointsCount,null!==r?r.Ck(!1):null!==g&&g.Ck(!1);var p=c.width,d=c.height;a.location.h(c.x,c.y),a.l.length=0,null!==l&&(Dh(a,p,d,l),r=l.measuredBounds,b.Tc(r),a.l.push(r)),r=ee.alloc();for(var q=St.alloc(),u=St.alloc(),y=0;y<t;y++){var m=e[y];if(m!==l)if(m.isPanelMain&&m instanceof pl){Dh(a,p,d,m);var v=m.measuredBounds;b.Tc(v),a.l.push(v)}else if(2>o)m.measure(1/0,1/0,0,0),v=m.measuredBounds,b.Tc(v),a.l.push(v);else{var x=m.segmentIndex,w=m.segmentFraction,k=m.alignmentFocus;k.nc()&&(k=bi);var M=m.segmentOrientation,S=m.segmentOffset;if(isNaN(x)){var P=h.na;v=I(),P.Wv(w,v);var N=St.allocAt(v[0],v[1]);if(N.add(h.i(0)),P.type===ge||(P=P.figures.first()),N.offset(-P.startX,-P.startY),P=v[2],M!==Ic){var C=h.computeAngle(m,M,P);m.Yb=C}C=N.x-c.x;var T=N.y-c.y;St.free(N),R(v)}else if(x<-o||x>=o)T=h.midPoint,P=h.midAngle,M!==Ic&&(C=h.computeAngle(m,M,P),m.Yb=C),C=T.x-c.x,T=T.y-c.y;else{if(C=0,0<=x?(T=f.J(x),v=x<o-1?f.J(x+1):T):(C=o+x,T=f.J(C),v=0<C?f.J(C-1):T),T.Na(v)){0<=x?(P=0<x?f.J(x-1):T,C=x<o-2?f.J(x+2):v):(P=C<o-1?f.J(C+1):T,C=1<C?f.J(C-2):v),N=P.Ge(T);var L=v.Ge(C);P=N>L+10?0<=x?P.Sa(T):T.Sa(P):L>N+10?0<=x?v.Sa(C):C.Sa(v):0<=x?P.Sa(C):C.Sa(P)}else P=0<=x?T.Sa(v):v.Sa(T);M!==Ic&&(C=h.computeAngle(m,M,P),m.Yb=C),C=T.x+(v.x-T.x)*w-c.x,T=T.y+(v.y-T.y)*w-c.y}m.measure(1/0,1/0,0,0),v=m.measuredBounds,N=m.naturalBounds;var A=0;m instanceof pl&&(A=m.strokeWidth),L=N.width+A;var j=N.height+A;r.reset(),r.translate(-v.x,-v.y),r.scale(m.scale,m.scale),r.rotate(M===Ic?m.angle:P,L/2,j/2),M!==qc&&M!==Wc||r.rotate(90,L/2,j/2),M!==Uc&&M!==Jc||r.rotate(-90,L/2,j/2),M===Zc&&(45<P&&135>P||225<P&&315>P)&&r.rotate(-P,L/2,j/2),N=new Jt(0,0,L,j),q.sj(N,k),r.sa(q),k=-q.x+A/2*m.scale,m=-q.y+A/2*m.scale,u.assign(S),A=isNaN(S.x);var D=isNaN(S.y);if(A||D){L=L/2+3,j=j/2+3;var O=45<=P&&135>=P,F=225<=P&&315>=P;M===Ic&&(O||F)?(u.x=D?L:S.y,u.y=A?j:S.x,O?0<=x||isNaN(x)&&.5>w||!A||(u.y=-j):F&&((0<=x||isNaN(x)&&.5>w)&&A&&(u.y=-j),D&&(u.x=-L))):(A&&(u.x=0<=x||isNaN(x)&&.5>w?L:-L),D&&(u.y=-j),u.rotate(P))}else u.rotate(P);C+=u.x,T+=u.y,N.set(v),N.h(C+k,T+m,v.width,v.height),a.l.push(N),b.Tc(N)}}if(null!==g)for(e=g.labelNodes;e.next();)e.value.measure(1/0,1/0);a.yg=b,(a=a.location).h(a.x+b.x,a.y+b.y),Zt(n,b.width||0,b.height||0),ee.free(r),St.free(q),St.free(u)}}}},jh.prototype.arrange=function(a,b){var t=b.length;if(a instanceof Eu||a instanceof uc){var e=null,n=null,o=null;a instanceof uc&&(n=e=a),a instanceof Eu&&(e=(o=a).adornedPart);var g=a instanceof Eu?null:e.path;if(0!==a.l.length){var r=a.l,h=0;if(null!==g&&h<a.l.length){var l=r[h];h++,g.arrange(l.x-a.yg.x,l.y-a.yg.y,l.width,l.height)}for(l=0;l<t;l++){var c=b[l];if(c!==g&&h<a.l.length){var f=r[h];h++,c.arrange(f.x-a.yg.x,f.y-a.yg.y,f.width,f.height)}}}if(2<=(t=(b=e.points).count)&&a instanceof uc)for(e=a.labelNodes;e.next();){var p=a;r=(g=e.value).segmentIndex,h=g.segmentFraction;var d=g.alignmentFocus;if(l=g.segmentOrientation,c=g.segmentOffset,isNaN(r)){f=p.na;var q=I();f.Wv(h,q);var u=St.allocAt(q[0],q[1]);u.add(p.i(0)),f.type===ge||(f=f.figures.first()),u.offset(-f.startX,-f.startY),f=q[2],l!==Ic&&(p=p.computeAngle(g,l,f),g.angle=p),p=u.x;var y=u.y;St.free(u),R(q)}else if(r<-t||r>=t)y=p.midPoint,f=p.midAngle,l!==Ic&&(p=p.computeAngle(g,l,f),g.angle=p),p=y.x,y=y.y;else{if(u=0,0<=r?(q=b.j[r],y=r<t-1?b.j[r+1]:q):(u=t+r,q=b.j[u],y=0<u?b.j[u-1]:q),q.Na(y)){0<=r?(f=0<r?b.j[r-1]:q,u=r<t-2?b.j[r+2]:y):(f=u<t-1?b.j[u+1]:q,u=1<u?b.j[u-2]:y);var m=f.Ge(q),v=y.Ge(u);f=m>v+10?0<=r?f.Sa(q):q.Sa(f):v>m+10?0<=r?y.Sa(u):u.Sa(y):0<=r?f.Sa(u):u.Sa(f)}else f=0<=r?q.Sa(y):y.Sa(q);l!==Ic&&(p=p.computeAngle(g,l,f),g.angle=p),p=q.x+(y.x-q.x)*h,y=q.y+(y.y-q.y)*h}if(d.Ut())g.location=new St(p,y);else{d.nc()&&(d=bi),(q=ee.alloc()).reset(),q.scale(g.scale,g.scale),q.rotate(g.angle,0,0);var x=g.naturalBounds;u=Jt.allocAt(0,0,x.width,x.height),(m=St.alloc()).sj(u,d),q.sa(m),d=-m.x,v=-m.y;var w=x.width,k=x.height;(x=St.alloc()).assign(c);var M=isNaN(c.x),S=isNaN(c.y);if(M||S){w=w/2+3,k=k/2+3;var P=45<=f&&135>=f,N=225<=f&&315>=f;l===Ic&&(P||N)?(x.x=S?w:c.y,x.y=M?k:c.x,P?0<=r||isNaN(r)&&.5>h||!M||(x.y=-k):N&&((0<=r||isNaN(r)&&.5>h)&&M&&(x.y=-k),S&&(x.x=-w))):(M&&(x.x=0<=r||isNaN(r)&&.5>h?w:-w),S&&(x.y=-k),x.rotate(f))}else x.rotate(f);p+=x.x,y+=x.y,q.Pw(u),d+=u.x,v+=u.y,r=St.allocAt(p+d,y+v),g.move(r),St.free(r),St.free(x),St.free(m),Jt.free(u),ee.free(q)}}null!==o?o.Ck(!1):null!==n&&n.Ck(!1)}},m(Oh,xh),Oh.prototype.measure=function(a,b,t,e,n,o,g){var r=a.rb();a.dh=[];var h=r.margin,l=h.right+h.left,c=h.top+h.bottom;r.measure(b,t,o,g);var f=r.measuredBounds,p=new Jt(-h.left,-h.top,Math.max(f.width+l,0),Math.max(f.height+c,0));a.dh.push(p),n.assign(p);for(var d=r.geometry,q=r.strokeWidth,u=d.flattenedSegments,y=d.flattenedLengths,m=d.flattenedTotalLength,v=u.length,x=0,w=0,k=I(),M=0;M<v;M++){var S=u[M],P=[];w=x=0;for(var N=S.length,C=0;C<N;C+=2){var T=S[C],L=S[C+1];if(0!==C){var A=180*Math.atan2(L-w,T-x)/Math.PI;0>A&&(A+=360),P.push(A)}x=T,w=L}k.push(P)}if(null===a.eh){for(var j=[],D=a.W.j,O=D.length,F=0;F<O;F++){var B=D[F],E=[];if(j.push(E),B.visible){var z=B.interval;if(!(0>z))for(var V=0;V<O;V++)if(V!==F){var G=D[V];if(G.visible&&B.constructor===G.constructor){var Y=G.interval;Y>z&&E.push(Y)}}}}a.eh=j}var X=a.eh,U=a.W.j,K=U.length,H=0,W=0,J=m;a.Kj=[];for(var Z,$=0;$<K;$++){var Q=U[$];if(Z=[],Q.visible&&Q!==r){var _=Math.abs(Q.interval),tt=a.graduatedTickUnit;if(!(2>tt*_*m/a.graduatedRange)){var it=y[0][0],et=0,nt=0;W=m*Q.graduatedStart-1e-4,J=m*Q.graduatedEnd+1e-4;var ot=tt*_,st=a.graduatedTickBase;if(st<a.graduatedMin){var at=(a.graduatedMin-st)/ot;st+=(at=0==at%1?at:Math.floor(at+1))*ot}else st>a.graduatedMin+ot&&(st-=Math.floor((st-a.graduatedMin)/ot)*ot);for(var ht=X[$],lt=st,ut=1;st<a.graduatedMax+5e-8;ut++){t:{for(var ct=ht.length,ft=0;ft<ct;ft++)if(oe.aa((st-a.graduatedTickBase)%(ht[ft]*a.graduatedTickUnit),0)){var pt=!1;break t}pt=!0}if(pt&&(null===Q.graduatedSkip||!Q.graduatedSkip(st))&&((H=(st-a.graduatedMin)*m/a.graduatedRange)>m&&(H=m),W<=H&&H<=J)){for(var gt=k[et][nt],yt=y[et][nt];et<y.length;){for(;H>it&&nt<y[et].length-1;)nt++,gt=k[et][nt],it+=yt=y[et][nt];if(H<=it)break;nt=0,gt=k[++et][nt],it+=yt=y[et][nt]}var mt=u[et],vt=mt[2*nt],xt=mt[2*nt+1],bt=(H-(it-yt))/yt,wt=new St(vt+(mt[2*nt+2]-vt)*bt+q/2-d.bounds.x,xt+(mt[2*nt+3]-xt)*bt+q/2-d.bounds.y);wt.scale(r.scale,r.scale);var kt=gt,Mt=k[et];if(1e-4>bt?0<nt?kt=Mt[nt-1]:oe.aa(mt[0],mt[mt.length-2])&&oe.aa(mt[1],mt[mt.length-1])&&(kt=Mt[Mt.length-1]):.9999<bt&&(nt+1<Mt.length?kt=Mt[nt+1]:oe.aa(mt[0],mt[mt.length-2])&&oe.aa(mt[1],mt[mt.length-1])&&(kt=Mt[0])),gt!==kt&&(180<Math.abs(gt-kt)&&(gt<kt?gt+=360:kt+=360),gt=(gt+kt)/2%360),Q instanceof Sl){var Pt="";null!==Q.graduatedFunction?Pt=null!=(Pt=Q.graduatedFunction(st))?Pt.toString():"":Pt=(+st.toFixed(2)).toString(),""!==Pt&&Z.push({Im:wt,angle:gt,text:Pt})}else Z.push({Im:wt,angle:gt})}st=lt+ut*ot}}}a.Kj.push(Z)}R(k);var Nt=a.Kj;if(null!==Nt)for(var Ct=e.length,Tt=0;Tt<Ct;Tt++){var Lt=e[Tt],At=Nt[Tt];if(Lt.visible&&Lt!==r&&0!==At.length){if(Lt instanceof pl){var jt=a,Dt=n,Ot=Lt.alignmentFocus;Ot.nc()&&(Ot=mi);var Ft=Lt.angle;Lt.Yb=0,Lt.measure(1/0,1/0,0,0),Lt.Yb=Ft;var Bt=Lt.measuredBounds,It=Bt.width,Rt=Bt.height,Et=Jt.allocAt(0,0,It,Rt),zt=St.alloc();zt.sj(Et,Ot),Jt.free(Et);for(var Vt=-zt.x,Gt=-zt.y,Yt=new Jt,Xt=At.length,qt=0;qt<Xt;qt++)for(var Ut=At[qt],Kt=Ut.Im.x,Ht=Ut.Im.y,Wt=Ut.angle,Zt=0;4>Zt;Zt++){switch(Zt){case 0:zt.h(Vt,Gt);break;case 1:zt.h(Vt+It,Gt);break;case 2:zt.h(Vt,Gt+Rt);break;case 3:zt.h(Vt+It,Gt+Rt)}zt.rotate(Wt+Lt.angle),zt.offset(Kt,Ht),0===qt&&0===Zt?Yt.h(zt.x,zt.y,0,0):Yt.Oe(zt),zt.offset(-Kt,-Ht),zt.rotate(-Wt-Lt.angle)}St.free(zt),null!==jt.dh&&jt.dh.push(Yt),ni(Dt,Yt.x,Yt.y,Yt.width,Yt.height)}else if(Lt instanceof Sl){var $t=a,Qt=n;null===$t.yh&&($t.yh=new Sl);var _t=$t.yh;Pl(_t,Lt);var ti=Lt.alignmentFocus;ti.nc()&&(ti=mi);for(var ii=Lt.segmentOrientation,ei=Lt.segmentOffset,oi=new Jt,ri=0,si=0,ai=0,hi=0,ui=0,ci=At.length,fi=0;fi<ci;fi++){var di=At[fi];ri=di.Im.x,si=di.Im.y,ai=di.angle,ui=hi=Lt.angle,ii!==Ic&&(ui=ii===Xc||ii===Hc?ai+Lt.angle:ai,hi=uc.computeAngle(ii,ui)),_t.Yb=hi,_t.text=di.text||"",_t.measure(1/0,1/0,0,0);var pi=_t.measuredBounds,gi=_t.naturalBounds,yi=gi.width,vi=gi.height,xi=ee.alloc();xi.reset(),xi.translate(-pi.x,-pi.y),xi.scale(_t.scale,_t.scale),xi.rotate(ui,yi/2,vi/2),ii!==qc&&ii!==Wc||xi.rotate(90,yi/2,vi/2),ii!==Uc&&ii!==Jc||xi.rotate(-90,yi/2,vi/2),ii===Zc&&(45<ai&&135>ai||225<ai&&315>ai)&&xi.rotate(-ai,yi/2,vi/2);var bi=Jt.allocAt(0,0,yi,vi),wi=St.alloc();wi.sj(bi,ti),xi.sa(wi);var ki=-wi.x,Mi=-wi.y,Si=St.alloc();Si.assign(ei),isNaN(Si.x)&&(Si.x=yi/2+3),isNaN(Si.y)&&(Si.y=-(vi/2+3)),Si.rotate(ai);var Pi=new Jt(ri+=Si.x+ki,si+=Si.y+Mi,pi.width,pi.height),Ni=new Jt(pi.x,pi.y,pi.width,pi.height),Ci=new Jt(gi.x,gi.y,gi.width,gi.height);di.DA=hi,di.lineCount=_t.lineCount,di.lines=[_t.ub,_t.Ci,_t.me,_t.ze,_t.Qb,_t.lb,_t.ke],di.actualBounds=Pi,di.measuredBounds=Ni,di.naturalBounds=Ci,0===fi?oi.assign(Pi):oi.Tc(Pi),St.free(Si),St.free(wi),Jt.free(bi),ee.free(xi)}null!==$t.dh&&$t.dh.push(oi),ni(Qt,oi.x,oi.y,oi.width,oi.height)}ka(Lt,!1)}}},Oh.prototype.arrange=function(a,b,t){if(null!==a.dh){var e=a.rb(),n=a.Kj;if(null!==n){var o=a.dh,g=0,r=o[g];g++,null!==e&&e.arrange(r.x-t.x,r.y-t.y,r.width,r.height);for(var h=b.length,l=0;l<h;l++){var c=b[l];r=n[l],c.visible&&c!==e&&0!==r.length&&(r=o[g],g++,c.arrange(r.x-t.x,r.y-t.y,r.width,r.height))}a.dh=null}}},Oh.prototype.cc=function(a,b,t){var e=t.wi;t.wi=!0;var n=a.naturalBounds,o=n.width;n=n.height,b.save(),b.beginPath(),b.rect(-1,-1,o+1,n+1),b.clip(),(o=a.rb()).cc(b,t),0>=(n=a.Cf()*t.scale)&&(n=1);for(var g=o.actualBounds,r=a.W.j,h=a.Kj,l=r.length,c=0;c<l;c++){var f=r[c],p=h[c],d=p.length;if(f.visible&&f!==o&&0!==p.length)if(f instanceof pl){if(!(2>a.graduatedTickUnit*f.interval*o.geometry.flattenedTotalLength/a.graduatedRange*n)){var q=f.measuredBounds,u=f.strokeWidth*f.scale,y=f.alignmentFocus;y.nc()&&(y=mi);for(var m=0;m<d;m++){var v=p[m].Im,x=p[m].angle,w=y,k=f.qb;k.reset(),k.translate(v.x+g.x,v.y+g.y),k.rotate(x+f.angle,0,0),k.translate(-q.width*w.x+w.offsetX+u/2,-q.height*w.y+w.offsetY+u/2),k.scale(f.scale,f.scale),xa(f,!1),f.Yh.set(f.qb),f.ol=f.scale,ba(f,!1),f.cc(b,t),f.qb.reset()}}}else if(f instanceof Sl)for(null===a.yh&&(a.yh=new Sl),Pl(q=a.yh,f),f=0;f<d;f++)(u=p[f]).actualBounds&&u.measuredBounds&&u.naturalBounds&&(q.Ub=u.text||"",q.Yb=u.DA||0,q.ad=u.lineCount||0,void 0!==(y=u.lines)&&(q.ub=y[0],q.Ci=y[1],q.me=y[2],q.ze=y[3],q.Qb=y[4],q.lb=y[5],q.ke=y[6]),u.naturalBounds&&(q.rc=u.naturalBounds),u.actualBounds&&(y=u.actualBounds,q.arrange(y.x,y.y,y.width,y.height)),y=u.actualBounds,q.arrange(y.x,y.y,y.width,y.height),m=u.measuredBounds,u=u.naturalBounds,(v=q.qb).reset(),v.translate(y.x+g.x,y.y+g.y),v.translate(-m.x,-m.y),ca(q,v,u.x,u.y,u.width,u.height),xa(q,!1),q.Yh.set(q.qb),q.ol=q.scale,ba(q,!1),q.cc(b,t))}t.wi=e,b.restore(),b.uc(!0)},m(Fh,ea),Fh.prototype.cloneProtected=function(a){if(ea.prototype.cloneProtected.call(this,a),a.pa=this.pa,a.ib=this.ib.G(),a.Jn=this.Jn.G(),a.Uf=this.Uf,a.pa===Fh.Table){a.Dj=this.Dj.G(),a.Vg=this.Vg,a.ri=this.ri,a.pi=this.pi,a.Ug=this.Ug,a.Tg=this.Tg,a.oi=this.oi;var b=[];if(0<this.vb.length)for(var t=this.vb,e=t.length,n=0;n<e;n++)if(void 0!==t[n]){var o=t[n].copy();o.rj(a),b[n]=o}if(a.vb=b,b=[],0<this.sb.length)for(e=(t=this.sb).length,n=0;n<e;n++)void 0!==t[n]&&((o=t[n].copy()).rj(a),b[n]=o);a.sb=b,a.bk=this.bk,a.Aj=this.Aj,a.Wi=this.Wi,a.Ei=this.Ei}a.lq=this.lq,a.jo=this.jo.G(),a.ko=this.ko.G(),a.fo=this.fo,a.eo=this.eo,a.io=this.io,a.ho=this.ho,a.Kj=this.Kj,a.eh=this.eh,a.nb=this.nb,a.ki=this.ki,a.xo=this.xo,a.Ai=this.Ai,a.re=this.re,a.Il=this.Il,a.yg.assign(this.yg),a.Mg=this.Mg,null!==this.Fp&&(a.Fp=this.Fp)},Fh.prototype.Af=function(a){ea.prototype.Af.call(this,a),a.W=this.W;for(var b=a.W.j,t=b.length,e=0;e<t;e++)b[e].qg=a;a.Ti=null},Fh.prototype.copy=function(){var a=ea.prototype.copy.call(this);if(null!==a){for(var b=this.W.j,t=b.length,e=0;e<t;e++){var n=b[e].copy();n.rj(a),n.Zj=null;var o=a.W,g=o.count;if(o.wb(g,n),null!==(o=a.part)){o.Vj=null,null!==n.portId&&o instanceof zu&&(o.Mh=!0);var r=a.diagram;null!==r&&r.undoManager.isUndoingRedoing||o.bb(Be,"elements",a,null,n,null,g)}}return a}return null},(n=Fh.prototype).toString=function(){return"Panel("+this.type+")#"+yt(this)},n.gp=function(a){ea.prototype.gp.call(this,a);for(var b=this.W.j,t=b.length,e=0;e<t;e++)b[e].gp(a)},n.dj=function(a,b){if(this.pa===Fh.Grid)this.pa.cc(this,a,b);else if(this.pa===Fh.Graduated)this.pa.cc(this,a,b);else{this.pa===Fh.Table&&(a.lineCap="butt",Rh(this,a,!0,this.vb,!0),Rh(this,a,!1,this.sb,!0),Ih(this,a,!0,this.vb),Ih(this,a,!1,this.sb),Rh(this,a,!0,this.vb,!1),Rh(this,a,!1,this.sb,!1));var t=this.isClipping&&this.pa===Fh.Spot;t&&a.save();for(var e=this.rb(),n=this.W.j,o=n.length,g=0;g<o;g++){var r=n[g];t&&r===e&&(a.clipInsteadOfFill=!0),r.cc(a,b),t&&r===e&&(a.clipInsteadOfFill=!1)}t&&(a.restore(),a.uc(!0))}},n.wk=function(a,b,t,e,n){var o=this.fe(),g=this.transform,r=1/(g.m11*g.m22-g.m12*g.m21),h=g.m22*r,l=-g.m12*r,c=-g.m21*r,f=g.m11*r,p=r*(g.m21*g.dy-g.m22*g.dx),d=r*(g.m12*g.dx-g.m11*g.dy);if(null!==this.areaBackground)return g=this.actualBounds,oe.Ef(g.left,g.top,g.right,g.bottom,a,b,t,e,n);if(null!==this.background)return o=a*h+b*c+p,r=a*l+b*f+d,a=t*h+e*c+p,h=t*l+e*f+d,n.h(0,0),t=this.naturalBounds,o=oe.Ef(0,0,t.width,t.height,o,r,a,h,n),n.transform(g),o;o||(h=1,c=l=0,f=1,d=p=0),r=a*h+b*c+p,a=a*l+b*f+d,h=t*h+e*c+p,t=t*l+e*f+d,n.h(h,t),e=(h-r)*(h-r)+(t-a)*(t-a),l=!1,d=(f=this.W.j).length,c=St.alloc(),p=null,b=1/0;var q=null,u=this.isClipping&&this.pa===Fh.Spot;u&&(q=St.alloc(),(l=(p=this.rb()).wk(r,a,h,t,q))&&(b=(r-q.x)*(r-q.x)+(a-q.y)*(a-q.y)));for(var y=0;y<d;y++){var m=f[y];m.visible&&m!==p&&m.wk(r,a,h,t,c)&&(l=!0,(m=(r-c.x)*(r-c.x)+(a-c.y)*(a-c.y))<e&&(e=m,n.set(c)))}return u&&(b>e&&n.set(q),St.free(q)),St.free(c),o&&n.transform(g),l},n.o=function(a){if(!0!==wa(this)){ea.prototype.o.call(this,a),a=null,this.pa!==Fh.Auto&&this.pa!==Fh.Link||(a=this.rb());for(var b=this.W.j,t=b.length,e=0;e<t;e++){var n=b[e];if((n===a||n.isPanelMain)&&n.o(!0),!n.desiredSize.u()){var o=da(n,!1);(n instanceof lc||n instanceof Fh||n instanceof Sl||o!==Is)&&n.o(!0)}}}},n.Bm=function(){if(!1===wa(this)){ka(this,!0),ol(this,!0);for(var a=this.W.j,b=a.length,t=0;t<b;t++)a[t].Bm()}},n.El=function(){if(0!=(2048&this.F)==!1){xa(this,!0),ba(this,!0);for(var a=this.W.j,b=a.length,t=0;t<b;t++)a[t].bw()}},n.bw=function(){ba(this,!0);for(var a=this.W.j,b=a.length,t=0;t<b;t++)a[t].bw()},n.Fm=function(a,b,t,e){var n=this.yg;n.h(0,0,0,0);var o=this.desiredSize,g=this.minSize;void 0===t&&(t=g.width,e=g.height),t=Math.max(t,g.width),e=Math.max(e,g.height);var r=this.maxSize;isNaN(o.width)||(a=Math.min(o.width,r.width)),isNaN(o.height)||(b=Math.min(o.height,r.height)),a=Math.max(t,a),b=Math.max(e,b);var h=this.ib;a=Math.max(a-h.left-h.right,0),b=Math.max(b-h.top-h.bottom,0);var l=this.W.j;0!==l.length&&this.pa.measure(this,a,b,l,n,t,e),a=n.width+h.left+h.right,h=n.height+h.top+h.bottom,isFinite(o.width)&&(a=o.width),isFinite(o.height)&&(h=o.height),a=Math.min(r.width,a),h=Math.min(r.height,h),a=Math.max(g.width,a),h=Math.max(g.height,h),Zt(n,a=Math.max(t,a),h=Math.max(e,h)),Zt(this.naturalBounds,a,h),ra(this,0,0,a,h)},n.rb=function(){if(null===this.Ti){var a=this.W.j,b=a.length;if(0===b)return null;for(var t=0;t<b;t++){var e=a[t];if(!0===e.isPanelMain)return this.Ti=e}this.Ti=a[0]}return this.Ti},n.Hh=function(a,b,t,e){var n=this.W.j;if(this.actualBounds.h(a,b,t,e),0!==n.length){if(!this.desiredSize.u()){a=da(this,!0);var o=this.measuredBounds;b=o.width,o=o.height;var g=this.jh,r=g.left+g.right;switch(g=g.top+g.bottom,b===t&&o===e&&(a=Is),a){case Is:(b>t||o>e)&&(this.o(),this.measure(b>t?t:b,o>e?e:o,0,0));break;case Bs:this.o(!0),this.measure(t+r,e+g,0,0);break;case zs:this.o(!0),this.measure(t+r,o+g,0,0);break;case Vs:this.o(!0),this.measure(b+r,e+g,0,0)}}this.pa.arrange(this,n,this.yg)}},n.Jh=function(a){var b=this.naturalBounds,t=zh(this);if(oi(0,0,b.width,b.height,a.x,a.y)){for(var e=(b=this.W.j).length,n=St.allocAt(0,0);e--;){var o=b[e];if((o.visible||o===t)&&(Tt(n.set(a),o.transform),o.$(n)))return St.free(n),!0}return St.free(n),null!==this.mb||null!==this.ec}return!1},n.Ft=function(a){if(this.bl===a)return this;for(var b=this.W.j,t=b.length,e=0;e<t;e++){var n=b[e].Ft(a);if(null!==n)return n}return null},n.Ym=function(a,b){if(b(this,a),a instanceof Fh)for(var t=(a=a.W.j).length,e=0;e<t;e++)this.Ym(a[e],b)},n.vm=function(a){return qh(this,this,a)},n.ab=function(a){if(this.name===a)return this;var b=this.W.j,t=b.length;null===this.Ai&&null===this.re||(t=Qh(this));for(var e=0;e<t;e++){var n=b[e];if(n instanceof Fh){var o=n.ab(a);if(null!==o)return o}if(n.name===a)return n}return null},n.fe=function(){return!(this.type===Fh.TableRow||this.type===Fh.TableColumn)},n.Vb=function(a,b,t){if(!1===this.pickable)return null;if(void 0===b&&(b=null),void 0===t&&(t=null),Ma(this))return null;var e=this.naturalBounds,n=1/this.Cf(),o=this.fe(),g=o?a:Tt(St.allocAt(a.x,a.y),this.transform),r=this.diagram,h=10,l=5;if(null!==r&&(l=(h=r.zm("extraTouchArea"))/2),oi(-l*n,-l*n,e.width+h*n,e.height+h*n,g.x,g.y)){if(!this.isAtomic){var c=(n=this.W.j).length;if(r=St.alloc(),l=(h=this.isClipping&&this.pa===Fh.Spot)?this.rb():null,h&&(l.fe()?Tt(r.set(a),l.transform):r.set(a),!l.$(r)))return St.free(r),o||St.free(g),null;for(var f=zh(this);c--;){var p=n[c];if((p.visible||p===f)&&(p.fe()?Tt(r.set(a),p.transform):r.set(a),!h||p!==l)){var d=null;if(p instanceof Fh?d=p.Vb(r,b,t):!0===p.pickable&&p.$(r)&&(d=p),null!==d&&(null!==b&&(d=b(d)),null!==d&&(null===t||t(d))))return St.free(r),o||St.free(g),d}}St.free(r)}return null===this.background&&null===this.areaBackground?(o||St.free(g),null):(a=oi(0,0,e.width,e.height,g.x,g.y)?this:null,o||St.free(g),a)}return o||St.free(g),null},n.gj=function(a,b,t,e){if(!1===this.pickable)return!1;void 0===b&&(b=null),void 0===t&&(t=null);var n=this.naturalBounds,o=this.fe(),g=o?a:Tt(St.allocAt(a.x,a.y),this.transform);if(n=oi(0,0,n.width,n.height,g.x,g.y),this.type===Fh.TableRow||this.type===Fh.TableColumn||n){if(!this.isAtomic){for(var r=this.W.j,h=r.length,l=St.alloc(),c=zh(this);h--;){var f=r[h];if(f.visible||f===c){f.fe()?Tt(l.set(a),f.transform):l.set(a);var p=f;(null!==(f=f instanceof Fh?f:null)?f.gj(l,b,t,e):p.$(l))&&!1!==p.pickable&&(null!==b&&(p=b(p)),null===p||null!==t&&!t(p)||e.add(p))}}St.free(l)}return o||St.free(g),n&&(null!==this.background||null!==this.areaBackground)}return o||St.free(g),!1},n.Bf=function(a,b,t,e,n,o){if(!1===this.pickable)return!1;void 0===b&&(b=null),void 0===t&&(t=null);var g=o;if(void 0===o&&(g=ee.alloc()).reset(),g.multiply(this.transform),this.Ih(a,g))return Kh(this,b,t,n),void 0===o&&ee.free(g),!0;if(this.Nc(a,g)){if(!this.isAtomic)for(var r=zh(this),h=this.W.j,l=h.length;l--;){var c=h[l];if(c.visible||c===r){var f=c.actualBounds,p=this.naturalBounds;f.x>p.width||f.y>p.height||0>f.x+f.width||0>f.y+f.height||(f=c,c=c instanceof Fh?c:null,(p=ee.alloc()).set(g),(null!==c?c.Bf(a,b,t,e,n,p):sa(f,a,e,p))&&(null!==b&&(f=b(f)),null===f||null!==t&&!t(f)||n.add(f)),ee.free(p))}}return void 0===o&&ee.free(g),e}return void 0===o&&ee.free(g),!1},n.Fg=function(a,b,t,e,n,o){if(!1===this.pickable)return!1;void 0===t&&(t=null),void 0===e&&(e=null);var g=this.naturalBounds,r=this.fe(),h=r?a:Tt(St.allocAt(a.x,a.y),this.transform),l=r?b:Tt(St.allocAt(b.x,b.y),this.transform),c=h.Ge(l),f=0<h.x&&h.x<g.width&&0<h.y&&h.y<g.height||Lt(h.x,h.y,0,0,0,g.height)<=c||Lt(h.x,h.y,0,g.height,g.width,g.height)<=c||Lt(h.x,h.y,g.width,g.height,g.width,0)<=c||Lt(h.x,h.y,g.width,0,0,0)<=c;if(g=h.rd(0,0)<=c&&h.rd(0,g.height)<=c&&h.rd(g.width,0)<=c&&h.rd(g.width,g.height)<=c,r||(St.free(h),St.free(l)),f){if(!this.isAtomic){h=St.alloc(),l=St.alloc(),c=zh(this);for(var p=this.W.j,d=p.length;d--;){var q=p[d];if(q.visible||q===c){var u=q.actualBounds,y=this.naturalBounds;r&&(u.x>y.width||u.y>y.height||0>u.x+u.width||0>u.y+u.height)||(q.fe()?(u=q.transform,Tt(h.set(a),u),Tt(l.set(b),u)):(h.set(a),l.set(b)),u=q,(null!==(q=q instanceof Fh?q:null)?q.Fg(h,l,t,e,n,o):u.ty(h,l,n))&&(null!==t&&(u=t(u)),null===u||null!==e&&!e(u)||o.add(u)))}}St.free(h),St.free(l)}return n?f:g}return!1},n.add=function(a){this.wb(this.W.count,a)},n.J=function(a){return this.W.J(a)},n.wb=function(a,b){b instanceof yu&&N("Cannot add a Part to a Panel: "+b+"; use a Panel instead"),(this===b||this.Hg(b))&&(this===b&&N("Cannot make a Panel contain itself: "+this.toString()),N("Cannot make a Panel indirectly contain itself: "+this.toString()+" already contains "+b.toString()));var t=b.panel;if(null!==t&&t!==this&&N("Cannot add a GraphObject that already belongs to another Panel to this Panel: "+b.toString()+", already contained by "+t.toString()+", cannot be shared by this Panel: "+this.toString()),this.pa!==Fh.Grid||b instanceof pl||N("Can only add Shapes to a Grid Panel, not: "+b),this.pa!==Fh.Graduated||b instanceof pl||b instanceof Sl||N("Can only add Shapes or TextBlocks to a Graduated Panel, not: "+b),b.rj(this),b.Zj=null,null!==this.itemArray){var e=b.data;null!==e&&"object"==typeof e&&(null===this.Wd&&(this.Wd=new Mt),this.Wd.add(e,b))}var n=this.W;if(e=-1,t===this){for(var o=-1,g=this.W.j,r=g.length,h=0;h<r;h++)if(g[h]===b){o=h;break}if(-1!==o){if(o===a||o+1>=n.count&&a>=n.count)return;n.cb(o),e=o}else N("element "+b.toString()+" has panel "+t.toString()+" but is not contained by it.")}(0>a||a>n.count)&&(a=n.count),n.wb(a,b),(0===a||b.isPanelMain)&&(this.Ti=null),wa(this)||this.o(),b.o(!1),(null!==b.portId||b instanceof Fh&&!0===b.Mh)&&(this.Mh=!0),this.eh=null,null!==(t=this.part)&&(t.Vj=null,t.kh=NaN,this.Mh&&t instanceof zu&&(t.Mh=!0),t.Mh&&t instanceof zu&&(t.tc=null),null!==(n=this.diagram)&&n.undoManager.isUndoingRedoing||(-1!==e&&t.bb(Ie,"elements",this,b,null,e,null),t.bb(Be,"elements",this,null,b,null,a),this.Ig()||il(this,b,!1)))},n.remove=function(a){for(var b=this.W.j,t=b.length,e=-1,n=0;n<t;n++)if(b[n]===a){e=n;break}-1!==e&&this.Mc(e,!0)},n.cb=function(a){0<=a&&this.Mc(a,!0)},n.Mc=function(a,b){var t=this.W,e=t.J(a);if(e.Zj=null,e.rj(null),null!==this.Wd){var n=e.data;"object"==typeof n&&this.Wd.remove(n)}t.cb(a),ka(this,!1),this.o(),this.Ti===e&&(this.Ti=null),this.eh=null;var o=this.part;null!==o&&(o.Vj=null,o.kh=NaN,o.Mb(),o instanceof zu&&(e instanceof Fh?e.Ym(e,(function(a,t){Zu(o,t,b)})):Zu(o,e,b)),null!==(t=this.diagram)&&t.undoManager.isUndoingRedoing||o.bb(Ie,"elements",this,e,null,a,null))},Fh.prototype.getRowDefinition=function(a){0>a&&T(a,">= 0",Fh,"getRowDefinition:idx"),a=Math.round(a);var b=this.vb;if(void 0===b)return null;if(void 0===b[a]){var t=new al;t.rj(this),t.isRow=!0,t.index=a,b[a]=t}return b[a]},Fh.prototype.uw=function(a){0>a&&T(a,">= 0",Fh,"removeRowDefinition:idx"),a=Math.round(a);var b=this.vb;void 0!==b&&(this.bb(Ie,"coldefs",this,b[a],null,a,null),b[a]&&delete b[a],this.o())},Fh.prototype.getColumnDefinition=function(a){0>a&&T(a,">= 0",Fh,"getColumnDefinition:idx"),a=Math.round(a);var b=this.sb;if(void 0===b)return null;if(void 0===b[a]){var t=new al;t.rj(this),t.isRow=!1,t.index=a,b[a]=t}return b[a]},(n=Fh.prototype).sw=function(a){0>a&&T(a,">= 0",Fh,"removeColumnDefinition:idx"),a=Math.round(a);var b=this.sb;void 0!==b&&(this.bb(Ie,"coldefs",this,b[a],null,a,null),b[a]&&delete b[a],this.o())},n.aA=function(a){if(0>a||this.type!==Fh.Table)return-1;for(var b=0,t=this.vb,e=t.length,n=this.Wi;n<e;n++){var o=t[n];if(void 0!==o&&a<(b+=o.total))break}return n},n.Tz=function(a){if(0>a||this.type!==Fh.Table)return-1;for(var b=0,t=this.sb,e=t.length,n=this.Ei;n<e;n++){var o=t[n];if(void 0!==o&&a<(b+=o.total))break}return n},n.qA=function(a,b){if(void 0===b&&(b=new St(NaN,NaN)),this.type!==Fh.Graduated)return b.h(NaN,NaN),b;a=Math.min(Math.max(a,this.graduatedMin),this.graduatedMax);var t=this.rb();return t.geometry.Vv((a-this.graduatedMin)/this.graduatedRange,b),t.transform.sa(b)},n.rA=function(a){if(this.type!==Fh.Graduated)return NaN;var b=this.rb();return b.transform.Gd(a),b.geometry.xy(a)*this.graduatedRange+this.graduatedMin},n.Gz=function(a){void 0===a&&(a=!1);var b=this.copy();return Yh(b,(function(a){a instanceof Fh&&(a.ki=null,a.nb=null);var b=a.fb;null!==b&&(a.fb=null,b.each((function(b){a.bind(b.copy())}))),null!==(b=a.Ng)&&(a.Ng=null,b.each((function(b){a.Qw(b.value.copy())})))})),a&&$h(b),b},n.Ca=function(a){var b=this.ki;if(null!==b)for(void 0===a&&(a=""),b=b.iterator;b.next();){var t=b.value,e=t.sourceProperty;if((""===a||""===e||e===a)&&(e=t.targetProperty,null!==t.converter||""!==e)){e=this.data;var n=t.sourceName;if(null!==n)e=""===n||"/"===n||"."===n||".."===n?this:this.ab(n);else{var o=this.diagram;null!==o&&t.isToModel&&(e=o.model.modelData)}if(null!==e){o=this;var g=t.vj;if(-1!==g){if(null===(o=this.Ft(g)))continue}else null!==t.qd&&(o=t.qd);if("/"===n?e=o.part:"."===n?e=o:".."===n&&(e=o.panel),0!==(n=t.cq)){if(!(o instanceof Fh))continue;1===n?o=o.getColumnDefinition(t.lm):2===n&&(o=o.getRowDefinition(t.lm))}void 0!==o&&t.Tw(o,e)}}}},n.cu=function(){for(var a=Qh(this);this.W.length>a;)this.Mc(this.W.length-1,!1);if(null!==(a=this.itemArray))for(var b=a.length,t=0;t<b;t++)_h(this,a[t],t)},n.sy=function(a){return null==a||null===this.Wd?null:this.Wd.H(a)},v.Object.defineProperties(Fh.prototype,{type:{get:function(){return this.pa},set:function(a){var b=this.pa;b!==a&&(this.pa=a,this.pa===Fh.Grid?this.isAtomic=!0:this.pa===Fh.Table&&Bh(this),this.o(),this.g("type",b,a))}},elements:{get:function(){return this.W.iterator}},naturalBounds:{get:function(){return this.rc}},padding:{get:function(){return this.ib},set:function(a){"number"==typeof a?(0>a&&T(a,">= 0",Fh,"padding"),a=new ui(a)):(0>a.left&&T(a.left,">= 0",Fh,"padding:value.left"),0>a.right&&T(a.right,">= 0",Fh,"padding:value.right"),0>a.top&&T(a.top,">= 0",Fh,"padding:value.top"),0>a.bottom&&T(a.bottom,">= 0",Fh,"padding:value.bottom"));var b=this.ib;b.w(a)||(this.ib=a=a.G(),this.o(),this.g("padding",b,a))}},defaultAlignment:{get:function(){return this.Jn},set:function(a){var b=this.Jn;b.w(a)||(this.Jn=a=a.G(),this.o(),this.g("defaultAlignment",b,a))}},defaultStretch:{get:function(){return this.Uf},set:function(a){var b=this.Uf;b!==a&&(this.Uf=a,this.o(),this.g("defaultStretch",b,a))}},defaultSeparatorPadding:{get:function(){return void 0===this.Dj?di:this.Dj},set:function(a){if(void 0!==this.Dj){"number"==typeof a&&(a=new ui(a));var b=this.Dj;b.w(a)||(this.Dj=a=a.G(),this.o(),this.g("defaultSeparatorPadding",b,a))}}},defaultRowSeparatorStroke:{get:function(){return void 0===this.ri?null:this.ri},set:function(a){var b=this.ri;b!==a&&(null===a||"string"==typeof a||a instanceof qa)&&(a instanceof qa&&a.freeze(),this.ri=a,this.M(),this.g("defaultRowSeparatorStroke",b,a))}},defaultRowSeparatorStrokeWidth:{get:function(){return void 0===this.Vg?1:this.Vg},set:function(a){if(void 0!==this.Vg){var b=this.Vg;b!==a&&isFinite(a)&&0<=a&&(this.Vg=a,this.o(),this.g("defaultRowSeparatorStrokeWidth",b,a))}}},defaultRowSeparatorDashArray:{get:function(){return void 0===this.pi?null:this.pi},set:function(a){if(void 0!==this.pi){var b=this.pi;if(b!==a){if(null!==a){for(var t=a.length,e=0,n=0;n<t;n++){var o=a[n];"number"==typeof o&&0<=o&&isFinite(o)||N("defaultRowSeparatorDashArray value "+o+" at index "+n+" must be a positive number or zero."),e+=o}if(0===e){if(null===b)return;a=null}}this.pi=a,this.M(),this.g("defaultRowSeparatorDashArray",b,a)}}}},defaultColumnSeparatorStroke:{get:function(){return void 0===this.Tg?null:this.Tg},set:function(a){if(void 0!==this.Tg){var b=this.Tg;b!==a&&(null===a||"string"==typeof a||a instanceof qa)&&(a instanceof qa&&a.freeze(),this.Tg=a,this.M(),this.g("defaultColumnSeparatorStroke",b,a))}}},defaultColumnSeparatorStrokeWidth:{get:function(){return void 0===this.Ug?1:this.Ug},set:function(a){if(void 0!==this.Ug){var b=this.Ug;b!==a&&isFinite(a)&&0<=a&&(this.Ug=a,this.o(),this.g("defaultColumnSeparatorStrokeWidth",b,a))}}},defaultColumnSeparatorDashArray:{get:function(){return void 0===this.oi?null:this.oi},set:function(a){if(void 0!==this.oi){var b=this.oi;if(b!==a){if(null!==a){for(var t=a.length,e=0,n=0;n<t;n++){var o=a[n];"number"==typeof o&&0<=o&&isFinite(o)||N("defaultColumnSeparatorDashArray value "+o+" at index "+n+" must be a positive number or zero."),e+=o}if(0===e){if(null===b)return;a=null}}this.oi=a,this.M(),this.g("defaultColumnSeparatorDashArray",b,a)}}}},viewboxStretch:{get:function(){return this.lq},set:function(a){var b=this.lq;b!==a&&(this.lq=a,this.o(),this.g("viewboxStretch",b,a))}},gridCellSize:{get:function(){return this.jo},set:function(a){var b=this.jo;if(!b.w(a)){a.u()&&0!==a.width&&0!==a.height||N("Invalid Panel.gridCellSize: "+a),this.jo=a.G();var t=this.diagram;null!==t&&this===t.grid&&Er(t),this.M(),this.g("gridCellSize",b,a)}}},gridOrigin:{get:function(){return this.ko},set:function(a){var b=this.ko;if(!b.w(a)){a.u()||N("Invalid Panel.gridOrigin: "+a),this.ko=a.G();var t=this.diagram;null!==t&&this===t.grid&&Er(t),this.M(),this.g("gridOrigin",b,a)}}},graduatedMin:{get:function(){return this.fo},set:function(a){var b=this.fo;b!==a&&(this.fo=a,this.o(),this.g("graduatedMin",b,a),ma(this)&&(null!==(a=this.part)&&oa(this,a,"graduatedRange")))}},graduatedMax:{get:function(){return this.eo},set:function(a){var b=this.eo;b!==a&&(this.eo=a,this.o(),this.g("graduatedMax",b,a),ma(this)&&(null!==(a=this.part)&&oa(this,a,"graduatedRange")))}},graduatedRange:{get:function(){return this.graduatedMax-this.graduatedMin}},graduatedTickUnit:{get:function(){return this.io},set:function(a){var b=this.io;b!==a&&0<a&&(this.io=a,this.o(),this.g("graduatedTickUnit",b,a))}},graduatedTickBase:{get:function(){return this.ho},set:function(a){var b=this.ho;b!==a&&(this.ho=a,this.o(),this.g("graduatedTickBase",b,a))}},Mh:{get:function(){return 0!=(8388608&this.F)},set:function(a){0!=(8388608&this.F)!==a&&(this.F^=8388608)}},rowCount:{get:function(){return void 0===this.vb?0:this.vb.length}},columnCount:{get:function(){return void 0===this.sb?0:this.sb.length}},rowSizing:{get:function(){return void 0===this.bk?fl:this.bk},set:function(a){if(void 0!==this.bk){var b=this.bk;b!==a&&(this.bk=a,this.o(),this.g("rowSizing",b,a))}}},columnSizing:{get:function(){return void 0===this.Aj?fl:this.Aj},set:function(a){if(void 0!==this.Aj){var b=this.Aj;b!==a&&(this.Aj=a,this.o(),this.g("columnSizing",b,a))}}},topIndex:{get:function(){return void 0===this.Wi?0:this.Wi},set:function(a){if(void 0!==this.Wi){var b=this.Wi;b!==a&&((!isFinite(a)||0>a)&&N("Panel.topIndex must be greater than zero and a real number, not: "+a),this.Wi=a,this.o(),this.g("topIndex",b,a))}}},leftIndex:{get:function(){return void 0===this.Ei?0:this.Ei},set:function(a){if(void 0!==this.Ei){var b=this.Ei;b!==a&&((!isFinite(a)||0>a)&&N("Panel.leftIndex must be greater than zero and a real number, not: "+a),this.Ei=a,this.o(),this.g("leftIndex",b,a))}}},data:{get:function(){return this.nb},set:function(a){var b=this.nb;if(b!==a){var t=this instanceof yu&&!(this instanceof Eu);$h(this),this.nb=a;var e=this.diagram;null!==e&&(t?(t=e.partManager,this instanceof uc?(null!==b&&t.Ue.remove(b),null!==a&&t.Ue.add(a,this)):this instanceof yu&&(null!==b&&t.Ve.remove(b),null!==a&&t.Ve.add(a,this))):null!==(t=this.panel)&&null!==t.Wd&&(null!==b&&t.Wd.remove(b),null!==a&&t.Wd.add(a,this))),this.g("data",b,a),null!==e&&e.undoManager.isUndoingRedoing||null!==a&&this.Ca()}}},itemIndex:{get:function(){return this.xo},set:function(a){var b=this.xo;b!==a&&(this.xo=a,this.g("itemIndex",b,a))}},itemArray:{get:function(){return this.Ai},set:function(a){var b=this.Ai;if(b!==a||null!==a&&function(a,b){for(var t=(a=a.W.j).length,e=b.length,n=0,o=null;n<t&&!((o=a[n])instanceof Fh&&null!==o.data);)o=a[++n];if(t-n!==e)return!0;if(null===o)return 0<e;for(var g=0;n<t&&g<e;){if(!((o=a[n])instanceof Fh)||o.data!==b[g])return!0;n++,g++}return!1}(this,a)){var t=this.diagram;b!==a&&(null!==t&&null!==b&&sd(t.partManager,this,t),this.Ai=a,null!==t&&null!==a&&rd(t.partManager,this)),this.g("itemArray",b,a),null!==t&&t.undoManager.isUndoingRedoing||this.cu()}}},itemTemplate:{get:function(){return null===this.re?null:this.re.H("")},set:function(a){if(null===this.re){if(null===a)return;this.re=new Mt}var b=this.re.H("");b!==a&&((a instanceof yu||a.isPanelMain)&&N("Panel.itemTemplate must not be a Part or be Panel.isPanelMain: "+a),this.re.add("",a),this.g("itemTemplate",b,a),null!==(a=this.diagram)&&a.undoManager.isUndoingRedoing||this.cu())}},itemTemplateMap:{get:function(){return this.re},set:function(a){var b=this.re;if(b!==a){for(var t=a.iterator;t.next(););this.re=a,this.g("itemTemplateMap",b,a),null!==(a=this.diagram)&&a.undoManager.isUndoingRedoing||this.cu()}}},itemCategoryProperty:{get:function(){return this.Il},set:function(a){var b=this.Il;b!==a&&(this.Il=a,this.g("itemCategoryProperty",b,a))}},isAtomic:{get:function(){return 0!=(1048576&this.F)},set:function(a){var b=0!=(1048576&this.F);b!==a&&(this.F^=1048576,this.g("isAtomic",b,a))}},isClipping:{get:function(){return 0!=(2097152&this.F)},set:function(a){var b=0!=(2097152&this.F);b!==a&&(!a||this.type===Fh.Spot||this instanceof oc||L("Warning: Panel.isClipping set on non-Spot Panel: "+this.toString()),this.F^=2097152,this instanceof oc&&(this.Ya=null),this.o(),this.g("isClipping",b,a))}},isOpposite:{get:function(){return 0!=(33554432&this.F)},set:function(a){var b=0!=(33554432&this.F);b!==a&&(this.F^=33554432,this.o(),this.g("isOpposite",b,a))}},isEnabled:{get:function(){return 0!=(4194304&this.F)},set:function(a){var b=0!=(4194304&this.F);if(b!==a){var t=null===this.panel||this.panel.Ig();this.F^=4194304,this.g("isEnabled",b,a),null!==(b=this.diagram)&&b.undoManager.isUndoingRedoing||t&&il(this,this,a)}}},alignmentFocusName:{get:function(){return this.Mg},set:function(a){var b=this.Mg;b!==a&&(this.Mg=a,this.o(),this.g("alignmentFocusName",b,a))}}}),v.Object.defineProperties(Fh,{Position:{get:function(){return sl.H("Position")}},Horizontal:{get:function(){return sl.H("Horizontal")}},Vertical:{get:function(){return sl.H("Vertical")}},Spot:{get:function(){return sl.H("Spot")}},Auto:{get:function(){return sl.H("Auto")}},Table:{get:function(){return sl.H("Table")}},Viewbox:{get:function(){return sl.H("Viewbox")}},TableRow:{get:function(){return sl.H("TableRow")}},TableColumn:{get:function(){return sl.H("TableColumn")}},Link:{get:function(){return sl.H("Link")}},Grid:{get:function(){return sl.H("Grid")}},Graduated:{get:function(){return sl.H("Graduated")}}}),Fh.prototype.findItemPanelForData=Fh.prototype.sy,Fh.prototype.rebuildItemElements=Fh.prototype.cu,Fh.prototype.updateTargetBindings=Fh.prototype.Ca,Fh.prototype.copyTemplate=Fh.prototype.Gz,Fh.prototype.graduatedValueForPoint=Fh.prototype.rA,Fh.prototype.graduatedPointForValue=Fh.prototype.qA,Fh.prototype.findColumnForLocalX=Fh.prototype.Tz,Fh.prototype.findRowForLocalY=Fh.prototype.aA,Fh.prototype.removeColumnDefinition=Fh.prototype.sw,Fh.prototype.removeRowDefinition=Fh.prototype.uw,Fh.prototype.removeAt=Fh.prototype.cb,Fh.prototype.remove=Fh.prototype.remove,Fh.prototype.insertAt=Fh.prototype.wb,Fh.prototype.elt=Fh.prototype.J,Fh.prototype.add=Fh.prototype.add,Fh.prototype.findObject=Fh.prototype.ab,Fh.prototype.findInVisualTree=Fh.prototype.vm,Fh.prototype.walkVisualTreeFrom=Fh.prototype.Ym,Fh.prototype.findMainElement=Fh.prototype.rb;var nl=!1,rl=null,sl=new Mt;function al(){pt(this),this.qg=null,this.ns=!0,this.Pa=0,this.cd=NaN,this.nh=0,this.lh=1/0,this.zb=Vi,this.la=this.ac=this.ha=0,this.fb=null,this.Up=ll,this.Be=Es,this.Op=this.ug=null,this.Pp=NaN,this.mb=this.dk=null,this.Fn=!1}function hl(a){if(a.sizing===ll){var b=a.qg;return a.isRow?b.rowSizing:b.columnSizing}return a.sizing}Fh.className="Panel",Fh.definePanelLayout=el,el("Position",new bh),el("Vertical",new kh),el("Auto",new Sh),el("Link",new jh),al.prototype.copy=function(){var a=new al;return a.ns=this.ns,a.Pa=this.Pa,a.cd=this.cd,a.nh=this.nh,a.lh=this.lh,a.zb=this.zb,a.ha=this.ha,a.ac=this.ac,a.la=this.la,a.Be=this.Be,a.Up=this.Up,null===this.ug?a.ug=null:a.ug=this.ug.G(),a.Op=this.Op,a.Pp=this.Pp,a.dk=null,null!==this.dk&&(a.separatorDashArray=O(this.separatorDashArray)),a.mb=this.mb,a.Fn=this.Fn,a.fb=this.fb,a},(n=al.prototype).Bt=function(a){a.isRow?this.height=a.height:this.width=a.width,this.minimum=a.minimum,this.maximum=a.maximum,this.alignment=a.alignment,this.stretch=a.stretch,this.sizing=a.sizing,this.ug=null===a.separatorPadding?null:a.separatorPadding.G(),this.separatorStroke=a.separatorStroke,this.separatorStrokeWidth=a.separatorStrokeWidth,this.dk=null,a.separatorDashArray&&(this.dk=O(a.separatorDashArray)),this.background=a.background,this.coversSeparators=a.coversSeparators,this.fb=a.fb},n.jb=function(a){a.classType===al&&(this.sizing=a)},n.toString=function(){return"RowColumnDefinition "+(this.isRow?"(Row ":"(Column ")+this.index+") #"+yt(this)},n.rj=function(a){this.qg=a},n.Hv=function(){var a=0,b=0,t=this.qg,e=this.isRow;if(null!==t&&t.type===Fh.Table)for(var n=e?t.vb.length:t.sb.length,o=0;o<n;o++){var g=e?t.vb[o]:t.sb[o];if(void 0!==g){b=g.index;break}}if(this.index!==b&&(null===(b=this.separatorStroke)&&null!==t&&(b=this.isRow?t.defaultRowSeparatorStroke:t.defaultColumnSeparatorStroke),null!==b&&(a=this.separatorStrokeWidth,isNaN(a)&&(a=null!==t?this.isRow?t.defaultRowSeparatorStrokeWidth:t.defaultColumnSeparatorStrokeWidth:0))),null===(b=this.ug)){if(null===t)return a;b=t.defaultSeparatorPadding}return a+(this.isRow?b.top:b.left)},n.wc=function(){var a=0,b=this.qg,t=0,e=this.isRow;if(null!==b&&b.type===Fh.Table)for(var n=e?b.vb.length:b.sb.length,o=0;o<n;o++){var g=e?b.vb[o]:b.sb[o];if(void 0!==g){t=g.index;break}}if(this.index!==t&&(null===(t=this.separatorStroke)&&null!==b&&(t=e?b.defaultRowSeparatorStroke:b.defaultColumnSeparatorStroke),null!==t&&(a=this.separatorStrokeWidth,isNaN(a)&&(a=null!==b?e?b.defaultRowSeparatorStrokeWidth:b.defaultColumnSeparatorStrokeWidth:0))),null===(e=this.ug)){if(null===b)return a;e=b.defaultSeparatorPadding}return a+(this.isRow?e.top+e.bottom:e.left+e.right)},n.Cb=function(a,b,t){var e=this.qg;if(null!==e&&(e.bb(Fe,a,this,b,t,void 0,void 0),null!==this.fb&&(null!==(b=e.diagram)&&!b.skipsModelSourceBindings&&(null!==(e=e.hj())&&null!==(b=e.data)))))for(t=this.fb.iterator;t.next();)t.value.jr(this,b,a,e)},n.bind=function(a){a.qd=this;var b=this.panel;if(null!==b){var t=b.hj();null!==t&&Zh(t)&&N("Cannot add a Binding to a RowColumnDefinition that is already frozen: "+a+" on "+b)}null===this.fb&&(this.fb=new ut),this.fb.add(a)},v.Object.defineProperties(al.prototype,{panel:{get:function(){return this.qg}},isRow:{get:function(){return this.ns},set:function(a){this.ns=a}},index:{get:function(){return this.Pa},set:function(a){this.Pa=a}},height:{get:function(){return this.cd},set:function(a){var b=this.cd;b!==a&&(0>a&&T(a,">= 0",al,"height"),this.cd=a,this.actual=this.ha,null!==this.panel&&this.panel.o(),this.Cb("height",b,a))}},width:{get:function(){return this.cd},set:function(a){var b=this.cd;b!==a&&(0>a&&T(a,">= 0",al,"width"),this.cd=a,this.actual=this.ha,null!==this.panel&&this.panel.o(),this.Cb("width",b,a))}},minimum:{get:function(){return this.nh},set:function(a){var b=this.nh;b!==a&&((0>a||!isFinite(a))&&T(a,">= 0",al,"minimum"),this.nh=a,this.actual=this.ha,null!==this.panel&&this.panel.o(),this.Cb("minimum",b,a))}},maximum:{get:function(){return this.lh},set:function(a){var b=this.lh;b!==a&&(0>a&&T(a,">= 0",al,"maximum"),this.lh=a,this.actual=this.ha,null!==this.panel&&this.panel.o(),this.Cb("maximum",b,a))}},alignment:{get:function(){return this.zb},set:function(a){var b=this.zb;b.w(a)||(this.zb=a.G(),null!==this.panel&&this.panel.o(),this.Cb("alignment",b,a))}},stretch:{get:function(){return this.Be},set:function(a){var b=this.Be;b!==a&&(this.Be=a,null!==this.panel&&this.panel.o(),this.Cb("stretch",b,a))}},separatorPadding:{get:function(){return this.ug},set:function(a){"number"==typeof a&&(a=new ui(a));var b=this.ug;null!==a&&null!==b&&b.w(a)||(null!==a&&(a=a.G()),this.ug=a,null!==this.panel&&this.panel.o(),this.Cb("separatorPadding",b,a))}},separatorStroke:{get:function(){return this.Op},set:function(a){var b=this.Op;b!==a&&(null!==a&&nh(a,"RowColumnDefinition.separatorStroke"),a instanceof qa&&a.freeze(),this.Op=a,null!==this.panel&&this.panel.o(),this.Cb("separatorStroke",b,a))}},separatorStrokeWidth:{get:function(){return this.Pp},set:function(a){var b=this.Pp;b!==a&&(this.Pp=a,null!==this.panel&&this.panel.o(),this.Cb("separatorStrokeWidth",b,a))}},separatorDashArray:{get:function(){return this.dk},set:function(a){var b=this.dk;if(b!==a){if(null!==a){for(var t=a.length,e=0,n=0;n<t;n++){var o=a[n];"number"==typeof o&&0<=o&&isFinite(o)||N("separatorDashArray value "+o+" at index "+n+" must be a positive number or zero."),e+=o}if(0===e){if(null===b)return;a=null}}this.dk=a,null!==this.panel&&this.panel.M(),this.Cb("separatorDashArray",b,a)}}},background:{get:function(){return this.mb},set:function(a){var b=this.mb;b!==a&&(null!==a&&nh(a,"RowColumnDefinition.background"),a instanceof qa&&a.freeze(),this.mb=a,null!==this.panel&&this.panel.M(),this.Cb("background",b,a))}},coversSeparators:{get:function(){return this.Fn},set:function(a){var b=this.Fn;b!==a&&(this.Fn=a,null!==this.panel&&this.panel.M(),this.Cb("coversSeparators",b,a))}},sizing:{get:function(){return this.Up},set:function(a){var b=this.Up;b!==a&&(this.Up=a,null!==this.panel&&this.panel.o(),this.Cb("sizing",b,a))}},actual:{get:function(){return this.ha},set:function(a){this.ha=isNaN(this.cd)?Math.max(Math.min(this.lh,a),this.nh):Math.max(Math.min(this.lh,this.cd),this.nh)}},measured:{get:function(){return this.ac},set:function(a){this.ac=a}},total:{get:function(){return this.ha+this.wc()},set:function(a){this.ha=isNaN(this.cd)?Math.max(Math.min(this.lh,a),this.nh):Math.max(Math.min(this.lh,this.cd),this.nh),this.ha=Math.max(0,this.ha-this.wc())}},position:{get:function(){return this.la},set:function(a){this.la=a}}}),al.prototype.bind=al.prototype.bind,al.prototype.computeEffectiveSpacing=al.prototype.wc,al.prototype.computeEffectiveSpacingTop=al.prototype.Hv;var ll=new _(al,"Default",0),cl=new _(al,"None",1),fl=new _(al,"ProportionalExtra",2);function pl(){ea.call(this),this.Dd=this.na=null,this.Vn="None",this.co=Es,this.Ic=this.rl="black",this.wh=1,this.hm="butt",this.im="miter",this.ek=10,this.uh=null,this.vh=0,this.rf=this.qf=Vi,this.np=this.mp=NaN,this.po=!1,this.pp=null,this.sl=this.om="None",this.Vd=1,this.Td=0,this.Rd=1,this.Sd=null}function gl(a,b,t,e){var n=t.length;if(!(4>n)){var o=e.measuredBounds,g=Math.max(1,o.width);o=o.height;for(var r,h,l,p,c,q,f=t[0],d=t[1],u=0,y=I(),m=2;m<n;m+=2)0===(l=(r=t[m])-f)&&(l=.001),p=(f=(h=t[m+1])-d)/l,c=Math.atan2(f,l),q=Math.sqrt(l*l+f*f),y.push([l,c,p,q]),u+=q,f=r,d=h;f=t[0],d=t[1],l=e.measuredBounds.width,e instanceof pl&&(l-=e.strokeWidth),1>l&&(l=1),n=t=l,h=0!==(r=g/2),l=(q=y[m=0])[0],c=q[1],p=q[2],q=q[3];for(var v=0;.1<=u;){if(0===v&&(h?(n=t,n-=r,u-=r,h=!1):n=t,0===n&&(n=1)),n>u)return void R(y);n>q?(v=n-q,n=q):v=0;var x=Math.sqrt(n*n/(1+p*p));if(0>l&&(x=-x),f+=x,d+=p*x,a.translate(f,d),a.rotate(c),a.translate(-g/2,-o/2),0===v&&e.dj(a,b),a.translate(g/2,o/2),a.rotate(-c),a.translate(-f,-d),u-=n,q-=n,0!==v){if(++m===y.length)return void R(y);l=(q=y[m])[0],c=q[1],p=q[2],q=q[3],n=v}}R(y)}}function yl(a){var b=a.geometryStretch;return null!==a.Dd?b===Es?Bs:b:b===Es?Ml[a.figure].defaultStretch:b}function ml(a,b,t,e,n){return(b=(a=t.x-a)*a+(b=t.y-b)*b)<e?(n.x=t.x,n.y=t.y,b):e}function vl(a,b,t,e,n,o,g,r,h){var l=!1,c=(n-g)*(b-e)-(o-r)*(a-t);return 0!==c&&(h.x=((n*r-o*g)*(a-t)-(n-g)*(a*e-b*t))/c,h.y=((n*r-o*g)*(b-e)-(o-r)*(a*e-b*t))/c,(a>t?a-t:t-a)<(b>e?b-e:e-b)?(a=b<e?b:e,b=b<e?e:b,(h.y>a||oe.aa(h.y,a))&&(h.y<b||oe.aa(h.y,b))&&(l=!0)):(b=a<t?a:t,a=a<t?t:a,(h.x>b||oe.aa(h.x,b))&&(h.x<a||oe.aa(h.x,a))&&(l=!0)),l)}function xl(a,b,t,e){if(!a.Mt(b,t,e))return!1;a=b.x,b=b.y;var n=t.x,o=t.y;return t=e.x,e=e.y,a===n?(b<o?(a=b,b=o):a=o,e>=a&&e<=b):(a<n?(e=a,a=n):e=n,t>=e&&t<=a)}function bl(a){var b=a.diagram;null!==b&&b.undoManager.isUndoingRedoing||(a.segmentOrientation=Xc,"None"!==a.om?(a.segmentIndex=-1,a.alignmentFocus=Ki):"None"!==a.sl&&(a.segmentIndex=0,a.alignmentFocus=new $i(1-Ki.x,Ki.y)))}function wl(a){var b=kl[a];if(void 0===b){var t=a.toLowerCase();if("none"===t)return"None";if(void 0===(b=kl[t])){var e,n=null;for(e in oe.an)if(e.toLowerCase()===t){n=e;break}if(null!==n)return a=ae(oe.an[n],!1),kl[n]=a,t!==n&&(kl[t]=n),n}}return"string"==typeof b?b:b instanceof td?a:null}al.className="RowColumnDefinition",al.Default=ll,al.None=cl,al.ProportionalExtra=fl,m(pl,ea),pl.prototype.cloneProtected=function(a){ea.prototype.cloneProtected.call(this,a),a.na=this.na,a.Vn=this.Vn,a.co=this.co,a.Dd=this.Dd,a.rl=this.rl,a.Ic=this.Ic,a.wh=this.wh,a.hm=this.hm,a.im=this.im,a.ek=this.ek,null!==this.uh&&(a.uh=O(this.uh)),a.vh=this.vh,a.qf=this.qf.G(),a.rf=this.rf.G(),a.mp=this.mp,a.np=this.np,a.po=this.po,a.pp=this.pp,a.om=this.om,a.sl=this.sl,a.Vd=this.Vd,a.Td=this.Td,a.Rd=this.Rd,a.Sd=this.Sd},(n=pl.prototype).jb=function(a){a===Is||a===Rs||a===Gs||a===Es?this.geometryStretch=a:ea.prototype.jb.call(this,a)},n.toString=function(){return"Shape("+("None"!==this.figure?this.figure:"None"!==this.toArrow?this.toArrow:this.fromArrow)+")#"+yt(this)},n.dj=function(a,b){var t=this.Ic,e=this.rl;if(null!==t||null!==e){var n=this.actualBounds,o=this.naturalBounds;null!==e&&la(this,a,e,!0,!1,o,n);var g=this.part,r=this.wh;null===t||0!==r||null===g||!this.isPanelMain&&g.rb()!==this||(r=g.type===Fh.Link&&g instanceof Eu&&"Selection"===g.category&&g.adornedObject instanceof pl&&g.adornedPart.rb()===g.adornedObject?g.adornedObject.strokeWidth:0),0===r&&(t=null),null!==t&&0!==r&&(la(this,a,t,!1,!1,o,n),a.lineWidth=r,a.lineJoin=this.im,a.lineCap=this.hm,a.miterLimit=this.ek),n=!1,g&&b.Ie("drawShadows")&&(n=g.isShadowed),g=!0,null===t||null!==e&&"transparent"!==e||(g=!1),o=!1,null!==(r=this.strokeDashArray)&&(o=!0,a.Et(r,this.vh));var h=this.na;if(null!==h){if(h.type===ge)a.beginPath(),a.moveTo(h.startX,h.startY),a.lineTo(h.endX,h.endY),null!==t&&a.uj();else if(h.type===ye){var l=h.startX;r=h.startY;var c=h.endX,f=h.endY;h=Math.min(l,c);var p=Math.min(r,f);l=Math.abs(c-l),r=Math.abs(f-r),a.beginPath(),a.rect(h,p,l,r),null!==e&&a.He(e),null!==t&&(g&&n&&za(a),0!==l&&0!==r||(a.beginPath(),a.rect(h,p,Math.max(l,.1),Math.max(r,.1))),a.uj(),g&&n&&ul(a))}else if(h.type===me)l=h.startX,r=h.startY,c=h.endX,f=h.endY,h=Math.abs(c-l)/2,p=Math.abs(f-r)/2,l=Math.min(l,c)+h,r=Math.min(r,f)+p,a.beginPath(),a.moveTo(l,r-p),a.bezierCurveTo(l+oe.Lg*h,r-p,l+h,r-oe.Lg*p,l+h,r),a.bezierCurveTo(l+h,r+oe.Lg*p,l+oe.Lg*h,r+p,l,r+p),a.bezierCurveTo(l-oe.Lg*h,r+p,l-h,r+oe.Lg*p,l-h,r),a.bezierCurveTo(l-h,r-oe.Lg*p,l-oe.Lg*h,r-p,l,r-p),a.closePath(),null!==e&&a.He(e),null!==t&&(g&&n?(za(a),a.uj(),ul(a)):a.uj());else if(h.type===ve)for(h=(r=h.figures).length,p=0;p<h;p++){l=r.j[p],a.beginPath(),a.moveTo(l.startX,l.startY),f=(c=l.segments.j).length;for(var d=null,q=0;q<f;q++){var u=c[q];switch(u.type){case Se:a.moveTo(u.endX,u.endY);break;case Pe:a.lineTo(u.endX,u.endY);break;case Ne:a.bezierCurveTo(u.point1X,u.point1Y,u.point2X,u.point2Y,u.endX,u.endY);break;case Ce:a.quadraticCurveTo(u.point1X,u.point1Y,u.endX,u.endY);break;case Te:if(u.radiusX===u.radiusY){var y=Math.PI/180;a.arc(u.point1X,u.point1Y,u.radiusX,u.startAngle*y,(u.startAngle+u.sweepAngle)*y,0>u.sweepAngle,null!==d?d.endX:l.startX,null!==d?d.endY:l.startY)}else if(0===(y=(d=ke(u,l)).length))a.lineTo(u.centerX,u.centerY);else for(var m=0;m<y;m++){var v=d[m];0===m&&a.lineTo(v[0],v[1]),a.bezierCurveTo(v[2],v[3],v[4],v[5],v[6],v[7])}break;case Le:if(m=y=0,null!==d&&d.type===Te){if(0===(v=(d=ke(d,l)).length)){a.lineTo(u.centerX,u.centerY);break}null!==(d=d[v-1]||null)&&(y=d[6],m=d[7])}else y=null!==d?d.endX:l.startX,m=null!==d?d.endY:l.startY;if(0===(y=(d=Me(u,l,y,m)).length)){a.lineTo(u.centerX,u.centerY);break}for(m=0;m<y;m++)v=d[m],a.bezierCurveTo(v[2],v[3],v[4],v[5],v[6],v[7]);break;default:N("Segment not of valid type: "+u.type)}u.isClosed&&a.closePath(),d=u}c=l.isFilled,n?l.isShadowed?(!0===c&&"transparent"!==e&&null!==e&&a.He(e),null!==t&&(c&&g&&za(a),a.uj(),c&&g&&ul(a))):(za(a),c&&"transparent"!==e&&null!==e&&a.He(e),null!==t&&a.uj(),ul(a)):(c&&null!==e&&a.He(e),null!==t&&a.uj())}if(o&&a.Ct(),null!==this.pathPattern){if((t=this.pathPattern).measure(1/0,1/0),e=t.measuredBounds,t.arrange(0,0,e.width,e.height),n=this.geometry,a.save(),a.beginPath(),e=I(),n.type===ge)e.push(n.startX),e.push(n.startY),e.push(n.endX),e.push(n.endY),gl(a,b,e,t);else if(n.type===ve)for(n=n.figures.iterator;n.next();){for(g=n.value,e.length=0,e.push(g.startX),e.push(g.startY),h=o=g.startX,p=r=g.startY,c=(l=g.segments.j).length,f=0;f<c;f++){switch((q=l[f]).type){case Se:gl(a,b,e,t),e.length=0,e.push(q.endX),e.push(q.endY),h=o=q.endX,p=r=q.endY;break;case Pe:e.push(q.endX),e.push(q.endY),o=q.endX,r=q.endY;break;case Ne:oe.De(o,r,q.point1X,q.point1Y,q.point2X,q.point2Y,q.endX,q.endY,.5,e),o=q.endX,r=q.endY;break;case Ce:oe.Uq(o,r,q.point1X,q.point1Y,q.endX,q.endY,.5,e),o=q.endX,r=q.endY;break;case Te:if(0===(d=(u=ke(q,g)).length)){e.push(q.centerX),e.push(q.centerY),o=q.centerX,r=q.centerY;break}for(y=0;y<d;y++)m=u[y],oe.De(o,r,m[2],m[3],m[4],m[5],m[6],m[7],.5,e),o=m[6],r=m[7];break;case Le:if(0===(d=(u=Me(q,g,o,r)).length)){e.push(q.centerX),e.push(q.centerY),o=q.centerX,r=q.centerY;break}for(y=0;y<d;y++)m=u[y],oe.De(o,r,m[2],m[3],m[4],m[5],m[6],m[7],.5,e),o=m[6],r=m[7];break;default:N("Segment not of valid type: "+q.type)}q.isClosed&&(e.push(h),e.push(p),gl(a,b,e,t))}gl(a,b,e,t)}else if(n.type===ye)e.push(n.startX),e.push(n.startY),e.push(n.endX),e.push(n.startY),e.push(n.endX),e.push(n.endY),e.push(n.startX),e.push(n.endY),e.push(n.startX),e.push(n.startY),gl(a,b,e,t);else if(n.type===me){if((r=new be).startX=n.endX,r.startY=(n.startY+n.endY)/2,(o=new we(Te)).startAngle=0,o.sweepAngle=360,o.centerX=(n.startX+n.endX)/2,o.centerY=(n.startY+n.endY)/2,o.radiusX=Math.abs(n.startX-n.endX)/2,o.radiusY=Math.abs(n.startY-n.endY)/2,r.add(o),0===(g=(n=ke(o,r)).length))e.push(o.centerX),e.push(o.centerY);else for(o=r.startX,r=r.startY,h=0;h<g;h++)p=n[h],oe.De(o,r,p[2],p[3],p[4],p[5],p[6],p[7],.5,e),o=p[6],r=p[7];gl(a,b,e,t)}R(e),a.restore(),a.uc(!1)}}}},n.da=function(a,b){if(void 0===b&&(b=new St),a instanceof $i){a.nc()&&N("getDocumentPoint Spot must be a real, specific Spot, not: "+a.toString());var t=this.naturalBounds,e=this.strokeWidth;b.h(a.x*(t.width+e)-e/2+t.x+a.offsetX,a.y*(t.height+e)-e/2+t.y+a.offsetY)}else b.set(a);return this.Ed.sa(b),b},n.lj=function(a){void 0===a&&(a=new Jt);var b=this.naturalBounds,t=this.Ed;b=Jt.allocAt(b.x,b.y,b.width,b.height);var e=this.strokeWidth;return b.Kc(e/2,e/2),e=St.allocAt(b.x,b.y).transform(t),a.h(e.x,e.y,0,0),e.h(b.right,b.y).transform(t),ni(a,e.x,e.y,0,0),e.h(b.right,b.bottom).transform(t),ni(a,e.x,e.y,0,0),e.h(b.x,b.bottom).transform(t),ni(a,e.x,e.y,0,0),Jt.free(b),St.free(e),a},n.Jh=function(a,b){var t=this.geometry;if(null===t||null===this.fill&&null===this.stroke)return!1;var e=t.bounds,n=this.strokeWidth/2;t.type!==ge||b||(n+=2);var o=Jt.alloc();if(o.assign(e),o.Kc(n+2,n+2),!o.$(a))return Jt.free(o),!1;if(e=n+1e-4,t.type===ge)return null!==this.stroke&&(e=(t.endX-t.startX)*(a.x-t.startX)+(t.endY-t.startY)*(a.y-t.startY),!(0>(t.startX-t.endX)*(a.x-t.endX)+(t.startY-t.endY)*(a.y-t.endY)||0>e)&&(Jt.free(o),oe.Ob(t.startX,t.startY,t.endX,t.endY,n,a.x,a.y)));if(t.type===ye){b=t.startX;var g=t.startY,r=t.endX;if(t=t.endY,o.x=Math.min(b,r),o.y=Math.min(g,t),o.width=Math.abs(r-b),o.height=Math.abs(t-g),null===this.fill){if(o.Kc(-e,-e),o.$(a))return Jt.free(o),!1;o.Kc(e,e)}return null!==this.stroke&&o.Kc(n,n),a=o.$(a),Jt.free(o),a}if(t.type===me){g=t.startX,n=t.startY,r=t.endX;var h=t.endY;if(t=Math.min(g,r),b=Math.min(n,h),g=Math.abs(r-g)/2,n=Math.abs(h-n)/2,t=a.x-(t+g),b=a.y-(b+n),null===this.fill){if(n-=e,0>=(g-=e)||0>=n||1>=t*t/(g*g)+b*b/(n*n))return Jt.free(o),!1;g+=e,n+=e}return null!==this.stroke&&(g+=e,n+=e),Jt.free(o),!(0>=g||0>=n)&&1>=t*t/(g*g)+b*b/(n*n)}return t.type===ve?(Jt.free(o),null===this.fill?fe(t,a.x,a.y,n):ue(t,a,n,1<this.strokeWidth,b)):(N("Unknown Geometry type: "+t.type),!1)},n.Fm=function(a,b,t,e){var n=this.desiredSize,o=this.wh;if(a=Math.max(a,0),b=Math.max(b,0),null!==this.Dd)var g=this.geometry.bounds;else{var r=this.figure,h=Ml[r];if(void 0===h){var l=oe.Qe[r];"string"==typeof l&&(l=oe.Qe[l]),"function"==typeof l?(h=l(null,100,100),Ml[r]=h):N("Unsupported Figure: "+r)}g=h.bounds}r=g.width,h=g.height,l=g.width;var c=g.height;switch(da(this,!0)){case Is:e=t=0;break;case Bs:l=Math.max(a-o,0),c=Math.max(b-o,0);break;case zs:l=Math.max(a-o,0),e=0;break;case Vs:t=0,c=Math.max(b-o,0)}switch(isFinite(n.width)&&(l=n.width),isFinite(n.height)&&(c=n.height),n=this.maxSize,g=this.minSize,t=Math.max(t-o,g.width),e=Math.max(e-o,g.height),l=Math.min(n.width,l),c=Math.min(n.height,c),l=isFinite(l)?Math.max(t,l):Math.max(r,t),c=isFinite(c)?Math.max(e,c):Math.max(h,e),t=yl(this)){case Is:break;case Bs:r=l,h=c;break;case Rs:t=Math.min(l/r,c/h),isFinite(t)||(t=1),r*=t,h*=t;break;default:N(t+" is not a valid geometryStretch.")}null!==this.Dd?(r=Math.max(r,.01),h=Math.max(h,.01),e=r/(n=(t=null!==this.Dd?this.Dd:this.na).bounds).width,n=h/n.height,isFinite(e)||(e=1),isFinite(n)||(n=1),this.na=1===e&&1===n?t:t.copy().scale(e,n)):null!==this.na&&oe.aa(this.na.Cl,a-o)&&oe.aa(this.na.Bl,b-o)||(this.na=pl.makeGeometry(this,r,h)),g=this.na.bounds,1/0===a||1/0===b?ra(this,g.x-o/2,g.y-o/2,0===a&&0===r?0:g.width+o,0===b&&0===h?0:g.height+o):ra(this,-o/2,-o/2,l+o,c+o)},n.Hh=function(a,b,t,e){aa(this,a,b,t,e)},n.Mt=function(a,b,t){return this.wk(a.x,a.y,b.x,b.y,t)},n.wk=function(a,b,t,e,n){var o=this.transform,g=1/(o.m11*o.m22-o.m12*o.m21),r=o.m22*g,h=-o.m12*g,l=-o.m21*g,c=o.m11*g,f=g*(o.m21*o.dy-o.m22*o.dx),p=g*(o.m12*o.dx-o.m11*o.dy);o=a*r+b*l+f,g=a*h+b*c+p,r=t*r+e*l+f,h=t*h+e*c+p,f=this.wh/2,null===(l=this.na)&&(this.measure(1/0,1/0),l=this.na);var d=l.bounds;if(c=!1,l.type===ge)if(1.5>=this.strokeWidth)c=oe.Ke(l.startX,l.startY,l.endX,l.endY,o,g,r,h,n);else{if(l.startX===l.endX?(e=f,c=0):(b=(l.endY-l.startY)/(l.endX-l.startX),e=(c=f/Math.sqrt(1+b*b))*b),b=I(),a=new St,oe.Ke(l.startX+e,l.startY+c,l.endX+e,l.endY+c,o,g,r,h,a)&&b.push(a),a=new St,oe.Ke(l.startX-e,l.startY-c,l.endX-e,l.endY-c,o,g,r,h,a)&&b.push(a),a=new St,oe.Ke(l.startX+e,l.startY+c,l.startX-e,l.startY-c,o,g,r,h,a)&&b.push(a),a=new St,oe.Ke(l.endX+e,l.endY+c,l.endX-e,l.endY-c,o,g,r,h,a)&&b.push(a),0===(r=b.length))return R(b),!1;for(c=!0,h=1/0,e=0;e<r;e++)(t=((a=b[e]).x-o)*(a.x-o)+(a.y-g)*(a.y-g))<h&&(h=t,n.x=a.x,n.y=a.y);R(b)}else if(l.type===ye)c=oe.Ef(d.x-f,d.y-f,d.x+d.width+f,d.y+d.height+f,o,g,r,h,n);else if(l.type===me){t:if(0===(b=Jt.allocAt(d.x,d.y,d.width,d.height).Kc(f,f)).width)c=oe.Ke(b.x,b.y,b.x,b.y+b.height,o,g,r,h,n);else if(0===b.height)c=oe.Ke(b.x,b.y,b.x+b.width,b.y,o,g,r,h,n);else{if(a=b.width/2,l=b.height/2,e=b.x+a,c=b.y+l,t=9999,o!==r&&(t=(g-h)/(o-r)),9999>Math.abs(t)){if(0>a*a*t*t+l*l-(h=g-c-t*(o-e))*h){n.x=NaN,n.y=NaN,c=!1;break t}r=(-a*a*t*h+a*l*(f=Math.sqrt(a*a*t*t+l*l-h*h)))/(l*l+a*a*t*t)+e,a=(-a*a*t*h-a*l*f)/(l*l+a*a*t*t)+e,l=t*(r-e)+h+c,h=t*(a-e)+h+c,Math.abs((o-r)*(o-r))+Math.abs((g-l)*(g-l))<Math.abs((o-a)*(o-a))+Math.abs((g-h)*(g-h))?(n.x=r,n.y=l):(n.x=a,n.y=h)}else{if(r=l*l,0>(r-=r/(a*a)*(h=o-e)*h)){n.x=NaN,n.y=NaN,c=!1;break t}r=c+(h=Math.sqrt(r)),h=c-h,Math.abs(r-g)<Math.abs(h-g)?(n.x=o,n.y=r):(n.x=o,n.y=h)}c=!0}Jt.free(b)}else if(l.type===ve){p=St.alloc();var q=r-o,u=h-g,y=q*q+u*u,m=o,v=g;if(0<y&&d.contains(m,v)&&(p.x=m,p.y=v,this.$(p)))for(m-=q,v-=u;d.contains(m,v);)m-=q,v-=u;for(n.x=r,n.y=h,u=0;u<l.figures.count;u++)for(var x=l.figures.j[u],w=x.isFilled?m:o,k=x.isFilled?v:g,M=x.segments,S=d=x.startX,P=q=x.startY,C=0;C<M.count;C++){var T=M.j[C],L=T.type,A=T.endX,j=T.endY,D=!1;switch(L){case Se:S=A,P=j;break;case Pe:D=vl(d,q,A,j,w,k,r,h,p);break;case Ne:D=oe.sq(d,q,T.point1X,T.point1Y,T.point2X,T.point2Y,A,j,w,k,r,h,.6,p);break;case Ce:D=oe.sq(d,q,d+2/3*(T.point1X-d),q+2/3*(T.point1Y-q),A+2/3*(T.point1X-A),j+2/3*(T.point1Y-j),A,j,w,k,r,h,.6,p);break;case Te:case Le:var O=(L=T.type===Te?ke(T,x):Me(T,x,d,q)).length;if(0===O){D=vl(d,q,T.centerX,T.centerY,w,k,r,h,p);break}for(j=null,A=0;A<O;A++){if(j=L[A],0===A&&vl(d,q,j[0],j[1],w,k,r,h,p)){var F=ml(w,k,p,y,n);F<y&&(y=F,c=!0)}oe.sq(j[0],j[1],j[2],j[3],j[4],j[5],j[6],j[7],w,k,r,h,.6,p)&&((F=ml(w,k,p,y,n))<y&&(y=F,c=!0))}A=j[6],j=j[7];break;default:N("Unknown Segment type: "+L)}d=A,q=j,D&&((D=ml(w,k,p,y,n))<y&&(y=D,c=!0)),T.isClosed&&(vl(d,q,A=S,j=P,w,k,r,h,p)&&((T=ml(w,k,p,y,n))<y&&(y=T,c=!0)))}o=t-a,g=e-b,0!==(r=Math.sqrt(o*o+g*g))&&(o/=r,g/=r),n.x-=o*f,n.y-=g*f,St.free(p)}else N("Unknown Geometry type: "+l.type);return!!c&&(this.transform.sa(n),!0)},n.Ih=function(a,b){if(void 0===b)return a.Ee(this.actualBounds);var t=this.na;null===t&&(this.measure(1/0,1/0),t=this.na),t=t.bounds;var e=this.strokeWidth/2,n=!1,o=St.alloc();return o.h(t.x-e,t.y-e),a.$(b.sa(o))&&(o.h(t.x-e,t.bottom+e),a.$(b.sa(o))&&(o.h(t.right+e,t.bottom+e),a.$(b.sa(o))&&(o.h(t.right+e,t.y-e),a.$(b.sa(o))&&(n=!0)))),St.free(o),n},n.Nc=function(a,b){if(this.Ih(a,b)||void 0===b&&(b=this.transform,a.Ee(this.actualBounds)))return!0;var t=ee.alloc();t.set(b),t.Rt();var e=a.left,n=a.right,o=a.top;a=a.bottom;var g=St.alloc();if(g.h(e,o),t.sa(g),this.Jh(g,!0))return St.free(g),!0;if(g.h(n,o),t.sa(g),this.Jh(g,!0))return St.free(g),!0;if(g.h(e,a),t.sa(g),this.Jh(g,!0))return St.free(g),!0;if(g.h(n,a),t.sa(g),this.Jh(g,!0))return St.free(g),!0;var r=St.alloc(),h=St.alloc();return t.set(b),t.hw(this.transform),t.Rt(),r.x=n,r.y=o,r.transform(t),g.x=e,g.y=o,g.transform(t),b=!1,xl(this,g,r,h)?b=!0:(g.x=n,g.y=a,g.transform(t),xl(this,g,r,h)?b=!0:(r.x=e,r.y=a,r.transform(t),xl(this,g,r,h)?b=!0:(g.x=e,g.y=o,g.transform(t),xl(this,g,r,h)&&(b=!0)))),St.free(g),ee.free(t),St.free(r),St.free(h),b},n.ty=function(a,b,t){function e(a,b){for(var t=a.length,e=0;e<t;e+=2)if(b.rd(a[e],a[e+1])>n)return!0;return!1}if(t&&null!==this.fill&&this.Jh(a,!0))return!0;var n=a.Ge(b),o=n;if(1.5<this.strokeWidth&&(n=this.strokeWidth/2+Math.sqrt(n),n*=n),null===(b=this.na)&&(this.measure(1/0,1/0),null===(b=this.na)))return!1;if(!t){var g=b.bounds,r=g.x,h=g.y,l=g.x+g.width;if(g=g.y+g.height,At(a.x,a.y,r,h)<=n&&At(a.x,a.y,l,h)<=n&&At(a.x,a.y,r,g)<=n&&At(a.x,a.y,l,g)<=n)return!0}if(r=b.startX,h=b.startY,l=b.endX,g=b.endY,b.type===ge){if(t=(r-l)*(a.x-l)+(h-g)*(a.y-g),Lt(a.x,a.y,r,h,l,g)<=(0<=(l-r)*(a.x-r)+(g-h)*(a.y-h)&&0<=t?n:o))return!0}else{if(b.type===ye)return b=!1,t&&(b=Lt(a.x,a.y,r,h,r,g)<=n||Lt(a.x,a.y,r,h,l,h)<=n||Lt(a.x,a.y,l,h,l,g)<=n||Lt(a.x,a.y,r,g,l,g)<=n),b;if(b.type===me){b=a.x-(r+l)/2,o=a.y-(h+g)/2;var c=Math.abs(l-r)/2,f=Math.abs(g-h)/2;if(0===c||0===f)return Lt(a.x,a.y,r,h,l,g)<=n;if(!t)return!(At(b,o,-c,0)>=n||At(b,o,0,-f)>=n||At(b,o,0,f)>=n||At(b,o,c,0)>=n);if((a=oe.Mz(c,f,b,o))*a<=n)return!0}else if(b.type===ve){if(o=(l=b.bounds).x,r=l.y,h=l.x+l.width,l=l.y+l.height,a.x>h&&a.x<o&&a.y>l&&a.y<r&&Lt(a.x,a.y,o,r,o,l)>n&&Lt(a.x,a.y,o,r,h,r)>n&&Lt(a.x,a.y,h,l,o,l)>n&&Lt(a.x,a.y,h,l,h,r)>n)return!1;if(o=Math.sqrt(n),!t){for(t=b.figures,b=0;b<t.count;b++){if(g=(o=t.j[b]).startX,c=o.startY,a.rd(g,c)>n)return!1;for(h=(r=o.segments.j).length,l=0;l<h;l++)switch(f=r[l],f.type){case Se:case Pe:if(g=f.endX,c=f.endY,a.rd(g,c)>n)return!1;break;case Ne:var p=I();if(oe.De(g,c,f.point1X,f.point1Y,f.point2X,f.point2Y,f.endX,f.endY,.8,p),g=e(p,a),R(p),g)return!1;if(g=f.endX,c=f.endY,a.rd(g,c)>n)return!1;break;case Ce:if(p=I(),oe.Uq(g,c,f.point1X,f.point1Y,f.endX,f.endY,.8,p),g=e(p,a),R(p),g)return!1;if(g=f.endX,c=f.endY,a.rd(g,c)>n)return!1;break;case Te:case Le:var d=(p=f.type===Te?ke(f,o):Me(f,o,g,c)).length;if(0===d){if(g=f.centerX,c=f.centerY,a.rd(g,c)>n)return!1;break}f=null;for(var q=I(),u=0;u<d;u++)if(f=p[u],q.length=0,oe.De(f[0],f[1],f[2],f[3],f[4],f[5],f[6],f[7],.8,q),e(q,a))return R(q),!1;R(q),null!==f&&(g=f[6],c=f[7]);break;default:N("Unknown Segment type: "+f.type)}}return!0}if(null===this.fill?fe(b,a.x,a.y,o):ue(b,a,o,!0,!1))return!0}}return!1},n.dc=function(){this.na=null},pl.makeGeometry=function(a,b,t){if("None"!==a.toArrow)var e=kl[a.toArrow];else"None"!==a.fromArrow?e=kl[a.fromArrow]:("string"==typeof(e=oe.Qe[a.figure])&&(e=oe.Qe[e]),void 0===e&&N("Unknown Shape.figure: "+a.figure),(e=e(a,b,t)).Cl=b,e.Bl=t);if(null===e){var n=oe.Qe.Rectangle;"function"==typeof n&&(e=n(a,b,t))}return e},v.Object.defineProperties(pl.prototype,{geometry:{get:function(){return null!==this.na?this.na:this.Dd},set:function(a){var b=this.na,t=this.Dd;if(b!==a){this.Dd=this.na=null!==a?a.freeze():null;var e=this.part;null!==e&&(e.kh=NaN),this.o(),this.g("geometry",b||t,a),ma(this)&&(null!==(a=this.part)&&oa(this,a,"geometryString"))}}},geometryString:{get:function(){return null===this.geometry?"":this.geometry.toString()},set:function(a){var b=(a=ae(a)).normalize();this.geometry=a,this.position=a=St.allocAt(-b.x,-b.y),St.free(a)}},isGeometryPositioned:{get:function(){return this.po},set:function(a){var b=this.po;b!==a&&(this.po=a,this.o(),this.g("isGeometryPositioned",b,a))}},fill:{get:function(){return this.rl},set:function(a){var b=this.rl;b!==a&&(null!==a&&nh(a,"Shape.fill"),a instanceof qa&&a.freeze(),this.rl=a,this.M(),this.g("fill",b,a))}},stroke:{get:function(){return this.Ic},set:function(a){var b=this.Ic;b!==a&&(null!==a&&nh(a,"Shape.stroke"),a instanceof qa&&a.freeze(),this.Ic=a,this.M(),this.g("stroke",b,a))}},strokeWidth:{get:function(){return this.wh},set:function(a){var b=this.wh;if(b!==a)if(0<=a){this.wh=a,this.o();var t=this.part;null!==t&&(t.kh=NaN),this.g("strokeWidth",b,a)}else T(a,"value >= 0",pl,"strokeWidth:value")}},strokeCap:{get:function(){return this.hm},set:function(a){var b=this.hm;b!==a&&("string"!=typeof a||"butt"!==a&&"round"!==a&&"square"!==a?T(a,'"butt", "round", or "square"',pl,"strokeCap"):(this.hm=a,this.M(),this.g("strokeCap",b,a)))}},strokeJoin:{get:function(){return this.im},set:function(a){var b=this.im;b!==a&&("string"!=typeof a||"miter"!==a&&"bevel"!==a&&"round"!==a?T(a,'"miter", "bevel", or "round"',pl,"strokeJoin"):(this.im=a,this.M(),this.g("strokeJoin",b,a)))}},strokeMiterLimit:{get:function(){return this.ek},set:function(a){var b=this.ek;if(b!==a&&1<=a){this.ek=a,this.M();var t=this.part;null!==t&&(t.kh=NaN),this.g("strokeMiterLimit",b,a)}}},strokeDashArray:{get:function(){return this.uh},set:function(a){var b=this.uh;if(b!==a){if(null!==a){for(var t=a.length,e=0,n=0;n<t;n++){var o=a[n];0<=o&&isFinite(o)||N("strokeDashArray:value "+o+" at index "+n+" must be a positive number or zero."),e+=o}if(0===e){if(null===b)return;a=null}}this.uh=a,this.M(),this.g("strokeDashArray",b,a)}}},strokeDashOffset:{get:function(){return this.vh},set:function(a){var b=this.vh;b!==a&&0<=a&&(this.vh=a,this.M(),this.g("strokeDashOffset",b,a))}},figure:{get:function(){return this.Vn},set:function(a){var b=this.Vn;if(b!==a){var t=oe.Qe[a];"function"==typeof t?t=a:(t=oe.Qe[a.toLowerCase()])||N("Unknown Shape.figure: "+a),b!==t&&(null!==(a=this.part)&&(a.kh=NaN),this.Vn=t,this.Dd=null,this.dc(),this.o(),this.g("figure",b,t))}}},toArrow:{get:function(){return this.om},set:function(a){var b=this.om;if(!0===a?a="Standard":!1===a&&(a=""),b!==a){var t=wl(a);null===t?N("Unknown Shape.toArrow: "+a):b!==t&&(this.om=t,this.Dd=null,this.dc(),this.o(),bl(this),this.g("toArrow",b,t))}}},fromArrow:{get:function(){return this.sl},set:function(a){var b=this.sl;if(!0===a?a="Standard":!1===a&&(a=""),b!==a){var t=wl(a);null===t?N("Unknown Shape.fromArrow: "+a):b!==t&&(this.sl=t,this.Dd=null,this.dc(),this.o(),bl(this),this.g("fromArrow",b,t))}}},spot1:{get:function(){return this.qf},set:function(a){var b=this.qf;b.w(a)||(this.qf=a=a.G(),this.o(),this.g("spot1",b,a))}},spot2:{get:function(){return this.rf},set:function(a){var b=this.rf;b.w(a)||(this.rf=a=a.G(),this.o(),this.g("spot2",b,a))}},parameter1:{get:function(){return this.mp},set:function(a){var b=this.mp;b!==a&&(this.mp=a,this.dc(),this.o(),this.g("parameter1",b,a))}},parameter2:{get:function(){return this.np},set:function(a){var b=this.np;b!==a&&(this.np=a,this.dc(),this.o(),this.g("parameter2",b,a))}},naturalBounds:{get:function(){if(null!==this.na)return this.rc.assign(this.na.bounds),this.rc;var a=this.desiredSize;return new Jt(0,0,a.width,a.height)}},pathPattern:{get:function(){return this.pp},set:function(a){var b=this.pp;b!==a&&(this.pp=a,this.M(),this.g("pathPattern",b,a))}},geometryStretch:{get:function(){return this.co},set:function(a){var b=this.co;b!==a&&(this.co=a,this.g("geometryStretch",b,a))}},interval:{get:function(){return this.Vd},set:function(a){var b=this.Vd;if(b!==(a=Math.round(a))&&0!==a&&isFinite(a)){this.Vd=a;var t=this.diagram;null!==t&&this.panel===t.grid&&Er(t),this.o(),null!==(t=this.panel)&&(t.eh=null),this.g("interval",b,a)}}},graduatedStart:{get:function(){return this.Td},set:function(a){var b=this.Td;b!==a&&(0>a?a=0:1<a&&(a=1),this.Td=a,this.o(),this.g("graduatedStart",b,a))}},graduatedEnd:{get:function(){return this.Rd},set:function(a){var b=this.Rd;b!==a&&(0>a?a=0:1<a&&(a=1),this.Rd=a,this.o(),this.g("graduatedEnd",b,a))}},graduatedSkip:{get:function(){return this.Sd},set:function(a){var b=this.Sd;b!==a&&(this.Sd=a,this.o(),this.g("graduatedSkip",b,a))}}}),pl.prototype.intersectsRect=pl.prototype.Nc,pl.prototype.containedInRect=pl.prototype.Ih,pl.prototype.getNearestIntersectionPoint=pl.prototype.Mt,pl.prototype.getDocumentBounds=pl.prototype.lj,pl.prototype.getDocumentPoint=pl.prototype.da;var kl=new et,Ml=new et;function Sl(){ea.call(this),Jl||(Wl=hs?new Va(null).context:null,Jl=!0),this.Kx=this.Ub="",this.Ic="black",this.le="13px sans-serif",this.Ui="start",this.Qd=Is,this.$i=Xi,this.Nj=!0,this.yi=this.zi=!1,this.og=zl,this.Ag=Rl,this.us=this.ub=this.ad=0,this.bv=this.cv=null,this.Sn=!1,this.Dc=this.un=this.eq=this.Vi=this.fq=null,this.pf=this.nf=0,this.te=1/0,this.Ci=0,this.me=null,this.ze=0,this.ke=this.lb=this.Qb=null,this.Vd=1,this.Td=0,this.Rd=1,this.Sd=this.Jj=null}function Pl(a,b){a.F=6144|b.F,a.hb=b.opacity,a.mb=b.background,a.ec=b.areaBackground,a.Zc=b.desiredSize.G(),a.hg=b.minSize.G(),a.gg=b.maxSize.G(),a.eg=b.eg.copy(),a.ya=b.scale,a.Yb=b.angle,a.Be=b.stretch,a.jh=b.margin.G(),a.zb=b.alignment.G(),a.Yk=b.alignmentFocus.G(),a.Yl=b.segmentFraction,a.Zl=b.segmentOffset.G(),a.$l=b.segmentOrientation,null!==b.Ya&&(a.Ya=b.Ya.copy()),a.bm=b.shadowVisible,b instanceof Sl&&(a.Ub=b.Ub,a.Ic=b.Ic,a.le=b.le,a.Ui=b.Ui,a.Qd=b.Qd,a.$i=b.$i,a.Nj=b.Nj,a.zi=b.zi,a.yi=b.yi,a.og=b.og,a.Ag=b.Ag,a.me=null,a.nf=b.nf,a.pf=b.pf,a.te=b.te,a.Ci=b.Ci,a.Vd=b.Vd,a.Td=b.Td,a.Rd=b.Rd,a.Jj=b.Jj,a.Sd=b.Sd)}function Nl(a,b,t){null===a.ke?(a.ke=b,a.ub=t):(null!==a.lb&&null!==a.Qb||(a.lb=[],a.Qb=[],a.lb.push(a.ke),a.Qb.push(a.ub)),a.lb.push(b),a.Qb.push(t))}function Cl(a,b,t,e){b=b.trim();var n=0,o=a.le,g=a.nf+a.pf;g=Math.max(0,Al(a)+g);var r=a.og===Vl?jl(o):0;if(a.ad>=a.te)null!==e&&e.h(0,g);else{var h=b;if(a.Ag===Bl)if(a.ze=1,o=Ll(b),0===r||o<=t)a.ub=Math.max(a.ub,o),Nl(a,b,a.ub),null!==e&&e.h(o,g);else{for(o=Ll((n=Tl(a,h))+(b=Tl(a,h=h.substr(n.length))));0<b.length&&o<=t;)o=Ll(((n+=b)+(b=Tl(a,h=h.substr(b.length)))).trim());for(n+=b.trim(),t=Math.max(1,t-r);Ll(n)>t&&1<n.length;)n=n.substr(0,n.length-1);b=Ll(n+=Kl),a.ub=b,Nl(a,n,b),null!==e&&e.h(b,g)}else{for(r=0,0===h.length&&(r=1,Nl(a,h,0));0<h.length;){var l=Tl(a,h);for(h=h.substr(l.length);Ll(l)>t;){var c=1;for(o=Ll(l.substr(0,c)),b=0;o<=t;)c++,b=o,o=Ll(l.substr(0,c));if(1===c){var f=o;n=Math.max(n,o)}else f=b,n=Math.max(n,b);if(1>--c&&(c=1),Nl(a,l.substr(0,c),f),r++,l=l.substr(c),a.ad+r>a.te)break}for(o=Ll(l+(b=Tl(a,h)));0<b.length&&o<=t;)o=Ll(((l+=b)+(b=Tl(a,h=h.substr(b.length)))).trim());if(""!==(l=l.trim())&&("­"===l[l.length-1]&&(l=l.substring(0,l.length-1)+"‐"),0===b.length?(c=o,n=Math.max(n,o)):(c=b=Ll(l),n=Math.max(n,b)),Nl(a,l,c),r++,a.ad+r>a.te))break}a.ze=Math.min(a.te,r),a.ub=Math.max(a.ub,n),null!==e&&e.h(a.ub,g*a.ze)}}}function Tl(a,b){if(a.Ag===El)return b.substr(0,1);a=b.length;for(var t=0,e=Gl;t<a&&!e.test(b.charAt(t));)t++;for(;t<a&&e.test(b.charAt(t));)t++;return t>=a?b:b.substr(0,t)}function Ll(a){return null===Wl?8*a.length:Wl.measureText(a).width}function Al(a){if(null!==a.me)return a.me;var b=a.le;if(null===Wl){var t=16;return a.me=t}return void 0!==Yl[b]&&5e3>Xl?t=Yl[b]:(t=1.3*Wl.measureText("M").width,Yl[b]=t,Xl++),a.me=t}function jl(a){if(null===Wl)return 6;if(void 0!==ql[a]&&5e3>Ul)var b=ql[a];else b=Wl.measureText(Kl).width,ql[a]=b,Ul++;return b}function Dl(a,b){var t=a.Ub.replace(/\r\n/g,"\n").replace(/\r/g,"\n"),e=a.nf+a.pf;if(e=Math.max(0,Al(a)+e),0===t.length)return a.ub=0,a.ad=1,e;if(!a.isMultiline){var n=t.indexOf("\n",0);0<=n&&(t=t.substr(0,n))}n=0;for(var g,o=a.ad=0,r=!1;!r;){if(-1===(g=t.indexOf("\n",o))&&(g=t.length,r=!0),o<=g){if(o=t.substr(o,g-o),a.Ag!==Bl){a.ze=0;var h=Ut.alloc();Cl(a,o,b,h),n+=h.height,Ut.free(h),a.ad+=a.ze}else Cl(a,o,b,null),n+=e,a.ad++;a.ad===a.te&&(r=!0)}o=g+1}return a.us=n}pl.className="Shape",pl.getFigureGenerators=function(){var b,a=new Mt;for(b in oe.Qe)b!==b.toLowerCase()&&a.add(b,oe.Qe[b]);return a.freeze(),a},pl.defineFigureGenerator=function(a,b){var t=a.toLowerCase(),e=oe.Qe;e[a]=b,e[t]=a},pl.getArrowheadGeometries=function(){var a=new Mt;for(e in oe.an)if(void 0===kl[e]){var b=ae(oe.an[e],!1);kl[e]=b,(b=e.toLowerCase())!==e&&(kl[b]=e)}for(var t in kl)if(t!==t.toLowerCase()){var e=kl[t];e instanceof td&&a.add(t,e)}return a.freeze(),a},pl.defineArrowheadGeometry=function(a,b){var t=null;t="string"==typeof b?ae(b,!1):b,"none"!==(b=a.toLowerCase())&&a!==b||N("Shape.defineArrowheadGeometry name must not be empty or None or all-lower-case: "+a);var e=kl;e[a]=t,e[b]=a},m(Sl,ea),Sl.prototype.cloneProtected=function(a){ea.prototype.cloneProtected.call(this,a),a.Ub=this.Ub,a.Kx=this.Kx,a.Ic=this.Ic,a.le=this.le,a.Ui=this.Ui,a.Qd=this.Qd,a.$i=this.$i,a.Nj=this.Nj,a.zi=this.zi,a.yi=this.yi,a.og=this.og,a.Ag=this.Ag,a.ad=this.ad,a.us=this.us,a.ub=this.ub,a.cv=this.cv,a.bv=this.bv,a.Sn=this.Sn,a.fq=this.fq,a.Vi=this.Vi,a.eq=this.eq,a.un=this.un,a.Dc=this.Dc,a.nf=this.nf,a.pf=this.pf,a.te=this.te,a.me=this.me,a.ze=this.ze,a.Qb=this.Qb,a.lb=this.lb,a.ke=this.ke,a.Ci=this.Ci,a.Vd=this.Vd,a.Td=this.Td,a.Rd=this.Rd,a.Jj=this.Jj,a.Sd=this.Sd},(n=Sl.prototype).jb=function(a){a.classType===Sl?this.wrap=a:ea.prototype.jb.call(this,a)},n.toString=function(){return 22<this.Ub.length?'TextBlock("'+this.Ub.substring(0,20)+'"...)':'TextBlock("'+this.Ub+'")'},n.o=function(){ea.prototype.o.call(this),this.bv=this.cv=null},n.dj=function(a,b){if(null!==this.Ic&&0!==this.Ub.length&&null!==this.le){var t=this.naturalBounds,e=this.actualBounds,n=t.width,o=t.height,g=Al(this),r=a.textAlign=this.Ui,h=b.Fl;"start"===r?r=h?"right":"left":"end"===r&&(r=h?"left":"right"),h=this.zi;var l=this.yi;la(this,a,this.Ic,!0,!1,t,e),(h||l)&&la(this,a,this.Ic,!1,!1,t,e),e=0,t=!1;var c=St.allocAt(0,0);this.Ed.sa(c);var f=St.allocAt(0,g);this.Ed.sa(f);var p=c.Ge(f);switch(St.free(c),St.free(f),8>p*(c=b.scale)*c&&(t=!0),b.Hb!==a&&(t=!1),!1===b.Ie("textGreeking")&&(t=!1),b=this.nf,p=this.pf,this.flip){case Xs:a.translate(n,0),a.scale(-1,1);break;case Ys:a.translate(0,o),a.scale(1,-1);break;case dl:a.translate(n,o),a.scale(-1,-1)}if(o>(f=(b+g+p)*(c=this.ad))&&(e=(e=this.$i).y*o-e.y*f+e.offsetY),1===c&&null!==this.ke)(p=this.ub)>n&&(p=n),this.cj(this.ke,a,0,e+b,n,g,p,t,r,h,l);else if(null!==this.Qb&&null!==this.lb)for(f=0;f<c;f++){var d=this.Qb[f];d>n&&(d=n),e+=b,this.cj(this.lb[f],a,0,e,n,g,d,t,r,h,l),e+=g+p}switch(this.flip){case Xs:a.scale(-1,1),a.translate(-n,0);break;case Ys:a.scale(1,-1),a.translate(0,-o);break;case dl:a.scale(-1,-1),a.translate(-n,-o)}}},n.cj=function(a,b,t,e,n,o,g,r,h,l,c){var f=0;r?("left"===h?f=0:"right"===h?f=n-g:"center"===h&&(f=(n-g)/2),b.fillRect(t+f,e+.25*o,g,1)):("left"===h?f=0:"right"===h?f=n:"center"===h&&(f=n/2),n=null!==Ol?Ol(this,o):.75*o,b.fillText(a,t+f,e+n),0===(a=o/20|0)&&(a=1),"right"===h?f-=g:"center"===h&&(f-=g/2),l&&(h=null!==Fl?Fl(this,o):.8*o,b.beginPath(),b.lineWidth=a,b.moveTo(t+f,e+h),b.lineTo(t+f+g,e+h),b.stroke()),c&&(b.beginPath(),b.lineWidth=a,e=e+o-o/2.2|0,0!=a%2&&(e+=.5),b.moveTo(t+f,e),b.lineTo(t+f+g,e),b.stroke()))},n.Fm=function(a,b,t,e){this.Ci=a;var n,o=this.le;if(null!==Wl&&Hl!==o&&(Hl=Wl.font=o),this.ub=this.ze=0,this.ke=this.lb=this.Qb=this.me=null,isNaN(this.desiredSize.width)){if(0===(o=this.Ub.replace(/\r\n/g,"\n").replace(/\r/g,"\n")).length)o=0;else if(this.isMultiline){for(var g=n=0,r=!1;!r;){var h=o.indexOf("\n",g);-1===h&&(h=o.length,r=!0),n=Math.max(n,Ll(o.substr(g,h-g).trim())),g=h+1}o=n}else 0<=(n=o.indexOf("\n",0))&&(o=o.substr(0,n)),o=Ll(o);o=Math.min(o,a/this.scale),o=Math.max(8,o)}else o=this.desiredSize.width;if(null!==this.panel&&(o=Math.min(o,this.panel.maxSize.width)),n=Dl(this,o),g=n=isNaN(this.desiredSize.height)?Math.min(n,b/this.scale):this.desiredSize.height,0!==this.ub&&null!==this.Qb&&null!==this.lb&&this.og===Vl&&(b=this.le,b=this.og===Vl?jl(b):0,r=this.nf+this.pf,r=Math.max(0,Al(this)+r),!((g=Math.min(this.maxLines-1,Math.max(Math.floor(g/r+.01)-1,0)))+1>=this.lb.length))){for(r=this.lb[g],b=Math.max(1,a-b);Ll(r)>b&&1<r.length;)r=r.substr(0,r.length-1);b=Ll(r+=Kl),this.lb[g]=r,this.lb=this.lb.slice(0,g+1),this.Qb[g]=b,this.Qb=this.Qb.slice(0,g+1),this.ze=this.lb.length,this.ub=Math.max(this.ub,b),this.ad=this.ze,1===this.ad&&(this.ke=this.lb[0])}(this.wrap===Il||isNaN(this.desiredSize.width))&&(o=isNaN(a)?this.ub:Math.min(a,this.ub),isNaN(this.desiredSize.width)&&(o=Math.max(8,o))),o=Math.max(t,o),n=Math.max(e,n),Zt(this.rc,o,n),ra(this,0,0,o,n)},n.Hh=function(a,b,t,e){aa(this,a,b,t,e)},v.Object.defineProperties(Sl.prototype,{font:{get:function(){return this.le},set:function(a){var b=this.le;b!==a&&(this.le=a,this.me=null,this.o(),this.g("font",b,a))}},text:{get:function(){return this.Ub},set:function(a){var b=this.Ub;b!==(a=null!=a?a.toString():"")&&(this.Ub=a,this.o(),this.g("text",b,a))}},textAlign:{get:function(){return this.Ui},set:function(a){var b=this.Ui;b===a||"start"!==a&&"end"!==a&&"left"!==a&&"right"!==a&&"center"!==a||(this.Ui=a,this.M(),this.g("textAlign",b,a))}},flip:{get:function(){return this.Qd},set:function(a){var b=this.Qd;b!==a&&(this.Qd=a,this.M(),this.g("flip",b,a))}},verticalAlignment:{get:function(){return this.$i},set:function(a){var b=this.$i;b.w(a)||(this.$i=a=a.G(),fa(this),this.g("verticalAlignment",b,a))}},naturalBounds:{get:function(){if(!this.rc.u()){var a=Ut.alloc();Cl(this,this.Ub,999999,a);var b=a.width;Ut.free(a),a=Dl(this,b);var t=this.desiredSize;isNaN(t.width)||(b=t.width),isNaN(t.height)||(a=t.height),Zt(this.rc,b,a)}return this.rc}},isMultiline:{get:function(){return this.Nj},set:function(a){var b=this.Nj;b!==a&&(this.Nj=a,this.o(),this.g("isMultiline",b,a))}},isUnderline:{get:function(){return this.zi},set:function(a){var b=this.zi;b!==a&&(this.zi=a,this.M(),this.g("isUnderline",b,a))}},isStrikethrough:{get:function(){return this.yi},set:function(a){var b=this.yi;b!==a&&(this.yi=a,this.M(),this.g("isStrikethrough",b,a))}},wrap:{get:function(){return this.Ag},set:function(a){var b=this.Ag;b!==a&&(this.Ag=a,this.o(),this.g("wrap",b,a))}},overflow:{get:function(){return this.og},set:function(a){var b=this.og;b!==a&&(this.og=a,this.o(),this.g("overflow",b,a))}},stroke:{get:function(){return this.Ic},set:function(a){var b=this.Ic;b!==a&&(null!==a&&nh(a,"TextBlock.stroke"),a instanceof qa&&a.freeze(),this.Ic=a,this.M(),this.g("stroke",b,a))}},lineCount:{get:function(){return this.ad}},editable:{get:function(){return this.Sn},set:function(a){var b=this.Sn;b!==a&&(this.Sn=a,this.g("editable",b,a))}},textEditor:{get:function(){return this.fq},set:function(a){var b=this.fq;b!==a&&(this.fq=a,this.g("textEditor",b,a))}},errorFunction:{get:function(){return this.Dc},set:function(a){var b=this.Dc;b!==a&&(this.Dc=a,this.g("errorFunction",b,a))}},interval:{get:function(){return this.Vd},set:function(a){var b=this.Vd;if(b!==(a=Math.round(a))&&0!==a&&isFinite(a)){this.Vd=a,this.o();var t=this.panel;null!==t&&(t.eh=null),this.g("interval",b,a)}}},graduatedStart:{get:function(){return this.Td},set:function(a){var b=this.Td;b!==a&&(0>a?a=0:1<a&&(a=1),this.Td=a,this.o(),this.g("graduatedStart",b,a))}},graduatedEnd:{get:function(){return this.Rd},set:function(a){var b=this.Rd;b!==a&&(0>a?a=0:1<a&&(a=1),this.Rd=a,this.o(),this.g("graduatedEnd",b,a))}},graduatedFunction:{get:function(){return this.Jj},set:function(a){var b=this.Jj;b!==a&&(this.Jj=a,this.o(),this.g("graduatedFunction",b,a))}},graduatedSkip:{get:function(){return this.Sd},set:function(a){var b=this.Sd;b!==a&&(this.Sd=a,this.o(),this.g("graduatedSkip",b,a))}},textValidation:{get:function(){return this.Vi},set:function(a){var b=this.Vi;b!==a&&(this.Vi=a,this.g("textValidation",b,a))}},textEdited:{get:function(){return this.eq},set:function(a){var b=this.eq;b!==a&&(this.eq=a,this.g("textEdited",b,a))}},spacingAbove:{get:function(){return this.nf},set:function(a){var b=this.nf;b!==a&&(this.nf=a,this.g("spacingAbove",b,a))}},spacingBelow:{get:function(){return this.pf},set:function(a){var b=this.pf;b!==a&&(this.pf=a,this.g("spacingBelow",b,a))}},maxLines:{get:function(){return this.te},set:function(a){var b=this.te;b!==a&&(0>=(a=Math.floor(a))&&T(a,"> 0",Sl,"maxLines"),this.te=a,this.g("maxLines",b,a),this.o())}},metrics:{get:function(){return{arrSize:null!==this.Qb?this.Qb:[this.ub],arrText:null!==this.lb?this.lb:[this.ke],maxLineWidth:this.ub,fontHeight:this.me}}},choices:{get:function(){return this.un},set:function(a){var b=this.un;b!==a&&(this.un=a,this.g("choices",b,a))}}});var Ol=null,Fl=null,Bl=new _(Sl,"None",0),Il=new _(Sl,"WrapFit",1),Rl=new _(Sl,"WrapDesiredSize",2),El=new _(Sl,"WrapBreakAll",3),zl=new _(Sl,"OverflowClip",0),Vl=new _(Sl,"OverflowEllipsis",1),Gl=/[ \u200b\u00ad]/,Yl=new et,Xl=0,ql=new et,Ul=0,Kl="...",Hl="",Wl=null,Jl=!1;function Zl(){this.Qb=[],this.lb=[]}function $l(){ea.call(this),this.Zg=null,this.Wp="",this.th=ai,this.xl=Bs,this.sf=this.Dc=null,this.wl=bi,this.Qd=Is,this.km=null,this.Qu=!1,this.Yr=!0,this.Nl=!1,this.dm=null}function Ql(a){void 0===a&&(a=""),""!==a?iu[a]&&(delete iu[a],eu--):(iu=new et,eu=0)}function _l(a,b){a.ls=!0,a.tl=!1;for(var t,e=Y(),n=e.length,o=0;o<n;o++){var g=e[o];t=a.getAttribute("src");var r=g.Oi.H(t);if(null!==r)for(var h=r.length,l=0;l<h;l++)t=r[l],g.Ls.add(t),g.Eb(),void 0===a.mv&&(a.mv=b,null!==t.sf&&t.sf(t,b))}}function tu(a,b){a.tl=b;for(var t,e=Y(),n=e.length,o=0;o<n;o++){var g=e[o],r=a.getAttribute("src");if(null!==(t=g.Oi.H(r))){g=t.length,r=I();for(var h=0;h<g;h++)r.push(t[h]);for(h=0;h<g;h++)null!==(t=r[h]).Dc&&t.Dc(t,b);R(r)}}}Sl.className="TextBlock",Sl.getEllipsis=function(){return Kl},Sl.setEllipsis=function(a){Kl=a,ql=new et,Ul=0},Sl.getBaseline=function(){return Ol},Sl.setBaseline=function(a){Ol=a;for(var b=(a=Y()).length,t=0;t<b;t++)a[t].Le()},Sl.getUnderline=function(){return Fl},Sl.setUnderline=function(a){Fl=a;for(var b=(a=Y()).length,t=0;t<b;t++)a[t].Le()},Sl.isValidFont=function(a){if(Jl||(Wl=hs?new Va(null).context:null,Jl=!0),null===Wl)return!0;var b=Wl.font;if(a===b||"10px sans-serif"===a)return!0;Wl.font="10px sans-serif",Wl.font=a;var t=Wl.font;if("10px sans-serif"!==t)return Wl.font=b,!0;Wl.font="19px serif";var e=Wl.font;return Wl.font=a,t=Wl.font,Wl.font=b,t!==e},Sl.None=Bl,Sl.WrapFit=Il,Sl.WrapDesiredSize=Rl,Sl.WrapBreakAll=El,Sl.OverflowClip=zl,Sl.OverflowEllipsis=Vl,Zl.prototype.reset=function(){this.Qb=[],this.lb=[]},Zl.prototype.Bt=function(a){this.Qb=O(a.Qb),this.lb=O(a.lb)},Zl.className="TextBlockMetrics",m($l,ea),$l.prototype.cloneProtected=function(a){ea.prototype.cloneProtected.call(this,a),a.element=this.Zg,a.Wp=this.Wp,a.th=this.th.G(),a.xl=this.xl,a.Qd=this.Qd,a.Dc=this.Dc,a.sf=this.sf,a.wl=this.wl.G(),a.Yr=this.Yr,a.dm=this.dm},(n=$l.prototype).jb=function(a){a===Is||a===Rs||a===Gs?this.imageStretch=a:ea.prototype.jb.call(this,a)},n.toString=function(){return"Picture("+this.source+")#"+yt(this)},n.QA=function(){if(""!==this.source){Ql(this.source);var a=this.source;this.source="",this.source=a}},n.Le=function(){this.M()},n.dj=function(a,b){var t=this.Zg;if(null!==t){var e=t.getAttribute("src");if(!(t instanceof HTMLImageElement&&(null===e||""===e)||t.tl instanceof Event&&a instanceof Ga)){e=this.naturalBounds;var n=0,o=0,g=this.Qu,r=g?+t.width:t.naturalWidth;if(g=g?+t.height:t.naturalHeight,void 0===r&&t.videoWidth&&(r=t.videoWidth),void 0===g&&t.videoHeight&&(g=t.videoHeight),r=r||e.width,g=g||e.height,0!==r&&0!==g){var h=r,l=g;this.sourceRect.u()&&(n=this.th.x,o=this.th.y,r=this.th.width,g=this.th.height);var c=r,f=g,p=this.xl,d=this.wl;switch(p){case Is:if(this.sourceRect.u())break;c>=e.width&&(n=n+d.offsetX+(c*d.x-e.width*d.x)),f>=e.height&&(o=o+d.offsetY+(f*d.y-e.height*d.y)),r=Math.min(e.width,c),g=Math.min(e.height,f);break;case Bs:c=e.width,f=e.height;break;case Rs:case Gs:p===Rs?(c*=p=Math.min(e.height/f,e.width/c),f*=p):p===Gs&&(f*=p=Math.max(e.height/f,e.width/c),(c*=p)>=e.width&&(n=(n+d.offsetX+(c*d.x-e.width*d.x)/c)*r),f>=e.height&&(o=(o+d.offsetY+(f*d.y-e.height*d.y)/f)*g),r*=1/(c/e.width),g*=1/(f/e.height),c=e.width,f=e.height)}var q=c*(p=this.Cf()*b.scale)*f*p,u=r*g/q,y=t.__goCache;p=null;var m=nu;if(t.ls&&void 0!==y&&4<q&&u>m*m)for(null===y.bj&&(ru(y,4,h,l,t),ru(y,16,h,l,t)),l=(h=y.bj).length,q=0;q<l&&h[q].ratio*h[q].ratio<u;q++)p=h[q];if(!b.pl){if(null===this.km)if(null===this.Zg)this.km=!1;else{(h=new Va(null).context).drawImage(this.Zg,0,0);try{h.getImageData(0,0,1,1).data[3]&&(this.km=!1),this.km=!1}catch(t){this.km=!0}}if(this.km)return}switch(h=0,c<e.width&&(h=d.offsetX+(e.width*d.x-c*d.x)),l=0,f<e.height&&(l=d.offsetY+(e.height*d.y-f*d.y)),this.flip){case Xs:a.translate(Math.min(e.width,c),0),a.scale(-1,1);break;case Ys:a.translate(0,Math.min(e.height,f)),a.scale(1,-1);break;case dl:a.translate(Math.min(e.width,c),Math.min(e.height,f)),a.scale(-1,-1)}if(b.Ie("pictureRatioOptimization")&&!b.wi&&void 0!==y&&null!==p&&1!==p.ratio){a.save(),b=p.ratio;try{a.drawImage(p.source,n/b,o/b,Math.min(p.source.width,r/b),Math.min(p.source.height,g/b),h,l,Math.min(e.width,c),Math.min(e.height,f))}catch(t){this.Yr=!1}a.restore()}else try{a.drawImage(t,n,o,r,g,h,l,Math.min(e.width,c),Math.min(e.height,f))}catch(t){this.Yr=!1}switch(this.flip){case Xs:a.scale(-1,1),a.translate(-Math.min(e.width,c),0);break;case Ys:a.scale(1,-1),a.translate(0,-Math.min(e.height,f));break;case dl:a.scale(-1,-1),a.translate(-Math.min(e.width,c),-Math.min(e.height,f))}}}}},n.Fm=function(a,b,t,e){var n=this.desiredSize,o=da(this,!0),g=this.Zg,r=this.Qu;(r||!this.Nl&&g&&g.complete)&&(this.Nl=!0),null===g&&(isFinite(n.width)||(a=0),isFinite(n.height)||(b=0)),isFinite(n.width)||o===Bs||o===zs?(isFinite(a)||(a=this.sourceRect.u()?this.sourceRect.width:r?+g.width:g.naturalWidth),t=0):null!==g&&!1!==this.Nl&&(a=this.sourceRect.u()?this.sourceRect.width:r?+g.width:g.naturalWidth),isFinite(n.height)||o===Bs||o===Vs?(isFinite(b)||(b=this.sourceRect.u()?this.sourceRect.height:r?+g.height:g.naturalHeight),e=0):null!==g&&!1!==this.Nl&&(b=this.sourceRect.u()?this.sourceRect.height:r?+g.height:g.naturalHeight),isFinite(n.width)&&(a=n.width),isFinite(n.height)&&(b=n.height),n=this.maxSize,o=this.minSize,t=Math.max(t,o.width),e=Math.max(e,o.height),a=Math.min(n.width,a),b=Math.min(n.height,b),a=Math.max(t,a),b=Math.max(e,b),null===g||g.complete||(isFinite(a)||(a=0),isFinite(b)||(b=0)),Zt(this.rc,a,b),ra(this,0,0,a,b)},n.Hh=function(a,b,t,e){aa(this,a,b,t,e)},v.Object.defineProperties($l.prototype,{element:{get:function(){return this.Zg},set:function(a){var b=this.Zg;if(b!==a){if(null===a||a instanceof HTMLImageElement||a instanceof HTMLVideoElement||a instanceof HTMLCanvasElement||N("Picture.element must be an instance of Image, Canvas, or Video, not: "+a),this.Qu=a instanceof HTMLCanvasElement,this.Zg=a,null!==a)if(a instanceof HTMLCanvasElement||!0===a.complete)a.tl instanceof Event&&null!==this.Dc&&this.Dc(this,a.tl),!0===a.ls&&null!==this.sf&&this.sf(this,a.mv),a.ls=!0,this.desiredSize.u()||(ka(this,!1),this.o());else{var t=this;a.yx||(a.addEventListener("load",(function(b){_l(a,b),t.desiredSize.u()||(ka(t,!1),t.o())})),a.addEventListener("error",(function(b){tu(a,b)})),a.yx=!0)}this.g("element",b,a),this.M()}}},source:{get:function(){return this.Wp},set:function(a){var b=this.Wp;if(b!==a){this.Wp=a;var t=iu,e=this.diagram;if(hs){var n=null;if(void 0!==t[a])n=t[a];else if(""!==a){30<eu&&(Ql(),t=iu),n=P("img");var o=this;n.addEventListener("load",(function(a){_l(n,a),o.desiredSize.u()||(ka(o,!1),o.o())})),n.addEventListener("error",(function(a){tu(n,a)})),n.yx=!0;var g=this.dm;null!==g&&(n.crossOrigin=g(this)),n.src=a,t[a]=n,eu++}null!==e&&Yr(e,this),this.element=n,null!==e&&null!==n&&Gr(e,this),null!==n&&void 0===n.__goCache&&(n.__goCache=new ou),this.o(),this.M()}this.g("source",b,a)}}},sourceCrossOrigin:{get:function(){return this.dm},set:function(a){if(this.dm!==a&&(this.dm=a,null!==this.element)){var b=this.element.getAttribute("src");null===a&&"string"==typeof b?this.element.crossOrigin=null:null!==a&&(this.element.crossOrigin=a(this)),this.element.src=b}}},sourceRect:{get:function(){return this.th},set:function(a){var b=this.th;b.w(a)||(this.th=a=a.G(),this.M(),this.g("sourceRect",b,a))}},imageStretch:{get:function(){return this.xl},set:function(a){var b=this.xl;b!==a&&(this.xl=a,this.M(),this.g("imageStretch",b,a))}},flip:{get:function(){return this.Qd},set:function(a){var b=this.Qd;b!==a&&(this.Qd=a,this.M(),this.g("flip",b,a))}},imageAlignment:{get:function(){return this.wl},set:function(a){var b=this.wl;b.w(a)||(this.wl=a=a.G(),this.o(),this.g("imageAlignment",b,a))}},errorFunction:{get:function(){return this.Dc},set:function(a){var b=this.Dc;b!==a&&(this.Dc=a,this.g("errorFunction",b,a))}},successFunction:{get:function(){return this.sf},set:function(a){var b=this.sf;b!==a&&(this.sf=a,this.g("successFunction",b,a))}},naturalBounds:{get:function(){return this.rc}}}),$l.prototype.redraw=$l.prototype.Le,$l.prototype.reloadSource=$l.prototype.QA;var iu=null,eu=0,nu=4;function ou(){this.bj=null}function ru(a,b,t,e,n){null===a.bj&&(a.bj=[]);var o=new Va(null),g=o.context,r=1/b;o.width=t/b,o.height=e/b,0!==o.width&&0!==o.height&&(b=new su(o.Ga,b),t=1,0<a.bj.length&&(n=(t=a.bj[a.bj.length-1]).source,t=t.ratio),g.setTransform(r*t,0,0,r*t,0,0),g.drawImage(n,0,0),a.bj.push(b))}function su(a,b){this.source=a,this.ratio=b}function au(){this.Jt=new td,this.ic=null}function hu(a,b,t,e,n){a.ic=new be,a.ic.startX=b,a.ic.startY=t,a.ic.isFilled=e,a.Jt.figures.add(a.ic),void 0!==n&&(a.ic.isShadowed=n)}function lu(a){var b=a.ic.segments.length;0<b&&a.ic.segments.J(b-1).close()}function uu(a,b,t,e,n,o,g){var r;void 0===r&&(r=!1);var h=new we(Ne);h.point1X=b,h.point1Y=t,h.point2X=e,h.point2Y=n,h.endX=o,h.endY=g,r&&h.close(),a.ic.segments.add(h)}function cu(a,b,t,e,n){var o;void 0===o&&(o=!1);var g=new we(Ce);g.point1X=b,g.point1Y=t,g.endX=e,g.endY=n,o&&g.close(),a.ic.segments.add(g)}function fu(a,b,t,e,n,o,g,r){var h;void 0===h&&(h=!1),b=new we(Le,g,r,b,t,e,n,o),h&&b.close(),a.ic.segments.add(b)}function du(a){var b=pu;return null!==b?(pu=null,b.reset(a),b):((b=new au).reset(a),b)}$l.className="Picture",iu=new et,$l.clearCache=Ql,ou.className="PictureCacheArray",su.className="PictureCacheInstance",(n=au.prototype).reset=function(a){null!==a?(a.ea(),this.Jt=a,a.figures.clear()):this.Jt=new td,this.ic=null},n.er=function(a){this.ic.isShadowed=a},n.moveTo=function(a,b,t){void 0===t&&(t=!1);var e=new we(Se);e.endX=a,e.endY=b,t&&e.close(),this.ic.segments.add(e)},n.lineTo=function(a,b,t){void 0===t&&(t=!1);var e=new we(Pe);e.endX=a,e.endY=b,t&&e.close(),this.ic.segments.add(e)},n.arcTo=function(a,b,t,e,n,o,g){void 0===o&&(o=0),void 0===g&&(g=!1);var r=new we(Te);r.startAngle=a,r.sweepAngle=b,r.centerX=t,r.centerY=e,r.radiusX=n,r.radiusY=0!==o?o:n,g&&r.close(),this.ic.segments.add(r)};var pu=null;function gu(a,b){var t=a.toLowerCase(),e=oe.Qe;e[a]=b,e[t]=a}function yu(a){Fh.call(this,a),this.D=2408959,this.ih=this.Pf="",this.Ap=this.wp=this.Lp=this.Bo=null,this.Np="",this.Nf=this.no=this.Mp=this.sh=null,this.yp="",this.xp=Xt,this.Ub=this.Bp="",this.Di=this.xn=this.li=null,this.fg=new St(NaN,NaN).freeze(),this.Io="",this.df=null,this.Jo=yi,this.Cp=Vi,this.So=Ot,this.Ko=Ft,this.Pn=null,this.Co=127,this.Rp=Bt,this.Qp="gray",this.lf=4,this.Ax=-1,this.pq=NaN,this.gz=new Jt,this.Vj=null,this.kh=NaN}function mu(a){0!=(16384&a.D)!=!1&&(a.updateAdornments(),a.D&=-16385)}function vu(a){if(!1===Cu(a)){Tu(a,!0),a.El();var b=a.diagram;null!==b&&(b.vd.add(a),b.Eb())}}function xu(a){if(a.D|=2097152,!1!==Cu(a)){var b=a.position,t=a.location;t.u()&&b.u()||ku(a,b,t),t=a.yb;var e=Jt.alloc().assign(t);t.ea(),t.x=b.x,t.y=b.y,t.freeze(),a.Gm(e,t),Jt.free(e),Tu(a,!1)}}function bu(a,b){var t=a.gz;isNaN(a.kh)&&(a.kh=Uh(a));var e=a.kh,n=2*e;if(!a.isShadowed)return t.h(b.x-1-e,b.y-1-e,b.width+2+n,b.height+2+n),t;e=b.x,n=b.y;var o=b.width;b=b.height;var g=a.shadowBlur;return o+=g,b+=g,e-=g/2,n-=g/2,0<(a=a.shadowOffset).x?o+=a.x:(e+=a.x,o-=a.x),0<a.y?b+=a.y:(n+=a.y,b-=a.y),t.h(e-1,n-1,o+2,b+2),t}function wu(a,b,t,e){null===b||a instanceof Eu||(b=b.animationManager).ff&&mo(b,a,e.copy(),t.copy())}function ku(a,b,t){var e=St.alloc(),n=a.locationSpot,o=a.locationObject;n.nc()&&N("determineOffset: Part's locationSpot must be real: "+n.toString());var g=o.naturalBounds,r=o instanceof pl?o.strokeWidth:0;if(e.Qk(0,0,g.width+r,g.height+r,n),o!==a)for(e.offset(-r/2,-r/2),o.transform.sa(e),n=o.panel;null!==n&&n!==a;)n.transform.sa(e),n=n.panel;a.eg.sa(e),e.offset(-a.qc.x,-a.qc.y),n=a.diagram,o=t.u(),g=b.u(),o&&g?0!=(2097152&a.D)?Mu(a,b,t,n,e):Su(a,b,t,n,e):o?Mu(a,b,t,n,e):g&&Su(a,b,t,n,e),a.D|=2097152,St.free(e),a.El()}function Mu(a,b,t,e,n){var o=b.x,g=b.y;b.h(t.x-n.x,t.y-n.y),null!==e&&((e=(t=e.animationManager).isAnimating)||!t.ff||a instanceof Eu||mo(t,a,new St(o,g),b),e||b.x===o&&b.y===g||a.g("position",new St(o,g),b.copy()))}function Su(a,b,t,e,n){var o=t.copy();t.h(b.x+n.x,b.y+n.y),t.w(o)||null===e||a.g("location",o,t.copy())}function Pu(a,b,t){Lu(a,!1),a instanceof zu&&ts(t,a),a.layer.isTemporary||b||t.Oa(),b=a.yb;var e=t.viewportBounds;e.u()?Au(a)?(ei(b,e)||a.Ld(!1),a.updateAdornments()):b.Nc(e)?(a.Ld(!0),a.updateAdornments()):a.Mb():t.vi=!0}function Nu(a,b,t,e){b.constructor===a.constructor||Ru||(Ru=!0,L('Should not change the class of the Part when changing category from "'+t+'" to "'+e+'"'),L("  Old class: "+E(a.constructor)+", new class: "+E(b.constructor)+", part: "+a.toString())),a.lk();var n=a.data;t=a.layerName;var o=a.isSelected,g=a.isHighlighted,r=!0,h=!0,l=!1;a instanceof zu&&(r=a.isTreeLeaf,h=a.isTreeExpanded,l=a.wasTreeExpanded),b.Af(a),b.cloneProtected(a),a.Pf=e,a.o(),a.M(),e=!0,null!==(b=a.diagram)&&(e=b.skipsUndoManager,b.skipsUndoManager=!0),a.nb=n,a.D=o?4096|a.D:-4097&a.D,a.D=g?524288|a.D:-524289&a.D,a instanceof zu&&(a.P=r?4|a.P:-5&a.P,a.P=h?1|a.P:-2&a.P,a.P=l?2|a.P:-3&a.P),null!==n&&a.Ca(),(n=a.layerName)!==t&&(a.ih=t,a.layerName=n),null!==b&&(b.skipsUndoManager=e),a.Oc()&&a.C(64)}function Cu(a){return 0!=(32768&a.D)}function Tu(a,b){a.D=b?32768|a.D:-32769&a.D}function Lu(a,b){a.D=b?65536|a.D:-65537&a.D}function Au(a){return 0!=(131072&a.D)}function ju(a,b){a.D=b?1048576|a.D:-1048577&a.D}function Du(a,b){var t=b.containingGroup;return null!==t?1+Du(a,t):b instanceof zu&&null!==(b=b.labeledLink)?Du(a,b):0}function Ou(a,b){var t=b.containingGroup;return null!==t||b instanceof zu&&null!==(t=b.labeledLink)?Ou(a,t):b}function Fu(a,b,t){if(b===t||null===t)return!1;var e=b.containingGroup;return!(null===e||e!==t&&!Fu(a,e,t))||b instanceof zu&&null!==(b=b.labeledLink)&&Fu(a,b,t)}function Bu(a){return!!a.isVisible()&&(null===(a=a.layer)||!a.isTemporary)}function Iu(a,b,t,e,n,o){if(void 0===o&&(o=null),!(a.contains(b)||null!==o&&!o(b)||b instanceof Eu))if(a.add(b),b instanceof zu){if(t&&b instanceof oc)for(var g=b.memberParts;g.next();)Iu(a,g.value,t,e,n,o);if(!1!==n)for(g=b.linksConnected;g.next();){var r=g.value;if(!a.contains(r)){var h=r.fromNode,l=r.toNode;h=null===h||a.contains(h),l=null===l||a.contains(l),(n?h&&l:h||l)&&Iu(a,r,t,e,n,o)}}if(1<e)for(b=b.Uv();b.next();)Iu(a,b.value,t,e-1,n,o)}else if(b instanceof uc)for(b=b.labelNodes;b.next();)Iu(a,b.value,t,e,n,o)}au.className="StreamGeometryContext",gu("Rectangle",(function(a,b,t){a="r"+b+","+t;var e=oe.Th[a];return void 0!==e||((e=new td(ye)).endX=b,e.endY=t,50>oe.Uh&&(oe.Th[a]=e,oe.Uh++)),e})),gu("Square",(function(a,b,t){a="s"+b+","+t;var e=oe.Th[a];return void 0!==e||((e=new td(ye)).endX=b,e.endY=t,e.defaultStretch=Rs,50>oe.Uh&&(oe.Th[a]=e,oe.Uh++)),e})),gu("RoundedRectangle",(function(a,b,t){var e=a?a.parameter1:NaN;return(isNaN(e)||0>e)&&(e=5),e=Math.min(e,b/3),a=(e=Math.min(e,t/3))*oe.Lg,b=(new td).add(new be(e,0,!0).add(new we(Pe,b-e,0)).add(new we(Ne,b,e,b-a,0,b,a)).add(new we(Pe,b,t-e)).add(new we(Ne,b-e,t,b,t-a,b-a,t)).add(new we(Pe,e,t)).add(new we(Ne,0,t-e,a,t,0,t-a)).add(new we(Pe,0,e)).add(new we(Ne,e,0,0,a,a,0).close())),1<a&&(b.spot1=new $i(0,0,a,a),b.spot2=new $i(1,1,-a,-a)),b})),gu("Border","RoundedRectangle"),gu("Ellipse",(function(a,b,t){a="e"+b+","+t;var e=oe.Th[a];return void 0!==e||((e=new td(me)).endX=b,e.endY=t,e.spot1=Wi,e.spot2=Ji,50>oe.Uh&&(oe.Th[a]=e,oe.Uh++)),e})),gu("Circle",(function(a,b,t){a="c"+b+","+t;var e=oe.Th[a];return void 0!==e||((e=new td(me)).endX=b,e.endY=t,e.spot1=Wi,e.spot2=Ji,e.defaultStretch=Rs,50>oe.Uh&&(oe.Th[a]=e,oe.Uh++)),e})),gu("TriangleRight",(function(a,b,t){return(new td).add(new be(0,0).add(new we(Pe,b,.5*t)).add(new we(Pe,0,t).close())).Wm(0,.25,.5,.75)})),gu("TriangleDown",(function(a,b,t){return(new td).add(new be(0,0).add(new we(Pe,b,0)).add(new we(Pe,.5*b,t).close())).Wm(.25,0,.75,.5)})),gu("TriangleLeft",(function(a,b,t){return(new td).add(new be(b,t).add(new we(Pe,0,.5*t)).add(new we(Pe,b,0).close())).Wm(.5,.25,1,.75)})),gu("TriangleUp",(function(a,b,t){return(new td).add(new be(b,t).add(new we(Pe,0,t)).add(new we(Pe,.5*b,0).close())).Wm(.25,.5,.75,1)})),gu("Triangle","TriangleUp"),gu("Diamond",(function(a,b,t){return(new td).add(new be(.5*b,0).add(new we(Pe,0,.5*t)).add(new we(Pe,.5*b,t)).add(new we(Pe,b,.5*t).close())).Wm(.25,.25,.75,.75)})),gu("LineH",(function(a,b,t){return(a=new td(ge)).startX=0,a.startY=t/2,a.endX=b,a.endY=t/2,a})),gu("LineV",(function(a,b,t){return(a=new td(ge)).startX=b/2,a.startY=0,a.endX=b/2,a.endY=t,a})),gu("None","Rectangle"),gu("BarH","Rectangle"),gu("BarV","Rectangle"),gu("MinusLine","LineH"),gu("PlusLine",(function(a,b,t){return(new td).add(new be(0,t/2,!1).add(new we(Pe,b,t/2)).add(new we(Se,b/2,0)).add(new we(Pe,b/2,t)))})),gu("XLine",(function(a,b,t){return(new td).add(new be(0,t,!1).add(new we(Pe,b,0)).add(new we(Se,0,0)).add(new we(Pe,b,t)))})),oe.an={"":"",Standard:"F1 m 0,0 l 8,4 -8,4 2,-4 z",Backward:"F1 m 8,0 l -2,4 2,4 -8,-4 z",Triangle:"F1 m 0,0 l 8,4.62 -8,4.62 z",BackwardTriangle:"F1 m 8,4 l 0,4 -8,-4 8,-4 0,4 z",Boomerang:"F1 m 0,0 l 8,4 -8,4 4,-4 -4,-4 z",BackwardBoomerang:"F1 m 8,0 l -8,4 8,4 -4,-4 4,-4 z",SidewaysV:"m 0,0 l 8,4 -8,4 0,-1 6,-3 -6,-3 0,-1 z",BackwardV:"m 8,0 l -8,4 8,4 0,-1 -6,-3 6,-3 0,-1 z",OpenTriangle:"m 0,0 l 8,4 -8,4",BackwardOpenTriangle:"m 8,0 l -8,4 8,4",OpenTriangleLine:"m 0,0 l 8,4 -8,4 m 8.5,0 l 0,-8",BackwardOpenTriangleLine:"m 8,0 l  -8,4 8,4 m -8.5,0 l 0,-8",OpenTriangleTop:"m 0,0 l 8,4 m 0,4",BackwardOpenTriangleTop:"m 8,0 l -8,4 m 0,4",OpenTriangleBottom:"m 0,8 l 8,-4",BackwardOpenTriangleBottom:"m 0,4 l 8,4",HalfTriangleTop:"F1 m 0,0 l 0,4 8,0 z m 0,8",BackwardHalfTriangleTop:"F1 m 8,0 l 0,4 -8,0 z m 0,8",HalfTriangleBottom:"F1 m 0,4 l 0,4 8,-4 z",BackwardHalfTriangleBottom:"F1 m 8,4 l 0,4 -8,-4 z",ForwardSemiCircle:"m 4,0 b 270 180 0 4 4",BackwardSemiCircle:"m 4,8 b 90 180 0 -4 4",Feather:"m 0,0 l 3,4 -3,4",BackwardFeather:"m 3,0 l -3,4 3,4",DoubleFeathers:"m 0,0 l 3,4 -3,4 m 3,-8 l 3,4 -3,4",BackwardDoubleFeathers:"m 3,0 l -3,4 3,4 m 3,-8 l -3,4 3,4",TripleFeathers:"m 0,0 l 3,4 -3,4 m 3,-8 l 3,4 -3,4 m 3,-8 l 3,4 -3,4",BackwardTripleFeathers:"m 3,0 l -3,4 3,4 m 3,-8 l -3,4 3,4 m 3,-8 l -3,4 3,4",ForwardSlash:"m 0,8 l 5,-8",BackSlash:"m 0,0 l 5,8",DoubleForwardSlash:"m 0,8 l 4,-8 m -2,8 l 4,-8",DoubleBackSlash:"m 0,0 l 4,8 m -2,-8 l 4,8",TripleForwardSlash:"m 0,8 l 4,-8 m -2,8 l 4,-8 m -2,8 l 4,-8",TripleBackSlash:"m 0,0 l 4,8 m -2,-8 l 4,8 m -2,-8 l 4,8",Fork:"m 0,4 l 8,0 m -8,0 l 8,-4 m -8,4 l 8,4",BackwardFork:"m 8,4 l -8,0 m 8,0 l -8,-4 m 8,4 l -8,4",LineFork:"m 0,0 l 0,8 m 0,-4 l 8,0 m -8,0 l 8,-4 m -8,4 l 8,4",BackwardLineFork:"m 8,4 l -8,0 m 8,0 l -8,-4 m 8,4 l -8,4 m 8,-8 l 0,8",CircleFork:"F1 m 6,4 b 0 360 -3 0 3 z m 0,0 l 6,0 m -6,0 l 6,-4 m -6,4 l 6,4",BackwardCircleFork:"F1 m 0,4 l 6,0 m -6,-4 l 6,4 m -6,4 l 6,-4 m 6,0 b 0 360 -3 0 3",CircleLineFork:"F1 m 6,4 b 0 360 -3 0 3 z m 1,-4 l 0,8 m 0,-4 l 6,0 m -6,0 l 6,-4 m -6,4 l 6,4",BackwardCircleLineFork:"F1 m 0,4 l 6,0 m -6,-4 l 6,4 m -6,4 l 6,-4 m 0,-4 l 0,8 m 7,-4 b 0 360 -3 0 3",Circle:"F1 m 8,4 b 0 360 -4 0 4 z",Block:"F1 m 0,0 l 0,8 8,0 0,-8 z",StretchedDiamond:"F1 m 0,3 l 5,-3 5,3 -5,3 -5,-3 z",Diamond:"F1 m 0,4 l 4,-4 4,4 -4,4 -4,-4 z",Chevron:"F1 m 0,0 l 5,0 3,4 -3,4 -5,0 3,-4 -3,-4 z",StretchedChevron:"F1 m 0,0 l 8,0 3,4 -3,4 -8,0 3,-4 -3,-4 z",NormalArrow:"F1 m 0,2 l 4,0 0,-2 4,4 -4,4 0,-2 -4,0 z",X:"m 0,0 l 8,8 m 0,-8 l -8,8",TailedNormalArrow:"F1 m 0,0 l 2,0 1,2 3,0 0,-2 2,4 -2,4 0,-2 -3,0 -1,2 -2,0 1,-4 -1,-4 z",DoubleTriangle:"F1 m 0,0 l 4,4 -4,4 0,-8 z  m 4,0 l 4,4 -4,4 0,-8 z",BigEndArrow:"F1 m 0,0 l 5,2 0,-2 3,4 -3,4 0,-2 -5,2 0,-8 z",ConcaveTailArrow:"F1 m 0,2 h 4 v -2 l 4,4 -4,4 v -2 h -4 l 2,-2 -2,-2 z",RoundedTriangle:"F1 m 0,1 a 1,1 0 0 1 1,-1 l 7,3 a 0.5,1 0 0 1 0,2 l -7,3 a 1,1 0 0 1 -1,-1 l 0,-6 z",SimpleArrow:"F1 m 1,2 l -1,-2 2,0 1,2 -1,2 -2,0 1,-2 5,0 0,-2 2,2 -2,2 0,-2 z",AccelerationArrow:"F1 m 0,0 l 0,8 0.2,0 0,-8 -0.2,0 z m 2,0 l 0,8 1,0 0,-8 -1,0 z m 3,0 l 2,0 2,4 -2,4 -2,0 0,-8 z",BoxArrow:"F1 m 0,0 l 4,0 0,2 2,0 0,-2 2,4 -2,4 0,-2 -2,0 0,2 -4,0 0,-8 z",TriangleLine:"F1 m 8,4 l -8,-4 0,8 8,-4 z m 0.5,4 l 0,-8",CircleEndedArrow:"F1 m 10,4 l -2,-3 0,2 -2,0 0,2 2,0 0,2 2,-3 z m -4,0 b 0 360 -3 0 3 z",DynamicWidthArrow:"F1 m 0,3 l 2,0 2,-1 2,-2 2,4 -2,4 -2,-2 -2,-1 -2,0 0,-2 z",EquilibriumArrow:"m 0,3 l 8,0 -3,-3 m 3,5 l -8,0 3,3",FastForward:"F1 m 0,0 l 3.5,4 0,-4 3.5,4 0,-4 1,0 0,8 -1,0 0,-4 -3.5,4 0,-4 -3.5,4 0,-8 z",Kite:"F1 m 0,4 l 2,-4 6,4 -6,4 -2,-4 z",HalfArrowTop:"F1 m 0,0 l 4,4 4,0 -8,-4 z m 0,8",HalfArrowBottom:"F1 m 0,8 l 4,-4 4,0 -8,4 z",OpposingDirectionDoubleArrow:"F1 m 0,4 l 2,-4 0,2 4,0 0,-2 2,4 -2,4 0,-2 -4,0 0,2 -2,-4 z",PartialDoubleTriangle:"F1 m 0,0 4,3 0,-3 4,4 -4,4 0,-3 -4,3 0,-8 z",LineCircle:"F1 m 0,0 l 0,8 m 7 -4 b 0 360 -3 0 3 z",DoubleLineCircle:"F1 m 0,0 l 0,8 m 2,-8 l 0,8 m 7 -4 b 0 360 -3 0 3 z",TripleLineCircle:"F1 m 0,0 l 0,8 m 2,-8 l 0,8 m 2,-8 l 0,8 m 7 -4 b 0 360 -3 0 3 z",CircleLine:"F1 m 6 4 b 0 360 -3 0 3 z m 1,-4 l 0,8",DiamondCircle:"F1 m 8,4 l -4,4 -4,-4 4,-4 4,4 m 8,0 b 0 360 -4 0 4 z",PlusCircle:"F1 m 8,4 b 0 360 -4 0 4 l -8 0 z m -4 -4 l 0 8",OpenRightTriangleTop:"m 8,0 l 0,4 -8,0 m 0,4",OpenRightTriangleBottom:"m 8,8 l 0,-4 -8,0",Line:"m 0,0 l 0,8",DoubleLine:"m 0,0 l 0,8 m 2,0 l 0,-8",TripleLine:"m 0,0 l 0,8 m 2,0 l 0,-8 m 2,0 l 0,8",PentagonArrow:"F1 m 8,4 l -4,-4 -4,0 0,8 4,0 4,-4 z"},m(yu,Fh),yu.prototype.cloneProtected=function(a){Fh.prototype.cloneProtected.call(this,a),a.D=-4097&this.D|49152,a.Pf=this.Pf,a.ih=this.ih,a.Bo=this.Bo,a.Lp=this.Lp,a.wp=this.wp,a.Ap=this.Ap,a.Np=this.Np,a.Mp=this.Mp,a.no=this.no,a.Nf=null,a.yp=this.yp,a.xp=this.xp.G(),a.Bp=this.Bp,a.Cp=this.Cp.G(),a.Ub=this.Ub,a.xn=this.xn,a.fg.assign(this.fg),a.Io=this.Io,a.Jo=this.Jo.G(),a.So=this.So.G(),a.Ko=this.Ko.G(),a.Pn=this.Pn,a.Co=this.Co,a.Rp=this.Rp.G(),a.Qp=this.Qp,a.lf=this.lf,a.pq=this.pq},yu.prototype.Af=function(a){Fh.prototype.Af.call(this,a),a.Nh(),a.sh=null,a.df=null,a.Vj=null},yu.prototype.toString=function(){var a=E(this.constructor)+"#"+yt(this);return null!==this.data&&(a+="("+z(this.data)+")"),a},yu.prototype.Ok=function(a,b,t,e,n,o,g){var r=this.diagram;null!==r&&(a===Be&&"elements"===b?n instanceof Fh?Vh(n,(function(a){rd(r.partManager,a),Vr(r,a)})):Gr(r,n):a===Ie&&"elements"===b&&(n instanceof Fh?Vh(n,(function(a){sd(r.partManager,a,r)})):Yr(r,n)),r.bb(a,b,t,e,n,o,g))},yu.prototype.Ca=function(a){if(Fh.prototype.Ca.call(this,a),null!==this.data){for(var b=this.W.j,t=b.length,e=0;e<t;e++){var n=b[e];n instanceof Fh&&Vh(n,(function(a){null!==a.data&&a.Ca()}))}for(b=this.adornments;b.next();)b.value.Ca(a)}},yu.prototype.updateRelationshipsFromData=function(){null!==this.data&&this.diagram.partManager.updateRelationshipsFromData(this)},yu.prototype.uk=function(a){var b=this.Nf;return null===b?null:b.H(a)},yu.prototype.Fh=function(a,b){if(null!==b){var t=null,e=this.Nf;if(null!==e&&(t=e.H(a)),t!==b){if(null!==t){var n=t.diagram;null!==n&&n.remove(t)}null===e&&(this.Nf=e=new Mt),b.Pf!==a&&(b.category=a),e.add(a,b),null!==(a=this.diagram)&&(a.add(b),null!==(a=b.adornedObject)&&(null!==(a=a.hj())&&(b.data=a.data)))}}},yu.prototype.Jf=function(a){var b=this.Nf;if(null!==b){var t=b.H(a);if(null!==t){var e=t.diagram;null!==e&&e.remove(t)}b.remove(a),0===b.count&&(this.Nf=null)}},yu.prototype.lk=function(){var a=this.Nf;if(null!==a){var b=I();for(a=a.iterator;a.next();)b.push(a.key);a=b.length;for(var t=0;t<a;t++)this.Jf(b[t]);R(b)}},yu.prototype.updateAdornments=function(){var a=this.diagram;if(null!==a){for(var b=this.adornments;b.next();){var t=b.value;t.o(),t.placeholder&&t.placeholder.o()}t:{if(this.isSelected&&this.selectionAdorned&&(null!==(b=this.selectionObject)&&this.actualBounds.u()&&this.isVisible()&&b.If()&&b.actualBounds.u())){if(null===(t=this.uk("Selection"))){if(null===(t=this.selectionAdornmentTemplate)&&(t=this.Oh()?a.linkSelectionAdornmentTemplate:this instanceof oc?a.groupSelectionAdornmentTemplate:a.nodeSelectionAdornmentTemplate),!(t instanceof Eu))break t;$h(t),null!==(t=t.copy())&&(this.Oh()&&this.selectionObject===this.path&&(t.type=Fh.Link),t.adornedObject=b)}if(null!==t){t.type===Fh.Link&&t.o(),this.Fh("Selection",t);break t}}this.Jf("Selection")}for(function(a,b){b.toolManager.mouseDownTools.each((function(b){b.isEnabled&&b.updateAdornments(a)})),b.toolManager.updateAdornments(a)}(this,a),b=this.adornments;b.next();)b.value.Ca()}},yu.prototype.Mb=function(){var a=this.diagram;null!==a&&(Sr(a),0!=(16384&this.D)!=!0&&(this.D|=16384,a.Eb()))},yu.prototype.move=function(a,b){!0===b?this.location=a:this.position=a},yu.prototype.moveTo=function(a,b,t){a=St.allocAt(a,b),this.move(a,t),St.free(a)},yu.prototype.isVisible=function(){if(!this.visible)return!1;var a=this.layer;if(null!==a){if(!a.visible)return!1;if(null!==(a=a.diagram)&&a.animationManager.au(this))return!0}return!!(null===(a=this.containingGroup)||a.isSubGraphExpanded&&a.isVisible())},(n=yu.prototype).Pb=function(a){var b=this.diagram;a?(this.C(4),this.Mb(),null!==b&&b.vd.add(this)):(this.C(8),this.lk()),this.Nh(),null!==b&&(b.Oa(),b.M())},n.ab=function(a){if(this.name===a)return this;var b=this.Vj;if(null===b&&(this.Vj=b=new Mt),null!==b.H(a))return b.H(a);var t=Fh.prototype.ab.call(this,a);return null!==t?(b.set(a,t),t):(b.set(a,null),null)},n.Ff=function(a,b,t){void 0===t&&(t=new St),b=b.nc()?bi:b;var e=a.naturalBounds;if(t.h(e.width*b.x+b.offsetX,e.height*b.y+b.offsetY),null===a||a===this)return t;for(a.transform.sa(t),a=a.panel;null!==a&&a!==this;)a.transform.sa(t),a=a.panel;return this.eg.sa(t),t.offset(-this.qc.x,-this.qc.y),t},n.lj=function(a){return void 0===a&&(a=new Jt),a.assign(this.actualBounds)},n.Ta=function(){!0===wa(this)&&this.measure(1/0,1/0),this.arrange()},yu.prototype.arrange=function(){if(!1===Ma(this))xu(this);else{ol(this,!1);var a=this.yb,b=Jt.alloc();b.assign(a);var t=Au(this);this.Hh(0,0,this.qc.width,this.qc.height);var e=this.position;ku(this,e,this.location),a.ea(),a.x=e.x,a.y=e.y,a.freeze(),this.Gm(b,a),b.w(a)?this.Ld(t):!this.Oc()||oe.A(b.width,a.width)&&oe.A(b.height,a.height)||0<=this.Ax&&this.C(16),Jt.free(b),Tu(this,!1)}},(n=yu.prototype).Gm=function(a,b){var t=this.diagram;if(null!==t){var e=!1;if(!1===t.ti&&a.u()){var n=Jt.alloc();n.assign(t.documentBounds),n.Jw(t.padding),a.x>n.x&&a.y>n.y&&a.right<n.right&&a.bottom<n.bottom&&b.x>n.x&&b.y>n.y&&b.right<n.right&&b.bottom<n.bottom&&(e=!0),Jt.free(n)}0!=(65536&this.D)!=!0&&a.w(b)||Pu(this,e,t),t.M(),_t(a,b)||(this instanceof zu&&!t.undoManager.isUndoingRedoing&&this.td(),this.Nh())}},n.Ew=function(a,b){if(this.Oh()||!a.u())return!1;var t=this.diagram;null!==t&&wu(this,t,a,b),this.la=a,this.D&=-2097153;var e=this.fg;return!e.u()||null!==t&&!t.animationManager.isTicking&&t.undoManager.isUndoingRedoing||(t=e.copy(),e.h(e.x+(a.x-b.x),e.y+(a.y-b.y)),this.g("location",t,e.copy())),!1===Cu(this)&&!1===Ma(this)&&(vu(this),xu(this)),!0},n.dr=function(a,b,t){var e=this.fg,n=this.la;if(t){if(e.x===a&&e.y===b)return;Cu(this)||Ma(this)?n.h(NaN,NaN):n.h(n.x+a-e.x,n.y+b-e.y),e.h(a,b)}else{if(n.x===a&&n.y===b)return;Cu(this)||Ma(this)?this.ju():e.h(e.x+a-n.x,e.y+b-n.y),n.h(a,b)}vu(this)},n.ju=function(){this.D&=-2097153,vu(this)},n.qj=function(){return!0},n.Oc=function(){return!0},n.Oh=function(){return!1},n.Hf=function(){return!0},yu.prototype.canCopy=function(){if(!this.copyable)return!1;var a=this.layer;return null===a||!!a.allowCopy&&(null===(a=a.diagram)||!!a.allowCopy)},yu.prototype.canDelete=function(){if(!this.deletable)return!1;var a=this.layer;return null===a||!!a.allowDelete&&(null===(a=a.diagram)||!!a.allowDelete)},yu.prototype.canEdit=function(){if(!this.textEditable)return!1;var a=this.layer;return null===a||!!a.allowTextEdit&&(null===(a=a.diagram)||!!a.allowTextEdit)},yu.prototype.canGroup=function(){if(!this.groupable)return!1;var a=this.layer;return null===a||!!a.allowGroup&&(null===(a=a.diagram)||!!a.allowGroup)},yu.prototype.canMove=function(){if(!this.movable)return!1;var a=this.layer;return null===a||!!a.allowMove&&(null===(a=a.diagram)||!!a.allowMove)},yu.prototype.canReshape=function(){if(!this.reshapable)return!1;var a=this.layer;return null===a||!!a.allowReshape&&(null===(a=a.diagram)||!!a.allowReshape)},yu.prototype.canResize=function(){if(!this.resizable)return!1;var a=this.layer;return null===a||!!a.allowResize&&(null===(a=a.diagram)||!!a.allowResize)},yu.prototype.canRotate=function(){if(!this.rotatable)return!1;var a=this.layer;return null===a||!!a.allowRotate&&(null===(a=a.diagram)||!!a.allowRotate)},yu.prototype.canSelect=function(){if(!this.selectable)return!1;var a=this.layer;return null===a||!!a.allowSelect&&(null===(a=a.diagram)||!!a.allowSelect)},(n=yu.prototype).Ld=function(a){this.D=a?131072|this.D:-131073&this.D},n.Nh=function(){var a=this.containingGroup;null!==a&&(a.o(),null!==a.placeholder&&a.placeholder.o(),a.td())},n.M=function(){var a=this.diagram;null!==a&&!Ma(this)&&!Cu(this)&&this.isVisible()&&this.yb.u()&&a.M(bu(this,this.yb))},n.o=function(){Fh.prototype.o.call(this);var a=this.diagram;null!==a&&(a.vd.add(this),this instanceof zu&&null!==this.labeledLink&&fa(this.labeledLink),a.Eb(!0))},n.Iq=function(a){a||null!==(a=this.li)&&rc(a,this)},n.Jq=function(a){a||null!==(a=this.li)&&sc(a,this)},n.sk=function(){var a=this.data;if(null!==a){var b=this.diagram;null!==b&&(null!==(b=b.model)&&b.Lm(a))}},n.bA=function(){return Du(this,this)},n.eA=function(){return Ou(this,this)},n.Hd=function(a){return a instanceof oc&&Fu(this,this,a)},n.py=function(a){if(null===a)return null;if(this===a)return this.containingGroup;for(var b=this;null!==b;){if(b instanceof oc&&ju(b,!0),b instanceof zu){var t=b.labeledLink;null!==t&&(b=t)}b=b.containingGroup}for(t=null,b=a;null!==b;){if(0!=(1048576&b.D)){t=b;break}b instanceof zu&&(null!==(a=b.labeledLink)&&(b=a)),b=b.containingGroup}for(b=this;null!==b;)b instanceof oc&&ju(b,!1),b instanceof zu&&(null!==(a=b.labeledLink)&&(b=a)),b=b.containingGroup;return t},yu.prototype.canLayout=function(){if(!this.isLayoutPositioned||!this.isVisible())return!1;var a=this.layer;return!(null!==a&&a.isTemporary||this instanceof zu&&this.isLinkLabel)},yu.prototype.C=function(a){if(void 0===a&&(a=16777215),this.isLayoutPositioned&&0!=(a&this.layoutConditions)){var b=this.layer;null!==b&&b.isTemporary||this instanceof zu&&this.isLinkLabel?b=!1:b=null===(b=this.diagram)||!b.undoManager.isUndoingRedoing}else b=!1;if(b)if(null!==(b=this.li)){var t=b.layout;null!==t?t.C():b.C(a)}else null!==(a=this.diagram)&&(null!==(a=a.layout)&&a.C())},v.Object.defineProperties(yu.prototype,{key:{get:function(){var a=this.diagram;if(null!==a)return a.model.ja(this.data)}},adornments:{get:function(){return null===this.Nf?st:this.Nf.iteratorValues}},layer:{get:function(){return this.Di}},diagram:{get:function(){var a=this.Di;return null!==a?a.diagram:null}},layerName:{get:function(){return this.ih},set:function(a){var b=this.ih;if(b!==a){var t=this.diagram;if((null===t||null!==t.wm(a)&&!t.partManager.addsToTemporaryLayer)&&(this.ih=a,null!==t&&t.Oa(),this.g("layerName",b,a),null!==(b=this.layer)&&b.name!==a&&(null!==(t=b.diagram)&&(null!==(a=t.wm(a))&&a!==b)))){var e=b.Mc(-1,this,!0);if(0<=e&&t.bb(Ie,"parts",b,this,null,e,!0),e=a.nj(99999999,this,!0),b.visible!==a.visible&&this.Pb(a.visible),0<=e&&t.bb(Be,"parts",a,null,this,!0,e),null!==(e=this.layerChanged)){var n=t.Z;t.Z=!0,e(this,b,a),t.Z=n}}}}},layerChanged:{get:function(){return this.Bo},set:function(a){var b=this.Bo;b!==a&&(this.Bo=a,this.g("layerChanged",b,a))}},zOrder:{get:function(){return this.pq},set:function(a){var b=this.pq;if(b!==a){this.pq=a;var t=this.layer;null!==t&&Yo(t,-1,this),this.g("zOrder",b,a),null!==(a=this.diagram)&&a.M()}}},locationObject:{get:function(){if(null===this.df){var a=this.locationObjectName;""!==a?(a=this.ab(a),this.df=null!==a?a:this):this instanceof Eu&&this.type!==Fh.Link&&null!==this.placeholder?this.df=this.placeholder:this.df=this}return this.df.visible?this.df:this}},minLocation:{get:function(){return this.So},set:function(a){var b=this.So;b.w(a)||(this.So=a=a.G(),this.g("minLocation",b,a))}},maxLocation:{get:function(){return this.Ko},set:function(a){var b=this.Ko;b.w(a)||(this.Ko=a=a.G(),this.g("maxLocation",b,a))}},locationObjectName:{get:function(){return this.Io},set:function(a){var b=this.Io;b!==a&&(this.Io=a,this.df=null,this.o(),this.g("locationObjectName",b,a))}},locationSpot:{get:function(){return this.Jo},set:function(a){var b=this.Jo;b.w(a)||(this.Jo=a=a.G(),this.o(),this.g("locationSpot",b,a))}},location:{get:function(){return this.fg},set:function(a){var b=a.x,t=a.y,e=this.fg,n=e.x,o=e.y;(n===b||isNaN(n)&&isNaN(b))&&(o===t||isNaN(o)&&isNaN(t))||(b=a=a.copy(),this.Oh()?b=!1:(this.fg=b,this.D|=2097152,!1===Ma(this)&&(vu(this),(t=this.la).u()&&(null===(n=this.diagram)||n.animationManager.isTicking||!n.undoManager.isUndoingRedoing))&&(o=t.copy(),t.h(t.x+(b.x-e.x),t.y+(b.y-e.y)),wu(this,n,t,o),this.g("position",o,t.copy())),b=!0),b&&this.g("location",e.copy(),a.copy()))}},category:{get:function(){return this.Pf},set:function(a){var b=this.Pf;if(b!==a){var t=this.diagram,e=this.data,n=null;if(null!==t&&null!==e&&!(this instanceof Eu)){var o=t.model.undoManager;o.isEnabled&&!o.isUndoingRedoing&&(n=this.clone()).W.addAll(this.W)}this.Pf=a,this.g("category",b,a),null===t||null===e||this instanceof Eu?this instanceof Eu&&(null!==(n=this.adornedPart)&&(null!==(a=n.Nf)&&a.remove(b),n.Fh(this.category,this))):(o=t.model).undoManager.isUndoingRedoing||(this.Oh()?(t.partManager.setLinkCategoryForData(e,a),null!==(t=t.partManager.findLinkTemplateForCategory(a))&&($h(t),null!==(t=t.copy())&&Nu(this,t,b,a))):(null!==o&&o.Sm(e,a),null!==(t=ed(t.partManager,e,a))&&($h(t),null===(t=t.copy())||t instanceof uc||(e=this.location.copy(),Nu(this,t,b,a),this.location.u()||(this.location=e)))),null!==n&&((b=this.clone()).W.addAll(this.W),this.g("self",n,b)))}}},self:{get:function(){return this},set:function(a){Nu(this,a,this.category,a.category)}},copyable:{get:function(){return 0!=(1&this.D)},set:function(a){var b=0!=(1&this.D);b!==a&&(this.D^=1,this.g("copyable",b,a))}},deletable:{get:function(){return 0!=(2&this.D)},set:function(a){var b=0!=(2&this.D);b!==a&&(this.D^=2,this.g("deletable",b,a))}},textEditable:{get:function(){return 0!=(4&this.D)},set:function(a){var b=0!=(4&this.D);b!==a&&(this.D^=4,this.g("textEditable",b,a),this.Mb())}},groupable:{get:function(){return 0!=(8&this.D)},set:function(a){var b=0!=(8&this.D);b!==a&&(this.D^=8,this.g("groupable",b,a))}},movable:{get:function(){return 0!=(16&this.D)},set:function(a){var b=0!=(16&this.D);b!==a&&(this.D^=16,this.g("movable",b,a))}},selectionAdorned:{get:function(){return 0!=(32&this.D)},set:function(a){var b=0!=(32&this.D);b!==a&&(this.D^=32,this.g("selectionAdorned",b,a),this.Mb())}},isInDocumentBounds:{get:function(){return 0!=(64&this.D)},set:function(a){var b=0!=(64&this.D);if(b!==a){this.D^=64;var t=this.diagram;null!==t&&t.Oa(),this.g("isInDocumentBounds",b,a)}}},isLayoutPositioned:{get:function(){return 0!=(128&this.D)},set:function(a){var b=0!=(128&this.D);b!==a&&(this.D^=128,this.g("isLayoutPositioned",b,a),this.C(a?4:8))}},selectable:{get:function(){return 0!=(256&this.D)},set:function(a){var b=0!=(256&this.D);b!==a&&(this.D^=256,this.g("selectable",b,a),this.Mb())}},reshapable:{get:function(){return 0!=(512&this.D)},set:function(a){var b=0!=(512&this.D);b!==a&&(this.D^=512,this.g("reshapable",b,a),this.Mb())}},resizable:{get:function(){return 0!=(1024&this.D)},set:function(a){var b=0!=(1024&this.D);b!==a&&(this.D^=1024,this.g("resizable",b,a),this.Mb())}},rotatable:{get:function(){return 0!=(2048&this.D)},set:function(a){var b=0!=(2048&this.D);b!==a&&(this.D^=2048,this.g("rotatable",b,a),this.Mb())}},isSelected:{get:function(){return 0!=(4096&this.D)},set:function(a){var b=0!=(4096&this.D);if(b!==a){var t=this.diagram;if(!a||this.canSelect()&&!(null!==t&&t.selection.count>=t.maxSelectionCount)){this.D^=4096;var e=!1;if(null!==t){e=t.skipsUndoManager,t.skipsUndoManager=!0;var n=t.selection;n.ea(),a?n.add(this):n.remove(this),n.freeze()}this.g("isSelected",b,a),this.Mb(),null!==(a=this.selectionChanged)&&a(this),null!==t&&(t.Eb(),t.skipsUndoManager=e)}}}},isHighlighted:{get:function(){return 0!=(524288&this.D)},set:function(a){var b=0!=(524288&this.D);if(b!==a){this.D^=524288;var t=this.diagram;null!==t&&((t=t.highlighteds).ea(),a?t.add(this):t.remove(this),t.freeze()),this.g("isHighlighted",b,a),this.M(),null!==(a=this.highlightedChanged)&&a(this)}}},isShadowed:{get:function(){return 0!=(8192&this.D)},set:function(a){var b=0!=(8192&this.D);b!==a&&(this.D^=8192,this.g("isShadowed",b,a),this.M())}},isAnimated:{get:function(){return 0!=(262144&this.D)},set:function(a){var b=0!=(262144&this.D);b!==a&&(this.D^=262144,this.g("isAnimated",b,a))}},highlightedChanged:{get:function(){return this.no},set:function(a){var b=this.no;b!==a&&(this.no=a,this.g("highlightedChanged",b,a))}},selectionObjectName:{get:function(){return this.Np},set:function(a){var b=this.Np;b!==a&&(this.Np=a,this.sh=null,this.g("selectionObjectName",b,a))}},selectionAdornmentTemplate:{get:function(){return this.Lp},set:function(a){var b=this.Lp;b!==a&&(this.Lp=a,this.g("selectionAdornmentTemplate",b,a))}},selectionObject:{get:function(){if(null===this.sh){var a=this.selectionObjectName;null!==a&&""!==a?(a=this.ab(a),this.sh=null!==a?a:this):this instanceof uc?(a=this.path,this.sh=null!==a?a:this):this.sh=this}return this.sh}},selectionChanged:{get:function(){return this.Mp},set:function(a){var b=this.Mp;b!==a&&(this.Mp=a,this.g("selectionChanged",b,a))}},resizeAdornmentTemplate:{get:function(){return this.wp},set:function(a){var b=this.wp;b!==a&&(this.wp=a,this.g("resizeAdornmentTemplate",b,a))}},resizeObjectName:{get:function(){return this.yp},set:function(a){var b=this.yp;b!==a&&(this.yp=a,this.g("resizeObjectName",b,a))}},resizeObject:{get:function(){var a=this.resizeObjectName;return""!==a&&null!==(a=this.ab(a))?a:this}},resizeCellSize:{get:function(){return this.xp},set:function(a){var b=this.xp;b.w(a)||(this.xp=a=a.G(),this.g("resizeCellSize",b,a))}},rotateAdornmentTemplate:{get:function(){return this.Ap},set:function(a){var b=this.Ap;b!==a&&(this.Ap=a,this.g("rotateAdornmentTemplate",b,a))}},rotateObjectName:{get:function(){return this.Bp},set:function(a){var b=this.Bp;b!==a&&(this.Bp=a,this.g("rotateObjectName",b,a))}},rotateObject:{get:function(){var a=this.rotateObjectName;return""!==a&&null!==(a=this.ab(a))?a:this}},rotationSpot:{get:function(){return this.Cp},set:function(a){var b=this.Cp;b.w(a)||(this.Cp=a=a.G(),this.g("rotationSpot",b,a))}},text:{get:function(){return this.Ub},set:function(a){var b=this.Ub;b!==a&&(this.Ub=a,this.g("text",b,a))}},containingGroup:{get:function(){return this.li},set:function(a){if(this.Oc()){var b=this.li;if(b!==a){null===a||this!==a&&!a.Hd(this)||(this===a&&N("Cannot make a Group a member of itself: "+this.toString()),N("Cannot make a Group indirectly contain itself: "+this.toString()+" already contains "+a.toString())),this.C(2);var t=this.diagram;if(null!==b?sc(b,this):this instanceof oc&&null!==t&&t.Ch.remove(this),this.li=a,null!==a?rc(a,this):this instanceof oc&&null!==t&&t.Ch.add(this),this.C(1),null!==t&&t.Z){var e=this.data,n=t.model;if(null!==e&&n.zk()){var o=n.ja(null!==a?a.data:null);n.cr(e,o)}}if(null!==(e=this.containingGroupChanged)&&(n=!0,null!==t&&(n=t.Z,t.Z=!0),e(this,b,a),null!==t&&(t.Z=n)),this instanceof oc)for(Iu(t=new ft,this,!0,0,!0),t=t.iterator;t.next();)if((e=t.value)instanceof zu)for(e=e.linksConnected;e.next();)cc(e.value);if(this instanceof zu){for(t=this.linksConnected;t.next();)cc(t.value);null!==(t=this.labeledLink)&&cc(t)}this.g("containingGroup",b,a),null!==a&&(null!==(b=a.layer)&&Yo(b,-1,a))}}else N("cannot set the Part.containingGroup of a Link or Adornment")}},containingGroupChanged:{get:function(){return this.xn},set:function(a){var b=this.xn;b!==a&&(this.xn=a,this.g("containingGroupChanged",b,a))}},isTopLevel:{get:function(){return!(null!==this.containingGroup||this instanceof zu&&null!==this.labeledLink)}},layoutConditions:{get:function(){return this.Co},set:function(a){var b=this.Co;b!==a&&(this.Co=a,this.g("layoutConditions",b,a))}},dragComputation:{get:function(){return this.Pn},set:function(a){var b=this.Pn;b!==a&&(this.Pn=a,this.g("dragComputation",b,a))}},shadowOffset:{get:function(){return this.Rp},set:function(a){var b=this.Rp;b.w(a)||(this.Rp=a=a.G(),this.M(),this.g("shadowOffset",b,a))}},shadowColor:{get:function(){return this.Qp},set:function(a){var b=this.Qp;b!==a&&(this.Qp=a,this.M(),this.g("shadowColor",b,a))}},shadowBlur:{get:function(){return this.lf},set:function(a){var b=this.lf;b!==a&&(this.lf=a,this.M(),this.g("shadowBlur",b,a))}}}),yu.prototype.invalidateLayout=yu.prototype.C,yu.prototype.findCommonContainingGroup=yu.prototype.py,yu.prototype.isMemberOf=yu.prototype.Hd,yu.prototype.findTopLevelPart=yu.prototype.eA,yu.prototype.findSubGraphLevel=yu.prototype.bA,yu.prototype.ensureBounds=yu.prototype.Ta,yu.prototype.getDocumentBounds=yu.prototype.lj,yu.prototype.getRelativePoint=yu.prototype.Ff,yu.prototype.findObject=yu.prototype.ab,yu.prototype.moveTo=yu.prototype.moveTo,yu.prototype.invalidateAdornments=yu.prototype.Mb,yu.prototype.clearAdornments=yu.prototype.lk,yu.prototype.removeAdornment=yu.prototype.Jf,yu.prototype.addAdornment=yu.prototype.Fh,yu.prototype.findAdornment=yu.prototype.uk,yu.prototype.updateTargetBindings=yu.prototype.Ca;var Ru=!1;function Eu(a){yu.call(this,a),this.D&=-257,this.ih="Adornment",this.ge=null,this.Fx=0,this.Tx=!1,this.l=[],this.Ra=null}function zu(a){yu.call(this,a),this.P=13,this.Za=new ut,this.jq=this.Jl=this.Gi=this.Eo=this.Do=null,this.al=pi,this.tc=this.Te=null,this.sp=ec,this.Dh=!1}function Vu(a,b){null!==b&&(null===a.Te&&(a.Te=new ft),a.Te.add(b))}function Gu(a,b,t,e){if(null===b||null===a.Te)return null;for(var n=a.Te.iterator;n.next();){var o=n.value;if(o.Zt===a&&o.jw===b&&o.Oy===t&&o.Py===e||o.Zt===b&&o.jw===a&&o.Oy===e&&o.Py===t)return o}return null}function Yu(a,b){for(a=a.linksConnected;a.next();){var t=a.value;t.fromPort!==b&&t.toPort!==b||(Xu(t.fromPort),Xu(t.toPort),t.Ua())}}function Xu(a){if(null!==a){var b=a.rp;null!==b&&b.Am(),null===(b=(a=a.part).containingGroup)||a.isVisible()||Xu(b.port)}}function qu(a,b,t,e){if(null!==b&&!t.has(b)){t.add(b);var n=!0,o=a.diagram;null!==o&&(n=o.isTreePathToChildren),b.linksConnected.each((function(o){o.isTreeLink?(n?o.fromNode===b:o.toNode===b)&&qu(a,n?o.toNode:o.fromNode,t,e):e.add(o)}))}}function Uu(a,b,t){Xu(t);var e=a.Za.contains(b);if(e||a.Za.add(b),!e||b.fromNode===b.toNode){var n=a.linkConnected;if(null!==n){var o=!0,g=a.diagram;null!==g&&(o=g.Z,g.Z=!0),n(a,b,t),null!==g&&(g.Z=o)}}!e&&b.isTreeLink&&(t=b.fromNode,b=b.toNode,null!==t&&null!==b&&t!==b&&(e=!0,null!==(a=a.diagram)&&(e=a.isTreePathToChildren),o=e?t:b,(n=e?b:t).Dh||(n.Dh=o),!o.isTreeLeaf||null!==a&&a.undoManager.isUndoingRedoing||(e?t===o&&(o.isTreeLeaf=!1):b===o&&(o.isTreeLeaf=!1))))}function Ku(a,b,t){Xu(t);var e=a.Za.remove(b),n=null;if(e||b.toNode===b.fromNode){var o=a.linkDisconnected;if(n=a.diagram,null!==o){var g=!0;null!==n&&(g=n.Z,n.Z=!0),o(a,b,t),null!==n&&(n.Z=g)}}e&&b.isTreeLink&&(t=!0,null!==n&&(t=n.isTreePathToChildren),a=t?b.toNode:b.fromNode,b=t?b.fromNode:b.toNode,null!==a&&(a.Dh=!1),null===b||b.isTreeLeaf||(0===b.Za.count?(b.Dh=null,null!==n&&n.undoManager.isUndoingRedoing||(b.isTreeLeaf=!0)):Hu(b)))}function Hu(a){if(a.Dh=!1,0!==a.Za.count){var b=!0,t=a.diagram;if(null===t||!t.undoManager.isUndoingRedoing){for(null!==t&&(b=t.isTreePathToChildren),t=a.Za.iterator;t.next();){var e=t.value;if(e.isTreeLink)if(b){if(e.fromNode===a)return void(a.isTreeLeaf=!1)}else if(e.toNode===a)return void(a.isTreeLeaf=!1)}a.isTreeLeaf=!0}}}function Wu(a){null===a.tc?a.tc=new Mt:a.tc.clear(),a.Ym(a,(function(a,t){Ju(a,t)})),0===a.tc.count&&a.tc.add("",a)}function Ju(a,b){var t=b.portId;null!==t&&null!==a.tc&&a.tc.add(t,b)}function Zu(a,b,t){var e=b.portId;if(null!==e&&(null!==a.tc&&a.tc.remove(e),null!==(b=a.diagram)&&t)){for(t=null,a=a.findLinksConnected(e);a.next();)e=a.value,null===t&&(t=I()),t.push(e);if(null!==t){for(a=0;a<t.length;a++)b.remove(t[a]);R(t)}}}function $u(a,b){return null===(b=b.Gg())?0:1+$u(a,b)}function Qu(a,b,t,e,n,o,g){if(1<e)for(var r=t?a.Bq():a.Fd();r.next();){var h=r.value;h.isTreeLink&&(null===(h=h.Gq(a))||h===a||b.contains(h)||(b.add(h),Qu(h,b,t,e-1,n,o,g)))}else _u(a,b,t,n,o,g)}function _u(a,b,t,e,n,o){for(var g=n===a||a.isTreeExpanded,r=t?a.Bq():a.Fd();r.next();){var h=r.value;if(h.isTreeLink&&(null!==(h=h.Gq(a))&&h!==a)){var l=b.contains(h);l||b.add(h),g&&(o&&e.hk(h,n),h.Nh(),h.Pb(!1)),h.isTreeExpanded&&(h.wasTreeExpanded=h.isTreeExpanded,l||_u(h,b,t,e,n,o))}}a.isTreeExpanded=!1}function tc(a,b,t,e,n,o,g){for(var r=o!==a&&a.isTreeExpanded,h=t?a.Bq():a.Fd();h.next();){var l=h.value;l.isTreeLink&&(r||l.kd||l.Ua(),null!==(l=l.Gq(a))&&l!==a&&!b.contains(l)&&(b.add(l),r||(l.Pb(!0),l.Nh(),g&&n.jk(l,o)),2<e||l.wasTreeExpanded))&&(l.wasTreeExpanded=!1,tc(l,b,t,e-1,n,o,g))}a.isTreeExpanded=!0}yu.className="Part",yu.LayoutNone=0,yu.LayoutAdded=1,yu.LayoutRemoved=2,yu.LayoutShown=4,yu.LayoutHidden=8,yu.LayoutNodeSized=16,yu.LayoutGroupLayout=32,yu.LayoutNodeReplaced=64,yu.LayoutStandard=127,yu.LayoutAll=16777215,m(Eu,yu),Eu.prototype.toString=function(){var a=this.adornedPart;return"Adornment("+this.category+")"+(null!==a?a.toString():"")},Eu.prototype.updateRelationshipsFromData=function(){},Eu.prototype.Ck=function(a){var b=this.adornedObject.part;if(b instanceof uc&&this.adornedObject instanceof pl){var t=b.path;b.Ck(a),a=t.geometry,t=(b=this.W.j).length;for(var e=0;e<t;e++){var n=b[e];n.isPanelMain&&n instanceof pl&&(n.na=a)}}},Eu.prototype.qj=function(){var a=this.ge;return null===a||(null===(a=a.part)||!Ma(a))},Eu.prototype.Oc=function(){return!1},Eu.prototype.Ok=function(a,b,t,e,n,o,g){if(a===Be&&"elements"===b){if(n instanceof lc)null===this.Ra&&(this.Ra=n);else if(n instanceof Fh){var r=n.vm((function(a){return a instanceof lc}));r instanceof lc&&null===this.Ra&&(this.Ra=r)}}else a===Ie&&"elements"===b&&null!==this.Ra&&(e===this.Ra||e instanceof Fh&&this.Ra.Hg(e))&&(this.Ra=null);yu.prototype.Ok.call(this,a,b,t,e,n,o,g)},Eu.prototype.updateAdornments=function(){},Eu.prototype.sk=function(){},v.Object.defineProperties(Eu.prototype,{placeholder:{get:function(){return this.Ra}},adornedObject:{get:function(){return this.ge},set:function(a){var b=this.adornedPart,t=null;null!==a&&(t=a.part),null===b||null!==a&&b===t||b.Jf(this.category),this.ge=a,null!==t&&t.Fh(this.category,this)}},adornedPart:{get:function(){var a=this.ge;return null!==a?a.part:null}},containingGroup:{get:function(){return null}}}),Eu.className="Adornment",m(zu,yu),zu.prototype.cloneProtected=function(a){yu.prototype.cloneProtected.call(this,a),a.P=this.P,a.P=-17&this.P,a.Do=this.Do,a.Eo=this.Eo,a.Gi=this.Gi,a.jq=this.jq,a.al=this.al.G(),a.sp=this.sp},(n=zu.prototype).Af=function(a){yu.prototype.Af.call(this,a),a.td(),a.Te=this.Te,a.tc=null},n.xA=function(a,b,t){null==b&&(b=""),null==t&&(t=""),null!==(a=Gu(this,a,b,t))&&a.Am()},n.Ok=function(a,b,t,e,n,o,g){(a===Be&&"elements"===b||a===Ie&&"elements"===b)&&(this.tc=null),yu.prototype.Ok.call(this,a,b,t,e,n,o,g)},n.td=function(a){void 0===a&&(a=null);for(var b=this.linksConnected;b.next();){var t=b.value;null!==a&&a.contains(t)||(Xu(t.fromPort),Xu(t.toPort),t.Ua())}},n.qj=function(){return!0},zu.prototype.getAvoidableRect=function(a){return a.set(this.actualBounds),a.qq(this.al),a},zu.prototype.findVisibleNode=function(){for(var a=this;null!==a&&!a.isVisible();)a=a.containingGroup;return a},zu.prototype.isVisible=function(){if(!yu.prototype.isVisible.call(this))return!1;var a=!0,b=ks,t=this.diagram;if(null!==t){if(t.animationManager.au(this))return!0;a=t.isTreePathToChildren,b=t.treeCollapsePolicy}if(b===ks){if(null!==(a=this.Gg())&&!a.isTreeExpanded)return!1}else if(b===Ms){if(0<(a=a?this.Rv():this.Sv()).count&&a.all((function(a){return!a.isTreeExpanded})))return!1}else if(b===Ss&&(0<(a=a?this.Rv():this.Sv()).count&&a.any((function(a){return!a.isTreeExpanded}))))return!1;return null===(a=this.labeledLink)||a.isVisible()},zu.prototype.Pb=function(a){yu.prototype.Pb.call(this,a);for(var b=this.linksConnected;b.next();){var t=b.value;if(a&&null!==this.containingGroup){var e=t.Gq(this);null===e||e.Hd(this.containingGroup)||t.Ua()}t.Pb(a)}},zu.prototype.qy=function(){var a=new ft,b=new ft;return qu(this,this,a,b),b.iterator},zu.prototype.findLinksConnected=function(a){if(void 0===a&&(a=null),null===a)return this.Za.iterator;var b=new ht(this.Za),t=this;return b.predicate=function(b){return b.fromNode===t&&b.fromPortId===a||b.toNode===t&&b.toPortId===a},b},(n=zu.prototype).Bq=function(a){void 0===a&&(a=null);var b=new ht(this.Za),t=this;return b.predicate=function(b){return b.fromNode===t&&(null===a||b.fromPortId===a)},b},n.Fd=function(a){void 0===a&&(a=null);var b=new ht(this.Za),t=this;return b.predicate=function(b){return b.toNode===t&&(null===a||b.toPortId===a)},b},n.Qv=function(a){void 0===a&&(a=null);for(var b=null,t=null,e=this.Za.iterator;e.next();){var n=e.value;n.fromNode===this?null!==a&&n.fromPortId!==a||(n=n.toNode,null!==b?b.add(n):null!==t&&t!==n?((b=new ft).add(t),b.add(n)):t=n):n.toNode!==this||null!==a&&n.toPortId!==a||(n=n.fromNode,null!==b?b.add(n):null!==t&&t!==n?((b=new ft).add(t),b.add(n)):t=n)}return null!==b?b.iterator:null!==t?new at(t):st},n.Sv=function(a){void 0===a&&(a=null);for(var b=null,t=null,e=this.Za.iterator;e.next();){var n=e.value;n.fromNode!==this||null!==a&&n.fromPortId!==a||(n=n.toNode,null!==b?b.add(n):null!==t&&t!==n?((b=new ft).add(t),b.add(n)):t=n)}return null!==b?b.iterator:null!==t?new at(t):st},n.Rv=function(a){void 0===a&&(a=null);for(var b=null,t=null,e=this.Za.iterator;e.next();){var n=e.value;n.toNode!==this||null!==a&&n.toPortId!==a||(n=n.fromNode,null!==b?b.add(n):null!==t&&t!==n?((b=new ft).add(t),b.add(n)):t=n)}return null!==b?b.iterator:null!==t?new at(t):st},n.Xz=function(a,b,t){void 0===b&&(b=null),void 0===t&&(t=null);var e=new ht(this.Za),n=this;return e.predicate=function(e){return!(e.fromNode!==n||e.toNode!==a||null!==b&&e.fromPortId!==b||null!==t&&e.toPortId!==t)||!(e.fromNode!==a||e.toNode!==n||null!==t&&e.fromPortId!==t||null!==b&&e.toPortId!==b)},e},n.Yz=function(a,b,t){void 0===b&&(b=null),void 0===t&&(t=null);var e=new ht(this.Za),n=this;return e.predicate=function(e){return!(e.fromNode!==n||e.toNode!==a||null!==b&&e.fromPortId!==b||null!==t&&e.toPortId!==t)},e},zu.prototype.updateRelationshipsFromData=function(){var a=this.diagram;null!==a&&a.partManager.updateRelationshipsFromData(this)},(n=zu.prototype).Iq=function(a){yu.prototype.Iq.call(this,a),a||(Hu(this),null!==(a=this.Jl)&&fc(a,this))},n.Jq=function(a){yu.prototype.Jq.call(this,a),a||null!==(a=this.Jl)&&null!==a.od&&(a.od.remove(this),a.o())},n.sk=function(){if(0<this.Za.count){var a=this.diagram;if(null!==a)for(var b=null===a.commandHandler||a.commandHandler.deletesConnectedLinks,t=this.Za.copy().iterator;t.next();){var e=t.value;b?a.remove(e):(e.fromNode===this&&(e.fromNode=null),e.toNode===this&&(e.toNode=null))}}this.labeledLink=null,yu.prototype.sk.call(this)},n.It=function(a){if(null===this.tc){if(""===a&&!1===this.Mh)return this;Wu(this)}var b=this.tc.H(a);return null!==b||""!==a&&null!==(b=this.tc.H(""))?b:this},n.zA=function(a){if(null===a||a===this)return!1;var b=!0,t=this.diagram;if(null!==t&&(b=t.isTreePathToChildren),t=this,b)for(;t!==a;){b=null;for(var e=t.Za.iterator;e.next();){var n=e.value;if(n.isTreeLink&&((b=n.fromNode)!==t&&b!==this))break}if(b===this||null===b||b===t)return!1;t=b}else for(;t!==a;){for(b=null,e=t.Za.iterator;e.next()&&(!(n=e.value).isTreeLink||((b=n.toNode)===t||b===this)););if(b===this||null===b||b===t)return!1;t=b}return!0},n.iA=function(){var a=!0,b=this.diagram;if(null!==b&&(a=b.isTreePathToChildren),b=this,a)for(;;){a=null;for(var t=b.Za.iterator;t.next();){var e=t.value;if(e.isTreeLink&&((a=e.fromNode)!==b&&a!==this))break}if(a===this)return this;if(null===a||a===b)return b;b=a}else for(;;){for(a=null,t=b.Za.iterator;t.next()&&(!(e=t.value).isTreeLink||((a=e.toNode)===b||a===this)););if(a===this)return this;if(null===a||a===b)return b;b=a}},n.Uz=function(a){if(null===a)return null;if(this===a)return this;for(var b=this;null!==b;)ju(b,!0),b=b.Gg();var t=null;for(b=a;null!==b;){if(0!=(1048576&b.D)){t=b;break}b=b.Gg()}for(b=this;null!==b;)ju(b,!1),b=b.Gg();return t},n.ij=function(){var a=!0,b=this.diagram;if(null!==b&&(a=b.isTreePathToChildren),b=this.Za.iterator,a){for(;b.next();)if((a=b.value).isTreeLink&&a.fromNode!==this)return a}else for(;b.next();)if((a=b.value).isTreeLink&&a.toNode!==this)return a;return null},n.Gg=function(){var a=this.Dh;if(null===a)return null;if(a instanceof zu)return a;var b=!0;if(null!==(a=this.diagram)&&(b=a.isTreePathToChildren),a=this.Za.iterator,b){for(;a.next();)if((b=a.value).isTreeLink&&(b=b.fromNode)!==this)return this.Dh=b}else for(;a.next();)if((b=a.value).isTreeLink&&(b=b.toNode)!==this)return this.Dh=b;return this.Dh=null},n.gA=function(){var b=new ft;return function a(b,t){if(null!==b){t.add(b);var e=b.ij();null!==e&&(t.add(e),a(b.Gg(),t))}}(this,b),b},n.fA=function(){return $u(this,this)},n.Dq=function(){var a=!0,b=this.diagram;null!==b&&(a=b.isTreePathToChildren),b=new ht(this.Za);var t=this;return b.predicate=a?function(a){return!(!a.isTreeLink||a.fromNode!==t)}:function(a){return!(!a.isTreeLink||a.toNode!==t)},b},n.Uv=function(){var a=!0,b=this.diagram;null!==b&&(a=b.isTreePathToChildren);var t=b=null,e=this.Za.iterator;if(a)for(;e.next();)(a=e.value).isTreeLink&&a.fromNode===this&&(a=a.toNode,null!==b?b.add(a):null!==t&&t!==a?((b=new ut).add(t),b.add(a)):t=a);else for(;e.next();)(a=e.value).isTreeLink&&a.toNode===this&&(a=a.fromNode,null!==b?b.add(a):null!==t&&t!==a?((b=new ut).add(t),b.add(a)):t=a);return null!==b?b.iterator:null!==t?new at(t):st},n.hA=function(a){void 0===a&&(a=1/0);var b=new ft;return Iu(b,this,!1,a,!0),b},zu.prototype.collapseTree=function(a){void 0===a&&(a=1),1>a&&(a=1);var b=this.diagram;if(null!==b&&!b.Je){b.Je=!0;var t=new ft;t.add(this),Qu(this,t,b.isTreePathToChildren,a,b,this,b.treeCollapsePolicy===ks),b.Je=!1}},zu.prototype.expandTree=function(a){void 0===a&&(a=2),2>a&&(a=2);var b=this.diagram;if(null!==b&&!b.Je){b.Je=!0;var t=new ft;t.add(this),tc(this,t,b.isTreePathToChildren,a,b,this,b.treeCollapsePolicy===ks),b.Je=!1}},v.Object.defineProperties(zu.prototype,{portSpreading:{get:function(){return this.sp},set:function(a){var b=this.sp;b!==a&&(this.sp=a,this.g("portSpreading",b,a),null!==(a=this.diagram)&&a.undoManager.isUndoingRedoing||this.td())}},avoidable:{get:function(){return 0!=(8&this.P)},set:function(a){var b=0!=(8&this.P);if(b!==a){this.P^=8;var t=this.diagram;null!==t&&ts(t,this),this.g("avoidable",b,a)}}},avoidableMargin:{get:function(){return this.al},set:function(a){"number"==typeof a&&(a=new ui(a));var b=this.al;if(!b.w(a)){this.al=a=a.G();var t=this.diagram;null!==t&&ts(t,this),this.g("avoidableMargin",b,a)}}},linksConnected:{get:function(){return this.Za.iterator}},linkConnected:{get:function(){return this.Do},set:function(a){var b=this.Do;b!==a&&(this.Do=a,this.g("linkConnected",b,a))}},linkDisconnected:{get:function(){return this.Eo},set:function(a){var b=this.Eo;b!==a&&(this.Eo=a,this.g("linkDisconnected",b,a))}},linkValidation:{get:function(){return this.Gi},set:function(a){var b=this.Gi;b!==a&&(this.Gi=a,this.g("linkValidation",b,a))}},isLinkLabel:{get:function(){return null!==this.Jl}},labeledLink:{get:function(){return this.Jl},set:function(a){var b=this.Jl;if(b!==a){var t=this.diagram,e=this.data;if(null!==b){if(null!==b.od&&(b.od.remove(this),b.o()),null!==t&&null!==e&&!t.undoManager.isUndoingRedoing){var n=b.data,o=t.model;if(null!==n&&o.pj()){var g=o.ja(e);void 0!==g&&o.Qy(n,g)}}this.containingGroup=null}this.Jl=a,null!==a&&(fc(a,this),null===t||null===e||t.undoManager.isUndoingRedoing||(n=a.data,t=t.model,null!==n&&t.pj()&&(void 0!==(e=t.ja(e))&&t.Bv(n,e))),this.containingGroup=a.containingGroup),fa(this),this.g("labeledLink",b,a)}}},port:{get:function(){return this.It("")}},ports:{get:function(){return null===this.tc&&Wu(this),this.tc.iteratorValues}},isTreeExpanded:{get:function(){return 0!=(1&this.P)},set:function(a){var b=0!=(1&this.P);if(b!==a){this.P^=1;var t=this.diagram;if(this.g("isTreeExpanded",b,a),null!==(b=this.treeExpandedChanged)){var e=!0;null!==t&&(e=t.Z,t.Z=!0),b(this),null!==t&&(t.Z=e)}null!==t&&t.undoManager.isUndoingRedoing?this.Pb(a):a?this.expandTree():this.collapseTree()}}},wasTreeExpanded:{get:function(){return 0!=(2&this.P)},set:function(a){var b=0!=(2&this.P);b!==a&&(this.P^=2,this.g("wasTreeExpanded",b,a))}},treeExpandedChanged:{get:function(){return this.jq},set:function(a){var b=this.jq;b!==a&&(this.jq=a,this.g("treeExpandedChanged",b,a))}},isTreeLeaf:{get:function(){return 0!=(4&this.P)},set:function(a){var b=0!=(4&this.P);b!==a&&(this.P^=4,this.g("isTreeLeaf",b,a))}}}),zu.prototype.expandTree=zu.prototype.expandTree,zu.prototype.collapseTree=zu.prototype.collapseTree,zu.prototype.findTreeParts=zu.prototype.hA,zu.prototype.findTreeChildrenNodes=zu.prototype.Uv,zu.prototype.findTreeChildrenLinks=zu.prototype.Dq,zu.prototype.findTreeLevel=zu.prototype.fA,zu.prototype.findTreeParentChain=zu.prototype.gA,zu.prototype.findTreeParentNode=zu.prototype.Gg,zu.prototype.findTreeParentLink=zu.prototype.ij,zu.prototype.findCommonTreeParent=zu.prototype.Uz,zu.prototype.findTreeRoot=zu.prototype.iA,zu.prototype.isInTreeOf=zu.prototype.zA,zu.prototype.findPort=zu.prototype.It,zu.prototype.findLinksTo=zu.prototype.Yz,zu.prototype.findLinksBetween=zu.prototype.Xz,zu.prototype.findNodesInto=zu.prototype.Rv,zu.prototype.findNodesOutOf=zu.prototype.Sv,zu.prototype.findNodesConnected=zu.prototype.Qv,zu.prototype.findLinksInto=zu.prototype.Fd,zu.prototype.findLinksOutOf=zu.prototype.Bq,zu.prototype.findExternalTreeLinksConnected=zu.prototype.qy,zu.prototype.invalidateConnectedLinks=zu.prototype.td,zu.prototype.invalidateLinkBundle=zu.prototype.xA;var ic=new _(zu,"SpreadingNone",10),ec=new _(zu,"SpreadingEvenly",11),nc=new _(zu,"SpreadingPacked",12);function oc(a){zu.call(this,a),this.P|=4608,this.Po=new ft,this.Rl=new ft,this.Ra=this.$p=this.Ii=this.Qo=this.Oo=this.Ya=null,this.lc=new wf,this.lc.group=this}function rc(a,b){if(a.Po.add(b)){b instanceof oc&&a.Rl.add(b);var t=a.memberAdded;if(null!==t){var e=!0,n=a.diagram;null!==n&&(e=n.Z,n.Z=!0),t(a,b),null!==n&&(n.Z=e)}a.isVisible()&&a.isSubGraphExpanded||b.Pb(!1)}b instanceof uc&&!a.computesBoundsIncludingLinks||(null===(b=a.Ra)&&(b=a),b.o())}function sc(a,b){if(a.Po.remove(b)){b instanceof oc&&a.Rl.remove(b);var t=a.memberRemoved;if(null!==t){var e=!0,n=a.diagram;null!==n&&(e=n.Z,n.Z=!0),t(a,b),null!==n&&(n.Z=e)}a.isVisible()&&a.isSubGraphExpanded||b.Pb(!0)}b instanceof uc&&!a.computesBoundsIncludingLinks||(null===(b=a.Ra)&&(b=a),b.o())}function ac(a,b,t,e){for(var n=a.memberParts;n.next();){var o=n.value;if(o.Pb(!1),o instanceof oc&&o.isSubGraphExpanded&&(o.wasSubGraphExpanded=o.isSubGraphExpanded,ac(o,b,t,e)),o instanceof zu)o.td(b),t.hk(o,e);else if(o instanceof uc)for(o=o.labelNodes;o.next();)o.value.td(b)}a.isSubGraphExpanded=!1}function hc(a,b,t,e){for(var n=a.memberParts;n.next();){var o=n.value;if(o.Pb(!0),o instanceof oc&&o.wasSubGraphExpanded&&(o.wasSubGraphExpanded=!1,hc(o,b,t,e)),o instanceof zu)o.td(b),t.jk(o,e);else if(o instanceof uc)for(o=o.labelNodes;o.next();)o.value.td(b)}a.isSubGraphExpanded=!0}function lc(){ea.call(this),this.ib=di,this.Hp=new Jt(NaN,NaN,NaN,NaN)}function uc(){yu.call(this,Fh.Link),this.Fa=8,this.Xe=null,this.Ye="",this.tf=this.bo=null,this.uf="",this.iq=null,this.Wk=Ic,this.En=0,this.Gn=Ic,this.Hn=NaN,this.ak=Dc,this.Vp=.5,this.od=null,this.Bb=(new ut).freeze(),this.sg=this.ph=null,this.Wl=new Jt,this.na=new td,this.I=this.v=this.Of=this.Xf=null,this.l=[],this.tv=new St,this.$r=this.Ox=this.Nx=null,this.Nu=NaN,this.O=null}function cc(a){var b=a.fromNode,t=a.toNode,e=null;if(e=null!==b?null!==t?b.py(t):b.containingGroup:null!==t?t.containingGroup:null,b=e,(t=a.li)!==b){null!==t&&sc(t,a),a.li=b,null!==b&&rc(b,a);var n=a.containingGroupChanged;if(null!==n){var o=!0,g=a.diagram;null!==g&&(o=g.Z,g.Z=!0),n(a,t,b),null!==g&&(g.Z=o)}!a.kd||a.Nx!==t&&a.Ox!==t||a.Ua()}if(a.isLabeledLink)for(a=a.labelNodes;a.next();)a.value.containingGroup=e}function fc(a,b){null===a.od&&(a.od=new ft),a.od.add(b),a.o()}function dc(a,b,t){if(0!==b||0!==t){for(var e=a.kd,n=new ut,o=a.Bb.iterator;o.next();){var g=o.value;n.add(new St(g.x+b,g.y+t).freeze())}n.freeze(),o=a.Bb,a.Bb=n,g=a.diagram,isNaN(b)||isNaN(t)||null!==g&&g.animationManager.sc?a.o():(a.fg.h(a.fg.x+b,a.fg.y+t),a.la.h(a.la.x+b,a.la.y+t),fa(a)),e?pc(a):(a.defaultFromPoint&&(a.defaultFromPoint=a.i(0)),a.defaultToPoint&&(a.defaultToPoint=a.i(a.pointsCount-1))),null!==g&&g.animationManager.sc&&(a.sg=n),a.g("points",o,n)}}function pc(a){0===a.Bb.count?a.kd=!1:(a.kd=!0,a.$r=null,a.Nu=NaN,a.defaultFromPoint=a.i(0),a.defaultToPoint=a.i(a.pointsCount-1),Nc(a,!1))}function rp(a,b){return Math.abs(b.x-a.x)>Math.abs(b.y-a.y)?(b.x>=a.x?b.x=a.x+9e9:b.x=a.x-9e9,b.y=a.y):(b.y>=a.y?b.y=a.y+9e9:b.y=a.y-9e9,b.x=a.x),b}function gc(a,b){var t=b.rp;return null===t&&((t=new yf).port=b,t.node=b.part,b.rp=t),vf(t,a)}function yc(a){return a===gi||.5===a.x&&.5===a.y}function mc(a){return.5===a.x&&.5===a.y?a:bi}function vc(a){if(null===a.diagram||!a.isAvoiding||!$r(a.diagram))return!1;var b=a.points.j,t=b.length;if(4>t)return!1;a=Qr(a.diagram,!0,a.containingGroup,null);for(var e=1;e<t-2;e++){var n=b[e],o=b[e+1];if(!a.Ak(Math.min(n.x,o.x),Math.min(n.y,o.y),Math.abs(n.x-o.x),Math.abs(n.y-o.y)))return!0}return!1}function xc(a,b,t,e,n,o){var g=b.vq,r=b.uq,h=of(b,t,e),l=t,c=e;for(0===n?l+=g:90===n?c+=r:180===n?l-=g:c-=r;h>ff&&of(b,l,c)===h-1;)t=l,e=c,0===n?l+=g:90===n?c+=r:180===n?l-=g:c-=r,--h;o?h>ff&&(180===n||0===n?t=Math.floor(t/g)*g+g/2:90!==n&&270!==n||(e=Math.floor(e/r)*r+r/2)):(t=Math.floor(t/g)*g+g/2,e=Math.floor(e/r)*r+r/2),h>ff&&(o=n,l=t,c=e,0===n?(o=90,c+=r):90===n?(o=180,l-=g):180===n?(o=270,c-=r):270===n&&(o=0,l+=g),of(b,l,c)===h-1?xc(a,b,l,c,o,!1):(l=t,c=e,0===n?(o=270,c-=r):90===n?(o=0,l+=g):180===n?(o=90,c+=r):270===n&&(o=180,l-=g),of(b,l,c)===h-1&&xc(a,b,l,c,o,!1))),a.xf(t,e)}function bc(a,b,t,e){return a=t-a,isNaN(a)||1/0===a||-1/0===a?NaN:(0>a&&(a=-a),b=e-b,isNaN(b)||1/0===b||-1/0===b?NaN:(0>b&&(b=-b),oe.aa(a,0)?b:oe.aa(b,0)?a:Math.sqrt(a*a+b*b)))}function wc(a,b,t,e){var n=a.pointsCount;if(2>n)return b;if(t){var o=a.i(1);if(t=o.x-e.x,o=o.y-e.y,0===(e=bc(b.x,b.y,t,o)))return b;n=2===n?.5*e:e,(a=a.computeShortLength(!0))>n&&(a=n),n=a*(o-b.y)/e,b.x+=a*(t-b.x)/e,b.y+=n}else{if(t=(o=a.i(n-2)).x-e.x,o=o.y-e.y,0===(e=bc(b.x,b.y,t,o)))return b;n=2===n?.5*e:e,(a=a.computeShortLength(!1))>n&&(a=n),n=a*(b.y-o)/e,b.x-=a*(b.x-t)/e,b.y-=n}return b}function kc(a,b,t,e){for(var n=a.pointsCount,o=b;oe.aa(b.x,o.x)&&oe.aa(b.y,o.y);){if(t>=n)return n-1;o=a.i(t++)}if(!oe.aa(b.x,o.x)&&!oe.aa(b.y,o.y))return t-1;for(var g=o;oe.aa(b.x,o.x)&&oe.aa(o.x,g.x)&&(!e||(b.y>=o.y?o.y>=g.y:o.y<=g.y))||oe.aa(b.y,o.y)&&oe.aa(o.y,g.y)&&(!e||(b.x>=o.x?o.x>=g.x:o.x<=g.x));){if(t>=n)return n-1;g=a.i(t++)}return t-2}function Mc(a,b,t,e,n,o,g){if(!g&&Pc(a)){g=[];var r=0;if(a.isVisible()&&(r=function(a,b,t,e){var n=a.diagram;if(null===n||b.w(t))return 0;for(n=n.layers;n.next();){var o=n.value;if(null!==o&&o.visible)for(var g=(o=o.Da.j).length,r=0;r<g;r++){var h=o[r];if(h instanceof uc){if(h===a)return 0<e.length&&e.sort((function(a,b){return a-b})),e.length;if(h.isVisible()&&Pc(h)){var l=h.routeBounds;l.u()&&a.routeBounds.Nc(l)&&!a.usesSamePort(h)&&(null!==(l=h.path)&&l.If()&&Sc(b,t,e,h))}}}}return 0<e.length&&e.sort((function(a,b){return a-b})),e.length}(a,n,o,g)),0<r)if(oe.A(n.y,o.y))if(n.x<o.x)for(var h=0;h<r;){var l=Math.max(n.x,Math.min(g[h++]-5,o.x-10));b.lineTo(l+t,o.y+e);for(var c=l+t,f=Math.min(l+10,o.x);h<r&&(l=g[h])<f+10;)h++,f=Math.min(l+5,o.x);l=o.y-10+e,f+=t;var p=o.y+e;a.curve===Ec?hu(b,f,p,!1):uu(b,c,l,f,l,f,p)}else for(--r;0<=r;){for(h=Math.min(n.x,Math.max(g[r--]+5,o.x+10)),b.lineTo(h+t,o.y+e),c=h+t,l=Math.max(h-10,o.x);0<=r&&(h=g[r])>l-10;)r--,l=Math.max(h-5,o.x);h=o.y-10+e,l+=t,f=o.y+e,a.curve===Ec?hu(b,l,f,!1):uu(b,c,h,l,h,l,f)}else if(oe.A(n.x,o.x))if(n.y<o.y)for(h=0;h<r;){for(l=Math.max(n.y,Math.min(g[h++]-5,o.y-10)),b.lineTo(o.x+t,l+e),c=l+e,l=Math.min(l+10,o.y);h<r&&(f=g[h])<l+10;)h++,l=Math.min(f+5,o.y);f=o.x-10+t,p=o.x+t,l+=e,a.curve===Ec?hu(b,p,l,!1):uu(b,f,c,f,l,p,l)}else for(--r;0<=r;){for(h=Math.min(n.y,Math.max(g[r--]+5,o.y+10)),b.lineTo(o.x+t,h+e),c=h+e,h=Math.max(h-10,o.y);0<=r&&(l=g[r])>h-10;)r--,h=Math.max(l-5,o.y);l=o.x-10+t,f=o.x+t,h+=e,a.curve===Ec?hu(b,f,h,!1):uu(b,l,c,l,h,f,h)}}b.lineTo(o.x+t,o.y+e)}function Sc(a,b,t,e){for(var n=oe.A(a.y,b.y),o=e.pointsCount,g=e.i(0),r=St.alloc(),h=1;h<o;h++){var l=e.i(h);if(h<o-1){var c=e.i(h+1);if(g.y===l.y&&l.y===c.y){if(l.x>g.x&&c.x>=l.x||l.x<g.x&&c.x<=l.x)continue}else if(g.x===l.x&&l.x===c.x&&(l.y>g.y&&c.y>=l.y||l.y<g.y&&c.y<=l.y))continue}t:{c=a.x;var f=a.y,p=b.x,d=b.y,q=g.x;g=g.y;var u=l.x,y=l.y;if(oe.A(c,p)){if(!oe.A(f,d)&&oe.A(g,y)&&Math.min(f,d)<g&&Math.max(f,d)>g&&Math.min(q,u)<c&&Math.max(q,u)>c&&!oe.A(q,u)){r.x=c,r.y=g,c=!0;break t}}else if(oe.A(f,d)&&oe.A(q,u)&&Math.min(c,p)<q&&Math.max(c,p)>q&&Math.min(g,y)<f&&Math.max(g,y)>f&&!oe.A(g,y)){r.x=q,r.y=f,c=!0;break t}r.x=0,r.y=0,c=!1}c&&(n?t.push(r.x):t.push(r.y)),g=l}St.free(r)}function Pc(a){return(a=a.curve)===zc||a===Ec}function Nc(a,b){(b||Pc(a))&&(null===(b=a.diagram)||b.animationManager.isTicking||b.Wg.contains(a)||0===a.Wl.width&&0===a.Wl.height||b.Wg.add(a,a.Wl.copy()))}function Cc(a,b,t){if(null!==b&&b.Xm&&b.kd&&Pc(b)){var e=b.routeBounds;e.u()&&(a.routeBounds.Nc(e)||t.Nc(e))&&(a.usesSamePort(b)||b.dc())}}function Tc(a){var b=a.Xe;if(null!==b){var t=a.tf;if(null!==t&&isNaN(a.curviness)){for(var e=a.Ye,n=a.uf,o=a=null,g=b.Za.j,r=g.length,h=0;h<r;h++){var l=g[h];(l.Xe===b&&l.Ye===e&&l.tf===t&&l.uf===n||l.Xe===t&&l.Ye===n&&l.tf===b&&l.uf===e)&&(null===o?o=l:(null===a&&(a=[]).push(o),a.push(l)))}if(null!==a){for(null===(o=Gu(b,t,e,n))&&(Vu(b,o=new tf(b,e,t,n)),Vu(t,o)),o.links=a,b=0;b<a.length;b++)a[b].Of=o;o.Am()}}}}function Lc(a){var b=a.Of;null!==b&&isNaN(a.curviness)&&(a.Of=null,0<=(a=b.links.indexOf(a))&&(B(b.links,a),b.Am()))}zu.className="Node",zu.SpreadingNone=ic,zu.SpreadingEvenly=ec,zu.SpreadingPacked=nc,m(oc,zu),oc.prototype.cloneProtected=function(a){zu.prototype.cloneProtected.call(this,a),this.P=-32769&this.P,null!==this.Ya&&(a.Ya=this.Ya.copy()),a.Oo=this.Oo,a.Qo=this.Qo,a.Ii=this.Ii,a.$p=this.$p;var b=a.vm((function(a){return a instanceof lc}));a.Ra=b instanceof lc?b:null,null!==this.lc?(a.lc=this.lc.copy(),a.lc.group=a):(null!==a.lc&&(a.lc.group=null),a.lc=null)},(n=oc.prototype).Af=function(a){zu.prototype.Af.call(this,a);var b=a.vk();for(a=a.memberParts;a.next();){var t=a.value;if(t.o(),t.C(8),t.lk(),t instanceof zu)t.td(b);else if(t instanceof uc)for(t=t.labelNodes;t.next();)t.value.td(b)}},n.Ok=function(a,b,t,e,n,o,g){if(a===Be&&"elements"===b){if(n instanceof lc)null===this.Ra?this.Ra=n:this.Ra!==n&&N("Cannot insert a second Placeholder into the visual tree of a Group.");else if(n instanceof Fh){var r=n.vm((function(a){return a instanceof lc}));r instanceof lc&&(null===this.Ra?this.Ra=r:this.Ra!==r&&N("Cannot insert a second Placeholder into the visual tree of a Group."))}}else a===Ie&&"elements"===b&&null!==this.Ra&&(e===this.Ra||e instanceof Fh&&this.Ra.Hg(e))&&(this.Ra=null);zu.prototype.Ok.call(this,a,b,t,e,n,o,g)},n.Gm=function(a,b){zu.prototype.Gm.call(this,a,b),this.isClipping&&this.type!==Fh.Spot&&((a=this.resizeObject)instanceof Fh&&(a=a.rb()),null===this.Ya&&(this.Ya=new Jt),a.lj(this.Ya),a instanceof pl&&this.Ya.Kc(-a.strokeWidth,-a.strokeWidth))},n.Hh=function(a,b,t,e){this.df=this.Ra,zu.prototype.Hh.call(this,a,b,t,e)},n.Ta=function(){var a=this;a.isSubGraphExpanded&&this.memberParts.each((function(b){!a.computesBoundsIncludingLinks&&b instanceof uc||b.Ta()})),zu.prototype.Ta.call(this)},n.qj=function(){if(!zu.prototype.qj.call(this))return!1;for(var a=this.memberParts;a.next();){var b=a.value;if(b instanceof zu){if(b.isVisible()&&Ma(b))return!1}else if(b instanceof uc&&b.isVisible()&&Ma(b)&&b.fromNode!==this&&b.toNode!==this)return!1}return!0},n.sk=function(){if(0<this.Po.count){var a=this.diagram;if(null!==a)for(var b=this.Po.copy().iterator;b.next();)a.remove(b.value)}zu.prototype.sk.call(this)},oc.prototype.canAddMembers=function(a){var b=this.diagram;if(null===b)return!1;for(b=b.commandHandler,a=ia(a).iterator;a.next();)if(!b.isValidMember(this,a.value))return!1;return!0},oc.prototype.addMembers=function(a,b){var t=this.diagram;if(null===t)return!1;t=t.commandHandler;var e=!0;for(a=ia(a).iterator;a.next();){var n=a.value;!b||t.isValidMember(this,n)?n.containingGroup=this:e=!1}return e},oc.prototype.canUngroup=function(){if(!this.ungroupable)return!1;var a=this.layer;return!(null!==a&&!a.allowUngroup)&&!(null!==(a=a.diagram)&&!a.allowUngroup)},(n=oc.prototype).td=function(a){void 0===a&&(a=null);var b=0!=(65536&this.P);if(zu.prototype.td.call(this,a),!b)for(0!=(65536&this.P)!=!0&&(this.P=65536^this.P),b=this.Pv();b.next();){var t=b.value;if(null===a||!a.contains(t)){var e=t.fromNode;null!==e&&e!==this&&e.Hd(this)&&!e.isVisible()?(Xu(t.fromPort),Xu(t.toPort),t.Ua()):null!==(e=t.toNode)&&e!==this&&e.Hd(this)&&!e.isVisible()&&(Xu(t.fromPort),Xu(t.toPort),t.Ua())}}},n.Pv=function(){var a=this.vk();a.add(this);for(var b=new ft,t=a.iterator;t.next();){var e=t.value;if(e instanceof zu)for(e=e.linksConnected;e.next();){var n=e.value;a.contains(n)||b.add(n)}}return b.iterator},n.Wz=function(){var a=this.vk();a.add(this);for(var b=new ft,t=a.iterator;t.next();){var e=t.value;if(e instanceof zu)for(e=e.linksConnected;e.next();){var n=e.value,o=n.fromNode;null===o||a.contains(o)&&o!==this||b.add(o),null===(n=n.toNode)||a.contains(n)&&n!==this||b.add(n)}}return b.iterator},n.Vz=function(){var b=new ft;return function a(b,t){null!==b&&(t.add(b),a(b.containingGroup,t))}(this,b),b},n.vk=function(){var a=new ft;return Iu(a,this,!0,0,!0),a.remove(this),a},n.Pb=function(a){zu.prototype.Pb.call(this,a);for(var b=this.memberParts;b.next();)b.value.Pb(a)},oc.prototype.collapseSubGraph=function(){var a=this.diagram;null===a||a.Je||(a.Je=!0,ac(this,this.vk(),a,this),a.Je=!1)},oc.prototype.expandSubGraph=function(){var a=this.diagram;null===a||a.Je||(a.Je=!0,hc(this,this.vk(),a,this),a.Je=!1)},oc.prototype.move=function(a,b){void 0===b&&(b=!1);var t=b?this.location:this.position,e=t.x;t=t.y;var n=a.x,o=a.y;if(!(e===n||isNaN(e)&&isNaN(n))||!(t===o||isNaN(t)&&isNaN(o))){for(e=n-(isNaN(e)?0:e),t=o-(isNaN(t)?0:t),o=St.alloc(),zu.prototype.move.call(this,a,b),a=new ft,b=this.vk().iterator;b.next();)(n=b.value)instanceof uc&&(n.suspendsRouting&&a.add(n),n.kd||n.fromNode!==this&&n.toNode!==this)&&(n.suspendsRouting=!0);for(b.reset();b.next();)if(!((n=b.value).Oh()||n instanceof zu&&n.isLinkLabel)){var g=n.position,r=n.location;g.u()?(o.x=g.x+e,o.y=g.y+t,n.position=o):r.u()&&(o.x=r.x+e,o.y=r.y+t,n.location=o)}for(b.reset();b.next();)(n=b.value)instanceof uc&&(n.suspendsRouting=a.contains(n),n.kd||n.fromNode!==this&&n.toNode!==this)&&(g=n.position,o.x=g.x+e,o.y=g.y+t,o.u()?n.move(o):n.Ua(),vc(n)&&n.Ua());St.free(o)}},v.Object.defineProperties(oc.prototype,{placeholder:{get:function(){return this.Ra}},computesBoundsAfterDrag:{get:function(){return 0!=(2048&this.P)},set:function(a){var b=0!=(2048&this.P);b!==a&&(this.P^=2048,this.g("computesBoundsAfterDrag",b,a))}},computesBoundsIncludingLinks:{get:function(){return 0!=(4096&this.P)},set:function(a){var b=0!=(4096&this.P);b!==a&&(this.P^=4096,this.g("computesBoundsIncludingLinks",b,a))}},computesBoundsIncludingLocation:{get:function(){return 0!=(8192&this.P)},set:function(a){var b=0!=(8192&this.P);b!==a&&(this.P^=8192,this.g("computesBoundsIncludingLocation",b,a))}},handlesDragDropForMembers:{get:function(){return 0!=(16384&this.P)},set:function(a){var b=0!=(16384&this.P);b!==a&&(this.P^=16384,this.g("handlesDragDropForMembers",b,a))}},memberParts:{get:function(){return this.Po.iterator}},layout:{get:function(){return this.lc},set:function(a){var b=this.lc;if(b!==a){null!==b&&(b.diagram=null,b.group=null),this.lc=a;var t=this.diagram;null!==a&&(a.diagram=t,a.group=this),null!==t&&(t.Og=!0),this.g("layout",b,a),null!==t&&t.Eb()}}},memberAdded:{get:function(){return this.Oo},set:function(a){var b=this.Oo;b!==a&&(this.Oo=a,this.g("memberAdded",b,a))}},memberRemoved:{get:function(){return this.Qo},set:function(a){var b=this.Qo;b!==a&&(this.Qo=a,this.g("memberRemoved",b,a))}},memberValidation:{get:function(){return this.Ii},set:function(a){var b=this.Ii;b!==a&&(this.Ii=a,this.g("memberValidation",b,a))}},ungroupable:{get:function(){return 0!=(256&this.P)},set:function(a){var b=0!=(256&this.P);b!==a&&(this.P^=256,this.g("ungroupable",b,a))}},isSubGraphExpanded:{get:function(){return 0!=(512&this.P)},set:function(a){var b=0!=(512&this.P);if(b!==a){this.P^=512;var t=this.diagram;if(this.g("isSubGraphExpanded",b,a),null!==(b=this.subGraphExpandedChanged)){var e=!0;null!==t&&(e=t.Z,t.Z=!0),b(this),null!==t&&(t.Z=e)}null!==t&&t.undoManager.isUndoingRedoing?(null!==this.Ra&&this.Ra.o(),this.memberParts.each((function(a){a.updateAdornments()}))):a?this.expandSubGraph():this.collapseSubGraph()}}},wasSubGraphExpanded:{get:function(){return 0!=(1024&this.P)},set:function(a){var b=0!=(1024&this.P);b!==a&&(this.P^=1024,this.g("wasSubGraphExpanded",b,a))}},subGraphExpandedChanged:{get:function(){return this.$p},set:function(a){var b=this.$p;b!==a&&(this.$p=a,this.g("subGraphExpandedChanged",b,a))}},Qh:{get:function(){return 0!=(32768&this.P)},set:function(a){0!=(32768&this.P)!==a&&(this.P^=32768)}}}),oc.prototype.expandSubGraph=oc.prototype.expandSubGraph,oc.prototype.collapseSubGraph=oc.prototype.collapseSubGraph,oc.prototype.findSubGraphParts=oc.prototype.vk,oc.prototype.findContainingGroupChain=oc.prototype.Vz,oc.prototype.findExternalNodesConnected=oc.prototype.Wz,oc.prototype.findExternalLinksConnected=oc.prototype.Pv,oc.prototype.ensureBounds=oc.prototype.Ta,oc.className="Group",m(lc,ea),lc.prototype.cloneProtected=function(a){ea.prototype.cloneProtected.call(this,a),a.ib=this.ib.G(),a.Hp=this.Hp.copy()},lc.prototype.Jh=function(a){if(null===this.background&&null===this.areaBackground)return!1;var b=this.naturalBounds;return oi(0,0,b.width,b.height,a.x,a.y)},lc.prototype.Fm=function(){var a=this.part;if(null!==a&&(a instanceof oc||a instanceof Eu)||N("Placeholder is not inside a Group or Adornment."),a instanceof oc){var b=this.computeBorder(this.Hp),t=this.minSize,e=this.rc;for(Zt(e,(isFinite(t.width)?Math.max(t.width,b.width):b.width)||0,(isFinite(t.height)?Math.max(t.height,b.height):b.height)||0),ra(this,0,0,e.width,e.height),e=a.memberParts,t=!1;e.next();)if(e.value.isVisible()){t=!0;break}e=a.diagram,!t||null===e||e.animationManager.cw(a)||isNaN(b.x)||isNaN(b.y)||((t=St.alloc()).sj(b,a.locationSpot),t.w(a.location)||(a.location=new St(t.x,t.y)),St.free(t))}else{b=this.rc,e=(t=this.ib).left+t.right;var n=t.top+t.bottom,o=a.adornedObject;a.angle=o.kj();var g=0;o instanceof pl&&(g=o.strokeWidth);var r=o.Cf(),h=o.naturalBounds,l=(h.width+g)*r;g=(h.height+g)*r,a.type!==Fh.Link&&(o=o.da("Selection"===a.category?yi:a.locationSpot,St.alloc()),a.location=o,St.free(o)),isNaN(l)||isNaN(g)?(l=(a=a.adornedObject).da(yi,St.alloc()),(o=Jt.allocAt(l.x,l.y,0,0)).Oe(a.da(Si,l)),o.Oe(a.da(vi,l)),o.Oe(a.da(ki,l)),Zt(b,o.width+e||0,o.height+n||0),ra(this,-t.left,-t.top,b.width,b.height),St.free(l),Jt.free(o)):(Zt(b,l+e||0,g+n||0),ra(this,-t.left,-t.top,b.width,b.height))}},lc.prototype.Hh=function(a,b,t,e){this.actualBounds.h(a,b,t,e)},lc.prototype.computeBorder=function(a){var b=this.part,t=b.diagram;if(null!==t&&b instanceof oc&&!b.layer.isTemporary&&b.computesBoundsAfterDrag&&this.Hp.u()){var e=t.toolManager.findTool("Dragging");if(e===t.currentTool&&null!==(t=e.computeBorder(b,this.Hp,a)))return t}t=Jt.alloc(),e=this.computeMemberBounds(t);var n=this.ib;return b instanceof oc&&!b.isSubGraphExpanded?a.h(e.x-n.left,e.y-n.top,0,0):a.h(e.x-n.left,e.y-n.top,Math.max(e.width+n.left+n.right,0),Math.max(e.height+n.top+n.bottom,0)),Jt.free(t),b instanceof oc&&b.computesBoundsIncludingLocation&&b.location.u()&&a.Oe(b.location),a},lc.prototype.computeMemberBounds=function(a){if(!(this.part instanceof oc))return a.h(0,0,0,0),a;for(var b=this.part,t=1/0,e=1/0,n=-1/0,o=-1/0,g=b.memberParts;g.next();){var r=g.value;if(r.isVisible()){if(r instanceof uc){if(!b.computesBoundsIncludingLinks)continue;if(wa(r))continue;if(r.fromNode===b||r.toNode===b)continue}(r=r.actualBounds).left<t&&(t=r.left),r.top<e&&(e=r.top),r.right>n&&(n=r.right),r.bottom>o&&(o=r.bottom)}}return isFinite(t)&&isFinite(e)?a.h(t,e,n-t,o-e):(b=b.location,a.h(b.x,b.y,0,0)),a},v.Object.defineProperties(lc.prototype,{padding:{get:function(){return this.ib},set:function(a){"number"==typeof a&&(a=new ui(a));var b=this.ib;b.w(a)||(this.ib=a=a.G(),this.g("padding",b,a),this.o())}}}),lc.className="Placeholder",m(uc,yu),uc.prototype.cloneProtected=function(a){yu.prototype.cloneProtected.call(this,a),a.Fa=-113&this.Fa,a.Ye=this.Ye,a.bo=this.bo,a.uf=this.uf,a.iq=this.iq,a.Wk=this.Wk,a.En=this.En,a.Gn=this.Gn,a.Hn=this.Hn,a.ak=this.ak,a.Vp=this.Vp,null!==this.O&&(a.O=this.O.copy())},(n=uc.prototype).Af=function(a){yu.prototype.Af.call(this,a),this.Ye=a.Ye,this.uf=a.uf,a.ph=null,a.Ua(),a.Of=this.Of;var b=a.fromPort;null!==b&&Xu(b),null!==(a=a.toPort)&&Xu(a)},n.jb=function(a){a.classType===uc?2==(2&a.value)?this.routing=a:a===Rc||a===Ec||a===zc?this.curve=a:a===Vc||a===Gc||a===Yc?this.adjusting=a:a!==Dc&&a!==Ic&&N("Unknown Link enum value for a Link property: "+a):yu.prototype.jb.call(this,a)},n.Lc=function(){null===this.O&&(this.O=new bf)},n.qj=function(){var a=this.fromNode;if(null!==a){var b=a.findVisibleNode();if(null!==b&&(a=b),Ma(a)||Cu(a))return!1}return null===(a=this.toNode)||(null!==(b=a.findVisibleNode())&&(a=b),!Ma(a)&&!Cu(a))},n.Ew=function(){return!1},n.ju=function(){},n.Oc=function(){return!1},uc.prototype.computeAngle=function(a,b,t){return uc.computeAngle(b,t)},uc.computeAngle=function(a,b){switch(a){default:case Ic:a=0;break;case Xc:a=b;break;case qc:a=b+90;break;case Uc:a=b-90;break;case Kc:a=b+180;break;case Hc:90<(a=oe.Rq(b))&&270>a&&(a-=180);break;case Wc:90<(a=oe.Rq(b+90))&&270>a&&(a-=180);break;case Jc:90<(a=oe.Rq(b-90))&&270>a&&(a-=180);break;case Zc:if(45<(a=oe.Rq(b))&&135>a||225<a&&315>a)return 0;90<a&&270>a&&(a-=180)}return oe.Rq(a)},(n=uc.prototype).Nh=function(){var a=this.containingGroup;null!==a&&this.fromNode!==a&&this.toNode!==a&&a.computesBoundsIncludingLinks&&yu.prototype.Nh.call(this)},n.Gq=function(a){var b=this.fromNode;return a===b?this.toNode:b},n.nA=function(a){var b=this.fromPort;return a===b?this.toPort:b},n.Iq=function(a){if(yu.prototype.Iq.call(this,a),Pc(this)&&this.Lq(this.actualBounds),!a){var b=null;null!==(a=this.Xe)&&Uu(a,this,b=this.fromPort);var t=this.tf;if(null!==t){var e=this.toPort;t===a&&e===b||Uu(t,this,e)}Tc(this)}},n.Jq=function(a){if(yu.prototype.Jq.call(this,a),Pc(this)&&this.Lq(this.actualBounds),!a){var b=null;null!==(a=this.Xe)&&Ku(a,this,b=this.fromPort);var t=this.tf;if(null!==t){var e=this.toPort;t===a&&e===b||Ku(t,this,e)}Lc(this)}},n.sk=function(){if(this.kd=!0,null!==this.od){var a=this.diagram;if(null!==a)for(var b=this.od.copy().iterator;b.next();)a.remove(b.value)}null!==this.data&&(null!==(a=this.diagram)&&a.partManager.removeDataForLink(this))},uc.prototype.updateRelationshipsFromData=function(){if(null!==this.data){var a=this.diagram;null!==a&&a.partManager.updateRelationshipsFromData(this)}},uc.prototype.move=function(a,b){var t=b?this.location:this.position,e=t.x;isNaN(e)&&(e=0);var n=t.y;for(isNaN(n)&&(n=0),e=a.x-e,n=a.y-n,!0===b?yu.prototype.move.call(this,a,!1):(a=St.allocAt(t.x+e,t.y+n),yu.prototype.move.call(this,a,!1),St.free(a)),dc(this,e,n),a=this.labelNodes;a.next();)t=(b=a.value).position,b.moveTo(t.x+e,t.y+n)},uc.prototype.canRelinkFrom=function(){if(!this.relinkableFrom)return!1;var a=this.layer;return null===a||!!a.allowRelink&&!(null!==(a=a.diagram)&&!a.allowRelink)},uc.prototype.canRelinkTo=function(){if(!this.relinkableTo)return!1;var a=this.layer;return null===a||!!a.allowRelink&&!(null!==(a=a.diagram)&&!a.allowRelink)},uc.prototype.computeMidPoint=function(a){var b=this.pointsCount;if(0===b)return a.assign(It),a;if(1===b)return a.assign(this.i(0)),a;if(2===b){var t=this.i(0),e=this.i(1);return a.h((t.x+e.x)/2,(t.y+e.y)/2),a}if(this.isOrthogonal&&(15<=this.computeCorner()||this.computeCurve()===Rc))return this.na.Vv(.5,a),a.add(this.i(0)),t=this.na.figures.first(),a.offset(-t.startX,-t.startY),a;if(this.computeCurve()===Rc){if(3===b)return this.i(1);if(t=3*((e=(b-1)/3|0)/2|0),1==e%2){e=this.i(t);var n=this.i(t+1),o=this.i(t+2);t=this.i(t+3),oe.yz(e.x,e.y,n.x,n.y,o.x,o.y,t.x,t.y,a)}else a.assign(this.i(t));return a}var g=this.flattenedLengths;for(t=this.flattenedTotalLength,n=o=e=0;e<t/2&&o<b&&!(e+(n=g[o])>t/2);)e+=n,o++;return b=this.i(o),o=this.i(o+1),1>Math.abs(b.x-o.x)?b.y>o.y?a.h(b.x,b.y-(t/2-e)):a.h(b.x,b.y+(t/2-e)):1>Math.abs(b.y-o.y)?b.x>o.x?a.h(b.x-(t/2-e),b.y):a.h(b.x+(t/2-e),b.y):(t=(t/2-e)/n,a.h(b.x+t*(o.x-b.x),b.y+t*(o.y-b.y))),a},uc.prototype.computeMidAngle=function(){var a=this.pointsCount;if(2>a)return NaN;if(2===a)return this.i(0).Sa(this.i(1));if(this.isOrthogonal&&(15<=this.computeCorner()||this.computeCurve()===Rc))return this.na.wy(.5);if(this.computeCurve()===Rc&&4<=a){var b=(a-1)/3|0,t=3*(b/2|0);if(1==b%2){t=Math.floor(t),a=this.i(t),b=this.i(t+1);var e=this.i(t+2);return t=this.i(t+3),oe.xz(a.x,a.y,b.x,b.y,e.x,e.y,t.x,t.y)}if(0<t&&t+1<a)return this.i(t-1).Sa(this.i(t+1))}b=this.flattenedLengths,e=this.flattenedTotalLength;var n,o=0;for(t=0;o<e/2&&t<a&&!(o+(n=b[t])>e/2);)o+=n,t++;if(b=this.i(t),e=this.i(t+1),1>Math.abs(b.x-e.x)&&1>Math.abs(b.y-e.y)){if(0<t&&t+2<a)return this.i(t-1).Sa(this.i(t+2))}else{if(1>Math.abs(b.x-e.x))return b.y>e.y?270:90;if(1>Math.abs(b.y-e.y))return b.x>e.x?180:0}return b.Sa(e)},(n=uc.prototype).i=function(a){return this.Bb.j[a]},n.Rc=function(a,b){this.Bb.Qc(a,b)},n.L=function(a,b,t){this.Bb.Qc(a,new St(b,t))},n.wA=function(a,b){this.Bb.wb(a,b)},n.m=function(a,b,t){this.Bb.wb(a,new St(b,t))},n.$d=function(a){this.Bb.add(a)},n.xf=function(a,b){this.Bb.add(new St(a,b))},n.tw=function(a){this.Bb.cb(a)},n.mk=function(){this.Bb.clear()},n.Sh=function(){null===this.ph&&(this.ph=this.Bb,this.Bb=this.Bb.copy())},n.zf=function(){if(null!==this.ph){for(var a=this.ph,b=this.Bb,t=1/0,e=1/0,n=a.j,o=n.length,g=0;g<o;g++){var r=n[g];t=Math.min(r.x,t),e=Math.min(r.y,e)}r=g=1/0;for(var h=b.j,l=h.length,c=0;c<l;c++){var f=h[c];g=Math.min(f.x,g),r=Math.min(f.y,r),f.freeze()}if(b.freeze(),l===o){for(o=0;o<l;o++)if(c=n[o],f=h[o],c.x-t!=f.x-g||c.y-e!=f.y-r){this.dc();break}}else this.dc();this.ph=null,null!==(t=this.diagram)&&t.animationManager.sc&&(this.sg=b),pc(this),this.g("points",a,b)}},n.yw=function(){null!==this.ph&&(this.Bb=this.ph,this.ph=null)},n.Ua=function(){if(!this.suspendsRouting){var a=this.diagram;if(a){if(a.Wt.contains(this)||a.undoManager.isUndoingRedoing)return;if((a=a.animationManager).isTicking&&!a.isAnimating)return;null!==this.sg&&!a.isTicking&&a.isAnimating&&(this.sg=null)}null!==(a=this.path)&&(this.kd=!1,this.o(),a.o())}},n.wj=function(){if(!this.kd&&!this.At){var a=!0;try{this.At=!0,this.Sh(),a=this.computePoints()}catch(t){this.At=!1,this.yw()}finally{this.At=!1,a?this.zf():this.yw()}}},uc.prototype.computePoints=function(){if(null===this.diagram)return!1;var a=this.fromNode,b=null;if(null===a?(Ac||((Ac=new zu).desiredSize=Rt,Ac.Ta()),this.defaultFromPoint&&(Ac.location=this.defaultFromPoint,Ac.Ta(),b=a=Ac)):b=this.fromPort,null!==b&&!a.isVisible()){var t=a.findVisibleNode();null!==t&&t!==a?(a=t,b=t.port):a=t}if(this.Nx=a,null===a||!a.location.u())return!1;for(;!(null===b||b.actualBounds.u()&&b.If());)b=b.panel;if(null===b)return!1;var e=this.toNode,n=null;if(null===e?(jc||((jc=new zu).desiredSize=Rt,jc.Ta()),this.defaultToPoint&&(jc.location=this.defaultToPoint,jc.Ta(),n=e=jc)):n=this.toPort,null===n||e.isVisible()||(null!==(t=e.findVisibleNode())&&t!==e?(e=t,n=t.port):e=t),this.Ox=e,null===e||!e.location.u())return!1;for(;!(null===n||n.actualBounds.u()&&n.If());)n=n.panel;if(null===n)return!1;var o=this.pointsCount,g=this.computeSpot(!0,b);t=this.computeSpot(!1,n);var r=yc(g),h=yc(t),l=b===n&&null!==b,c=this.isOrthogonal,f=this.curve===Rc;this.Xf=!(!l||c)&&(f=!0);var p=this.computeAdjusting()===Ic||l;if(!c&&!l&&r&&h){if(r=!1,!p&&3<=o&&(p=this.getLinkPoint(a,b,g,!0,!1,e,n),h=this.getLinkPoint(e,n,t,!1,!1,a,b),r=this.adjustPoints(0,p,o-1,h))&&(p=this.getLinkPoint(a,b,g,!0,!1,e,n),h=this.getLinkPoint(e,n,t,!1,!1,a,b),this.adjustPoints(0,p,o-1,h)),!r)if(this.mk(),f){o=this.getLinkPoint(a,b,g,!0,!1,e,n),r=(p=this.getLinkPoint(e,n,t,!1,!1,a,b)).x-o.x,h=p.y-o.y,l=this.computeCurviness(),f=c=0;var d=o.x+r/3,q=o.y+h/3,u=d,y=q;oe.A(h,0)?y=0<r?y-l:y+l:(c=-r/h,f=Math.sqrt(l*l/(c*c+1)),0>l&&(f=-f),y=c*((u=(0>h?-1:1)*f+d)-d)+q);var m=d=o.x+2*r/3,v=q=o.y+2*h/3;oe.A(h,0)?v=0<r?v-l:v+l:v=c*((m=(0>h?-1:1)*f+d)-d)+q,this.mk(),this.$d(o),this.xf(u,y),this.xf(m,v),this.$d(p),this.Rc(0,this.getLinkPoint(a,b,g,!0,!1,e,n)),this.Rc(3,this.getLinkPoint(e,n,t,!1,!1,a,b))}else o=e,p=n,e=this.getLinkPoint(a,b,g,!0,!1,o,p),n=this.getLinkPoint(o,p,t,!1,!1,a,b),this.hasCurviness()?(p=n.x-e.x,t=n.y-e.y,g=this.computeCurviness(),o=a=e.x+p/2,r=b=e.y+t/2,oe.A(t,0)?r=0<p?r-g:r+g:(p=-p/t,o=Math.sqrt(g*g/(p*p+1)),0>g&&(o=-o),r=p*((o=(0>t?-1:1)*o+a)-a)+b),this.$d(e),this.xf(o,r),this.$d(n)):(this.$d(e),this.$d(n),r=Jt.alloc(),b.lj(r),h=r.$(n),p.lj(r),l=r.$(e),(h||l)&&(g=b.da(mc(g),new St),this.Rc(0,this.getLinkPointFromPoint(a,b,g,n,!0,g)),t=p.da(mc(t),new St),this.Rc(1,this.getLinkPointFromPoint(o,p,t,e,!1,t))),Jt.free(r))}else{f=this.isAvoiding,p&&(c&&f||l)&&this.mk();var x=l?this.computeCurviness():0;f=this.getLinkPoint(a,b,g,!0,c,e,n),d=u=q=0,(c||!r||l)&&(y=this.computeEndSegmentLength(a,b,g,!0),d=this.getLinkDirection(a,b,f,g,!0,c,e,n),l&&(r||g.w(t)||!c&&1===g.x+t.x&&1===g.y+t.y)&&(d-=c?90:30,0>x&&(d-=180)),0>d?d+=360:360<=d&&(d-=360),l&&(y+=Math.abs(x)*(c?1:2)),0===d?q=y:90===d?u=y:180===d?q=-y:270===d?u=-y:(q=y*Math.cos(d*Math.PI/180),u=y*Math.sin(d*Math.PI/180)),g.nc()&&l&&(y=b.da(bi,St.alloc()),m=St.allocAt(y.x+1e3*q,y.y+1e3*u),this.getLinkPointFromPoint(a,b,y,m,!0,f),St.free(y),St.free(m))),y=this.getLinkPoint(e,n,t,!1,c,a,b);var w=v=m=0;if(c||!h||l){var k=this.computeEndSegmentLength(e,n,t,!1);w=this.getLinkDirection(e,n,y,t,!1,c,a,b),l&&(h||g.w(t)||!c&&1===g.x+t.x&&1===g.y+t.y)&&(w+=c?0:30,0>x&&(w+=180)),0>w?w+=360:360<=w&&(w-=360),l&&(k+=Math.abs(x)*(c?1:2)),0===w?m=k:90===w?v=k:180===w?m=-k:270===w?v=-k:(m=k*Math.cos(w*Math.PI/180),v=k*Math.sin(w*Math.PI/180)),t.nc()&&l&&(t=n.da(bi,St.alloc()),g=St.allocAt(t.x+1e3*m,t.y+1e3*v),this.getLinkPointFromPoint(e,n,t,g,!1,y),St.free(t),St.free(g))}t=f,(c||!r||l)&&(t=new St(f.x+q,f.y+u)),g=y,(c||!h||l)&&(g=new St(y.x+m,y.y+v)),!p&&!c&&r&&3<o&&this.adjustPoints(0,f,o-2,g)?this.Rc(o-1,y):!p&&!c&&h&&3<o&&this.adjustPoints(1,t,o-1,y)?this.Rc(0,f):!p&&(c?6<=o:4<o)&&this.adjustPoints(1,t,o-2,g)?(this.Rc(0,f),this.Rc(o-1,y)):(this.mk(),this.$d(f),(c||!r||l)&&this.$d(t),c&&this.addOrthoPoints(t,d,g,w,a,e),(c||!h||l)&&this.$d(g),this.$d(y))}return!0},uc.prototype.getLinkPointFromPoint=function(a,b,t,e,n,o){if(void 0===o&&(o=new St),null===a||null===b)return o.assign(t),o;if(a.isVisible()||null!==(n=a.findVisibleNode())&&n!==a&&(b=n.port),a=null,null===(n=b.panel)||n.fe()||(n=n.panel),null===n){n=e.x,e=e.y;var g=t.x;t=t.y}else{n=1/((a=n.Ed).m11*a.m22-a.m12*a.m21),g=a.m22*n;var r=-a.m12*n,h=-a.m21*n,l=a.m11*n,c=n*(a.m21*a.dy-a.m22*a.dx),f=n*(a.m12*a.dx-a.m11*a.dy);n=e.x*g+e.y*h+c,e=e.x*r+e.y*l+f,g=t.x*g+t.y*h+c,t=t.x*r+t.y*l+f}return b.wk(n,e,g,t,o),null!==a&&o.transform(a),o},uc.prototype.getLinkPoint=function(a,b,t,e,n,o,g,r){if(void 0===r&&(r=new St),t.kb()&&!yc(t))return b.da(t,r),r;if(t.Pc()){var h=gc(this,b);if(null!==h){if(r.assign(h.Oq),n&&this.routing===Bc){var l=gc(this,g);if(null!==l&&h.tm<l.tm){h=St.alloc(),l=St.alloc();var c=new Jt(b.da(yi,h),b.da(Si,l)),f=this.computeSpot(!e,g);a=this.getLinkPoint(o,g,f,!e,n,a,b,l),(t.Gf(Ni)||t.Gf(Ci))&&a.y>=c.y&&a.y<=c.y+c.height?r.y=a.y:(t.Gf(Pi)||t.Gf(Ti))&&a.x>=c.x&&a.x<=c.x+c.width&&(r.x=a.x),St.free(h),St.free(l)}}return r}}return t=b.da(mc(t),St.alloc()),this.pointsCount>(n?6:2)?(g=e?this.i(1):this.i(this.pointsCount-2),n&&(g=rp(t,g.copy()))):(h=this.computeSpot(!e,g),o=St.alloc(),g=g.da(mc(h),o),n&&(g=rp(t,g)),St.free(o)),this.getLinkPointFromPoint(a,b,t,g,e,r),St.free(t),r},uc.prototype.getLinkDirection=function(a,b,t,e,n,o,g,r){t:if(e.kb())var h=e.x>e.y?e.x>1-e.y?0:e.x<1-e.y?270:315:e.x<e.y?e.x>1-e.y?90:e.x<1-e.y?180:135:.5>e.x?225:.5<e.x?45:0;else{if(e.Pc()&&null!==(h=gc(this,b)))switch(h.Bc){case 1:h=270;break t;case 2:h=180;break t;default:case 4:h=0;break t;case 8:h=90;break t}h=b.da(bi,St.alloc()),this.pointsCount>(o?6:2)?(r=n?this.i(1):this.i(this.pointsCount-2),r=o?rp(h,r.copy()):t):(t=St.alloc(),r=r.da(bi,t),St.free(t)),t=Math.abs(r.x-h.x)>Math.abs(r.y-h.y)?r.x>=h.x?0:180:r.y>=h.y?90:270,St.free(h),h=t}return e.nc()&&g.Hd(a)&&(360<=(h+=180)&&(h-=360)),yc(e)||0===(a=b.kj())||(45<=a&&135>a?h+=90:135<=a&&225>a?h+=180:225<=a&&315>a&&(h+=270),360<=h&&(h-=360)),h},uc.prototype.computeEndSegmentLength=function(a,b,t,e){return null!==b&&t.Pc()&&null!==(a=gc(this,b))?a.Nv:(a=e?this.fromEndSegmentLength:this.toEndSegmentLength,null!==b&&isNaN(a)&&(a=e?b.fromEndSegmentLength:b.toEndSegmentLength),isNaN(a)&&(a=10),a)},uc.prototype.computeSpot=function(a,b){return void 0===b&&(b=null),a?null===(a=b||this.fromPort)?a=bi:((b=this.fromSpot).Nb()&&(b=a.fromSpot),a=b===Vi?gi:b):null===(a=b||this.toPort)?a=bi:((b=this.toSpot).Nb()&&(b=a.toSpot),a=b===Vi?gi:b),a},uc.prototype.computeOtherPoint=function(a,b){return this.computeAdjusting()!==Ic&&4<this.pointsCount?this.computeMidPoint(new St):(a=b.da(bi),null!==(b=null!==(b=b.rp)?vf(b,this):null)&&(a=b.Oq),a)},uc.prototype.computeShortLength=function(a){if(a){if(a=this.fromShortLength,isNaN(a)){var b=this.fromPort;null!==b&&(a=b.fromShortLength)}return isNaN(a)?0:a}return a=this.toShortLength,isNaN(a)&&(null!==(b=this.toPort)&&(a=b.toShortLength)),isNaN(a)?0:a},uc.prototype.Bf=function(a,b,t,e,n,o){if(!1===this.pickable)return!1;void 0===b&&(b=null),void 0===t&&(t=null);var g=o;if(void 0===o&&(g=ee.alloc()).reset(),g.multiply(this.transform),this.Ih(a,g))return Kh(this,b,t,n),void 0===o&&ee.free(g),!0;if(this.Nc(a,g)){var r=!1;if(!this.isAtomic)for(var h=this.W.j,l=h.length;l--;){var c=h[l];if(c.visible||c===this.locationObject){var f=c.actualBounds,p=this.naturalBounds;if(!(f.x>p.width||f.y>p.height||0>f.x+f.width||0>f.y+f.height)){if((f=ee.alloc()).set(g),c instanceof Fh)r=c.Bf(a,b,t,e,n,f);else if(this.path===c){if(c instanceof pl)if(r=a,p=e,!1===c.pickable)r=!1;else if(f.multiply(c.transform),p)t:{var d=r,q=f;if(c.Ih(d,q))r=!0;else{if(void 0===q&&(q=c.transform,d.Ee(c.actualBounds))){r=!0;break t}r=d.left,p=d.right;var u=d.top;d=d.bottom;var y=St.alloc(),m=St.alloc(),v=St.alloc(),x=ee.alloc();x.set(q),x.hw(c.transform),x.Rt(),m.x=p,m.y=u,m.transform(x),y.x=r,y.y=u,y.transform(x),q=!1,xl(c,y,m,v)?q=!0:(y.x=p,y.y=d,y.transform(x),xl(c,y,m,v)?q=!0:(m.x=r,m.y=d,m.transform(x),xl(c,y,m,v)?q=!0:(y.x=r,y.y=u,y.transform(x),xl(c,y,m,v)&&(q=!0)))),ee.free(x),St.free(y),St.free(m),St.free(v),r=q}}else r=c.Ih(r,f)}else r=sa(c,a,e,f);r&&(p=c,null!==b&&(p=b(c)),p&&(null===t||t(p))&&n.add(p)),ee.free(f)}}}return void 0===o&&ee.free(g),r||null!==this.background||null!==this.areaBackground}return void 0===o&&ee.free(g),!1},uc.prototype.computeCurve=function(){if(null===this.Xf){var a=this.fromPort,b=this.isOrthogonal;this.Xf=null!==a&&a===this.toPort&&!b}return this.Xf?Rc:this.curve},uc.prototype.computeCorner=function(){if(this.curve===Rc)return 0;var a=this.corner;return(isNaN(a)||0>a)&&(a=10),a},uc.prototype.findMidLabel=function(){for(var a=this.path,b=this.W.j,t=b.length,e=0;e<t;e++){var n=b[e];if(n!==a&&!n.isPanelMain&&(-1/0===n.segmentIndex||isNaN(n.segmentIndex)))return n}for(a=this.labelNodes;a.next();)if(-1/0===(b=a.value).segmentIndex||isNaN(b.segmentIndex))return b;return null},uc.prototype.computeSpacing=function(){if(!this.isVisible())return 0;var a=Qc;a=Math.max(a,this.computeThickness());var b=this.fromPort,t=this.toPort;if(null!==b&&null!==t){var e=this.findMidLabel();if(null!==e){var n=e.naturalBounds,o=e.margin,g=isNaN(n.width)?30:n.width*e.scale+o.left+o.right;n=isNaN(n.height)?14:n.height*e.scale+o.top+o.bottom,(e=e.segmentOrientation)===Xc||e===Hc||e===Kc?a=Math.max(a,n):e===Uc||e===Jc||e===qc||e===Wc?a=Math.max(a,g):(b=b.da(bi).Sa(t.da(bi))/180*Math.PI,a=Math.max(a,Math.abs(Math.sin(b)*g)+Math.abs(Math.cos(b)*n)+1)),this.curve===Rc&&(a*=1.333)}}return a},uc.prototype.arrangeBundledLinks=function(a,b){if(b)for(b=0;b<a.length;b++){var t=a[b];t.computeAdjusting()===Ic&&t.Ua()}},uc.prototype.computeCurviness=function(){var a=this.curviness;if(isNaN(a)){a=$c;var b=this.Of;if(null!==b){for(var t=I(),e=0,n=b.links,o=0;o<n.length;o++){var g=n[o].computeSpacing();t.push(g),e+=g}for(e=-e/2,o=0;o<n.length;o++){if(n[o]===this){a=e+t[o]/2;break}e+=t[o]}b.Zt===this.fromNode&&(a=-a),R(t)}}return a},uc.prototype.computeThickness=function(){if(!this.isVisible())return 0;var a=this.path;return null!==a?Math.max(a.strokeWidth,1):1},uc.prototype.hasCurviness=function(){return!isNaN(this.curviness)||null!==this.Of},uc.prototype.adjustPoints=function(a,b,t,e){var n=this.computeAdjusting();if(this.isOrthogonal){if(n===Gc)return!1;n===Yc&&(n=Vc)}switch(n){case Gc:var o=this.i(a),g=this.i(t);if(!o.Na(b)||!g.Na(e)){n=o.x,o=o.y;var r=g.x-n,h=g.y-o,l=Math.sqrt(r*r+h*h);if(!oe.aa(l,0)){if(oe.aa(r,0))var c=0>h?-Math.PI/2:Math.PI/2;else c=Math.atan(h/Math.abs(r)),0>r&&(c=Math.PI-c);g=b.x;var f=b.y;r=e.x-g;var p=e.y-f;for(h=Math.sqrt(r*r+p*p),oe.aa(r,0)?p=0>p?-Math.PI/2:Math.PI/2:(p=Math.atan(p/Math.abs(r)),0>r&&(p=Math.PI-p)),l=h/l,c=p-c,this.Rc(a,b),a+=1;a<t;a++)r=(b=this.i(a)).x-n,h=b.y-o,b=Math.sqrt(r*r+h*h),oe.aa(b,0)||(oe.aa(r,0)?h=0>h?-Math.PI/2:Math.PI/2:(h=Math.atan(h/Math.abs(r)),0>r&&(h=Math.PI-h)),r=h+c,b*=l,this.L(a,g+b*Math.cos(r),f+b*Math.sin(r)));this.Rc(t,e)}}return!0;case Yc:if(o=this.i(a),f=this.i(t),!o.Na(b)||!f.Na(e)){n=o.x,o=o.y,l=((g=f.x)-n)*(g-n)+((f=f.y)-o)*(f-o),r=b.x,c=b.y,h=e.x,p=e.y;var d=1;if(0!=h-r){var q=(p-c)/(h-r);d=Math.sqrt(1+1/(q*q))}else q=9e9;for(this.Rc(a,b),a+=1;a<t;a++){var u=(b=this.i(a)).x,y=b.y,m=.5;0!==l&&(m=((n-u)*(n-g)+(o-y)*(o-f))/l);var v=n+m*(g-n),x=o+m*(f-o);b=Math.sqrt((u-v)*(u-v)+(y-x)*(y-x)),y<q*(u-v)+x&&(b=-b),0<q&&(b=-b),u=r+m*(h-r),m=c+m*(p-c),0!==q?(b=u+b/d,this.L(a,b,m-(b-u)/q)):this.L(a,u,m+b)}this.Rc(t,e)}return!0;case Vc:return this.isOrthogonal&&(n=this.i(a),o=this.i(a+1),g=this.i(a+2),f=r=o.x,l=c=o.y,oe.A(n.y,o.y)?oe.A(o.x,g.x)?c=b.y:oe.A(o.y,g.y)&&(r=b.x):oe.A(n.x,o.x)&&(oe.A(o.y,g.y)?r=b.x:oe.A(o.x,g.x)&&(c=b.y)),this.L(a+1,r,c),n=this.i(t),o=this.i(t-1),g=this.i(t-2),h=r=o.x,p=c=o.y,oe.A(n.y,o.y)?oe.A(o.x,g.x)?c=e.y:oe.A(o.y,g.y)&&(r=e.x):oe.A(n.x,o.x)&&(oe.A(o.y,g.y)?r=e.x:oe.A(o.x,g.x)&&(c=e.y)),this.L(t-1,r,c),vc(this))?(this.L(a+1,f,l),this.L(t-1,h,p),t=!1):(this.Rc(a,b),this.Rc(t,e),t=!0),t;default:return!1}},uc.prototype.addOrthoPoints=function(a,b,t,e,n,o){b=-45<=b&&45>b?0:45<=b&&135>b?90:135<=b&&225>b?180:270,e=-45<=e&&45>e?0:45<=e&&135>e?90:135<=e&&225>e?180:270;var g=n.actualBounds.copy(),r=o.actualBounds.copy();if(g.u()&&r.u()){if(g.Kc(_c,_c),r.Kc(_c,_c),g.Oe(a),r.Oe(t),0===b)if(t.x>a.x||270===e&&t.y<a.y&&r.right>a.x||90===e&&t.y>a.y&&r.right>a.x){var h=new St(t.x,a.y),l=new St(t.x,(a.y+t.y)/2);180===e?(h.x=this.computeMidOrthoPosition(a.x,a.y,t.x,t.y,!1),l.x=h.x,l.y=t.y):270===e&&t.y<a.y||90===e&&t.y>a.y?(h.x=a.x<r.left?this.computeMidOrthoPosition(a.x,a.y,r.left,t.y,!1):a.x<r.right&&(270===e&&a.y<r.top||90===e&&a.y>r.bottom)?this.computeMidOrthoPosition(a.x,a.y,t.x,t.y,!1):r.right,l.x=h.x,l.y=t.y):0===e&&a.x<r.left&&a.y>r.top&&a.y<r.bottom&&(h.x=a.x,h.y=a.y<t.y?Math.min(t.y,r.top):Math.max(t.y,r.bottom),l.y=h.y)}else h=new St(a.x,t.y),l=new St((a.x+t.x)/2,t.y),(180===e||90===e&&t.y<g.top||270===e&&t.y>g.bottom)&&(180===e&&(r.$(a)||g.$(t))?h.y=this.computeMidOrthoPosition(a.x,a.y,t.x,t.y,!0):t.y<a.y&&(180===e||90===e)?h.y=this.computeMidOrthoPosition(a.x,g.top,t.x,Math.max(t.y,r.bottom),!0):t.y>a.y&&(180===e||270===e)&&(h.y=this.computeMidOrthoPosition(a.x,g.bottom,t.x,Math.min(t.y,r.top),!0)),l.x=t.x,l.y=h.y),h.y>g.top&&h.y<g.bottom&&(t.x>=g.left&&t.x<=a.x||a.x<=r.right&&a.x>=t.x?90!==e&&270!==e||(h=new St(Math.max((a.x+t.x)/2,a.x),a.y),l=new St(h.x,t.y)):(h.y=270===e||(0===e||180===e)&&t.y<a.y?Math.min(t.y,0===e?g.top:Math.min(g.top,r.top)):Math.max(t.y,0===e?g.bottom:Math.max(g.bottom,r.bottom)),l.x=t.x,l.y=h.y));else 180===b?t.x<a.x||270===e&&t.y<a.y&&r.left<a.x||90===e&&t.y>a.y&&r.left<a.x?(h=new St(t.x,a.y),l=new St(t.x,(a.y+t.y)/2),0===e?(h.x=this.computeMidOrthoPosition(a.x,a.y,t.x,t.y,!1),l.x=h.x,l.y=t.y):270===e&&t.y<a.y||90===e&&t.y>a.y?(h.x=a.x>r.right?this.computeMidOrthoPosition(a.x,a.y,r.right,t.y,!1):a.x>r.left&&(270===e&&a.y<r.top||90===e&&a.y>r.bottom)?this.computeMidOrthoPosition(a.x,a.y,t.x,t.y,!1):r.left,l.x=h.x,l.y=t.y):180===e&&a.x>r.right&&a.y>r.top&&a.y<r.bottom&&(h.x=a.x,h.y=a.y<t.y?Math.min(t.y,r.top):Math.max(t.y,r.bottom),l.y=h.y)):(h=new St(a.x,t.y),l=new St((a.x+t.x)/2,t.y),(0===e||90===e&&t.y<g.top||270===e&&t.y>g.bottom)&&(0===e&&(r.$(a)||g.$(t))?h.y=this.computeMidOrthoPosition(a.x,a.y,t.x,t.y,!0):t.y<a.y&&(0===e||90===e)?h.y=this.computeMidOrthoPosition(a.x,g.top,t.x,Math.max(t.y,r.bottom),!0):t.y>a.y&&(0===e||270===e)&&(h.y=this.computeMidOrthoPosition(a.x,g.bottom,t.x,Math.min(t.y,r.top),!0)),l.x=t.x,l.y=h.y),h.y>g.top&&h.y<g.bottom&&(t.x<=g.right&&t.x>=a.x||a.x>=r.left&&a.x<=t.x?90!==e&&270!==e||(h=new St(Math.min((a.x+t.x)/2,a.x),a.y),l=new St(h.x,t.y)):(h.y=270===e||(0===e||180===e)&&t.y<a.y?Math.min(t.y,180===e?g.top:Math.min(g.top,r.top)):Math.max(t.y,180===e?g.bottom:Math.max(g.bottom,r.bottom)),l.x=t.x,l.y=h.y))):90===b?t.y>a.y||180===e&&t.x<a.x&&r.bottom>a.y||0===e&&t.x>a.x&&r.bottom>a.y?(h=new St(a.x,t.y),l=new St((a.x+t.x)/2,t.y),270===e?(h.y=this.computeMidOrthoPosition(a.x,a.y,t.x,t.y,!0),l.x=t.x,l.y=h.y):180===e&&t.x<a.x||0===e&&t.x>a.x?(h.y=a.y<r.top?this.computeMidOrthoPosition(a.x,a.y,t.x,r.top,!0):a.y<r.bottom&&(180===e&&a.x<r.left||0===e&&a.x>r.right)?this.computeMidOrthoPosition(a.x,a.y,t.x,t.y,!0):r.bottom,l.x=t.x,l.y=h.y):90===e&&a.y<r.top&&a.x>r.left&&a.x<r.right&&(h.x=a.x<t.x?Math.min(t.x,r.left):Math.max(t.x,r.right),h.y=a.y,l.x=h.x)):(h=new St(t.x,a.y),l=new St(t.x,(a.y+t.y)/2),(270===e||0===e&&t.x<g.left||180===e&&t.x>g.right)&&(270===e&&(r.$(a)||g.$(t))?h.x=this.computeMidOrthoPosition(a.x,a.y,t.x,t.y,!1):t.x<a.x&&(270===e||0===e)?h.x=this.computeMidOrthoPosition(g.left,a.y,Math.max(t.x,r.right),t.y,!1):t.x>a.x&&(270===e||180===e)&&(h.x=this.computeMidOrthoPosition(g.right,a.y,Math.min(t.x,r.left),t.y,!1)),l.x=h.x,l.y=t.y),h.x>g.left&&h.x<g.right&&(t.y>=g.top&&t.y<=a.y||a.y<=r.bottom&&a.y>=t.y?0!==e&&180!==e||(h=new St(a.x,Math.max((a.y+t.y)/2,a.y)),l=new St(t.x,h.y)):(h.x=180===e||(90===e||270===e)&&t.x<a.x?Math.min(t.x,90===e?g.left:Math.min(g.left,r.left)):Math.max(t.x,90===e?g.right:Math.max(g.right,r.right)),l.x=h.x,l.y=t.y))):t.y<a.y||180===e&&t.x<a.x&&r.top<a.y||0===e&&t.x>a.x&&r.top<a.y?(h=new St(a.x,t.y),l=new St((a.x+t.x)/2,t.y),90===e?(h.y=this.computeMidOrthoPosition(a.x,a.y,t.x,t.y,!0),l.x=t.x,l.y=h.y):180===e&&t.x<a.x||0===e&&t.x>=a.x?(h.y=a.y>r.bottom?this.computeMidOrthoPosition(a.x,a.y,t.x,r.bottom,!0):a.y>r.top&&(180===e&&a.x<r.left||0===e&&a.x>r.right)?this.computeMidOrthoPosition(a.x,a.y,t.x,t.y,!0):r.top,l.x=t.x,l.y=h.y):270===e&&a.y>r.bottom&&a.x>r.left&&a.x<r.right&&(h.x=a.x<t.x?Math.min(t.x,r.left):Math.max(t.x,r.right),h.y=a.y,l.x=h.x)):(h=new St(t.x,a.y),l=new St(t.x,(a.y+t.y)/2),(90===e||0===e&&t.x<g.left||180===e&&t.x>g.right)&&(90===e&&(r.$(a)||g.$(t))?h.x=this.computeMidOrthoPosition(a.x,a.y,t.x,t.y,!1):t.x<a.x&&(90===e||0===e)?h.x=this.computeMidOrthoPosition(g.left,a.y,Math.max(t.x,r.right),t.y,!1):t.x>a.x&&(90===e||180===e)&&(h.x=this.computeMidOrthoPosition(g.right,a.y,Math.min(t.x,r.left),t.y,!1)),l.x=h.x,l.y=t.y),h.x>g.left&&h.x<g.right&&(t.y<=g.bottom&&t.y>=a.y||a.y>=r.top&&a.y<=t.y?0!==e&&180!==e||(h=new St(a.x,Math.min((a.y+t.y)/2,a.y)),l=new St(t.x,h.y)):(h.x=180===e||(90===e||270===e)&&t.x<a.x?Math.min(t.x,270===e?g.left:Math.min(g.left,r.left)):Math.max(t.x,270===e?g.right:Math.max(g.right,r.right)),l.x=h.x,l.y=t.y)));var c=h,f=l,p=t;if(this.isAvoiding){var d=this.diagram;if(null===d||!$r(d)||g.$(p)&&!o.Hd(n)||r.$(a)&&!n.Hd(o)||n===o||this.layer.isTemporary)b=!1;else{var q=Qr(d,!0,this.containingGroup,null);if(17!==this.segmentIndex&&q.Ak(Math.min(a.x,c.x),Math.min(a.y,c.y),Math.abs(a.x-c.x),Math.abs(a.y-c.y))&&q.Ak(Math.min(c.x,f.x),Math.min(c.y,f.y),Math.abs(c.x-f.x),Math.abs(c.y-f.y))&&q.Ak(Math.min(f.x,p.x),Math.min(f.y,p.y),Math.abs(f.x-p.x),Math.abs(f.y-p.y)))b=!1;else{n=a,o=p;var u=t=null;if(d.isVirtualized){(d=q.bounds.copy()).Kc(-q.vq,-q.uq);var y=St.alloc();nf(q,a.x,a.y)||(oe.Ef(d.x,d.y,d.x+d.width,d.y+d.height,a.x,a.y,c.x,c.y,y)?(t=a=y.copy(),b=y.Sa(c)):oe.Ef(d.x,d.y,d.x+d.width,d.y+d.height,c.x,c.y,f.x,f.y,y)?(t=a=y.copy(),b=y.Sa(f)):oe.Ef(d.x,d.y,d.x+d.width,d.y+d.height,f.x,f.y,p.x,p.y,y)&&(t=a=y.copy(),b=y.Sa(p))),nf(q,p.x,p.y)||(oe.Ef(d.x,d.y,d.x+d.width,d.y+d.height,p.x,p.y,f.x,f.y,y)?(u=p=y.copy(),e=f.Sa(y)):oe.Ef(d.x,d.y,d.x+d.width,d.y+d.height,f.x,f.y,c.x,c.y,y)?(u=p=y.copy(),e=c.Sa(y)):oe.Ef(d.x,d.y,d.x+d.width,d.y+d.height,c.x,c.y,a.x,a.y,y)&&(u=p=y.copy(),e=a.Sa(y))),St.free(y)}(g=g.copy().Tc(r)).Kc(q.vq*q.Yy,q.uq*q.Yy),lf(q,a,b,p,e,g,!0),r=of(q,p.x,p.y),!q.abort&&r>=df&&(rf(q),g.Kc(q.vq*q.Iy,q.uq*q.Iy),lf(q,a,b,p,e,g,!1),r=of(q,p.x,p.y)),!q.abort&&r<df&&of(q,p.x,p.y)!==cf?(xc(this,q,p.x,p.y,e,!0),r=this.i(2),4>this.pointsCount?(0===b||180===b?(r.x=a.x,r.y=p.y):(r.x=p.x,r.y=a.y),this.L(2,r.x,r.y),this.m(3,r.x,r.y)):(g=this.i(3),0===b||180===b?oe.A(r.x,g.x)?(r=0===b?Math.max(r.x,a.x):Math.min(r.x,a.x),this.L(2,r,a.y),this.L(3,r,g.y)):oe.A(r.y,g.y)?(Math.abs(a.y-r.y)<=q.uq/2&&(this.L(2,r.x,a.y),this.L(3,g.x,a.y)),this.m(2,r.x,a.y)):this.L(2,a.x,r.y):90!==b&&270!==b||(oe.A(r.y,g.y)?(r=90===b?Math.max(r.y,a.y):Math.min(r.y,a.y),this.L(2,a.x,r),this.L(3,g.x,r)):oe.A(r.x,g.x)?(Math.abs(a.x-r.x)<=q.vq/2&&(this.L(2,a.x,r.y),this.L(3,a.x,g.y)),this.m(2,a.x,r.y)):this.L(2,r.x,a.y))),null!==t&&(a=this.i(1),g=this.i(2),a.x!==g.x&&a.y!==g.y?0===b||180===b?this.m(2,a.x,g.y):this.m(2,g.x,a.y):0===b||180===b?this.m(2,n.x,t.y):this.m(2,t.x,n.y)),null!==u&&(0===e||180===e?this.xf(o.x,u.y):this.xf(u.x,o.y)),b=!0):b=!1}}}else b=!1;b||(this.$d(h),this.$d(l))}},uc.prototype.computeMidOrthoPosition=function(a,b,t,e,n){var o=0;return!this.hasCurviness()||this.computeSpot(!0,this.fromPort).Pc()||this.computeSpot(!1,this.toPort).Pc()||(o=this.computeCurviness()),n?(b+e)/2+o:(a+t)/2+o},uc.prototype.Sz=function(a){var b=a.x;a=a.y;for(var t=this.i(0),e=this.i(1),n=Lt(b,a,t.x,t.y,e.x,e.y),o=0,g=1;g<this.pointsCount-1;g++){t=this.i(g+1);var r=Lt(b,a,e.x,e.y,t.x,t.y);e=t,r<n&&(o=g,n=r)}return o},uc.prototype.dc=function(){this.Xm=!1,this.o()},uc.prototype.Ck=function(a){if(!a){if(!1===this.kd)return;if(a=this.rb(),this.Xm&&(null===a||null!==a.geometry))return}if(this.na=this.makeGeometry(),null!==(a=this.path)){a.na=this.na;for(var b=this.W.j,t=b.length,e=0;e<t;e++){var n=b[e];n!==a&&n.isPanelMain&&n instanceof pl&&(n.na=this.na)}}},uc.prototype.makeGeometry=function(){var a=this.na,b=this.pointsCount;if(2>b)return a.type=ge,this.Xm=!0,a;var t=!1,e=this.diagram;null!==e&&Pc(this)&&e.Wg.contains(this)&&(0!==this.Wl.width||0!==this.Wl.height)&&(t=!0);var n=this.i(0).copy(),o=n.copy();e=this.Bb.j;var g=this.computeCurve();if(g===Rc&&3<=b&&!oe.aa(this.smoothness,0))if(3===b){var r=this.i(1);e=Math.min(n.x,r.x);var h=Math.min(n.y,r.y);r=this.i(2),e=Math.min(e,r.x),h=Math.min(h,r.y)}else{if(this.isOrthogonal)for(h=0;h<b;h++)r=e[h],o.x=Math.min(r.x,o.x),o.y=Math.min(r.y,o.y);else for(e=3;e<b;e+=3)e+3>=b&&(e=b-1),h=this.i(e),o.x=Math.min(h.x,o.x),o.y=Math.min(h.y,o.y);e=o.x,h=o.y}else{for(h=0;h<b;h++)r=e[h],o.x=Math.min(r.x,o.x),o.y=Math.min(r.y,o.y);e=o.x,h=o.y}if(e-=this.tv.x,h-=this.tv.y,n.x-=e,n.y-=h,2!==b||Pc(this)){if(a.type=ve,r=du(a),0!==this.computeShortLength(!0)&&(n=wc(this,n,!0,o)),hu(r,n.x,n.y,!1),g===Rc&&3<=b&&!oe.aa(this.smoothness,0))if(3===b)b=(t=this.i(1)).x-e,t=t.y-h,(n=this.i(2).copy()).x-=e,n.y-=h,0!==this.computeShortLength(!1)&&(n=wc(this,n,!1,o)),uu(r,b,t,b,t,n.x,n.y);else if(this.isOrthogonal){o=new St(e,h),n=this.i(1).copy(),g=new St(e,h),b=new St(e,h),t=this.i(0);for(var l,c=this.smoothness/3,f=1;f<this.pointsCount-1;f++){var p=t,d=l=this.i(f),q=this.i(kc(this,l,f,!1));if(!(oe.aa(p.x,d.x)&&oe.aa(d.x,q.x)||oe.aa(p.y,d.y)&&oe.aa(d.y,q.y))){var u=c;isNaN(u)&&(u=this.smoothness/3);var y=p.x;p=p.y;var m=d.x;d=d.y;var v=q.x;q=q.y;var x=u*bc(y,p,m,d);u*=bc(m,d,v,q),oe.aa(p,d)&&oe.aa(m,v)&&(m>y?q>d?(g.x=m-x,g.y=d-x,b.x=m+u,b.y=d+u):(g.x=m-x,g.y=d+x,b.x=m+u,b.y=d-u):q>d?(g.x=m+x,g.y=d-x,b.x=m-u,b.y=d+u):(g.x=m+x,g.y=d+x,b.x=m-u,b.y=d-u)),oe.aa(y,m)&&oe.aa(d,q)&&(d>p?(v>m?(g.x=m-x,g.y=d-x,b.x=m+u):(g.x=m+x,g.y=d-x,b.x=m-u),b.y=d+u):(v>m?(g.x=m-x,g.y=d+x,b.x=m+u):(g.x=m+x,g.y=d+x,b.x=m-u),b.y=d-u)),(oe.aa(y,m)&&oe.aa(m,v)||oe.aa(p,d)&&oe.aa(d,q))&&(y=.5*(y+v),p=.5*(p+q),g.x=y,g.y=p,b.x=y,b.y=p),(1===f||2===f&&oe.aa(t.x,this.i(0).x)&&oe.aa(t.y,this.i(0).y))&&(n.x=.5*(t.x+l.x),n.y=.5*(t.y+l.y)),uu(r,n.x-e,n.y-h,g.x-e,g.y-h,l.x-e,l.y-h),o.set(g),n.set(b),t=l}}o=t.x,t=t.y,n=this.i(this.pointsCount-1),0!==this.computeShortLength(!1)&&(n=wc(this,n.copy(),!1,Dt)),o=.5*(o+n.x),t=.5*(t+n.y),uu(r,b.x-e,b.y-h,o-e,t-h,n.x-e,n.y-h)}else for(t=3;t<b;t+=3)o=this.i(t-2),t+3>=b&&(t=b-1),n=this.i(t-1),g=this.i(t),t===b-1&&0!==this.computeShortLength(!1)&&(g=wc(this,g.copy(),!1,Dt)),uu(r,o.x-e,o.y-h,n.x-e,n.y-h,g.x-e,g.y-h);else{for((o=St.alloc()).assign(this.i(0)),(n=St.alloc()).assign(o),g=this.computeCorner(),f=1,l=0;f<b;){if(f=kc(this,o,f,1<f),c=this.i(f),f>=b-1){if(o.w(c)){if(0===l)for(f=1;f<b;)n.assign(o),Mc(this,r,-e,-h,o,c=this.i(f++),t),o.assign(c)}else 0!==this.computeShortLength(!1)&&(c=wc(this,c.copy(),!1,Dt)),Mc(this,r,-e,-h,o,c,t);break}if(l=kc(this,c,f+1,f<b-3),f=-e,y=-h,p=c,u=this.i(l),m=t,oe.A(o.y,p.y)&&oe.A(p.x,u.x))if(d=Math.min(g,Math.abs(p.x-n.x)/2),d=v=Math.min(d,Math.abs(u.y-p.y)/2),oe.A(d,0))Mc(this,r,f,y,o,p,m),o.assign(p);else{var w=q=p.x,k=x=p.y;q=p.x>o.x?p.x-d:p.x+d,k=u.y>p.y?p.y+v:p.y-v,Mc(this,r,f,y,o,new St(q,x),m),cu(r,p.x+f,p.y+y,w+f,k+y),o.h(w,k)}else oe.A(o.x,p.x)&&oe.A(p.y,u.y)?(d=Math.min(g,Math.abs(p.y-n.y)/2),d=v=Math.min(d,Math.abs(u.x-p.x)/2),oe.A(v,0)?(Mc(this,r,f,y,o,p,m),o.assign(p)):(w=q=p.x,k=x=p.y,x=p.y>o.y?p.y-d:p.y+d,w=u.x>p.x?p.x+v:p.x-v,Mc(this,r,f,y,o,new St(q,x),m),cu(r,p.x+f,p.y+y,w+f,k+y),o.h(w,k))):(Mc(this,r,f,y,o,p,m),o.assign(p));n.assign(c),f=l}St.free(o)}pu=r}else(r=this.i(1).copy()).x-=e,r.y-=h,0!==this.computeShortLength(!0)&&(n=wc(this,n,!0,o)),0!==this.computeShortLength(!1)&&(r=wc(this,r,!1,o)),a.type=ge,a.startX=n.x,a.startY=n.y,a.endX=r.x,a.endY=r.y;return this.Xm=!0,a},uc.prototype.Lq=function(a){var b=this.layer;if(null!==b&&b.visible&&!b.isTemporary){var t=b.diagram;if(null!==t&&!t.animationManager.isTicking){var e=!1;for(t=t.layers;t.next();){var n=t.value;if(n.visible)if(n===b){e=!0;for(var o=!1,g=(n=n.Da.j).length,r=0;r<g;r++){var h=n[r];h instanceof uc&&(h===this?o=!0:o&&Cc(this,h,a))}}else if(e)for(n=(o=n.Da.j).length,g=0;g<n;g++)(r=o[g])instanceof uc&&Cc(this,r,a)}}}},uc.prototype.usesSamePort=function(a){var b=this.pointsCount,t=a.pointsCount;if(0<b&&0<t){var e=this.i(0),n=a.i(0);if(e.Na(n))return!0;if(b=this.i(b-1),a=a.i(t-1),b.Na(a)||e.Na(a)||b.Na(n))return!0}else if(this.fromNode===a.fromNode||this.toNode===a.toNode||this.fromNode===a.toNode||this.toNode===a.fromNode)return!0;return!1},uc.prototype.isVisible=function(){if(!yu.prototype.isVisible.call(this))return!1;var a=this.containingGroup,b=!0,t=this.diagram;if(null!==t&&(b=t.isTreePathToChildren),null!==(t=this.fromNode)){if(this.isTreeLink&&b&&!t.isTreeExpanded)return!1;if(t===a)return!0;for(var e=t;null!==e;){if(e.labeledLink===this)return!0;e=e.containingGroup}if(null===(t=t.findVisibleNode())||t===a)return!1}if(null!==(t=this.toNode)){if(this.isTreeLink&&!b&&!t.isTreeExpanded)return!1;if(t===a)return!0;for(b=t;null!==b;){if(b.labeledLink===this)return!0;b=b.containingGroup}if(null===(b=t.findVisibleNode())||b===a)return!1}return!0},uc.prototype.Pb=function(a){if(yu.prototype.Pb.call(this,a),null!==this.Of&&this.Of.Am(),null!==this.od)for(var b=this.od.iterator;b.next();)b.value.Pb(a)},uc.prototype.computeAdjusting=function(){return this.isAvoiding&&null!==this.diagram&&this.diagram.animationManager.isAnimating?Vc:this.Wk},uc.prototype.Oh=function(){return!0},v.Object.defineProperties(uc.prototype,{fromNode:{get:function(){return this.Xe},set:function(a){var b=this.Xe;if(b!==a){var t=this.fromPort;null!==b&&(this.tf!==b&&Ku(b,this,t),Lc(this),this.C(2)),this.Xe=a,null!==a&&this.Pb(a.isVisible()),this.Xf=null,this.Ua();var e=this.diagram;null!==e&&e.Z&&e.partManager.setFromNodeForLink(this,a,b);var n=this.fromPort,o=this.fromPortChanged;if(null!==o){var g=!0;null!==e&&(g=e.Z,e.Z=!0),o(this,t,n),null!==e&&(e.Z=g)}null!==a&&(this.tf!==a&&Uu(a,this,n),Tc(this),this.C(1)),this.g("fromNode",b,a),cc(this)}}},fromPortId:{get:function(){return this.Ye},set:function(a){var b=this.Ye;if(b!==a){var t=this.fromPort;null!==t&&Xu(t),Lc(this),this.Ye=a;var e=this.fromPort;null!==e&&Xu(e);var n=this.diagram;if(null!==n){var o=this.data,g=n.model;null!==o&&g.pj()&&g.Cw(o,a)}t!==e&&(this.Xf=null,this.Ua(),null!==(o=this.fromPortChanged)&&(g=!0,null!==n&&(g=n.Z,n.Z=!0),o(this,t,e),null!==n&&(n.Z=g))),Tc(this),this.g("fromPortId",b,a)}}},fromPort:{get:function(){var a=this.Xe;return null===a?null:a.It(this.Ye)}},fromPortChanged:{get:function(){return this.bo},set:function(a){var b=this.bo;b!==a&&(this.bo=a,this.g("fromPortChanged",b,a))}},toNode:{get:function(){return this.tf},set:function(a){var b=this.tf;if(b!==a){var t=this.toPort;null!==b&&(this.Xe!==b&&Ku(b,this,t),Lc(this),this.C(2)),this.tf=a,null!==a&&this.Pb(a.isVisible()),this.Xf=null,this.Ua();var e=this.diagram;null!==e&&e.Z&&e.partManager.setToNodeForLink(this,a,b);var n=this.toPort,o=this.toPortChanged;if(null!==o){var g=!0;null!==e&&(g=e.Z,e.Z=!0),o(this,t,n),null!==e&&(e.Z=g)}null!==a&&(this.Xe!==a&&Uu(a,this,n),Tc(this),this.C(1)),this.g("toNode",b,a),cc(this)}}},toPortId:{get:function(){return this.uf},set:function(a){var b=this.uf;if(b!==a){var t=this.toPort;null!==t&&Xu(t),Lc(this),this.uf=a;var e=this.toPort;null!==e&&Xu(e);var n=this.diagram;if(null!==n){var o=this.data,g=n.model;null!==o&&g.pj()&&g.Hw(o,a)}t!==e&&(this.Xf=null,this.Ua(),null!==(o=this.toPortChanged)&&(g=!0,null!==n&&(g=n.Z,n.Z=!0),o(this,t,e),null!==n&&(n.Z=g))),Tc(this),this.g("toPortId",b,a)}}},toPort:{get:function(){var a=this.tf;return null===a?null:a.It(this.uf)}},toPortChanged:{get:function(){return this.iq},set:function(a){var b=this.iq;b!==a&&(this.iq=a,this.g("toPortChanged",b,a))}},fromSpot:{get:function(){return null!==this.O?this.O.bh:Vi},set:function(a){this.Lc();var b=this.O.bh;b.w(a)||(a=a.G(),this.O.bh=a,this.g("fromSpot",b,a),(b.Pc()||a.Pc())&&null!==this.fromNode&&Xu(this.fromPort),this.Ua())}},fromEndSegmentLength:{get:function(){return null!==this.O?this.O.$g:NaN},set:function(a){this.Lc();var b=this.O.$g;b!==a&&(0>a&&T(a,">= 0",uc,"fromEndSegmentLength"),this.O.$g=a,this.g("fromEndSegmentLength",b,a),this.Ua())}},fromShortLength:{get:function(){return null!==this.O?this.O.ah:NaN},set:function(a){this.Lc();var b=this.O.ah;b!==a&&(this.O.ah=a,this.dc(),this.g("fromShortLength",b,a))}},toSpot:{get:function(){return null!==this.O?this.O.Bh:Vi},set:function(a){this.Lc();var b=this.O.Bh;b.w(a)||(a=a.G(),this.O.Bh=a,this.g("toSpot",b,a),(b.Pc()||a.Pc())&&null!==this.toNode&&Xu(this.toPort),this.Ua())}},toEndSegmentLength:{get:function(){return null!==this.O?this.O.zh:NaN},set:function(a){this.Lc();var b=this.O.zh;b!==a&&(0>a&&T(a,">= 0",uc,"toEndSegmentLength"),this.O.zh=a,this.g("toEndSegmentLength",b,a),this.Ua())}},toShortLength:{get:function(){return null!==this.O?this.O.Ah:NaN},set:function(a){this.Lc();var b=this.O.Ah;b!==a&&(this.O.Ah=a,this.dc(),this.g("toShortLength",b,a))}},isLabeledLink:{get:function(){return null!==this.od&&0<this.od.count}},labelNodes:{get:function(){return null===this.od?st:this.od.iterator}},relinkableFrom:{get:function(){return 0!=(1&this.Fa)},set:function(a){var b=0!=(1&this.Fa);b!==a&&(this.Fa^=1,this.g("relinkableFrom",b,a),this.Mb())}},relinkableTo:{get:function(){return 0!=(2&this.Fa)},set:function(a){var b=0!=(2&this.Fa);b!==a&&(this.Fa^=2,this.g("relinkableTo",b,a),this.Mb())}},resegmentable:{get:function(){return 0!=(4&this.Fa)},set:function(a){var b=0!=(4&this.Fa);b!==a&&(this.Fa^=4,this.g("resegmentable",b,a),this.Mb())}},isTreeLink:{get:function(){return 0!=(8&this.Fa)},set:function(a){var b=0!=(8&this.Fa);b!==a&&(this.Fa^=8,this.g("isTreeLink",b,a),null!==this.fromNode&&Hu(this.fromNode),null!==this.toNode&&Hu(this.toNode))}},path:{get:function(){var a=this.rb();return a instanceof pl?a:null}},routeBounds:{get:function(){this.wj();var a=this.Wl,b=1/0,t=1/0,e=this.pointsCount;if(0===e)a.h(NaN,NaN,0,0);else{if(1===e)e=this.i(0),b=Math.min(e.x,b),t=Math.min(e.y,t),a.h(e.x,e.y,0,0);else if(2===e){e=this.i(0);var n=this.i(1);b=Math.min(e.x,n.x),t=Math.min(e.y,n.y),a.h(e.x,e.y,0,0),a.Oe(n)}else if(this.computeCurve()===Rc&&3<=e&&!this.isOrthogonal)if(b=(n=this.i(0)).x,t=n.y,a.h(b,t,0,0),3===e){e=this.i(1),b=Math.min(e.x,b),t=Math.min(e.y,t);var o=this.i(2);b=Math.min(o.x,b),t=Math.min(o.y,t),oe.sm(n.x,n.y,e.x,e.y,e.x,e.y,o.x,o.y,.5,a)}else for(o=3;o<e;o+=3){var g=this.i(o-2);o+3>=e&&(o=e-1);var r=this.i(o-1),h=this.i(o);oe.sm(n.x,n.y,g.x,g.y,r.x,r.y,h.x,h.y,.5,a),b=Math.min(h.x,b),t=Math.min(h.y,t),n=h}else for(n=this.i(0),o=this.i(1),b=Math.min(n.x,o.x),t=Math.min(n.y,o.y),a.h(n.x,n.y,0,0),a.Oe(o),n=2;n<e;n++)o=this.i(n),b=Math.min(o.x,b),t=Math.min(o.y,t),a.Oe(o);this.tv.h(b-a.x,t-a.y)}return a}},midPoint:{get:function(){return this.wj(),this.computeMidPoint(new St)}},midAngle:{get:function(){return this.wj(),this.computeMidAngle()}},flattenedLengths:{get:function(){if(null===this.$r){this.kd||pc(this);for(var a=this.$r=[],b=this.pointsCount,t=0;t<b-1;t++){var e=this.i(t),n=this.i(t+1);oe.aa(e.x,n.x)?0>(e=n.y-e.y)&&(e=-e):oe.aa(e.y,n.y)?0>(e=n.x-e.x)&&(e=-e):e=Math.sqrt(e.Ge(n)),a.push(e)}}return this.$r}},flattenedTotalLength:{get:function(){var a=this.Nu;if(isNaN(a)){for(var b=this.flattenedLengths,t=b.length,e=a=0;e<t;e++)a+=b[e];this.Nu=a}return a}},points:{get:function(){return this.Bb},set:function(a){var b=this.Bb;if(b!==a){var t=null;if(Array.isArray(a)){var e=0==a.length%2;if(e)for(var n=0;n<a.length;n++)if("number"!=typeof a[n]||isNaN(a[n])){e=!1;break}if(e)for(t=new ut,e=0;e<a.length/2;e++)n=new St(a[2*e],a[2*e+1]).freeze(),t.add(n);else{for(e=!0,n=0;n<a.length;n++){var o=a[n];if(!j(o)||"number"!=typeof o.x||isNaN(o.x)||"number"!=typeof o.y||isNaN(o.y)){e=!1;break}}if(e)for(t=new ut,e=0;e<a.length;e++)n=a[e],t.add(new St(n.x,n.y).freeze())}}else if(a instanceof ut)for(t=a.copy(),a=t.iterator;a.next();)a.value.freeze();else N("Link.points value is not an instance of List or Array: "+a);t.freeze(),this.Bb=t,this.dc(),pc(this),null!==(a=this.diagram)&&(a.oj||a.undoManager.isUndoingRedoing||a.Wt.add(this),a.animationManager.sc&&(this.sg=t)),this.g("points",b,t)}}},pointsCount:{get:function(){return this.Bb.count}},kd:{get:function(){return 0!=(16&this.Fa)},set:function(a){0!=(16&this.Fa)!==a&&(this.Fa^=16)}},suspendsRouting:{get:function(){return 0!=(32&this.Fa)},set:function(a){0!=(32&this.Fa)!==a&&(this.Fa^=32)}},At:{get:function(){return 0!=(64&this.Fa)},set:function(a){0!=(64&this.Fa)!==a&&(this.Fa^=64)}},defaultFromPoint:{get:function(){return this.v},set:function(a){this.v=a.copy()}},defaultToPoint:{get:function(){return this.I},set:function(a){this.I=a.copy()}},isOrthogonal:{get:function(){return 2==(2&this.ak.value)}},isAvoiding:{get:function(){return 4==(4&this.ak.value)}},Xm:{get:function(){return 0!=(128&this.Fa)},set:function(a){0!=(128&this.Fa)!==a&&(this.Fa^=128)}},geometry:{get:function(){return this.Xm||(this.wj(),this.na=this.makeGeometry()),this.na}},firstPickIndex:{get:function(){return 2>=this.pointsCount?0:this.isOrthogonal||!yc(this.computeSpot(!0))?1:0}},lastPickIndex:{get:function(){var a=this.pointsCount;return 0===a?0:2>=a?a-1:this.isOrthogonal||!yc(this.computeSpot(!1))?a-2:a-1}},adjusting:{get:function(){return this.Wk},set:function(a){var b=this.Wk;b!==a&&(this.Wk=a,this.g("adjusting",b,a))}},corner:{get:function(){return this.En},set:function(a){var b=this.En;b!==a&&(this.En=a,this.dc(),this.g("corner",b,a))}},curve:{get:function(){return this.Gn},set:function(a){var b=this.Gn;b!==a&&(this.Gn=a,this.Ua(),this.dc(),Nc(this,b===Ec||b===zc||a===Ec||a===zc),this.g("curve",b,a))}},curviness:{get:function(){return this.Hn},set:function(a){var b=this.Hn;b!==a&&(this.Hn=a,this.Ua(),this.dc(),this.g("curviness",b,a))}},routing:{get:function(){return this.ak},set:function(a){var b=this.ak;b!==a&&(this.ak=a,this.Xf=null,this.Ua(),Nc(this,2==(2&b.value)||2==(2&a.value)),this.g("routing",b,a))}},smoothness:{get:function(){return this.Vp},set:function(a){var b=this.Vp;b!==a&&(this.Vp=a,this.dc(),this.g("smoothness",b,a))}},key:{get:function(){var a=this.diagram;if(null!==a&&a.model.pj())return a.model.Wb(this.data)}}}),uc.prototype.invalidateOtherJumpOvers=uc.prototype.Lq,uc.prototype.findClosestSegment=uc.prototype.Sz,uc.prototype.updateRoute=uc.prototype.wj,uc.prototype.invalidateRoute=uc.prototype.Ua,uc.prototype.rollbackRoute=uc.prototype.yw,uc.prototype.commitRoute=uc.prototype.zf,uc.prototype.startRoute=uc.prototype.Sh,uc.prototype.clearPoints=uc.prototype.mk,uc.prototype.removePoint=uc.prototype.tw,uc.prototype.addPointAt=uc.prototype.xf,uc.prototype.addPoint=uc.prototype.$d,uc.prototype.insertPointAt=uc.prototype.m,uc.prototype.insertPoint=uc.prototype.wA,uc.prototype.setPointAt=uc.prototype.L,uc.prototype.setPoint=uc.prototype.Rc,uc.prototype.getPoint=uc.prototype.i,uc.prototype.getOtherPort=uc.prototype.nA,uc.prototype.getOtherNode=uc.prototype.Gq;var Ac=null,jc=null,Dc=new _(uc,"Normal",1),Oc=new _(uc,"Orthogonal",2),Fc=new _(uc,"AvoidsNodes",6),Bc=new _(uc,"AvoidsNodesStraight",7),Ic=new _(uc,"None",0),Rc=new _(uc,"Bezier",9),Ec=new _(uc,"JumpGap",10),zc=new _(uc,"JumpOver",11),Vc=new _(uc,"End",17),Gc=new _(uc,"Scale",18),Yc=new _(uc,"Stretch",19),Xc=new _(uc,"OrientAlong",21),qc=new _(uc,"OrientPlus90",22),Uc=new _(uc,"OrientMinus90",23),Kc=new _(uc,"OrientOpposite",24),Hc=new _(uc,"OrientUpright",25),Wc=new _(uc,"OrientPlus90Upright",26),Jc=new _(uc,"OrientMinus90Upright",27),Zc=new _(uc,"OrientUpright45",28),$c=16,Qc=14,_c=8;function tf(a,b,t,e){pt(this),this.qe=this.hs=!1,this.Zt=a,this.Oy=b,this.jw=t,this.Py=e,this.links=[]}function ef(){pt(this),this.Xy=this.group=null,this.Qt=!0,this.abort=!1,this.Ad=this.zd=1,this.Mo=this.Lo=-1,this.gc=this.fc=8,this.Rb=null,this.Zi=this.Yi=0,this.Yy=11,this.Iy=124}function nf(a,b,t){return a.zd<=b&&b<=a.Lo&&a.Ad<=t&&t<=a.Mo}function of(a,b,t){return nf(a,b,t)?(b-=a.zd,b/=a.fc,t-=a.Ad,t/=a.gc,a.Rb[0|b][0|t]):pf}function rf(a){if(null!==a.Rb)for(var b=0;b<=a.Yi;b++)for(var t=a.Rb[b],e=0;e<=a.Zi;e++)t[e]>=ff&&(t[e]=pf)}function sf(a,b,t,e,n,o,g,r,h){if(!(b<o||b>g||t<r||t>h)){var l=0|b,c=0|t,f=a.Rb[l][c];if(f>=ff&&f<df)for(n?c+=e:l+=e,f+=1;o<=l&&l<=g&&r<=c&&c<=h&&!(f>=a.Rb[l][c]);)a.Rb[l][c]=f,f+=1,n?c+=e:l+=e;if(l=n?c:l,n)if(0<e)for(t+=e;t<l;t+=e)sf(a,b,t,1,!n,o,g,r,h),sf(a,b,t,-1,!n,o,g,r,h);else for(t+=e;t>l;t+=e)sf(a,b,t,1,!n,o,g,r,h),sf(a,b,t,-1,!n,o,g,r,h);else if(0<e)for(b+=e;b<l;b+=e)sf(a,b,t,1,!n,o,g,r,h),sf(a,b,t,-1,!n,o,g,r,h);else for(b+=e;b>l;b+=e)sf(a,b,t,1,!n,o,g,r,h),sf(a,b,t,-1,!n,o,g,r,h)}}function af(a,b,t,e,n,o,g,r,h){b|=0,t|=0;var l=cf,c=ff;for(a.Rb[b][t]=c;l===cf&&b>o&&b<g&&t>r&&t<h;)c+=1,a.Rb[b][t]=c,n?t+=e:b+=e,l=a.Rb[b][t]}function hf(a,b,t,e,n,o,g,r,h){b|=0,t|=0;var l=cf,c=df;for(a.Rb[b][t]=c;l===cf&&b>o&&b<g&&t>r&&t<h;)a.Rb[b][t]=c,n?t+=e:b+=e,l=a.Rb[b][t]}function lf(a,b,t,e,n,o,g){if(null!==a.Rb){a.abort=!1;var r=b.x,h=b.y;if(nf(a,r,h)){r-=a.zd,r/=a.fc,h-=a.Ad,h/=a.gc;var l=e.x,c=e.y;if(nf(a,l,c))if(l-=a.zd,l/=a.fc,c-=a.Ad,c/=a.gc,1>=Math.abs(r-l)&&1>=Math.abs(h-c))a.abort=!0;else{var f=o.x;e=o.y,b=o.x+o.width;var p=o.y+o.height;f-=a.zd,f/=a.fc,e-=a.Ad,e/=a.gc,b-=a.zd,b/=a.fc,p-=a.Ad,p/=a.gc,o=Math.max(0,Math.min(a.Yi,0|f)),b=Math.min(a.Yi,Math.max(0,0|b)),f=Math.max(0,Math.min(a.Zi,0|e)),p=Math.min(a.Zi,Math.max(0,0|p)),h|=0,l|=0,c|=0;var d=0===t||90===t?1:-1;if(t=90===t||270===t,(e=a.Rb)[r|=0][h]===cf?(af(a,r,h,d,t,o,b,f,p),af(a,r,h,1,!t,o,b,f,p),af(a,r,h,-1,!t,o,b,f,p)):af(a,r,h,d,t,r,h,r,h),e[l][c]===cf?(hf(a,l,c,0===n||90===n?1:-1,90===n||270===n,o,b,f,p),hf(a,l,c,1,!(90===n||270===n),o,b,f,p),hf(a,l,c,-1,!(90===n||270===n),o,b,f,p)):hf(a,l,c,d,t,l,c,l,c),t=I(),g&&uf(a,l,c,n,r,h,t))for(t[0]===l&&t[1]===c||(t.unshift(c),t.unshift(l)),t[t.length-2]===r&&t[t.length-1]===h||(t.push(r),t.push(h)),a=ff,n=t[t.length-2],g=t[t.length-1],e[n][g]=a++,o=t.length-4;0<=o;o-=2)for(n=t[o+2],g=t[o+3],b=t[o],l=t[o+1];b>n?n++:b<n?n--:l>g?g++:l<g&&g--,e[n][g]=a++,n!==b||g!==l;);else sf(a,r,h,1,!1,o,b,f,p),sf(a,r,h,-1,!1,o,b,f,p),sf(a,r,h,1,!0,o,b,f,p),sf(a,r,h,-1,!0,o,b,f,p);R(t)}}}}function uf(a,b,t,e,n,o,g){for(var r=a.Rb,h=b,l=t;;){if(h===n&&l===o)return!0;var c=h,f=l;if(0===e){if(!(c<n))break;c++}else if(90===e){if(!(f<o))break;f++}else if(180===e){if(!(c>n))break;c--}else{if(!(f>o))break;f--}var p=r[c][f];if(0===p||p===gf)break;h=c,l=f}for(;;){if(c=e,f=h,p=l,0===e?p<o?(c=90,p++):p>o&&(c=270,p--):90===e?f<n?(c=0,f++):f>n&&(c=180,f--):180===e?p<o?(c=90,p++):p>o&&(c=270,p--):f<n?(c=0,f++):f>n&&(c=180,f--),f=r[f][p],c!==e&&0!==f&&f!==gf){if(g.push(h),g.push(l),uf(a,h,l,c,n,o,g))return!0;g.pop(),g.pop()}if(r[h][l]=gf,0===e){if(h===b)return!1;h--}else if(90===e){if(l===t)return!1;l--}else if(180===e){if(h===b)return!1;h++}else{if(l===t)return!1;l++}}}uc.className="Link",uc.Normal=Dc,uc.Orthogonal=Oc,uc.AvoidsNodes=Fc,uc.AvoidsNodesStraight=Bc,uc.None=Ic,uc.Bezier=Rc,uc.JumpGap=Ec,uc.JumpOver=zc,uc.End=Vc,uc.Scale=Gc,uc.Stretch=Yc,uc.OrientAlong=Xc,uc.OrientPlus90=qc,uc.OrientMinus90=Uc,uc.OrientOpposite=Kc,uc.OrientUpright=Hc,uc.OrientPlus90Upright=Wc,uc.OrientMinus90Upright=Jc,uc.OrientUpright45=Zc,uc.EndSegmentStep=8,uc.CurvinessStart=$c,uc.SpacingMin=Qc,uc.OrthoShortCut=_c,uc.AvoidanceCell=8,uc.AvoidanceLimit=999,tf.prototype.Am=function(){if(!this.hs){var a=this.links;0<a.length&&(null!==(a=a[0].diagram)&&(a.Pu.add(this),this.qe=a.undoManager.isUndoingRedoing))}this.hs=!0},tf.prototype.Vw=function(){if(this.hs){this.hs=!1;var a=this.links;if(0<a.length){var b=a[0],t=b.diagram;t=null===t||t.oj&&!this.qe,this.qe=!1,b.arrangeBundledLinks(a,t),1===a.length&&(b.Of=null,a.length=0)}0===a.length&&(a=this.Zt,null!==this&&null!==a.Te&&a.Te.remove(this),a=this.jw,null!==this&&null!==a.Te&&a.Te.remove(this))}},tf.className="LinkBundle",ef.prototype.initialize=function(a){if(!(0>=a.width||0>=a.height)){var b=a.y,t=a.x+a.width,e=a.y+a.height;if(this.zd=Math.floor((a.x-this.fc)/this.fc)*this.fc,this.Ad=Math.floor((b-this.gc)/this.gc)*this.gc,this.Lo=Math.ceil((t+2*this.fc)/this.fc)*this.fc,this.Mo=Math.ceil((e+2*this.gc)/this.gc)*this.gc,a=1+(0|Math.ceil((this.Lo-this.zd)/this.fc)),b=1+(0|Math.ceil((this.Mo-this.Ad)/this.gc)),null===this.Rb||this.Yi<a-1||this.Zi<b-1){for(t=[],e=0;e<=a;e++)t[e]=new Uint32Array(b);this.Rb=t,this.Yi=a-1,this.Zi=b-1}if(a=pf,null!==this.Rb)for(b=0;b<=this.Yi;b++)if((t=this.Rb[b]).fill)t.fill(a);else for(e=0;e<=this.Zi;e++)t[e]=a}},ef.prototype.Ak=function(a,b,t,e){if(a>this.Lo||a+t<this.zd||b>this.Mo||b+e<this.Ad)return!0;a=(a-this.zd)/this.fc|0,b=(b-this.Ad)/this.gc|0,t=Math.max(0,t)/this.fc+1|0;var n=Math.max(0,e)/this.gc+1|0;if(0>a&&(t+=a,a=0),0>b&&(n+=b,b=0),0>t||0>n)return!0;for(e=0|Math.min(a+t-1,this.Yi),t=0|Math.min(b+n-1,this.Zi);a<=e;a++){n=this.Rb[a];for(var o=b;o<=t;o++)if(n[o]===cf)return!1}return!0},v.Object.defineProperties(ef.prototype,{bounds:{get:function(){return new Jt(this.zd,this.Ad,this.Lo-this.zd,this.Mo-this.Ad)}},vq:{get:function(){return this.fc},set:function(a){0<a&&a!==this.fc&&(this.fc=a,this.initialize(this.bounds))}},uq:{get:function(){return this.gc},set:function(a){0<a&&a!==this.gc&&(this.gc=a,this.initialize(this.bounds))}}});var cf=0,ff=1,df=999999,pf=df+1,gf=df+2;function yf(){pt(this),this.port=this.node=null,this.be=[],this.Qq=!1}function mf(a,b,t,e){switch(b=b.offsetY){case 8:return 90;case 2:return 180;case 1:return 270;case 4:return 0}switch(b){case 9:return 180<t?270:90;case 6:return 90<t&&270>=t?180:0}switch(a=180*Math.atan2(a.height,a.width)/Math.PI,b){case 3:return t>a&&t<=180+a?180:270;case 5:return t>180-a&&t<=360-a?270:0;case 12:return t>a&&t<=180+a?90:0;case 10:return t>180-a&&t<=360-a?180:90;case 7:return 90<t&&t<=180+a?180:t>180+a&&t<=360-a?270:0;case 13:return 180<t&&t<=360-a?270:t>a&&180>=t?90:0;case 14:return t>a&&t<=180-a?90:t>180-a&&270>=t?180:0;case 11:return t>180-a&&t<=180+a?180:t>180+a?270:90}return e&&15!==b&&(0>(t-=15)&&(t+=360)),t>a&&t<180-a?90:t>=180-a&&t<=180+a?180:t>180+a&&t<360-a?270:0}function vf(a,b){var t=a.be;if(0===t.length){t:if(!a.Qq){t=a.Qq,a.Qq=!0;var e=null,n=a.node,o=n instanceof oc?n:null;if(null===o||o.isSubGraphExpanded)var g=n.isTreeExpanded?n.findLinksConnected(a.port.portId):n.qy();else{if(!o.actualBounds.u()){a.Qq=t;break t}g=(e=o).Pv()}o=a.be.length=0;var r=a.port.da(yi,St.alloc()),h=a.port.da(Si,St.alloc());for((n=Jt.allocAt(r.x,r.y,0,0)).Oe(h),St.free(r),St.free(h),r=St.allocAt(n.x+n.width/2,n.y+n.height/2),h=a.port.kj(),g=g.iterator;g.next();){var l=g.value;if(l.isVisible()&&l.fromPort!==l.toPort){var c=l.fromPort===a.port||null!==l.fromNode&&l.fromNode.Hd(e),f=l.computeSpot(c,a.port);if(f.Pc()&&null!==(c=c?l.toPort:l.fromPort)){var p=c.part;if(null!==p){var d=p.findVisibleNode();null!==d&&d!==p&&(c=(p=d).port),c=l.computeOtherPoint(p,c),p=r.Sa(c),0>(p-=h)?p+=360:360<=p&&(p-=360),0===(f=mf(n,f,p,l.isOrthogonal))?(f=4,180<p&&(p-=360)):90===f?(f=8,270<p&&(p-=360)):180===f?f=2:(f=1,90>p&&(p+=360)),void 0===(d=a.be[o])?(d=new xf(l,p,f),a.be[o]=d):(d.link=l,d.angle=p,d.Bc=f),d.mw.set(c),o++}}}}for(St.free(r),a.be.sort(yf.prototype.l),h=a.be.length,e=-1,o=r=0;o<h;o++)void 0!==(g=a.be[o])&&(g.Bc!==e&&(e=g.Bc,r=0),g.Hq=r,r++);for(e=-1,r=0,o=h-1;0<=o;o--)void 0!==(h=a.be[o])&&(h.Bc!==e&&(e=h.Bc,r=h.Hq+1),h.tm=r);if(o=a.be,f=a.port,e=a.node.portSpreading,r=St.alloc(),h=St.alloc(),g=St.alloc(),l=St.alloc(),f.da(yi,r),f.da(vi,h),f.da(Si,g),f.da(ki,l),d=p=c=f=0,e===nc)for(var q=0;q<o.length;q++){var u=o[q];if(null!==u){var y=u.link.computeThickness();switch(u.Bc){case 8:p+=y;break;case 2:d+=y;break;case 1:f+=y;break;default:case 4:c+=y}}}var m=q=0,v=1,x=u=0;for(y=0;y<o.length;y++){var w=o[y];if(null!==w){if(q!==w.Bc){switch(q=w.Bc){case 8:var k=g;m=l;break;case 2:k=l,m=r;break;case 1:k=r,m=h;break;default:case 4:k=h,m=g}switch(u=m.x-k.x,x=m.y-k.y,q){case 8:p>Math.abs(u)?(v=Math.abs(u)/p,p=Math.abs(u)):v=1;break;case 2:d>Math.abs(x)?(v=Math.abs(x)/d,d=Math.abs(x)):v=1;break;case 1:f>Math.abs(u)?(v=Math.abs(u)/f,f=Math.abs(u)):v=1;break;default:case 4:c>Math.abs(x)?(v=Math.abs(x)/c,c=Math.abs(x)):v=1}m=0}var M=w.Oq;if(e===nc){switch(w=w.link.computeThickness(),w*=v,M.set(k),q){case 8:M.x=k.x+u/2+p/2-m-w/2;break;case 2:M.y=k.y+x/2+d/2-m-w/2;break;case 1:M.x=k.x+u/2-f/2+m+w/2;break;default:case 4:M.y=k.y+x/2-c/2+m+w/2}m+=w}else{var S=.5;e===ec&&(S=(w.Hq+1)/(w.tm+1)),M.x=k.x+u*S,M.y=k.y+x*S}}}for(St.free(r),St.free(h),St.free(g),St.free(l),k=a.be,o=0;o<k.length;o++)null!==(e=k[o])&&(e.Nv=a.computeEndSegmentLength(e));a.Qq=t,Jt.free(n)}t=a.be}for(a=0;a<t.length;a++)if(null!==(n=t[a])&&n.link===b)return n;return null}function xf(a,b,t){this.link=a,this.angle=b,this.Bc=t,this.mw=new St,this.tm=this.Hq=0,this.Oq=new St,this.Nv=0}function bf(){this.Bh=this.bh=Vi,this.Ah=this.ah=this.zh=this.$g=NaN,this.gq=this.$n=null,this.hq=this.ao=1/0}function wf(){pt(this),this.v=this.B=null,this.xi=this.ro=!0,this.wo=!1,this.kn=new St(0,0).freeze(),this.to=!0,this.sn=this.so=null,this.vo=!1,this.l=null,this.I=0,this.No=this.mq=null,this.ut=!1,this.zg=this.ck=null,this.jt=!1}function kf(a,b,t,e,n,o,g,r){for(t=t.iterator;t.next();){var h=t.value;e&&!h.isTopLevel||null!==n&&!n(h)||!h.canLayout()||(o&&h instanceof zu?h.isLinkLabel||(h instanceof oc&&null===h.layout?kf(a,b,h.memberParts,!1,n,o,g,r):(Mf(h),b.add(h))):g&&h instanceof uc?b.add(h):!r||!h.Oc()||h instanceof zu||(Mf(h),b.add(h)))}}function Mf(a){var b=a.actualBounds;(0===b.width||0===b.height||isNaN(b.width)||isNaN(b.height))&&a.Ta()}function Sf(a,b){if(null!==a.workerStateChanged){var t={key:a.group?a.group.key:null};void 0!==b&&(t.time=b),null!==a.ck&&(t.running=Pf(a.ck)),null!==a.zg&&(t.waiting=Pf(a.zg)),a.workerStateChanged(t,a)}}function Pf(a){return{vertexes:a.vertexes.count,edges:a.edges.count}}function Nf(a,b){var t=Cf(a);if(!t)throw Error("Unknown Layout class: "+a);if(b)for(var e in b)t[e]=b[e]}function Cf(a){var b=null;if("function"==typeof a){if(!(b=jf.get(a))){var t=E(a);(b=jf.get(t))||((b=new Ff).Jv=a,b.name=t,b.l=a.name,b.Dy=Df,jf.set(t,b),jf.set(a,b),jf.set(a.name,b))}}else"string"==typeof a&&(b=jf.get(a));return b}function Tf(a,b){a.ut=!0;var t=Cf(a.constructor),e=Lf(a,b,!0);e._GoJS="_GoJS",t.Pe.postMessage(e),t.Dm.set(yt(a),a),a.ck=b}function Lf(a,b,t){a.onNetworkSerialization(1,t,b,null);var e={};a.serializeLayoutProperties(e,t);var n=[];b.vertexes.each((function(a){var b={};a.serializeVertexProperties(b,t),n.push(b)}));var o=[];return b.edges.each((function(a){var b={};a.serializeEdgeProperties(b,t),o.push(b)})),e={id:t?yt(a):a.id,layout:E(a.constructor),p:e,gB:n,Qz:o},a.onNetworkSerialization(2,t,b,e),e}function Af(a,b,t){t&&(a.id=b.id);var e=a.diagram,n=a.createNetwork();a.onNetworkSerialization(3,t,n,b);var o=b.gB,g=new Mt;o&&o.forEach((function(a){var b=null;null===a.key||null===e||t||(b=e.Db(a.key)),null!==b?b=n.kk(b):(b=n.createVertex(),null!==a.key&&(b.data=b),n.Cg(b)),t&&null!==b.data&&(b.data.Bi=a.key),g.set(a.id,b)}));var r=b.Qz,h=new Mt;return r&&r.forEach((function(a){var b=null;null===a.key||null===e||t||(b=e.findLinkForKey(a.key)),null!==b?b=n.Wx(b):(b=n.createEdge(),null!==a.key&&(b.data=b),n.qm(b)),t&&null!==b.data&&(b.data.Bi=a.key),h.set(a.id,b)})),a.deserializeLayoutProperties(b.p,g,h,t),o&&o.forEach((function(a){var b=g.get(a.id);b&&b.yq(a,g,h,t)})),r&&r.forEach((function(a){var b=h.get(a.id);b&&b.deserializeEdgeProperties(a,g,h,t)})),a.onNetworkSerialization(4,t,n,b),n}ef.className="PositionArray",yf.prototype.toString=function(){for(var a=this.be,b=this.node.toString()+" "+a.length.toString()+":",t=0;t<a.length;t++){var e=a[t];null!==e&&(b+="\n  "+e.toString())}return b},yf.prototype.Am=function(){this.be.length=0},yf.prototype.l=function(a,b){return a===b?0:null===a?-1:null===b?1:a.Bc<b.Bc?-1:a.Bc>b.Bc?1:a.angle<b.angle?-1:a.angle>b.angle?1:0},yf.prototype.computeEndSegmentLength=function(a){var b=a.link,t=b.computeEndSegmentLength(this.node,this.port,gi,b.fromPort===this.port),e=a.Hq;if(0>e)return t;var n=a.tm;if(1>=n||!b.isOrthogonal)return t;b=a.mw;var o=a.Oq;return 2!==a.Bc&&8!==a.Bc||(e=n-1-e),((a=2===a.Bc||4===a.Bc)?b.y<o.y:b.x<o.x)?t+8*e:(a?b.y===o.y:b.x===o.x)?t:t+8*(n-1-e)},yf.className="Knot",xf.prototype.toString=function(){return this.link.toString()+" "+this.angle.toString()+" "+this.Bc.toString()+":"+this.Hq.toString()+"/"+this.tm.toString()+" "+this.Oq.toString()+" "+this.Nv.toString()+" "+this.mw.toString()},xf.className="LinkInfo",bf.prototype.copy=function(){var a=new bf;return a.bh=this.bh.G(),a.Bh=this.Bh.G(),a.$g=this.$g,a.zh=this.zh,a.ah=this.ah,a.Ah=this.Ah,a.$n=this.$n,a.gq=this.gq,a.ao=this.ao,a.hq=this.hq,a},bf.className="LinkSettings",wf.prototype.cloneProtected=function(a){a.ro=this.ro,a.xi=this.xi,a.wo=this.wo,a.kn.assign(this.kn),a.to=this.to,a.so=this.so,a.sn=this.sn,a.vo=!0,a.No=this.No,a.mq=this.mq},wf.prototype.copy=function(){var a=new this.constructor;return this.cloneProtected(a),a},wf.prototype.serializeLayoutProperties=function(a){a.arrangementOrigin={x:this.arrangementOrigin.x,y:this.arrangementOrigin.y},a.isRouting=this.isRouting},wf.prototype.deserializeLayoutProperties=function(a){null!==a&&(this.arrangementOrigin=new St(a.arrangementOrigin.x,a.arrangementOrigin.y),this.isRouting=a.isRouting)},wf.prototype.jb=function(){},wf.prototype.toString=function(){var a=E(this.constructor);return a+="(",null!==this.group&&(a+=" in "+this.group),null!==this.diagram&&(a+=" for "+this.diagram),a+")"},wf.prototype.C=function(){if(this.isValidLayout){var a=this.diagram;if(null!==a&&!a.undoManager.isUndoingRedoing){var b=a.animationManager;!b.isTicking&&(b.defaultAnimation.isAnimating&&b.Sc(),this.isOngoing&&a.oj||this.isInitial&&!a.oj)&&(this.isValidLayout=!1,a.Eb())}}},wf.prototype.createNetwork=function(){return new Bf(this)},wf.prototype.makeNetwork=function(a){var b=this.createNetwork();return a instanceof Xo?(b.Bg(a.nodes,!0),b.Bg(a.links,!0)):a instanceof oc?b.Bg(a.memberParts):b.Bg(a.iterator),b},wf.prototype.updateParts=function(){if(this.isValidLayout=!0,!this.workerLayout()){var a=this.diagram;if(null===a&&null!==this.network)for(var b=this.network.vertexes.iterator;b.next();){var t=b.value.node;if(null!==t&&null!==(a=t.diagram))break}try{null!==a&&a.xa("Layout"),this.commitLayout()}finally{null!==a&&a.Wa("Layout")}}},wf.prototype.commitLayout=function(){if(null!==this.network){for(var a=this.network.vertexes.iterator;a.next();)a.value.commit();if(this.isRouting)for(a=this.network.edges.iterator;a.next();)a.value.commit()}},wf.prototype.doLayout=function(a){var b=new ft;a instanceof Xo?(kf(this,b,a.nodes,!0,this.Qh,!0,!1,!0),kf(this,b,a.parts,!0,this.Qh,!0,!1,!0)):a instanceof oc?kf(this,b,a.memberParts,!1,this.Qh,!0,!1,!0):b.addAll(a.iterator),0<b.count&&(null!==(a=this.diagram)&&a.xa("Layout"),this.doMinimalNoNetworkLayout(b),null!==a&&a.Wa("Layout")),this.isValidLayout=!0},wf.prototype.doMinimalNoNetworkLayout=function(a){var b=Math.ceil(Math.sqrt(a.count));this.arrangementOrigin=this.initialOrigin(this.arrangementOrigin);var t=this.arrangementOrigin.x,e=t,n=this.arrangementOrigin.y,o=0,g=0;for(a=a.iterator;a.next();){var r=a.value;Mf(r);var h=r.measuredBounds,l=h.width;h=h.height,r.moveTo(e,n),r instanceof oc&&(r.Qh=!1),e+=Math.max(l,50)+20,g=Math.max(g,Math.max(h,50)),o>=b-1?(o=0,e=t,n+=g+20,g=0):o++}},wf.prototype.doMinimalNetworkLayout=function(){var a=Math.ceil(Math.sqrt(this.network.vertexes.count));this.arrangementOrigin=this.initialOrigin(this.arrangementOrigin);for(var b=this.arrangementOrigin.x,t=b,e=this.arrangementOrigin.y,n=0,o=0,g=this.network.vertexes.iterator;g.next();){var r=g.value.node;if(!(null===r||r instanceof uc)&&(Mf(r),this.Qh(r))){var h=r.measuredBounds,l=h.width;h=h.height,r.moveTo(t,e),r instanceof oc&&(r.Qh=!1),t+=Math.max(l,50)+20,o=Math.max(o,Math.max(h,50)),n>=a-1?(n=0,t=b,e+=o+20,o=0):n++}}},wf.prototype.Qh=function(a){return!(a.location.u()&&!(a instanceof oc&&a.Qh))},wf.prototype.mj=function(a,b){var t=this.boundsComputation;return null!==t?(b||(b=new Jt),t(a,this,b)):b?(b.set(a.actualBounds),b):a.actualBounds},wf.prototype.by=function(a){var b=new ft;return a instanceof Xo?(kf(this,b,a.nodes,!0,null,!0,!0,!0),kf(this,b,a.links,!0,null,!0,!0,!0),kf(this,b,a.parts,!0,null,!0,!0,!0)):kf(this,b,a instanceof oc?a.memberParts:a.iterator,!1,null,!0,!0,!0),b},wf.prototype.initialOrigin=function(a){var b=this.group;if(null!==b){var t=b.position.copy();return(isNaN(t.x)||isNaN(t.y))&&t.set(a),null!==(b=b.placeholder)&&(t=b.da(yi),(isNaN(t.x)||isNaN(t.y))&&t.set(a),a=b.padding,t.x+=a.left,t.y+=a.top),t}return a},wf.prototype.mayUseWorker=function(){return!!this.mayUseWorkerFunction&&this.mayUseWorkerFunction(this)},wf.prototype.workerLayout=function(){return!1},wf.prototype.zz=function(){var a=Cf(this.constructor);a&&(null!==a.Pe&&a.Pe.terminate(),a.Pe=null,a.Dm.iteratorValues.each((function(a){a.ut=!1,a.ck=null,a.zg=null,a.jt=!1,Sf(a)})),a.Dm.clear())},wf.prototype.Uw=function(){if("undefined"==typeof Worker||!Of||"undefined"==typeof self||void 0!==self.DedicatedWorkerGlobalScope)return!1;if(!this.mayUseWorker())return this.ut&&(this.jt=!0,this.zg=this.ck=null,Sf(this)),!1;var a=Cf(this.constructor);return null!==a&&(null===a.Pe&&(a.Pe=new Worker(Of),a.Pe.onerror=function(a){a.preventDefault(),L("Worker Error at: "+a.filename+" "+a.lineno+" "+a.colno+"\n  "+a.message)},a.Pe.l=function(a){L("Worker serialization error: "+a)},a.Pe.onmessage=function(b){var t=b.data;if("_GoJS"===t._GoJS)if(t.version)L("GoJS v"+Xo.version+"  Worker v"+t.version);else if(b=a.Dm.get(t.id)){if(a.Dm.remove(t.id),b.ut=!1,b.ck=null,b.jt)b.jt=!1,b.zg=null;else{var e=Af(b,t,!1);b.network=e,b.updateParts(),b.network=null,b.isValidLayout=!0}if(Sf(b,t.time),null!==(t=b.zg))b.zg=null;else for(e=a.Dm.iteratorValues;e.next();){var n=e.value;if(null!==(t=n.zg)){n.zg=null;break}}null!==t&&Tf(b,t)}},a.Pe.postMessage({_GoJS:"_GoJS",url:a.Dy}),Array.isArray(a.scripts)&&a.scripts.forEach((function(b){a.Pe.postMessage({_GoJS:"_GoJS",url:b})})),a.Pe.postMessage({_GoJS:"_GoJS",version:-1})),null!==this.ck?this.zg=this.network:Tf(this,this.network),Sf(this),this.doMinimalNetworkLayout(),this.network=null,this.isValidLayout=!0)},wf.prototype.onNetworkSerialization=function(){},v.Object.defineProperties(wf.prototype,{diagram:{get:function(){return this.B},set:function(a){this.B=a}},group:{get:function(){return this.v},set:function(a){this.v!==a&&(this.v=a,null!==a&&(this.B=a.diagram))}},isOngoing:{get:function(){return this.ro},set:function(a){this.ro!==a&&(this.ro=a)}},isInitial:{get:function(){return this.xi},set:function(a){this.xi=a,a||(this.vo=!0)}},isViewportSized:{get:function(){return this.wo},set:function(a){this.wo!==a&&(this.wo=a)&&this.C()}},isRouting:{get:function(){return this.to},set:function(a){this.to!==a&&(this.to=a)}},isRealtime:{get:function(){return this.so},set:function(a){this.so!==a&&(this.so=a)}},isValidLayout:{get:function(){return this.vo},set:function(a){this.vo!==a&&(this.vo=a,a||null!==(a=this.diagram)&&(a.Og=!0))}},network:{get:function(){return this.l},set:function(a){this.l!==a&&(this.l=a,null!==a&&(a.layout=this))}},boundsComputation:{get:function(){return this.sn},set:function(a){this.sn!==a&&(this.sn=a,this.C())}},arrangementOrigin:{get:function(){return this.kn},set:function(a){this.kn.w(a)||(this.kn.assign(a),this.C())}},id:{get:function(){return this.I},set:function(a){this.I=a}},mayUseWorkerFunction:{get:function(){return this.No},set:function(a){this.No!==a&&(this.No=a)}},workerStateChanged:{get:function(){return this.mq},set:function(a){this.mq!==a&&(this.mq=a)}}}),wf.prototype.useWorker=wf.prototype.Uw,wf.declareWorkerLayout=Nf,wf.prototype.cancelWorker=wf.prototype.zz,wf.prototype.collectParts=wf.prototype.by,wf.prototype.getLayoutBounds=wf.prototype.mj,wf.prototype.invalidateLayout=wf.prototype.C;var jf=new Mt,Df="object"==typeof w.document&&w.document.currentScript?w.document.currentScript.src:"",Of="undefined"!=typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof Blob?URL.createObjectURL(new Blob(["self.onmessage=function(e){if(e.data.url){\nimportScripts(e.data.url);}}"],{type:"text/javascript"})):"";function Ff(){this.Jv=null,this.Dy=this.l=this.name="",this.scripts=[],this.Pe=null,this.Dm=new Mt}function Bf(a){pt(this),this.lc=a,this.vf=new ft,this.je=new ft,this.$t=new Mt,this.Vt=new Mt}function If(a,b){if(null===b)return!1;var t=a.vf.remove(b);return t&&(null!==(b=b.node)&&a.$t.remove(b)),t}function Rf(a,b){if(null!==b){a.je.add(b);var t=b.link;null!==t&&null===a.Aq(t)&&a.Vt.add(t,b),b.network=a}}function Ef(a,b){null!==b&&a.je.remove(b)&&(null!==(b=b.link)&&a.Vt.remove(b))}function zf(a,b,t){if(null!==t&&t.network!==b){If(a,t),b.Cg(t);for(var e=t.sourceEdges;e.next();){var n=e.value;n.network!==b&&(Ef(a,n),Rf(b,n),zf(a,b,n.fromVertex))}for(e=t.destinationEdges;e.next();)(t=e.value).network!==b&&(Ef(a,t),Rf(b,t),zf(a,b,t.toVertex))}}function Vf(a){pt(this),this.Vc=a,this.l=new Jt(0,0,10,10).freeze(),this.v=new St(5,5).freeze(),this.Ki=this.nb=null,this.Ne=new ut,this.Fe=new ut}function Gf(a,b){return a=a.Ki,b=b.Ki,a?b?(a=a.text)<(b=b.text)?-1:a>b?1:0:1:null!==b?-1:0}function Yf(a){pt(this),this.Uc=a,this.gd=this.$c=this.Ml=this.nb=null}function Xf(){wf.call(this),this.isViewportSized=!0,this.nq=this.oq=NaN,this.Rg=new Ut(NaN,NaN).freeze(),this.mf=new Ut(10,10).freeze(),this.zb=Kf,this.Fb=Hf,this.dd=$f,this.Yc=qf}function qf(a,b){return(a=a.text)<(b=b.text)?-1:a>b?1:0}wf.className="Layout",wf.GoJSScriptURL=Df,wf.declareWorkerLayout=Nf,"undefined"!=typeof self&&void 0!==self.DedicatedWorkerGlobalScope&&"undefined"!=typeof self&&void 0!==self.DedicatedWorkerGlobalScope&&(self.onmessage=function(a){if("_GoJS"===(a=a.data)._GoJS)if(a.url)importScripts(a.url);else if(a.version)self.postMessage({_GoJS:"_GoJS",version:Xo.version},void 0);else{var b=performance.now(),t=null;a.layout&&(t=Cf(a.layout));var e=null;if(t&&t.Jv&&(e=new t.Jv),!e)throw Error("no registered Worker Layout: "+a.layout);e.network=Af(e,a,!0),e.workerLayout=function(){var a=Lf(e,e.network,!1);return a._GoJS="_GoJS",a.time=performance.now()-b,self.postMessage(a,void 0),!0},e.doLayout(new ut)}}),Bf.prototype.clear=function(){if(this.vf)for(var a=this.vf.iterator;a.next();)a.value.clear();if(this.je)for(a=this.je.iterator;a.next();)a.value.clear();this.vf=new ft,this.je=new ft,this.$t=new Mt,this.Vt=new Mt},Bf.prototype.toString=function(a){void 0===a&&(a=0);var b="LayoutNetwork"+(null!==this.layout?"("+this.layout.toString()+")":"");if(0>=a)return b;if(b+=" vertexes: "+this.vf.count+" edges: "+this.je.count,1<a){for(var t=this.vf.iterator;t.next();)b+="\n    "+t.value.toString(a-1);for(t=this.je.iterator;t.next();)b+="\n    "+t.value.toString(a-1)}return b},Bf.prototype.createVertex=function(){return new Vf(this)},Bf.prototype.createEdge=function(){return new Yf(this)},Bf.prototype.Bg=function(a,b,t){if(null!==a){for(void 0===b&&(b=!1),void 0===t&&(t=null),null===t&&(t=function(a){if(a instanceof zu)return!a.isLinkLabel;if(a instanceof uc){var b=a.fromNode;return null!==b&&!b.isLinkLabel&&(null!==(a=a.toNode)&&!a.isLinkLabel)}return!1}),a=a.iterator;a.next();){var e=a.value;if(e instanceof zu&&(!b||e.isTopLevel)&&e.canLayout()&&t(e))if(e instanceof oc&&null===e.layout)this.Bg(e.memberParts,!1);else if(null===this.jj(e)){var n=this.createVertex();n.node=e,this.Cg(n)}}for(a.reset();a.next();)if((e=a.value)instanceof uc&&(!b||e.isTopLevel)&&e.canLayout()&&t(e)&&null===this.Aq(e)){var o=e.fromNode;n=e.toNode,null!==o&&null!==n&&o!==n&&(o=this.findGroupVertex(o),n=this.findGroupVertex(n),null!==o&&null!==n&&this.Bk(o,n,e))}}},Bf.prototype.findGroupVertex=function(a){if(null===a)return null;var b=a.findVisibleNode();if(null===b)return null;if(null!==(a=this.jj(b)))return a;for(b=b.containingGroup;null!==b;){if(null!==(a=this.jj(b)))return a;b=b.containingGroup}return null},(n=Bf.prototype).Cg=function(a){if(null!==a){this.vf.add(a);var b=a.node;null!==b&&this.$t.add(b,a),a.network=this}},n.kk=function(a){if(null===a)return null;var b=this.jj(a);return null===b&&((b=this.createVertex()).node=a,this.Cg(b)),b},n.Mv=function(a){if(null!==a&&If(this,a)){for(var b=a.Ne,t=b.count-1;0<=t;t--){var e=b.J(t);this.tk(e)}for(a=(b=a.Fe).count-1;0<=a;a--)t=b.J(a),this.tk(t)}},n.Lz=function(a){null!==a&&(null!==(a=this.jj(a))&&this.Mv(a))},n.jj=function(a){return null===a?null:this.$t.H(a)},n.qm=function(a){if(null!==a){Rf(this,a);var b=a.toVertex;null!==b&&b.Cv(a),null!==(b=a.fromVertex)&&b.Av(a)}},n.Wx=function(a){if(null===a)return null;var b=a.fromNode,t=a.toNode,e=this.Aq(a);return null===e?((e=this.createEdge()).link=a,null!==b&&(e.fromVertex=this.kk(b)),null!==t&&(e.toVertex=this.kk(t)),this.qm(e)):(e.fromVertex=null!==b?this.kk(b):null,e.toVertex=null!==t?this.kk(t):null),e},n.tk=function(a){if(null!==a){var b=a.toVertex;null!==b&&b.Lv(a),null!==(b=a.fromVertex)&&b.Kv(a),Ef(this,a)}},n.Kz=function(a){null!==a&&(null!==(a=this.Aq(a))&&this.tk(a))},n.Aq=function(a){return null===a?null:this.Vt.H(a)},n.Bk=function(a,b,t){if(null===a||null===b)return null;if(a.network===this&&b.network===this){var e=this.createEdge();return e.link=t,e.fromVertex=a,e.toVertex=b,this.qm(e),e}return null},n.Pm=function(a){if(null!==a){var b=a.fromVertex,t=a.toVertex;null!==b&&null!==t&&(b.Kv(a),t.Lv(a),a.Pm(),b.Cv(a),t.Av(a))}},n.xq=function(){for(var a=I(),b=this.je.iterator;b.next();){var t=b.value;t.fromVertex===t.toVertex&&a.push(t)}for(b=a.length,t=0;t<b;t++)this.tk(a[t]);R(a)},Bf.prototype.deleteArtificialVertexes=function(){for(var a=I(),b=this.vf.iterator;b.next();){var t=b.value;null===t.node&&null===t.data&&a.push(t)}for(t=a.length,b=0;b<t;b++)this.Mv(a[b]);for(b=I(),t=this.je.iterator;t.next();){var e=t.value;null===e.link&&null===e.data&&b.push(e)}for(t=b.length,e=0;e<t;e++)this.tk(b[e]);R(a),R(b)},Bf.prototype.Zy=function(a){void 0===a&&(a=!0),a&&(this.deleteArtificialVertexes(),function(a){for(var b=I(),t=a.je.iterator;t.next();){var e=t.value;null!==e.fromVertex&&null!==e.toVertex||b.push(e)}for(t=b.length,e=0;e<t;e++)a.tk(b[e]);R(b)}(this),this.xq()),a=new ut;for(var b=!0;b;){b=!1;for(var t=this.vf.iterator;t.next();){var e=t.value;if(0<e.Ne.count||0<e.Fe.count){b=this.layout.createNetwork(),a.add(b),zf(this,b,e),b=!0;break}}}return a.sort((function(a,b){return null===a||null===b||a===b?0:b.vertexes.count-a.vertexes.count})),a},Bf.prototype.Rz=function(){for(var a=new ft,b=this.vf.iterator;b.next();)a.add(b.value.node);for(b=this.je.iterator;b.next();)a.add(b.value.link);return a},v.Object.defineProperties(Bf.prototype,{layout:{get:function(){return this.lc},set:function(a){null!==a&&(this.lc=a)}},vertexes:{get:function(){return this.vf}},edges:{get:function(){return this.je}}}),Bf.prototype.findAllParts=Bf.prototype.Rz,Bf.prototype.splitIntoSubNetworks=Bf.prototype.Zy,Bf.prototype.deleteSelfEdges=Bf.prototype.xq,Bf.prototype.reverseEdge=Bf.prototype.Pm,Bf.prototype.linkVertexes=Bf.prototype.Bk,Bf.prototype.findEdge=Bf.prototype.Aq,Bf.prototype.deleteLink=Bf.prototype.Kz,Bf.prototype.deleteEdge=Bf.prototype.tk,Bf.prototype.addLink=Bf.prototype.Wx,Bf.prototype.addEdge=Bf.prototype.qm,Bf.prototype.findVertex=Bf.prototype.jj,Bf.prototype.deleteNode=Bf.prototype.Lz,Bf.prototype.deleteVertex=Bf.prototype.Mv,Bf.prototype.addNode=Bf.prototype.kk,Bf.prototype.addVertex=Bf.prototype.Cg,Bf.prototype.addParts=Bf.prototype.Bg,Bf.className="LayoutNetwork",Vf.prototype.serializeVertexProperties=function(a){a.id=yt(this),a.key=this.node?this.node.key:this.data?this.data.Bi:void 0,void 0===a.key&&(a.key=null),a.x=this.bounds.x,a.y=this.bounds.y,a.hB=this.bounds.width,a.tA=this.bounds.height,a.fx=this.focus.x,a.fy=this.focus.y;var b=[];this.Ne.each((function(a){b.push(yt(a))})),a.Wy=b;var t=[];this.Fe.each((function(a){t.push(yt(a))})),a.ky=t},Vf.prototype.yq=function(a,b,t){if(null!==a){this.x=a.x,this.y=a.y,this.width=a.hB,this.height=a.tA,this.focusX=a.fx,this.focusY=a.fy;var e=this;a.Wy&&a.Wy.forEach((function(a){(a=t.get(a))&&e.Ne.add(a)})),a.ky&&a.ky.forEach((function(a){(a=t.get(a))&&e.Fe.add(a)}))}},Vf.prototype.clear=function(){this.Ki=this.nb=null,this.Ne=new ut,this.Fe=new ut},Vf.prototype.toString=function(a){void 0===a&&(a=0);var b="LayoutVertex#"+yt(this);if(0<a&&(b+=null!==this.node?"("+this.node.toString()+")":"",1<a)){a="";for(var t=!0,e=this.Ne.iterator;e.next();){var n=e.value;t?t=!1:a+=",",a+=n.toString(0)}for(n="",t=!0,e=this.Fe.iterator;e.next();){t?t=!1:n+=",",n+=e.value.toString(0)}b+=" sources: "+a+" destinations: "+n}return b},Vf.prototype.commit=function(){var a=this.nb;if(null!==a){var b=this.bounds,t=a.bounds;j(t)?(t.x=b.x,t.y=b.y,t.width=b.width,t.height=b.height):a.bounds=b.copy()}else if(null!==(a=this.node)){if(b=this.bounds,!(a instanceof oc)){t=Jt.alloc();var e=this.network.layout.mj(a,t),n=a.locationObject.da(bi);if(e.u()&&n.u())return a.moveTo(b.x+this.focusX-(n.x-e.x),b.y+this.focusY-(n.y-e.y)),void Jt.free(t);Jt.free(t)}a.moveTo(b.x,b.y)}},Vf.prototype.Cv=function(a){null!==a&&(this.Ne.contains(a)||this.Ne.add(a))},Vf.prototype.Lv=function(a){null!==a&&this.Ne.remove(a)},Vf.prototype.Av=function(a){null!==a&&(this.Fe.contains(a)||this.Fe.add(a))},Vf.prototype.Kv=function(a){null!==a&&this.Fe.remove(a)},v.Object.defineProperties(Vf.prototype,{sourceEdgesArrayAccess:{get:function(){return this.Ne._dataArray}},destinationEdgesArrayAccess:{get:function(){return this.Fe._dataArray}},data:{get:function(){return this.nb},set:function(a){if(this.nb=a,null!==a&&a.bounds){var b=a.bounds;a=b.x;var t=b.y,e=b.width;b=b.height,this.v.h(e/2,b/2),this.l.h(a,t,e,b)}}},node:{get:function(){return this.Ki},set:function(a){if(this.Ki!==a){this.Ki=a,a.Ta();var b=this.network.layout,t=Jt.alloc(),e=b.mj(a,t);b=e.x;var n=e.y,o=e.width;if(e=e.height,isNaN(b)&&(b=0),isNaN(n)&&(n=0),this.l.h(b,n,o,e),Jt.free(t),!(a instanceof oc)&&(a=a.locationObject.da(bi)).u())return void this.v.h(a.x-b,a.y-n);this.v.h(o/2,e/2)}}},bounds:{get:function(){return this.l},set:function(a){this.l.w(a)||this.l.assign(a)}},focus:{get:function(){return this.v},set:function(a){this.v.w(a)||this.v.assign(a)}},centerX:{get:function(){return this.l.x+this.v.x},set:function(a){var b=this.l;b.x+this.v.x!==a&&(b.ea(),b.x=a-this.v.x,b.freeze())}},centerY:{get:function(){return this.l.y+this.v.y},set:function(a){var b=this.l;b.y+this.v.y!==a&&(b.ea(),b.y=a-this.v.y,b.freeze())}},focusX:{get:function(){return this.v.x},set:function(a){var b=this.v;b.x!==a&&(b.ea(),b.x=a,b.freeze())}},focusY:{get:function(){return this.v.y},set:function(a){var b=this.v;b.y!==a&&(b.ea(),b.y=a,b.freeze())}},x:{get:function(){return this.l.x},set:function(a){var b=this.l;b.x!==a&&(b.ea(),b.x=a,b.freeze())}},y:{get:function(){return this.l.y},set:function(a){var b=this.l;b.y!==a&&(b.ea(),b.y=a,b.freeze())}},width:{get:function(){return this.l.width},set:function(a){var b=this.l;b.width!==a&&(b.ea(),b.width=a,b.freeze())}},height:{get:function(){return this.l.height},set:function(a){var b=this.l;b.height!==a&&(b.ea(),b.height=a,b.freeze())}},network:{get:function(){return this.Vc},set:function(a){this.Vc=a}},sourceVertexes:{get:function(){for(var a=new ft,b=this.sourceEdges;b.next();)a.add(b.value.fromVertex);return a.iterator}},destinationVertexes:{get:function(){for(var a=new ft,b=this.destinationEdges;b.next();)a.add(b.value.toVertex);return a.iterator}},vertexes:{get:function(){for(var a=new ft,b=this.sourceEdges;b.next();)a.add(b.value.fromVertex);for(b=this.destinationEdges;b.next();)a.add(b.value.toVertex);return a.iterator}},sourceEdges:{get:function(){return this.Ne.iterator}},destinationEdges:{get:function(){return this.Fe.iterator}},edges:{get:function(){for(var a=new ut,b=this.sourceEdges;b.next();)a.add(b.value);for(b=this.destinationEdges;b.next();)a.add(b.value);return a.iterator}},edgesCount:{get:function(){return this.Ne.count+this.Fe.count}}}),Vf.prototype.deleteDestinationEdge=Vf.prototype.Kv,Vf.prototype.addDestinationEdge=Vf.prototype.Av,Vf.prototype.deleteSourceEdge=Vf.prototype.Lv,Vf.prototype.addSourceEdge=Vf.prototype.Cv,Vf.className="LayoutVertex",Vf.standardComparer=Gf,Vf.smartComparer=function(a,b){if(null!==a){if(null!==b){a=a.Ki;var t=b.Ki;if(null!==a){if(null!==t){for(b=a.text.toLocaleLowerCase().split(/([+\-]?[\.]?\d+(?:\.\d*)?(?:e[+\-]?\d+)?)/),a=t.text.toLocaleLowerCase().split(/([+\-]?[\.]?\d+(?:\.\d*)?(?:e[+\-]?\d+)?)/),t=0;t<b.length;t++)if(""!==a[t]&&void 0!==a[t]){var e=parseFloat(b[t]),n=parseFloat(a[t]);if(isNaN(e)){if(!isNaN(n))return 1;if(0!==b[t].localeCompare(a[t]))return b[t].localeCompare(a[t])}else{if(isNaN(n))return-1;if(0!=e-n)return e-n}}else if(""!==b[t])return 1;return""!==a[t]&&void 0!==a[t]?-1:0}return 1}return null!==t?-1:0}return 1}return null!==b?-1:0},Yf.prototype.clear=function(){this.gd=this.$c=this.Ml=this.nb=null},Yf.prototype.serializeEdgeProperties=function(a){a.id=yt(this),a.key=this.link?this.link.key:this.data?this.data.Bi:void 0,void 0===a.key&&(a.key=null),a.from=this.fromVertex?yt(this.fromVertex):null,a.cB=this.toVertex?yt(this.toVertex):null},Yf.prototype.deserializeEdgeProperties=function(a,b){if(null!==a){var t=b.get(a.from);t&&(this.fromVertex=t),(a=b.get(a.cB))&&(this.toVertex=a)}},Yf.prototype.toString=function(a){void 0===a&&(a=0);var b="LayoutEdge#"+yt(this);return 0<a&&(b+=null!==this.Ml?"("+this.Ml.toString()+")":"",1<a&&(b+=" "+(this.$c?this.$c.toString():"null")+" --\x3e "+(this.gd?this.gd.toString():"null"))),b},Yf.prototype.Pm=function(){var a=this.$c;this.$c=this.gd,this.gd=a},Yf.prototype.commit=function(){},Yf.prototype.Ay=function(a){return this.gd===a?this.$c:this.$c===a?this.gd:null},v.Object.defineProperties(Yf.prototype,{network:{get:function(){return this.Uc},set:function(a){this.Uc=a}},data:{get:function(){return this.nb},set:function(a){this.nb!==a&&(this.nb=a)}},link:{get:function(){return this.Ml},set:function(a){this.Ml!==a&&(this.Ml=a)}},fromVertex:{get:function(){return this.$c},set:function(a){this.$c!==a&&(this.$c=a)}},toVertex:{get:function(){return this.gd},set:function(a){this.gd!==a&&(this.gd=a)}}}),Yf.prototype.getOtherVertex=Yf.prototype.Ay,Yf.className="LayoutEdge",m(Xf,wf),Xf.prototype.cloneProtected=function(a){wf.prototype.cloneProtected.call(this,a),a.oq=this.oq,a.nq=this.nq,a.Rg.assign(this.Rg),a.mf.assign(this.mf),a.zb=this.zb,a.Fb=this.Fb,a.dd=this.dd,a.Yc=this.Yc},Xf.prototype.jb=function(a){a.classType===Xf?a===$f||a===Qf||a===Jf||a===Zf?this.sorting=a:a===Hf||a===Wf?this.arrangement=a:a===Kf||a===Uf?this.alignment=a:N("Unknown enum value: "+a):wf.prototype.jb.call(this,a)},Xf.prototype.doLayout=function(a){this.arrangementOrigin=this.initialOrigin(this.arrangementOrigin);var b=this.by(a);a=this.diagram;for(var t=b.copy().iterator;t.next();){var e=t.value;if(!e.Oh()||null===e.fromNode&&null===e.toNode){if(e.Ta(),e instanceof oc)for(e=e.memberParts;e.next();)b.remove(e.value)}else b.remove(e)}var n=b.ma();if(0!==n.length){switch(this.sorting){case Zf:n.reverse();break;case $f:n.sort(this.comparer);break;case Qf:n.sort(this.comparer),n.reverse()}var o=this.wrappingColumn;isNaN(o)&&(o=0);var g=this.wrappingWidth;switch(isNaN(g)&&null!==a?(b=a.padding,g=Math.max(a.viewportBounds.width-b.left-b.right,0)):g=Math.max(this.wrappingWidth,0),0>=o&&0>=g&&(o=1),b=this.spacing.width,isFinite(b)||(b=0),t=this.spacing.height,isFinite(t)||(t=0),null!==a&&a.xa("Layout"),e=[],this.alignment){case Uf:var r=b,h=t,l=Jt.alloc(),c=Math.max(this.cellSize.width,1);if(!isFinite(c))for(var f=c=0;f<n.length;f++){var p=this.mj(n[f],l);c=Math.max(c,p.width)}if(c=Math.max(c+r,1),f=Math.max(this.cellSize.height,1),!isFinite(f))for(p=f=0;p<n.length;p++){var d=this.mj(n[p],l);f=Math.max(f,d.height)}f=Math.max(f+h,1),p=this.arrangement;for(var q=d=this.arrangementOrigin.x,u=this.arrangementOrigin.y,y=0,m=0,v=0;v<n.length;v++){var x=n[v],w=this.mj(x,l),k=Math.ceil((w.width+r)/c)*c,M=Math.ceil((w.height+h)/f)*f;switch(p){case Wf:var S=Math.abs(q-w.width);break;default:S=q+w.width}switch((0<o&&y>o-1||0<g&&0<y&&S-d>g)&&(e.push(new Jt(0,u,g+r,m)),y=0,q=d,u+=m,m=0),m=Math.max(m,M),p){case Wf:w=-w.width;break;default:w=0}switch(x.moveTo(q+w,u),p){case Wf:q-=k;break;default:q+=k}y++}e.push(new Jt(0,u,g+r,m)),Jt.free(l);break;case Kf:for(h=g,c=o,f=b,p=t,g=Jt.alloc(),d=Math.max(this.cellSize.width,1),o=u=l=0,r=St.alloc(),q=0;q<n.length;q++)m=n[q],y=this.mj(m,g),m=m.Ff(m.locationObject,m.locationSpot,r),l=Math.max(l,m.x),u=Math.max(u,y.width-m.x),o=Math.max(o,m.y);switch(q=this.arrangement){case Wf:l+=f;break;default:u+=f}d=isFinite(d)?Math.max(d+f,1):Math.max(l+u,1);var P=m=this.arrangementOrigin.x;for(v=this.arrangementOrigin.y,u=0,h>=l&&(h-=l),l=x=0,k=Math.max(this.cellSize.height,1),w=o=0,M=!0,y=St.alloc(),S=0;S<n.length;S++){var N=n[S],C=this.mj(N,g),T=N.Ff(N.locationObject,N.locationSpot,r);if(0<u)switch(q){case Wf:P=(P-m-(C.width-T.x))/d,P=(P=oe.aa(Math.round(P),P)?Math.round(P):Math.floor(P))*d+m;break;default:P=(P-m+T.x)/d,P=(P=oe.aa(Math.round(P),P)?Math.round(P):Math.ceil(P))*d+m}else switch(q){case Wf:x=P+T.x+C.width;break;default:x=P-T.x}switch(q){case Wf:var L=-(P+T.x)+x;break;default:L=P+C.width-T.x-x}if(0<c&&u>c-1||0<h&&0<u&&L>h){for(e.push(new Jt(0,M?v-o:v,h+f,w+o+p)),P=0;P<u&&S!==u;P++){var A=(L=n[S-u+P]).Ff(L.locationObject,L.locationSpot,y);L.moveTo(L.position.x,L.position.y+o-A.y)}w+=p,v=M?v+w:v+(w+o),u=w=o=0,P=m,M=!1}switch(P===m&&(l=q===Wf?Math.max(l,C.width-T.x):Math.min(l,-T.x)),o=Math.max(o,T.y),w=Math.max(w,C.height-T.y),isFinite(k)&&(w=Math.max(w,Math.max(C.height,k)-T.y)),M?N.moveTo(P-T.x,v-T.y):N.moveTo(P-T.x,v),q){case Wf:P-=T.x+f;break;default:P+=C.width-T.x+f}u++}if(e.push(new Jt(0,v,h+f,(M?w:w+o)+p)),n.length!==u)for(h=0;h<u;h++)f=(c=n[n.length-u+h]).Ff(c.locationObject,c.locationSpot,r),c.moveTo(c.position.x,c.position.y+o-f.y);if(St.free(r),St.free(y),q===Wf)for(n=0;n<e.length;n++)(o=e[n]).width+=l,o.x-=l;else for(n=0;n<e.length;n++)(o=e[n]).x>l&&(o.width+=o.x-l,o.x=l);Jt.free(g)}for(r=o=g=n=0;r<e.length;r++)h=e[r],n=Math.min(n,h.x),g=Math.min(g,h.y),o=Math.max(o,h.x+h.width);this.arrangement===Wf?this.commitLayers(e,new St(n+b/2-(o+n),g-t/2)):this.commitLayers(e,new St(n-b/2,g-t/2)),null!==a&&a.Wa("Layout"),this.isValidLayout=!0}},Xf.prototype.commitLayers=function(){},v.Object.defineProperties(Xf.prototype,{wrappingWidth:{get:function(){return this.oq},set:function(a){this.oq!==a&&(0<a||isNaN(a))&&(this.oq=a,this.isViewportSized=isNaN(a),this.C())}},wrappingColumn:{get:function(){return this.nq},set:function(a){this.nq!==a&&(0<a||isNaN(a))&&(this.nq=a,this.C())}},cellSize:{get:function(){return this.Rg},set:function(a){this.Rg.w(a)||(this.Rg.assign(a),this.C())}},spacing:{get:function(){return this.mf},set:function(a){this.mf.w(a)||(this.mf.assign(a),this.C())}},alignment:{get:function(){return this.zb},set:function(a){this.zb===a||a!==Kf&&a!==Uf||(this.zb=a,this.C())}},arrangement:{get:function(){return this.Fb},set:function(a){this.Fb===a||a!==Hf&&a!==Wf||(this.Fb=a,this.C())}},sorting:{get:function(){return this.dd},set:function(a){this.dd===a||a!==Jf&&a!==Zf&&a!==$f&&a!==Qf||(this.dd=a,this.C())}},comparer:{get:function(){return this.Yc},set:function(a){this.Yc!==a&&(this.Yc=a,this.C())}}});var Uf=new _(Xf,"Position",0),Kf=new _(Xf,"Location",1),Hf=new _(Xf,"LeftToRight",2),Wf=new _(Xf,"RightToLeft",3),Jf=new _(Xf,"Forward",4),Zf=new _(Xf,"Reverse",5),$f=new _(Xf,"Ascending",6),Qf=new _(Xf,"Descending",7);function _f(){this.fp=new ft,this.Ho=new ft,this.Da=new ft,this.Ve=new Mt,this.Ue=new Mt,this.Oj=new Mt,this.B=null,this.mr=!1}function id(a,b,t){if(null!=b&&!a.diagram.undoManager.isUndoingRedoing&&!a.Ve.contains(b)){void 0===t&&(t=!0);t:{if(null!=b&&!a.B.undoManager.isUndoingRedoing&&!a.Ve.contains(b)){var e=a.Eq(b),n=ed(a,b,e);if(null!==n&&($h(n),null!==(n=n.copy()))){var o=a.diagram.skipsModelSourceBindings;a.diagram.skipsModelSourceBindings=!0,n.Pf=e,n.nb=b,a.mr&&(n.ih="Tool"),a.diagram.add(n),n.nb=null,n.data=b,a.diagram.skipsModelSourceBindings=o,e=n;break t}}e=null}null!==e&&t&&a.resolveReferencesForData(b)}}function ed(a,b,t){var e=(a=a.B).model;return e.zk()&&e.dw(b)?null===(b=a.groupTemplateMap.H(t))&&(null===(b=a.groupTemplateMap.H(""))&&(ld||(ld=!0,L('No Group template found for category "'+t+'"'),L("  Using default group template")),b=a.Bu)):null===(b=a.nodeTemplateMap.H(t))&&(null===(b=a.nodeTemplateMap.H(""))&&(hd||(hd=!0,L('No Node template found for category "'+t+'"'),L("  Using default node template")),b=a.Du)),b}function nd(a,b,t){for(var e in t){var n=b[e],o=t[e];if(D(o)){if(!D(n)||n.length<o.length)return!1;for(var g=0;g<n.length;g++){var r=o[g];if(void 0!==r&&!od(a,n[g],r))return!1}}else if(!od(a,n,o))return!1}return!0}function od(a,b,t){if("function"==typeof t){if(!t(b))return!1}else if(t instanceof RegExp){if(!b||!t.test(b.toString()))return!1}else if(j(b)&&j(t)){if(!nd(a,b,t))return!1}else if(b!==t)return!1;return!0}function rd(a,b){var t=b.Ai;if(D(t)){var e=a.Oj.H(t);if(null===e)(e=[]).push(b),a.Oj.add(t,e);else{for(a=0;a<e.length;a++)if(e[a]===b)return;e.push(b)}}}function sd(a,b,t){Vh(b,(function(a){for(var b=(a=a.W.j).length,e=0;e<b;e++)Yr(t,a[e])}));var e=b.Ai;if(D(e)){var n=a.Oj.H(e);if(null!==n)for(var o=0;o<n.length;o++)if(n[o]===b){n.splice(o,1),0===n.length&&a.Oj.remove(e);break}}}function ad(a,b,t,e,n){if(null===b||n&&!b.canCopy())return null;if(e.contains(b))return e.H(b);var o=a.copyPartData(b,t);if(!(o instanceof yu))return null;if(o.isSelected=!1,o.isHighlighted=!1,e.add(b,o),b instanceof zu){for(var g=b.linksConnected;g.next();){var r=g.value;if(r.fromNode===b){var h=e.H(r);null!==h&&(h.fromNode=o)}r.toNode===b&&(null!==(r=e.H(r))&&(r.toNode=o))}if(b instanceof oc&&o instanceof oc)for(b=b.memberParts;b.next();)(g=ad(a,b.value,t,e,n))instanceof uc||null===g||(g.containingGroup=o)}else if(b instanceof uc&&o instanceof uc)for(null!==(g=b.fromNode)&&(null!==(g=e.H(g))&&(o.fromNode=g)),null!==(g=b.toNode)&&(null!==(g=e.H(g))&&(o.toNode=g)),b=b.labelNodes;b.next();)null!==(g=ad(a,b.value,t,e,n))&&g instanceof zu&&(g.labeledLink=o);return o}Xf.className="GridLayout",Xf.standardComparer=qf,Xf.smartComparer=function(a,b){if(null!==a){if(null!==b){a=a.text.toLocaleLowerCase().split(/([+\-]?[\.]?\d+(?:\.\d*)?(?:e[+\-]?\d+)?)/),b=b.text.toLocaleLowerCase().split(/([+\-]?[\.]?\d+(?:\.\d*)?(?:e[+\-]?\d+)?)/);for(var t=0;t<a.length;t++)if(""!==b[t]&&void 0!==b[t]){var e=parseFloat(a[t]),n=parseFloat(b[t]);if(isNaN(e)){if(!isNaN(n))return 1;if(0!==a[t].localeCompare(b[t]))return a[t].localeCompare(b[t])}else{if(isNaN(n))return-1;if(0!=e-n)return e-n}}else if(""!==a[t])return 1;return""!==b[t]&&void 0!==b[t]?-1:0}return 1}return null!==b?-1:0},Xf.Position=Uf,Xf.Location=Kf,Xf.LeftToRight=Hf,Xf.RightToLeft=Wf,Xf.Forward=Jf,Xf.Reverse=Zf,Xf.Ascending=$f,Xf.Descending=Qf,(n=_f.prototype).clear=function(){this.fp.clear(),this.Ho.clear(),this.Da.clear(),this.Ve.clear(),this.Ue.clear(),this.Oj.clear()},n.ce=function(a){this.B=a},n.nj=function(a){if(a instanceof zu){if(this.fp.add(a),a instanceof oc){var b=a.containingGroup;null===b?this.B.Ch.add(a):b.Rl.add(a),null!==(b=a.layout)&&(b.diagram=this.B)}}else a instanceof uc?this.Ho.add(a):a instanceof Eu||this.Da.add(a);null===(b=a.data)||a instanceof Eu||(a instanceof uc?this.Ue.add(b,a):this.Ve.add(b,a))},n.Mc=function(a){if(a.lk(),a instanceof zu){if(this.fp.remove(a),a instanceof oc){var b=a.containingGroup;null===b?this.B.Ch.remove(a):b.Rl.remove(a),null!==(b=a.layout)&&(b.diagram=null)}}else a instanceof uc?this.Ho.remove(a):a instanceof Eu||this.Da.remove(a);null===(b=a.data)||a instanceof Eu||(a instanceof uc?this.Ue.remove(b):this.Ve.remove(b))},n.Kd=function(){for(var a=this.B.nodeTemplateMap.iterator;a.next();){var b=a.value,t=a.key;(!b.Oc()||b instanceof oc)&&N('Invalid node template in Diagram.nodeTemplateMap: template for "'+t+'" must be a Node or a simple Part, not a Group or Link: '+b)}for(a=this.B.groupTemplateMap.iterator;a.next();)b=a.value,t=a.key,b instanceof oc||N('Invalid group template in Diagram.groupTemplateMap: template for "'+t+'" must be a Group, not a normal Node or Link: '+b);for(a=this.B.linkTemplateMap.iterator;a.next();)b=a.value,t=a.key,b instanceof uc||N('Invalid link template in Diagram.linkTemplateMap: template for "'+t+'" must be a Link, not a normal Node or simple Part: '+b);for(a=I(),b=this.B.selection.iterator;b.next();)(t=b.value.data)&&a.push(t);for(b=I(),t=this.B.highlighteds.iterator;t.next();){var e=t.value.data;e&&b.push(e)}for(t=I(),e=this.nodes.iterator;e.next();){var n=e.value;null!==n.data&&(t.push(n.data),t.push(n.location))}for(e=this.links.iterator;e.next();)null!==(n=e.value).data&&(t.push(n.data),t.push(n.location));for(e=this.parts.iterator;e.next();)null!==(n=e.value).data&&(t.push(n.data),t.push(n.location));for(this.removeAllModeledParts(),this.addAllModeledParts(),e=0;e<a.length;e++)null!==(n=this.zc(a[e]))&&(n.isSelected=!0);for(e=0;e<b.length;e++)null!==(n=this.zc(b[e]))&&(n.isHighlighted=!0);for(e=0;e<t.length;e+=2)null!==(n=this.zc(t[e]))&&(n.location=t[e+1]);R(a),R(b),R(t)},_f.prototype.addAllModeledParts=function(){this.addModeledParts(this.diagram.model.nodeDataArray)},_f.prototype.addModeledParts=function(a,b){var t=this,e=this.diagram.model;a.forEach((function(a){e.$a(a)&&id(t,a,!1)})),a.forEach((function(a){e.$a(a)&&t.resolveReferencesForData(a)})),!1!==b&&qr(this.diagram,!1)},_f.prototype.insertLink=function(){return null},_f.prototype.resolveReferencesForData=function(){},_f.prototype.Eq=function(a){return this.B.model.Eq(a)},_f.prototype.getLinkCategoryForData=function(){return""},_f.prototype.setLinkCategoryForData=function(){},_f.prototype.setFromNodeForLink=function(){},_f.prototype.setToNodeForLink=function(){},_f.prototype.findLinkTemplateForCategory=function(a){var b=this.B.linkTemplateMap.H(a);return null===b&&(null===(b=this.B.linkTemplateMap.H(""))&&(ud||(ud=!0,L('No Link template found for category "'+a+'"'),L("  Using default link template")),b=this.B.Cu)),b},_f.prototype.removeAllModeledParts=function(){this.du(this.diagram.model.nodeDataArray)},_f.prototype.du=function(a){var b=this;a.forEach((function(a){b.Zq(a)}))},_f.prototype.Zq=function(a){null!==(a=this.zc(a))&&(Tr(this.diagram,a,!1),this.unresolveReferencesForPart(a))},_f.prototype.unresolveReferencesForPart=function(){},_f.prototype.removeDataForLink=function(){},_f.prototype.findPartForKey=function(a){return null==a?null:null!==(a=this.B.model.Lb(a))?this.Ve.H(a):null},_f.prototype.Db=function(a){return null==a||null===(a=this.B.model.Lb(a))?null:(a=this.Ve.H(a))instanceof zu?a:null},_f.prototype.findLinkForKey=function(){return null},(n=_f.prototype).zc=function(a){if(null===a)return null;var b=this.Ve.H(a);return null!==b?b:b=this.Ue.H(a)},n.fj=function(a){return null===a?null:(a=this.Ve.H(a))instanceof zu?a:null},n.yc=function(a){return null===a?null:this.Ue.H(a)},n.Ht=function(a){for(var b=0;b<arguments.length;++b);b=new ft;for(var t=this.fp.iterator;t.next();){var e=t.value,n=e.data;if(null!==n)for(var o=0;o<arguments.length;o++){var g=arguments[o];if(j(g)&&nd(this,n,g)){b.add(e);break}}}return b.iterator},n.Gt=function(a){for(var b=0;b<arguments.length;++b);b=new ft;for(var t=this.Ho.iterator;t.next();){var e=t.value,n=e.data;if(null!==n)for(var o=0;o<arguments.length;o++){var g=arguments[o];if(j(g)&&nd(this,n,g)){b.add(e);break}}}return b.iterator},_f.prototype.doModelChanged=function(a){if(this.B){var b=this.B;if(a.model===b.model){var t=a.change;if(b.doModelChanged(a),b.Z){b.Z=!1;try{var e=a.modelChange;if(""!==e)if(t===Fe){if("nodeCategory"===e){var n=this.zc(a.object),o=a.newValue;null!==n&&"string"==typeof o&&(n.category=o)}else"nodeDataArray"===e&&(this.du(a.oldValue),this.addModeledParts(a.newValue));b.isModified=!0}else if(t===Be){var g=a.newValue;"nodeDataArray"===e&&j(g)&&id(this,g),b.isModified=!0}else if(t===Ie){var r=a.oldValue;"nodeDataArray"===e&&j(r)&&this.Zq(r),b.isModified=!0}else t===Oe&&("SourceChanged"===e?null!==a.object?this.updateDataBindings(a.object,a.propertyName):(this.ir(),this.updateAllTargetBindings()):"ModelDisplaced"===e&&this.Kd());else if(t===Fe){var h=a.propertyName,l=a.object;l===b.model?"nodeKeyProperty"!==h&&"nodeCategoryProperty"!==h||b.undoManager.isUndoingRedoing||this.Kd():this.updateDataBindings(l,h),b.isModified=!0}else if(t===Be||t===Ie){var c=a.change===Be,f=c?a.newParam:a.oldParam,p=c?a.newValue:a.oldValue,d=this.Oj.H(a.object);if(Array.isArray(d))for(a=0;a<d.length;a++){var q=d[a];if(c)_h(q,p,f);else if(!(0>f)){var u=f+Qh(q);q.Mc(u,!0),tl(q,u,f)}}b.isModified=!0}}finally{b.Z=!0}}}}},_f.prototype.updateAllTargetBindings=function(a){void 0===a&&(a="");for(var b=this.parts.iterator;b.next();)b.value.Ca(a);for(b=this.nodes.iterator;b.next();)b.value.Ca(a);for(b=this.links.iterator;b.next();)b.value.Ca(a)},_f.prototype.ir=function(){for(var a=this.B.model,b=new ft,t=a.nodeDataArray,e=0;e<t.length;e++)b.add(t[e]);var n=[];for(this.nodes.each((function(a){null===a.data||b.contains(a.data)||n.push(a.data)})),this.parts.each((function(a){null===a.data||b.contains(a.data)||n.push(a.data)})),n.forEach((function(b){Od(a,b,!1)})),e=0;e<t.length;e++){var o=t[e];null===this.zc(o)&&Dd(a,o,!1)}for(this.refreshDataBoundLinks(),t=this.parts.iterator;t.next();)t.value.updateRelationshipsFromData();for(t=this.nodes.iterator;t.next();)t.value.updateRelationshipsFromData();for(t=this.links.iterator;t.next();)t.value.updateRelationshipsFromData()},_f.prototype.refreshDataBoundLinks=function(){},_f.prototype.updateRelationshipsFromData=function(){},_f.prototype.updateDataBindings=function(a,b){if("string"==typeof b){var t=this.zc(a);if(null!==t)t.Ca(b);else{t=null;for(var e=this.Oj.iterator;e.next();){for(var n=e.value,o=0;o<n.length;o++){var g=n[o].sy(a);null!==g&&(null===t&&(t=I()),t.push(g))}if(null!==t)break}if(null!==t){for(e=0;e<t.length;e++)t[e].Ca(b);R(t)}}a===this.diagram.model.modelData&&this.updateAllTargetBindings(b)}},_f.prototype.rk=function(a,b,t){void 0===t&&(t=!1);var e=new Mt;if(D(a))for(var n=0;n<a.length;n++)ad(this,a[n],b,e,t);else for(a=a.iterator;a.next();)ad(this,a.value,b,e,t);if(null!==b){t=b.model,a=null!==(a=b.toolManager.findTool("Dragging"))?a.dragOptions.dragsLink:b.il.dragsLink,n=new ft;for(var o=new Mt,g=e.iterator;g.next();){var r=g.value;if(r instanceof uc)a||null!==r.fromNode&&null!==r.toNode||n.add(r);else if(r instanceof zu&&null!==r.data&&t.Cm()){var h=r,l=(r=g.key).Gg();null!==l&&(null!==(l=e.H(l))?(t.de(h.data,t.ja(l.data)),h=b.yc(h.data),null!==(r=r.ij())&&null!==h&&o.add(r,h)):t.de(h.data,void 0))}}if(0<n.count&&b.eu(n,!1),0<o.count)for(t=o.iterator;t.next();)e.add(t.key,t.value)}if(null!==b&&null!==this.B&&null!==(t=(b=b.model).afterCopyFunction)){var c=new Mt;e.each((function(a){null!==a.key.data&&c.add(a.key.data,a.value.data)})),t(c,b,this.B.model)}for(b=e.iterator;b.next();)b.value.Ca();return e},_f.prototype.copyPartData=function(a,b){var t=null,e=a.data;if(null!==e&&null!==b){var n=b.model;a instanceof uc||j(e=n.copyNodeData(e))&&(n.wf(e),t=b.zc(e))}else $h(a),null!==(t=a.copy())&&(n=this.B,null!==b?b.add(t):null!==e&&null!==n&&null!==n.commandHandler&&n.commandHandler.copiesClipboardData&&(b=n.model,n=null,t instanceof uc||(n=b.copyNodeData(e)),j(n)&&(t.data=n)));return t},v.Object.defineProperties(_f.prototype,{nodes:{get:function(){return this.fp}},links:{get:function(){return this.Ho}},parts:{get:function(){return this.Da}},diagram:{get:function(){return this.B}},addsToTemporaryLayer:{get:function(){return this.mr},set:function(a){this.mr=a}}}),_f.prototype.updateAllRelationshipsFromData=_f.prototype.ir,_f.prototype.findLinksByExample=_f.prototype.Gt,_f.prototype.findNodesByExample=_f.prototype.Ht,_f.prototype.findLinkForData=_f.prototype.yc,_f.prototype.findNodeForData=_f.prototype.fj,_f.prototype.findPartForData=_f.prototype.zc,_f.prototype.findNodeForKey=_f.prototype.Db,_f.prototype.removeModeledPart=_f.prototype.Zq,_f.prototype.removeModeledParts=_f.prototype.du,_f.prototype.rebuildParts=_f.prototype.Kd;var hd=!1,ld=!1,ud=!1;function cd(a){_f.apply(this,arguments)}function fd(a,b){b.forEach((function(b){pd(a,b)})),qr(a.diagram,!1)}function pd(a,b){if(null!=b&&!a.diagram.undoManager.isUndoingRedoing&&!a.Ue.contains(b)){var t=a.getLinkCategoryForData(b),e=a.findLinkTemplateForCategory(t);if(null!==e){$h(e);var n=e.copy();if(null!==n){e=a.diagram.skipsModelSourceBindings,a.diagram.skipsModelSourceBindings=!0,n.Pf=t,n.nb=b;var o=_d(t=a.diagram.model,b,!0);""!==o&&(n.fromPortId=o),void 0!==(o=$d(t,b,!0))&&((o=a.Db(o))instanceof zu&&(n.fromNode=o)),""!==(o=_d(t,b,!1))&&(n.toPortId=o),void 0!==(o=$d(t,b,!1))&&((o=a.Db(o))instanceof zu&&(n.toNode=o)),t=t.Df(b),Array.isArray(t)&&t.forEach((function(b){null!==(b=a.Db(b))&&(b.labeledLink=n)})),a.mr&&(n.ih="Tool"),a.diagram.add(n),n.nb=null,n.data=b,a.diagram.skipsModelSourceBindings=e}}}}function gd(a,b){b.forEach((function(b){a.Zq(b)}))}function yd(){_f.apply(this,arguments),this.rh=null}function md(a,b,t){if(null!==b&&null!==t){var e=a.diagram.toolManager.findTool("Linking"),n=b,o=t;if(a.diagram.isTreePathToChildren){for(b=o.linksConnected;b.next();)if(b.value.toNode===o)return}else for(o=b,b=(n=t).linksConnected;b.next();)if(b.value.fromNode===n)return;if((null===e||!xn(e,n,o,null,!0))&&(e=a.getLinkCategoryForData(t.data),null!==(b=a.findLinkTemplateForCategory(e))&&($h(b),null!==(b=b.copy())))){var g=a.diagram.skipsModelSourceBindings;a.diagram.skipsModelSourceBindings=!0,b.Pf=e,b.nb=t.data,b.fromNode=n,b.toNode=o,a.diagram.add(b),b.nb=null,b.data=t.data,a.diagram.skipsModelSourceBindings=g}}}function vd(a){this.Mi=new ft,this.Ji=new ft,this.qu=',\n  "insertedNodeKeys": ',this.lx=',\n  "modifiedNodeData": ',this.su=',\n  "removedNodeKeys": ',this.Xh=null,pt(this),this.In=this.Qa="",this.bg=!1,this.l={},this.Gc=[],this.Va=new Mt,this.Li="key",this.gl=this.Ol=null,this.zn=this.An=!1,this.Cn=!0,this.gn=null,this.Wj="category",this.Vf=new Mt,this.$u=new ut,this.wg=!1,this.v=null,this.undoManager=new Ee,void 0!==a&&(this.nodeDataArray=a)}function xd(a,b,t,e,n,o){function g(a,t){r?(void 0===a.__gohashid&&o.push(a),e.set(a,t)):(a=mt++,e.set(a,t),n.set(a,b))}if(!j(b))return b;o||(o=[]);var r=Object.isExtensible(b);if(e||(e=new Mt),r){var h=e.get(b);if(h)return h}else for(n||(n=new Mt),h=n.iterator;h.next();){var l=h.key;if(h.value===b&&(l=e.get(l)))return l}if(Array.isArray(b)){g(b,h=[]);for(var c=0;c<b.length;c++)h.push(xd(a,b[c],!1,e,n,o))}else if(b instanceof St||b instanceof Ut||b instanceof Jt||b instanceof ui||b instanceof $i)h=b.copy(),g(b,h);else{if(b instanceof qa||b instanceof td||b instanceof _)return b;if(b instanceof ut)h=(new ut).addAll(xd(a,b.ma(),!1,e,n,o)),g(b,h);else if(b instanceof ft)h=(new ft).addAll(xd(a,b.ma(),!1,e,n,o)),g(b,h);else if(b instanceof Mt)h=(new Mt).addAll(xd(a,b.ma(),!1,e,n,o)),g(b,h);else if(b instanceof Date)h=new Date(b.getTime()),g(b,h);else if(b instanceof RegExp)h=new RegExp(b),g(b,h),h.lastIndex=b.lastIndex;else if("function"==typeof b.copy)h=b.copy(),g(b,h);else for(c in g(b,h={}),b)"__gohashid"!==c&&(h[c]=xd(a,b[c],!1,e,n,o))}return t&&o.forEach((function(a){delete a.__gohashid})),h}function br(a){return',\n  "modelData": '+Td(a,a.modelData)}function bd(a,b){j(b=b.modelData)&&(a.Mm(b),a.modelData=b)}function wd(a,b,t,e){if(b===t)return!0;if(typeof b!=typeof t||"function"==typeof b||"function"==typeof t)return!1;if(Array.isArray(b)&&Array.isArray(t)){if(e.H(b)===t)return!0;if(e.add(b,t),b.length!==t.length)return!1;for(var n=0;n<b.length;n++)if(!wd(a,b[n],t[n],e))return!1;return!0}if(j(b)&&j(t)){if(e.H(b)===t)return!0;for(var o in e.add(b,t),b){var g=b[o];if(!Nd(o,g)){var r=t[o];if(void 0===r||!wd(a,g,r,e))return!1}}for(n in t)if(!Nd(n,o=t[n])&&(void 0===(g=b[n])||!wd(a,g,o,e)))return!1;return!0}return!1}function hr(a,b,t){a[t]!==b[t]&&N("Model.computeJsonDifference: Model."+t+' is not the same in both models: "'+a[t]+'" and "'+b[t]+'"')}function kd(a,b){function t(a,b){if((b=b.part)&&a!==(b=b.data)){var t=e.get(a);null===t?((t=new ft).add(b),e.add(a,t)):t.add(b)}}var e=a.Xh;null===e&&(e=new Mt,b.changes.each((function(a){if(null!==a.diagram){var b=a.change;b===Fe?(a=a.object.panel)&&(b=a.data)&&t(b,a):b!==Be&&b!==Ie||(b=(a=a.object).itemArray)&&t(b,a)}})),a.Xh=e)}function Md(a,b){for(var t=new ft,e=0;e<a.nodeDataArray.length;e++){var n=a.nodeDataArray[e];Sd(a,b,n,n,t)}return t}function Sd(a,b,t,e,n){if(Array.isArray(t))for(var o=0;o<t.length;o++){var g=t[o];if(g===b)return n.add(e),!0;if(Sd(a,b,g,e,n))return!0}else if(j(t)&&Object.getPrototypeOf(t)===Object.prototype)for(o in t){if((g=t[o])===b)return n.add(e),!0;if(Sd(a,b,g,e,n))return!0}return!1}function Pd(a,b,t){void 0===t&&(t=!1);var e=b.length;if(0>=e)return"[]";var n=new it;n.add("["),t&&1<e&&n.add("\n");for(var o=0;o<e;o++){var g=b[o];void 0!==g&&(0<o&&(n.add(","),t&&n.add("\n")),n.add(a.Zm(g)))}return t&&1<e&&n.add("\n"),n.add("]"),n.toString()}function Nd(a,b){return void 0===b||"__gohashid"===a||"_"===a[0]||"function"==typeof b}function Cd(a){return isNaN(a)?"NaN":1/0===a?"9e9999":-1/0===a?"-9e9999":a}function Td(a,b){var t=b;if(t instanceof St)b={class:"go.Point",x:Cd(t.x),y:Cd(t.y)};else if(t instanceof Ut)b={class:"go.Size",width:Cd(t.width),height:Cd(t.height)};else if(t instanceof Jt)b={class:"go.Rect",x:Cd(t.x),y:Cd(t.y),width:Cd(t.width),height:Cd(t.height)};else if(t instanceof ui)b={class:"go.Margin",top:Cd(t.top),right:Cd(t.right),bottom:Cd(t.bottom),left:Cd(t.left)};else if(t instanceof $i)b=t.kb()?{class:"go.Spot",x:Cd(t.x),y:Cd(t.y),offsetX:Cd(t.offsetX),offsetY:Cd(t.offsetY)}:{class:"go.Spot",enum:t.toString()};else if(t instanceof qa){if(b={class:"go.Brush",type:t.type.name},t.type===oh?b.color=t.color:t.type!==rh&&t.type!==sh||(b.start=t.start,b.end=t.end,t.type===sh&&(0!==t.startRadius&&(b.startRadius=Cd(t.startRadius)),isNaN(t.endRadius)||(b.endRadius=Cd(t.endRadius)))),null!==t.colorStops){var e={};for(t=t.colorStops.iterator;t.next();)e[t.key]=t.value;b.colorStops=e}}else t instanceof td?(b={class:"go.Geometry",type:t.type.name},0!==t.startX&&(b.startX=Cd(t.startX)),0!==t.startY&&(b.startY=Cd(t.startY)),0!==t.endX&&(b.endX=Cd(t.endX)),0!==t.endY&&(b.endY=Cd(t.endY)),t.spot1.w(yi)||(b.spot1=t.spot1),t.spot2.w(Si)||(b.spot2=t.spot2),t.type===ve&&(b.path=se(t))):t instanceof _&&(b={class:"go.EnumValue",classType:zd(a,t.classType),name:t.name});for(var n in e="{",t=!0,b){var o=Gd(b,n);if(!Nd(n,o))if(t?t=!1:e+=",",e+='"'+n+'":',"points"===n&&o instanceof ut){var g="[";for(o=o.iterator;o.next();){var r=o.value;1<g.length&&(g+=","),g+=a.Zm(r.x),g+=",",g+=a.Zm(r.y)}e+=g+="]"}else e+=a.Zm(o)}return e+"}"}function Ld(a){return"number"==typeof a?a:"NaN"===a?NaN:"9e9999"===a?1/0:"-9e9999"===a?-1/0:parseFloat(a)}function Ad(a,b,t,e,n,o,g,r,h){void 0===r&&(r=null),void 0===h&&(h=null);var l=new De;l.model=a,l.change=t,l.modelChange=b,l.propertyName=e,l.object=n,l.oldValue=o,l.oldParam=r,l.newValue=g,l.newParam=h,a.xt(l)}function jd(a){return"number"==typeof a||"string"==typeof a}function Dd(a,b,t){var e=a.ja(b);void 0!==e&&a.Va.H(e)===b||(a.Xt(b),void 0===(e=a.ja(b))?N("Model.makeNodeDataKeyUnique failed on "+b+".  Data not added to Model."):(a.Va.add(e,b),e=null,t&&(e=a.Gc.length,F(a.Gc,e,b)),Ad(a,"nodeDataArray",Be,"nodeDataArray",a,null,b,null,e),a.Om(b),a.Nm(b)))}function Od(a,b,t){var e=a.ja(b);if(void 0!==e&&a.Va.remove(e),e=null,t){t:if(t=a.Gc,Array.isArray(t))e=t.indexOf(b);else{e=t.length;for(var n=0;n<e;n++)if(t[n]===b){e=n;break t}e=-1}if(0>e)return;B(a.Gc,e)}Ad(a,"nodeDataArray",Ie,"nodeDataArray",a,b,null,e,null),a.hr(b)}function Fd(a,b,t){if(void 0!==b){var e=a.Vf.H(b);null===e&&(e=new ft,a.Vf.add(b,e)),e.add(t)}}function Bd(a,b,t){if(void 0!==b){var e=a.Vf.H(b);e instanceof ft&&(null==t?a.Vf.remove(b):(e.remove(t),0===e.count&&a.Vf.remove(b)))}}function Id(a,b){return void 0===b?null:(a=a.Vf.H(b))instanceof ft?a:null}function Rd(a,b,t){if(a.copiesArrays&&Array.isArray(b)){var e=[];for(t=0;t<b.length;t++){var n=Rd(a,b[t],a.copiesArrayObjects);e.push(n)}return pt(e),e}if(t&&j(b)){for(e in t=(t=b.constructor)?new t:{},n=a.copiesKey||"string"!=typeof a.nodeKeyProperty?null:a.nodeKeyProperty,b)if("__gohashid"===e)t.__gohashid=void 0;else if(e===n)t[n]=void 0;else{var o=Gd(b,e),g=zd(a,o);"GraphObject"===g||"Diagram"===g||"Layer"===g||"RowColumnDefinition"===g||"AnimationManager"===g||"Tool"===g||"CommandHandler"===g||"Layout"===g||"InputEvent"===g||"DiagramEvent"===g||o instanceof vd||o instanceof Ee||o instanceof Re||o instanceof De||(o=Rd(a,o,!1)),Yd(t,e,o)}return pt(t),t}return b instanceof St||b instanceof Ut||b instanceof Jt||b instanceof $i||b instanceof ui?b.copy():b}function Ed(){return new vd}function zd(a,b){if("function"==typeof b){if(b.className)return b.className;if(b.name)return b.name}else if("object"==typeof b&&null!==b&&b.constructor)return zd(a,b.constructor);return typeof b}function Vd(a){return qd[a]?qd[a]:void 0!==w.go&&w.go[a]?w.go[a]:null}function Gd(a,b){if(!a||!b)return null;try{if("function"==typeof b)var t=b(a);else"function"==typeof a.getAttribute?null===(t=a.getAttribute(b))&&(t=void 0):t=a[b]}catch(t){}return t}function Yd(a,b,t){if(a&&b)try{"function"==typeof b?b(a,t):"function"==typeof a.setAttribute?a.setAttribute(b,t):a[b]=t}catch(t){}}_f.className="PartManager",m(cd,_f),cd.prototype.addAllModeledParts=function(){var a=this.diagram.model;this.addModeledParts(a.nodeDataArray),fd(this,a.linkDataArray)},cd.prototype.addModeledParts=function(a){for(_f.prototype.addModeledParts.call(this,a,!1),a=this.links.iterator;a.next();)cc(a.value);qr(this.diagram,!1)},cd.prototype.removeAllModeledParts=function(){var a=this.diagram.model;gd(this,a.linkDataArray),this.du(a.nodeDataArray)},cd.prototype.getLinkCategoryForData=function(a){return this.diagram.model.Kt(a)},cd.prototype.setLinkCategoryForData=function(a,b){return this.diagram.model.br(a,b)},cd.prototype.setFromNodeForLink=function(a,b){var t=this.diagram.model;t.Bw(a.data,t.ja(null!==b?b.data:null))},cd.prototype.setToNodeForLink=function(a,b){var t=this.diagram.model;t.Gw(a.data,t.ja(null!==b?b.data:null))},cd.prototype.removeDataForLink=function(a){this.diagram.model.Km(a.data)},cd.prototype.findPartForKey=function(a){var b=_f.prototype.findPartForKey.call(this,a);return null===b&&null!==(a=this.diagram.model.Eg(a))?this.Ue.H(a):b},cd.prototype.findLinkForKey=function(a){return null==a?null:null!==(a=this.diagram.model.Eg(a))?this.Ue.H(a):null},cd.prototype.doModelChanged=function(a){var b=this;if(_f.prototype.doModelChanged.call(this,a),this.diagram){var t=this.diagram;if(a.model===t.model){var e=a.change;if(t.Z){t.Z=!1;try{var n=a.modelChange;if(""!==n){if(e===Fe){if("linkFromKey"===n){var o=this.yc(a.object);if(null!==o){var g=this.Db(a.newValue);o.fromNode=g}}else if("linkToKey"===n){var r=this.yc(a.object);if(null!==r){var h=this.Db(a.newValue);r.toNode=h}}else if("linkFromPortId"===n){var l=this.yc(a.object);if(null!==l){var c=a.newValue;"string"==typeof c&&(l.fromPortId=c)}}else if("linkToPortId"===n){var f=this.yc(a.object);if(null!==f){var p=a.newValue;"string"==typeof p&&(f.toPortId=p)}}else if("nodeGroupKey"===n){var d=this.zc(a.object);if(null!==d){var q=a.newValue;if(void 0!==q){var u=this.Db(q);d.containingGroup=u instanceof oc?u:null}else d.containingGroup=null}}else if("linkLabelKeys"===n){var y=this.yc(a.object);if(null!==y){var m=a.oldValue,v=a.newValue;Array.isArray(m)&&m.forEach((function(a){0<=v.indexOf(a)||null!==(a=b.Db(a))&&(a.labeledLink=null)})),Array.isArray(v)&&v.forEach((function(a){null!==(a=b.Db(a))&&(a.labeledLink=y)}))}}else if("linkCategory"===n){var x=this.yc(a.object),w=a.newValue;null!==x&&"string"==typeof w&&(x.category=w)}else"linkDataArray"===n&&(gd(this,a.oldValue),fd(this,a.newValue));t.isModified=!0}else if(e===Be){var k=a.newValue;if("linkDataArray"===n&&"object"==typeof k&&null!==k)pd(this,k);else if("linkLabelKeys"===n&&jd(k)){var M=this.yc(a.object),S=this.Db(k);null!==M&&null!==S&&(S.labeledLink=M)}t.isModified=!0}else if(e===Ie){var P=a.oldValue;if("linkDataArray"===n&&"object"==typeof P&&null!==P)this.Zq(P);else if("linkLabelKeys"===n&&jd(P)){var N=this.Db(P);null!==N&&(N.labeledLink=null)}t.isModified=!0}}else if(e===Fe){var C=a.propertyName;a.object!==t.model||"linkFromKeyProperty"!==C&&"linkToKeyProperty"!==C&&"linkFromPortIdProperty"!==C&&"linkToPortIdProperty"!==C&&"linkLabelKeysProperty"!==C&&"nodeIsGroupProperty"!==C&&"nodeGroupKeyProperty"!==C&&"linkCategoryProperty"!==C||t.undoManager.isUndoingRedoing||this.Kd(),t.isModified=!0}}finally{t.Z=!0}}}}},cd.prototype.refreshDataBoundLinks=function(){var a=this,b=this.diagram.model,t=new ft,e=b.linkDataArray;e.forEach((function(a){t.add(a)}));var n=[];this.links.each((function(a){null===a.data||t.contains(a.data)||n.push(a.data)})),n.forEach((function(a){ep(b,a,!1)})),e.forEach((function(t){null===a.yc(t)&&ip(b,t,!1)}))},cd.prototype.updateRelationshipsFromData=function(a){var b=a.data;if(null!==b){var t=a.diagram;if(null!==t){var e=t.model;if(a instanceof uc){var n=$d(e,b,!0);if(n=t.Db(n),a.fromNode=n,n=$d(e,b,!1),n=t.Db(n),a.toNode=n,0<(b=e.Df(b)).length||0<a.labelNodes.count){if(1===b.length&&1===a.labelNodes.count){n=b[0];var o=a.labelNodes.first();if(e.ja(o.data)===n)return}n=(new ft).addAll(b);var g=new ft;a.labelNodes.each((function(a){null!==a.data&&(void 0!==(a=e.ja(a.data))&&g.add(a))})),(b=g.copy()).Yq(n),(n=n.copy()).Yq(g),(0<b.count||0<n.count)&&(b.each((function(b){null!==(b=t.Db(b))&&b.labeledLink===a&&(b.labeledLink=null)})),n.each((function(b){null!==(b=t.Db(b))&&b.labeledLink!==a&&(b.labeledLink=a)})))}}else!(a instanceof Eu)&&(b=e.Kh(b),null===(b=t.findPartForKey(b))||b instanceof oc)&&(a.containingGroup=b)}}},cd.prototype.resolveReferencesForData=function(a){var b=this.diagram.model,t=b.ja(a);if(void 0!==t){var e=Id(b,t),n=this.zc(a);if(null!==e&&null!==n){e=e.iterator;for(var o={};e.next();){var g=e.value;b.$a(g)?n instanceof oc&&b.Kh(g)===t&&(null!==(g=this.zc(g))&&(g.containingGroup=n)):(o.link=this.yc(g),null!==o.link&&n instanceof zu&&($d(b,g,!0)===t&&(o.link.fromNode=n),$d(b,g,!1)===t&&(o.link.toNode=n),g=b.Df(g),Array.isArray(g)&&g.some(function(a){return function(b){return b===t&&(n.labeledLink=a.link,!0)}}(o)))),o={link:o.link}}Bd(b,t)}void 0!==(a=b.Kh(a))&&((a=this.Db(a))instanceof oc&&(n.containingGroup=a))}},cd.prototype.unresolveReferencesForPart=function(a){var b=this.diagram.model;if(a instanceof zu){var t=b.ja(a.data);if(void 0!==t){for(var e=a.linksConnected;e.next();)Fd(b,t,e.value.data);if(a.isLinkLabel&&(null!==(e=a.labeledLink)&&Fd(b,t,e.data)),a instanceof oc)for(a=a.memberParts;a.next();)e=a.value.data,b.$a(e)&&Fd(b,t,e)}}},cd.prototype.copyPartData=function(a,b){var t=_f.prototype.copyPartData.call(this,a,b);if(a instanceof uc)if(null!==(a=a.data)&&null!==b){var e=b.model;"object"==typeof(a=e.wq(a))&&null!==a&&(e.aj(a),t=b.yc(a))}else null!==t&&(b=this.diagram,null!==a&&null!==b&&null!==b.commandHandler&&b.commandHandler.copiesClipboardData&&("object"==typeof(b=b.model.wq(a))&&null!==b&&(t.data=b)));return t},cd.prototype.insertLink=function(a,b,t,e){var n=this.diagram,o=n.model,g=n.toolManager.findTool("Linking"),r="";if(null!==a&&(null===b&&(b=a),null===(r=b.portId)&&(r="")),b="",null!==t&&(null===e&&(e=t),null===(b=e.portId)&&(b="")),(e=g.archetypeLinkData)instanceof uc){if($h(e),null!==(o=e.copy()))return o.fromNode=a,o.fromPortId=r,o.toNode=t,o.toPortId=b,n.add(o),(a=g.archetypeLabelNodeData)instanceof zu&&($h(a),null!==(a=a.copy())&&(a.labeledLink=o,n.add(a))),o}else if(null!==e&&("object"==typeof(e=o.wq(e))&&null!==e))return null!==a&&Qd(o,e,o.ja(a.data),!0),tp(o,e,r,!0),null!==t&&Qd(o,e,o.ja(t.data),!1),tp(o,e,b,!1),o.aj(e),null===(a=g.archetypeLabelNodeData)||a instanceof zu||"object"==typeof(a=o.copyNodeData(a))&&null!==a&&(o.wf(a),void 0!==(a=o.ja(a))&&o.Bv(e,a)),n.yc(e);return null},cd.prototype.findLinkForKey=cd.prototype.findLinkForKey,cd.prototype.findPartForKey=cd.prototype.findPartForKey,cd.prototype.removeAllModeledParts=cd.prototype.removeAllModeledParts,cd.prototype.addModeledParts=cd.prototype.addModeledParts,cd.prototype.addAllModeledParts=cd.prototype.addAllModeledParts,cd.className="GraphLinksPartManager",m(yd,_f),yd.prototype.getLinkCategoryForData=function(a){return this.diagram.model.Nt(a)},yd.prototype.setLinkCategoryForData=function(a,b){this.diagram.model.iu(a,b)},yd.prototype.setFromNodeForLink=function(a,b,t){var e=this.diagram.model;if(void 0===t&&(t=null),b=null!==b?b.data:null,this.diagram.isTreePathToChildren)e.de(a.data,e.ja(b));else{var n=this.rh;this.rh=a,null!==t&&e.de(t.data,void 0),e.de(b,e.ja(null!==a.toNode?a.toNode.data:null)),this.rh=n}},yd.prototype.setToNodeForLink=function(a,b,t){var e=this.diagram.model;if(void 0===t&&(t=null),b=null!==b?b.data:null,this.diagram.isTreePathToChildren){var n=this.rh;this.rh=a,null!==t&&e.de(t.data,void 0),e.de(b,e.ja(null!==a.fromNode?a.fromNode.data:null)),this.rh=n}else e.de(a.data,e.ja(b))},yd.prototype.removeDataForLink=function(a){this.diagram.model.de(a.data,void 0)},yd.prototype.findLinkForKey=function(a){return null==a?null:null!==(a=this.diagram.model.Lb(a))?this.Ue.H(a):null},yd.prototype.doModelChanged=function(a){if(_f.prototype.doModelChanged.call(this,a),this.diagram){var b=this.diagram;if(a.model===b.model){var t=a.change;if(b.Z){b.Z=!1;try{var e=a.modelChange;if(""!==e){if(t===Fe){if("nodeParentKey"===e){var n=a.object,o=this.Db(a.newValue),g=this.fj(n);if(null!==this.rh)null!==o&&(this.rh.data=n,this.rh.category=this.getLinkCategoryForData(n));else if(null!==g){var r=g.ij();null!==r?null===o?b.remove(r):b.isTreePathToChildren?r.fromNode=o:r.toNode=o:md(this,o,g)}}else if("parentLinkCategory"===e){var h=this.fj(a.object),l=a.newValue;if(null!==h&&"string"==typeof l){var c=h.ij();null!==c&&(c.category=l)}}b.isModified=!0}}else if(t===Fe){var f=a.propertyName;a.object===b.model&&"nodeParentKeyProperty"===f&&(b.undoManager.isUndoingRedoing||this.Kd()),b.isModified=!0}}finally{b.Z=!0}}}}},yd.prototype.updateRelationshipsFromData=function(a){var b=a.data;if(null!==b){var t=a.diagram;if(null!==t){var e=t.model;a instanceof zu&&(b=e.Lh(b),(b=t.Db(b))!==(e=a.Gg())&&(e=a.ij(),null!==b?null!==e?t.isTreePathToChildren?e.fromNode=b:e.toNode=b:md(this,b,a):null!==e&&Tr(t,e,!1)))}}},yd.prototype.updateDataBindings=function(a,b){_f.prototype.updateDataBindings.call(this,a,b),"string"==typeof b&&null!==this.zc(a)&&(null!==(a=this.yc(a))&&a.Ca(b))},yd.prototype.resolveReferencesForData=function(a){var b=this.diagram.model,t=b.ja(a);if(void 0!==t){var e=Id(b,t),n=this.zc(a);if(null!==e&&null!==n){for(e=e.iterator;e.next();){var o=e.value;b.$a(o)&&n instanceof zu&&b.Lh(o)===t&&md(this,n,this.fj(o))}Bd(b,t)}void 0!==(a=b.Lh(a))&&n instanceof zu&&md(this,a=this.Db(a),n)}},yd.prototype.unresolveReferencesForPart=function(a){var b=this.diagram.model;if(a instanceof zu){var t=b.ja(a.data),e=this.yc(a.data);if(null!==e){e.isSelected=!1,e.isHighlighted=!1;var n=e.layer;if(null!==n){var o=n.Mc(-1,e,!1);0<=o&&this.diagram.bb(Ie,"parts",n,e,null,o,null),null!==(o=e.layerChanged)&&o(e,n,null)}}for(e=this.diagram.isTreePathToChildren,a=a.linksConnected;a.next();)n=a.value,n=(e?n.toNode:n.fromNode).data,b.$a(n)&&Fd(b,t,n)}},yd.prototype.insertLink=function(a,b,t){b=this.diagram.model;var e=a,n=t;return this.diagram.isTreePathToChildren||(e=t,n=a),null!==e&&null!==n?(b.de(n.data,b.ja(e.data)),n.ij()):null},yd.prototype.findLinkForKey=yd.prototype.findLinkForKey,yd.className="TreePartManager",vd.prototype.cloneProtected=function(a){a.Qa=this.Qa,a.In=this.In,a.bg=this.bg,a.Li=this.Li,a.Ol=this.Ol,a.gl=this.gl,a.An=this.An,a.zn=this.zn,a.Cn=this.Cn,a.gn=this.gn,a.Wj=this.Wj},vd.prototype.copy=function(){var a=new this.constructor;return this.cloneProtected(a),a},vd.prototype.clear=function(){this.Gc=[],this.Va.clear(),this.Vf.clear(),this.undoManager.clear()},vd.prototype.toString=function(a){if(void 0===a&&(a=0),1<a)return this.fr();var b=(""!==this.name?this.name:"")+" Model";if(0<a){b+="\n node data:";for(var t=(a=this.nodeDataArray).length,e=0;e<t;e++){var n=a[e];b+=" "+this.ja(n)+":"+z(n)}}return b},vd.prototype.dB=function(a){a.change!==Oe&&N("Model.toIncrementalData argument is not a Transaction ChangedEvent:"+a.toString());var b=a.object;return a.isTransactionFinished&&b instanceof Re?(kd(this,b),a=this.Yw(b,"FinishedUndo"===a.propertyName),this.Xh=null,a):null},vd.prototype.Yw=function(a,b){var t=this,e=!1,n=new ft,o=new ft,g=new ft,r=this.Xh;a.changes.each((function(a){a.model===t&&("nodeDataArray"===a.modelChange?a.change===Be?n.add(a.newValue):a.change===Ie&&g.add(a.oldValue):t.$a(a.object)?o.add(a.object):a.change!==Fe||t.modelData!==a.object&&"modelData"!==a.propertyName?null!==a.object&&(r&&r.contains(a.object)?r.get(a.object).each((function(a){t.$a(a)&&o.add(a)})):a.object instanceof vd||t.pj()&&t.xc(a.object)||Md(t,a.object).each((function(a){o.add(a)}))):e=!0)}));var h=this.Ji;h.clear(),n.each((function(a){h.add(t.ja(a)),b||o.add(a)}));var l=this.Mi;l.clear(),g.each((function(a){l.add(t.ja(a)),b&&o.add(a)})),a=t.cloneDeep(o.ma());var c=null;return e&&(null===c&&(c={}),c.modelData=this.cloneDeep(this.modelData)),0<h.count&&(null===c&&(c={}),b?c.removedNodeKeys=h.ma():c.insertedNodeKeys=h.ma()),0<a.length&&(null===c&&(c={}),c.modifiedNodeData=a),0<l.count&&(null===c&&(c={}),b?c.insertedNodeKeys=l.ma():c.removedNodeKeys=l.ma()),l.clear(),h.clear(),c},vd.prototype.cloneDeep=function(a){return xd(this,a,!0)},(n=vd.prototype).Sk=function(){var a="";return""!==this.name&&(a+=',\n  "name": '+this.quote(this.name)),""!==this.dataFormat&&(a+=',\n  "dataFormat": '+this.quote(this.dataFormat)),this.isReadOnly&&(a+=',\n  "isReadOnly": '+this.isReadOnly),"key"!==this.nodeKeyProperty&&"string"==typeof this.nodeKeyProperty&&(a+=',\n  "nodeKeyProperty": '+this.quote(this.nodeKeyProperty)),this.copiesArrays&&(a+=',\n  "copiesArrays": true'),this.copiesArrayObjects&&(a+=',\n  "copiesArrayObjects": true'),this.copiesKey||(a+=',\n  "copiesKey": false'),"category"!==this.nodeCategoryProperty&&"string"==typeof this.nodeCategoryProperty&&(a+=',\n  "nodeCategoryProperty": '+this.quote(this.nodeCategoryProperty)),a},n.Wq=function(a){a.name&&(this.name=a.name),a.dataFormat&&(this.dataFormat=a.dataFormat),a.isReadOnly&&(this.isReadOnly=!0),a.nodeKeyProperty&&(this.nodeKeyProperty=a.nodeKeyProperty),a.copiesArrays&&(this.copiesArrays=!0),a.copiesArrayObjects&&(this.copiesArrayObjects=!0),!1===a.copiesKey&&(this.copiesKey=!1),a.nodeCategoryProperty&&(this.nodeCategoryProperty=a.nodeCategoryProperty)},n.Zw=function(){var t,a=this.modelData,b=!1;for(t in a)if(!Nd(t,a[t])){b=!0;break}return a="",b&&(a=br(this)),a+',\n  "nodeDataArray": '+Pd(this,this.nodeDataArray,!0)},n.pw=function(a){bd(this,a),D(a=a.nodeDataArray)&&(this.Mm(a),this.nodeDataArray=a)},n.kr=function(a){hr(this,a,"nodeKeyProperty");var b=this.Ji;b.clear();var t=new ft,e=this.Mi;e.clear(),e.addAll(this.Va.iteratorKeys);for(var n=new Mt,o=a.nodeDataArray,g=o.length,r=0;r<g;r++){var h=o[r],l=a.ja(h);if(void 0!==l){e.remove(l);var c=this.Lb(l);null===c?(b.add(l),t.add(h)):wd(this,c,h,n)||t.add(h)}else this.Xt(h),l=this.ja(h),b.add(l),t.add(h)}return o="",wd(this,this.modelData,a.modelData,n)||(o+=br(this)),0<b.count&&(o+=this.qu+Pd(this,b.ma(),!0)),0<t.count&&(o+=this.lx+Pd(this,t.ma(),!0)),0<e.count&&(o+=this.su+Pd(this,e.ma(),!0)),e.clear(),b.clear(),o},n.Dz=function(a,b){return void 0===b&&(b=zd(this,this)),'{ "class": '+this.quote(b)+', "incremental": 1'+this.Sk()+this.kr(a)+"}"},n.Xw=function(a,b){var t=this,e=!1,n=new ft,o=new ft,g=new ft,r=this.Xh;a.changes.each((function(a){a.model===t&&("nodeDataArray"===a.modelChange?a.change===Be?n.add(a.newValue):a.change===Ie&&g.add(a.oldValue):t.$a(a.object)?o.add(a.object):a.change!==Fe||t.modelData!==a.object&&"modelData"!==a.propertyName?null!==a.object&&(r&&r.contains(a.object)?r.get(a.object).each((function(a){t.$a(a)&&o.add(a)})):a.object instanceof vd||t.pj()&&t.xc(a.object)||Md(t,a.object).each((function(a){o.add(a)}))):e=!0)}));var h=this.Ji;h.clear(),n.each((function(a){h.add(t.ja(a)),b||o.add(a)}));var l=this.Mi;return l.clear(),g.each((function(a){l.add(t.ja(a)),b&&o.add(a)})),a="",e&&(a+=br(this)),0<h.count&&(a+=(b?this.su:this.qu)+Pd(this,h.ma(),!0)),0<o.count&&(a+=this.lx+Pd(this,o.ma(),!0)),0<l.count&&(a+=(b?this.qu:this.su)+Pd(this,l.ma(),!0)),l.clear(),h.clear(),a},n.Vq=function(a){(void 0!==a.name&&a.name!==this.name||void 0!==a.dataFormat&&a.dataFormat!==this.dataFormat||void 0!==a.isReadOnly&&a.isReadOnly!==this.isReadOnly||void 0!==a.nodeKeyProperty&&a.nodeKeyProperty!==this.nodeKeyProperty||void 0!==a.copiesArrays&&a.copiesArrays!==this.copiesArrays||void 0!==a.copiesArrayObjects&&a.copiesArrayObjects!==this.copiesArrayObjects||void 0!==a.copiesKey&&a.copiesKey!==this.copiesKey||void 0!==a.nodeCategoryProperty&&a.nodeCategoryProperty!==this.nodeCategoryProperty)&&N("applyIncrementalJson cannot change Model properties"),bd(this,a);var b=a.insertedNodeKeys,t=a.modifiedNodeData,e=new Mt;if(Array.isArray(t))for(var n=0;n<t.length;n++){var o=t[n],g=this.ja(o);null!=g&&e.set(g,o)}if(Array.isArray(b))for(n=b.length,o=0;o<n;o++){g=b[o];var r=this.Lb(g);null===r&&(r=(r=e.get(g))?r:this.copyNodeData({}),this.Tm(r,g),this.wf(r))}if(Array.isArray(t))for(b=t.length,e=0;e<b;e++)if(n=t[e],o=this.ja(n),null!==(o=this.Lb(o))){for(var h in n)"__gohashid"===h||h===this.nodeKeyProperty||this.yk()&&h===this.nodeIsGroupProperty||this.setDataProperty(o,h,n[h]);this.Um(n,o)}if(a=a.removedNodeKeys,Array.isArray(a))for(t=a.length,h=0;h<t;h++)null!==(b=this.Lb(a[h]))&&this.Lm(b)},n.$y=function(a,b){a.change!==Oe&&N("Model.toIncrementalJson argument is not a Transaction ChangedEvent:"+a.toString());var t=a.object;return a.isTransactionFinished&&t instanceof Re?(void 0===b&&(b=zd(this,this)),kd(this,t),a=this.Xw(t,"FinishedUndo"===a.propertyName),this.Xh=null,"2"===b?'{ "incremental": 2'+a+"}":'{ "class": '+this.quote(b)+', "incremental": 1'+this.Sk()+a+"}"):'{ "incremental": 0 }'},n.eB=function(a,b){return this.$y(a,b)},n.fr=function(a){return void 0===a&&(a=zd(this,this)),'{ "class": '+this.quote(a)+this.Sk()+this.Zw()+"}"},n.toJSON=function(a){return this.fr(a)},n.Zx=function(a){var b=null;if("string"==typeof a)try{b=w.JSON.parse(a)}catch(t){}else"object"==typeof a?b=a:N("Unable to modify a Model from: "+a);var t=b.incremental;"number"!=typeof t&&N("Unable to apply non-incremental changes to Model: "+a),0!==t&&(this.xa("applyIncrementalJson"),this.Vq(b),this.Wa("applyIncrementalJson"))},n.vz=function(a){return this.Zx(a)},vd.constructGraphLinksModel=function(){return new vd},(n=vd.prototype).Mm=function(a){if(D(a))for(var b=a.length,t=0;t<b;t++){var e=a[t];if(j(e)){var n=t;e=this.Mm(e),Array.isArray(a)?a[n]=e:N("Cannot replace an object in an HTMLCollection or NodeList at "+n)}}else if(j(a)){for(t in a)if(j(n=a[t])&&(n=this.Mm(n),a[t]=n,"points"===t&&Array.isArray(n))){e=0==n.length%2;for(var o=0;o<n.length;o++)if("number"!=typeof n[o]){e=!1;break}if(e){for(e=new ut,o=0;o<n.length/2;o++)e.add(new St(n[2*o],n[2*o+1]));e.freeze(),a[t]=e}}if("object"==typeof a){if(t=a,0===(n=a.class||"").indexOf("go.")&&(n=n.substr(3)),"NaN"===n)t=NaN;else if("Date"===n)t=new Date(a.value);else if("Point"===n)t=new St(Ld(a.x),Ld(a.y));else if("Size"===n)t=new Ut(Ld(a.width),Ld(a.height));else if("Rect"===n)t=new Jt(Ld(a.x),Ld(a.y),Ld(a.width),Ld(a.height));else if("Margin"===n)t=new ui(Ld(a.top),Ld(a.right),Ld(a.bottom),Ld(a.left));else if("Spot"===n)t="string"==typeof a.enum?_i(a.enum):new $i(Ld(a.x),Ld(a.y),Ld(a.offsetX),Ld(a.offsetY));else if("Brush"===n){if((t=new qa).type=tt(qa,a.type),"string"==typeof a.color&&(t.color=a.color),a.start instanceof $i&&(t.start=a.start),a.end instanceof $i&&(t.end=a.end),"number"==typeof a.startRadius&&(t.startRadius=Ld(a.startRadius)),"number"==typeof a.endRadius&&(t.endRadius=Ld(a.endRadius)),j(a=a.colorStops))for(b in a)t.addColorStop(parseFloat(b),a[b])}else"Geometry"===n?(b=null,(b="string"==typeof a.path?ae(a.path):new td).type=tt(td,a.type),"number"==typeof a.startX&&(b.startX=Ld(a.startX)),"number"==typeof a.startY&&(b.startY=Ld(a.startY)),"number"==typeof a.endX&&(b.endX=Ld(a.endX)),"number"==typeof a.endY&&(b.endY=Ld(a.endY)),a.spot1 instanceof $i&&(b.spot1=a.spot1),a.spot2 instanceof $i&&(b.spot2=a.spot2),t=b):"EnumValue"===n&&(0===(b=a.classType).indexOf("go.")&&(b=b.substr(3)),"function"==typeof(b=Vd(b))&&(t=tt(b,a.name)));a=t}}return a},n.quote=function(a){for(var b="",t=a.length,e=0;e<t;e++){var n=a[e];if('"'===n||"\\"===n)b+="\\"+n;else if("\b"===n)b+="\\b";else if("\f"===n)b+="\\f";else if("\n"===n)b+="\\n";else if("\r"===n)b+="\\r";else if("\t"===n)b+="\\t";else{var o=a.charCodeAt(e);b=16>o?b+"\\u000"+a.charCodeAt(e).toString(16):32>o?b+"\\u00"+a.charCodeAt(e).toString(16):8232===o?b+"\\u2028":8233===o?b+"\\u2029":b+n}}return'"'+b+'"'},n.Zm=function(a){return void 0===a?"undefined":null===a?"null":!0===a?"true":!1===a?"false":"string"==typeof a?this.quote(a):"number"==typeof a?1/0===a?"9e9999":-1/0===a?"-9e9999":isNaN(a)?'{"class":"NaN"}':a.toString():a instanceof Date?'{"class":"Date", "value":"'+a.toJSON()+'"}':a instanceof Number?this.Zm(a.valueOf()):D(a)?Pd(this,a):j(a)?Td(this,a):"function"==typeof a?"null":a.toString()},n.Gh=function(a){this.$u.add(a)},n.Pk=function(a){this.$u.remove(a)},n.xt=function(a){this.skipsUndoManager||this.undoManager.Zv(a);for(var b=this.$u,t=b.length,e=0;e<t;e++)b.J(e)(a)},n.bb=function(a,b,t,e,n,o,g){Ad(this,"",a,b,t,e,n,o,g)},n.g=function(a,b,t,e,n){Ad(this,"",Fe,a,this,b,t,e,n)},n.bu=function(a,b,t,e,n,o){Ad(this,"",Fe,b,a,t,e,n,o)},vd.prototype.changeState=function(a,b){if(null!==a&&a.model===this)if(a.change===Fe){var t=a.object,e=a.propertyName,n=a.H(b);e===this.nodeKeyProperty&&this.$a(t)&&(void 0!==(b=a.H(!b))&&this.Va.remove(b),void 0!==n&&this.Va.add(n,t)),Yd(t,e,n)}else a.change===Be?(t=a.newParam,"nodeDataArray"===a.modelChange?j(a=a.newValue)&&"number"==typeof t&&(e=this.ja(a),b?(this.Gc[t]===a&&B(this.Gc,t),void 0!==e&&this.Va.remove(e)):(this.Gc[t]!==a&&F(this.Gc,t,a),void 0!==e&&this.Va.add(e,a))):""===a.modelChange?((e=a.object)&&!D(e)&&a.propertyName&&(e=Gd(a.object,a.propertyName)),D(e)&&"number"==typeof t&&(a=a.newValue,b?B(e,t):F(e,t,a))):N("unknown ChangedEvent.Insert modelChange: "+a.toString())):a.change===Ie?(t=a.oldParam,"nodeDataArray"===a.modelChange?j(a=a.oldValue)&&"number"==typeof t&&(e=this.ja(a),b?(this.Gc[t]!==a&&F(this.Gc,t,a),void 0!==e&&this.Va.add(e,a)):(this.Gc[t]===a&&B(this.Gc,t),void 0!==e&&this.Va.remove(e))):""===a.modelChange?((e=a.object)&&!D(e)&&a.propertyName&&(e=Gd(a.object,a.propertyName)),D(e)&&"number"==typeof t&&(a=a.oldValue,b?F(e,t,a):B(e,t))):N("unknown ChangedEvent.Remove modelChange: "+a.toString())):a.change!==Oe&&N("unknown ChangedEvent: "+a.toString())},vd.prototype.xa=function(a){return this.undoManager.xa(a)},vd.prototype.Wa=function(a){return this.undoManager.Wa(a)},vd.prototype.Kf=function(){return this.undoManager.Kf()},vd.prototype.commit=function(a,b){void 0===b&&(b="");var t=this.skipsUndoManager;null===b&&(this.skipsUndoManager=!0,b=""),this.undoManager.xa(b);var e=!1;try{a(this),e=!0}finally{e?this.undoManager.Wa(b):this.undoManager.Kf(),this.skipsUndoManager=t}},(n=vd.prototype).Ca=function(a,b){void 0===b&&(b=""),Ad(this,"SourceChanged",Oe,b,a,null,null)},n.ja=function(a){if(null!==a){var b=this.Li;if(""!==b&&void 0!==(b=Gd(a,b))){if(jd(b))return b;N("Key value for node data "+a+" is not a number or a string: "+b)}}},n.Tm=function(a,b){if(null!==a){var t=this.Li;if(""!==t)if(this.$a(a)){var e=Gd(a,t);e!==b&&null===this.Lb(b)&&(Yd(a,t,b),void 0!==e&&this.Va.remove(e),this.Va.add(b,a),Ad(this,"nodeKey",Fe,t,a,e,b),"string"==typeof t&&this.Ca(a,t),this.$q(e,b))}else Yd(a,t,b)}},n.$a=function(a){var b=this.ja(a);return void 0!==b&&this.Va.H(b)===a},n.Lb=function(a){return null===a&&N("Model.findNodeDataForKey:key must not be null"),void 0!==a&&jd(a)?this.Va.H(a):null},n.Xt=function(a){if(null!==a){var b=this.Li;if(""!==b){var t=this.ja(a);if(void 0===t||this.Va.contains(t)){var e=this.Ol;if(null!==e&&(null!=(t=e(this,a))&&!this.Va.contains(t)))return void Yd(a,b,t);if("string"==typeof t){for(e=2;this.Va.contains(t+e);)e++;Yd(a,b,t+e)}else if(void 0===t||"number"==typeof t){for(t=-this.Va.count-1;this.Va.contains(t);)t--;Yd(a,b,t)}}}}},n.wf=function(a){null!==a&&(gt(a),this.$a(a)||Dd(this,a,!0))},n.qz=function(a){if(D(a))for(var b=a.length,t=0;t<b;t++)this.wf(a[t]);else for(a=a.iterator;a.next();)this.wf(a.value)},n.Lm=function(a){null!==a&&Od(this,a,!0)},n.UA=function(a){if(D(a))for(var b=a.length,t=0;t<b;t++)this.Lm(a[t]);else for(a=a.iterator;a.next();)this.Lm(a.value)},n.KA=function(a){if(a!==this.nodeDataArray&&D(a)){var b=this.Mi;b.clear(),b.addAll(this.Va.iteratorKeys);var t=this.Ji;t.clear();for(var e=a.length,n=0;n<e;n++){var o=a[n],g=this.ja(o);if(void 0!==g){t.add(g);var r=this.Lb(g);r!==o&&(null!==r?(this.rq(r,o),this.Um(o,r)):(o=this.cloneDeep(o),this.Tm(o,g),this.wf(o)))}else g=this.cloneDeep(o),this.wf(g),t.add(this.ja(g))}for(a=b.iterator;a.next();)e=a.value,t.contains(e)||(e=this.Lb(e))&&this.Lm(e);b.clear(),t.clear()}},n.$q=function(a,b){void 0!==b&&((a=Id(this,a))instanceof ft&&this.Vf.add(b,a))},n.Sw=function(){},n.Om=function(){},n.Nm=function(){},n.hr=function(){},n.Cz=function(a){void 0===a?this.Vf.clear():this.Vf.remove(a)},vd.prototype.copyNodeData=function(a){if(null===a)return null;var b=this.gl;return j(a=null!==b?b(a,this):Rd(this,a,!0))&&pt(a),a},vd.prototype.setDataProperty=function(a,b,t){if(this.$a(a)){if(b===this.nodeKeyProperty)return void this.Tm(a,t);if(b===this.nodeCategoryProperty)return void this.Sm(a,t)}else!Xd&&a instanceof ea&&(Xd=!0,L('Model.setDataProperty is modifying a GraphObject, "'+a.toString()+'"'),L("  Is that really your intent?"));var e=Gd(a,b);e!==t&&(Yd(a,b,t),this.bu(a,b,e,t))},(n=vd.prototype).set=function(a,b,t){this.setDataProperty(a,b,t)},n.rq=function(a,b){if(b){var t,e=this.$a(a);for(t in b)"__gohashid"===t||e&&t===this.nodeKeyProperty||this.setDataProperty(a,t,b[t])}},n.nz=function(a,b){this.Ot(a,-1,b)},n.Ot=function(a,b,t){0>b&&(b=a.length),F(a,b,t),Ad(this,"",Be,"",a,null,t,null,b)},n.rw=function(a,b){void 0===b&&(b=-1),a===this.Gc&&N("Model.removeArrayItem should not be called on the Model.nodeDataArray"),-1===b&&(b=a.length-1);var t=a[b];B(a,b),Ad(this,"",Ie,"",a,t,null,b,null)},n.Eq=function(a){if(null===a)return"";var b=this.Wj;return""===b||void 0===(b=Gd(a,b))?"":"string"==typeof b?b:(N("getCategoryForNodeData found a non-string category for "+a+": "+b),"")},n.Sm=function(a,b){if(null!==a){var t=this.Wj;if(""!==t)if(this.$a(a)){var e=Gd(a,t);void 0===e&&(e=""),e!==b&&(Yd(a,t,b),Ad(this,"nodeCategory",Fe,t,a,e,b))}else Yd(a,t,b)}},n.Um=function(a,b){this.Sm(b,this.Eq(a))},n.Cm=function(){return!1},n.yk=function(){return!1},n.pj=function(){return!1},n.Tt=function(){return!1},n.zk=function(){return!1},v.Object.defineProperties(vd.prototype,{name:{get:function(){return this.Qa},set:function(a){var b=this.Qa;b!==a&&(this.Qa=a,this.g("name",b,a))}},dataFormat:{get:function(){return this.In},set:function(a){var b=this.In;b!==a&&(this.In=a,this.g("dataFormat",b,a))}},isReadOnly:{get:function(){return this.bg},set:function(a){var b=this.bg;b!==a&&(this.bg=a,this.g("isReadOnly",b,a))}},modelData:{get:function(){return this.l},set:function(a){var b=this.l;b!==a&&(this.l=a,this.g("modelData",b,a),this.Ca(a))}},undoManager:{get:function(){return this.v},set:function(a){var b=this.v;b!==a&&(null!==b&&b.Ry(this),this.v=a,null!==a&&a.Xx(this))}},skipsUndoManager:{get:function(){return this.wg},set:function(a){this.wg=a}},nodeKeyProperty:{get:function(){return this.Li},set:function(a){var b=this.Li;b!==a&&(""===a&&N("Model.nodeKeyProperty may not be the empty string"),0<this.Va.count&&N("Cannot set Model.nodeKeyProperty when there is existing node data"),this.Li=a,this.g("nodeKeyProperty",b,a))}},makeUniqueKeyFunction:{get:function(){return this.Ol},set:function(a){var b=this.Ol;b!==a&&(this.Ol=a,this.g("makeUniqueKeyFunction",b,a))}},nodeDataArray:{get:function(){return this.Gc},set:function(a){var b=this.Gc;if(b!==a){this.Va.clear(),this.Sw();for(var t=a.length,e=0;e<t;e++){var n=a[e];if(!j(n))return void N("Model.nodeDataArray must only contain Objects, not: "+n);gt(n)}for(this.Gc=a,e=new ut,n=0;n<t;n++){var o=a[n],g=this.ja(o);void 0===g||null!==this.Va.H(g)?e.add(o):this.Va.add(g,o)}for(e=e.iterator;e.next();)n=e.value,this.Xt(n),void 0!==(o=this.ja(n))&&this.Va.add(o,n);for(Ad(this,"nodeDataArray",Fe,"nodeDataArray",this,b,a),b=0;b<t;b++)e=a[b],this.Om(e),this.Nm(e);Array.isArray(a)||(this.isReadOnly=!0)}}},copyNodeDataFunction:{get:function(){return this.gl},set:function(a){var b=this.gl;b!==a&&(this.gl=a,this.g("copyNodeDataFunction",b,a))}},copiesArrays:{get:function(){return this.An},set:function(a){var b=this.An;b!==a&&(this.An=a,this.g("copiesArrays",b,a))}},copiesArrayObjects:{get:function(){return this.zn},set:function(a){var b=this.zn;b!==a&&(this.zn=a,this.g("copiesArrayObjects",b,a))}},copiesKey:{get:function(){return this.Cn},set:function(a){var b=this.Cn;b!==a&&(this.Cn=a,this.g("copiesKey",b,a))}},afterCopyFunction:{get:function(){return this.gn},set:function(a){var b=this.gn;b!==a&&(this.gn=a,this.g("afterCopyFunction",b,a))}},nodeCategoryProperty:{get:function(){return this.Wj},set:function(a){var b=this.Wj;b!==a&&(this.Wj=a,this.g("nodeCategoryProperty",b,a))}},type:{get:function(){return"Model"}}}),vd.prototype.setCategoryForNodeData=vd.prototype.Sm,vd.prototype.getCategoryForNodeData=vd.prototype.Eq,vd.prototype.removeArrayItem=vd.prototype.rw,vd.prototype.insertArrayItem=vd.prototype.Ot,vd.prototype.addArrayItem=vd.prototype.nz,vd.prototype.assignAllDataProperties=vd.prototype.rq,vd.prototype.set=vd.prototype.set,vd.prototype.clearUnresolvedReferences=vd.prototype.Cz,vd.prototype.mergeNodeDataArray=vd.prototype.KA,vd.prototype.removeNodeDataCollection=vd.prototype.UA,vd.prototype.removeNodeData=vd.prototype.Lm,vd.prototype.addNodeDataCollection=vd.prototype.qz,vd.prototype.addNodeData=vd.prototype.wf,vd.prototype.makeNodeDataKeyUnique=vd.prototype.Xt,vd.prototype.findNodeDataForKey=vd.prototype.Lb,vd.prototype.containsNodeData=vd.prototype.$a,vd.prototype.setKeyForNodeData=vd.prototype.Tm,vd.prototype.getKeyForNodeData=vd.prototype.ja,vd.prototype.updateTargetBindings=vd.prototype.Ca,vd.prototype.commit=vd.prototype.commit,vd.prototype.rollbackTransaction=vd.prototype.Kf,vd.prototype.commitTransaction=vd.prototype.Wa,vd.prototype.startTransaction=vd.prototype.xa,vd.prototype.raiseDataChanged=vd.prototype.bu,vd.prototype.raiseChanged=vd.prototype.g,vd.prototype.raiseChangedEvent=vd.prototype.bb,vd.prototype.removeChangedListener=vd.prototype.Pk,vd.prototype.addChangedListener=vd.prototype.Gh,vd.prototype.writeJsonValue=vd.prototype.Zm,vd.prototype.replaceJsonObjects=vd.prototype.Mm,vd.prototype.applyIncrementalJSON=vd.prototype.vz,vd.prototype.applyIncrementalJson=vd.prototype.Zx,vd.prototype.toJSON=vd.prototype.toJSON,vd.prototype.toJson=vd.prototype.fr,vd.prototype.toIncrementalJSON=vd.prototype.eB,vd.prototype.toIncrementalJson=vd.prototype.$y,vd.prototype.computeJsonDifference=vd.prototype.Dz,vd.prototype.toIncrementalData=vd.prototype.dB,vd.prototype.clear=vd.prototype.clear;var Xd=!1,qd={};function Ud(a,b,t){pt(this),this.s=!1,void 0===a&&(a=""),void 0===b&&(b=a),void 0===t&&(t=null),this.l=-1,this.qd=null,this.mm=a,this.lm=this.cq=0,this.ft=null,this.uo=!1,this.em=b,this.yn=t,this.To=Wd,this.rn=null,this.Lu=new ft}function Kd(a,b,t){return null===(a=a.sourceName)||""===a?b:"/"===a?t.part:"."===a?t:".."===a?t.panel:b.ab(a)}vd.className="Model",vd.fromJSON=vd.fromJson=function(a,b){void 0===b&&(b=null);var t=null;if("string"==typeof a)try{t=w.JSON.parse(a)}catch(t){}else"object"==typeof a?t=a:N("Unable to construct a Model from: "+a);if(null===b){a=null;var e=t.class;if("string"==typeof e)try{var n=null;0===e.indexOf("go.")?n=Vd(e=e.substr(3)):null===(n=Vd(e))&&(n=w[e]),"function"==typeof n&&(a=new n)}catch(t){}null===a||a instanceof vd?b=a:N("Unable to construct a Model of declared class: "+t.class)}return null===b&&(b=vd.constructGraphLinksModel()),b.Wq(t),b.pw(t),b},vd.safePropertyValue=Gd,vd.safePropertySet=Yd,qd.Brush=qa,qd.ChangedEvent=De,qd.Geometry=td,qd.Margin=ui,qd.Panel=Fh,qd.Point=St,qd.Rect=Jt,qd.Size=Ut,qd.Spot=$i,qd.Transaction=Re,qd.UndoManager=Ee,Ud.prototype.copy=function(){var a=new Ud;return a.mm=this.mm,a.cq=this.cq,a.lm=this.lm,a.ft=this.ft,a.uo=this.uo,a.em=this.em,a.yn=this.yn,a.To=this.To,a.rn=this.rn,a},(n=Ud.prototype).jb=function(a){a.classType===Ud&&(this.mode=a)},n.toString=function(){return"Binding("+this.targetProperty+":"+this.sourceProperty+(-1!==this.vj?" "+this.vj:"")+" "+this.mode.name+")"},n.freeze=function(){return this.s=!0,this},n.ea=function(){return this.s=!1,this},n.Ky=function(a){return void 0===a&&(a=null),this.mode=Jd,this.backConverter=a,this},n.Sq=function(a){return void 0===a&&(a=""),this.sourceName=a,this.isToModel=!1,this},n.MA=function(){return this.sourceName=null,this.isToModel=!0,this},n.Tw=function(a,b,t){var e=this.em;if(void 0===t||""===e||e===t){t=this.mm;var n=this.yn;if(null===n&&""===t)L("Binding error: target property is the empty string: "+this.toString());else{var o=b;if(""!==e&&(o=Gd(b,e)),void 0!==o)if(null===n)""!==t&&Yd(a,t,o);else try{if(""!==t)Yd(a,t,n(o,a));else n(o,a)}catch(t){}}}},n.jr=function(a,b,t,e){if(this.To===Jd){var n=this.mm;if(void 0===t||n===t){t=this.em;var o=this.rn,g=a;if(""!==n&&(g=Gd(a,n)),void 0!==g&&!this.Lu.contains(a))try{this.Lu.add(a);var r=null!==e?e.diagram:null,h=null!==r?r.model:null;if(null===o){if(""!==t)null!==h?h.setDataProperty(b,t,g):Yd(b,t,g);else if(null!==h&&null!==e&&0<=e.itemIndex&&null!==e.panel&&Array.isArray(e.panel.itemArray)){var l=e.itemIndex,c=e.panel.itemArray;h.rw(c,l),h.Ot(c,l,g)}}else try{if(""!==t){var f=o(g,b,h);null!==h?h.setDataProperty(b,t,f):Yd(b,t,f)}else{var p=o(g,b,h);if(void 0!==p&&null!==h&&null!==e&&0<=e.itemIndex&&null!==e.panel&&Array.isArray(e.panel.itemArray)){var d=e.itemIndex,q=e.panel.itemArray;h.rw(q,d),h.Ot(q,d,p)}}}catch(t){}}finally{this.Lu.remove(a)}}}},v.Object.defineProperties(Ud.prototype,{vj:{get:function(){return this.l},set:function(a){this.s&&C(this),this.l=a}},targetProperty:{get:function(){return this.mm},set:function(a){this.s&&C(this),this.mm=a}},sourceName:{get:function(){return this.ft},set:function(a){this.s&&C(this),this.ft=a,null!==a&&(this.uo=!1)}},isToModel:{get:function(){return this.uo},set:function(a){this.s&&C(this),this.uo=a}},sourceProperty:{get:function(){return this.em},set:function(a){this.s&&C(this),this.em=a}},converter:{get:function(){return this.yn},set:function(a){this.s&&C(this),this.yn=a}},backConverter:{get:function(){return this.rn},set:function(a){this.s&&C(this),this.rn=a}},mode:{get:function(){return this.To},set:function(a){this.s&&C(this),this.To=a}}}),Ud.prototype.updateSource=Ud.prototype.jr,Ud.prototype.updateTarget=Ud.prototype.Tw,Ud.prototype.ofModel=Ud.prototype.MA,Ud.prototype.ofObject=Ud.prototype.Sq,Ud.prototype.makeTwoWay=Ud.prototype.Ky;var Hd="Binding",Wd=new _(Ud,"OneWay",1),Jd=new _(Ud,"TwoWay",2);function tr(a,b){vd.call(this),this.pu=',\n  "insertedLinkKeys": ',this.kx=',\n  "modifiedLinkData": ',this.ru=',\n  "removedLinkKeys": ',this.bd=[],this.cg=new ft,this.gb=new Mt,this.Fi="",this.yj=this.fl=this.Pl=null,this.bf="from",this.cf="to",this.Tj=this.Sj="",this.Rj="category",this.Yd="",this.Tl="isGroup",this.xe="group",this.Bn=!1,void 0!==a&&(this.nodeDataArray=a),void 0!==b&&(this.linkDataArray=b)}function Zd(a,b){for(var t=new ft,e=0;e<a.linkDataArray.length;e++){var n=a.linkDataArray[e];Sd(a,b,n,n,t)}return t}function $d(a,b,t){if(null!==b&&(""!==(a=t?a.bf:a.cf)&&void 0!==(a=Gd(b,a)))){if(jd(a))return a;N((t?"FromKey":"ToKey")+" value for link data "+b+" is not a number or a string: "+a)}}function Qd(a,b,t,e){if(null===t&&(t=void 0),null!==b){var n=e?a.bf:a.cf;if(""!==n)if(t=a.Em(t),a.xc(b)){var o=Gd(b,n);o!==t&&(Bd(a,o,b),Yd(b,n,t),null===a.Lb(t)&&Fd(a,t,b),Ad(a,e?"linkFromKey":"linkToKey",Fe,n,b,o,t),"string"==typeof n&&a.Ca(b,n))}else Yd(b,n,t)}}function _d(a,b,t){return null===b||""===(a=t?a.Sj:a.Tj)||void 0===(b=Gd(b,a))?"":b}function tp(a,b,t,e){if(null!==b){var n=e?a.Sj:a.Tj;if(""!==n)if(a.xc(b)){var o=Gd(b,n);void 0===o&&(o=""),o!==t&&(Yd(b,n,t),Ad(a,e?"linkFromPortId":"linkToPortId",Fe,n,b,o,t),"string"==typeof n&&a.Ca(b,n))}else Yd(b,n,t)}}function ip(a,b,t){if(""!==a.linkKeyProperty){var e=a.Wb(b);if(void 0!==e&&a.gb.H(e)===b)return;if(a.Pq(b),void 0===(e=a.Wb(b)))return void N("GraphLinksModel.makeLinkDataKeyUnique failed on "+b+". Data not added to model.");a.gb.add(e,b)}a.cg.add(b),e=null,t&&(e=a.bd.length,a.bd.splice(e,0,b)),Ad(a,"linkDataArray",Be,"linkDataArray",a,null,b,null,e),np(a,b)}function ep(a,b,t){a.cg.remove(b);var e=a.Wb(b);if(void 0!==e&&a.gb.remove(e),e=null,t){if(0>(e=a.bd.indexOf(b)))return;a.bd.splice(e,1)}if(Ad(a,"linkDataArray",Ie,"linkDataArray",a,b,null,e,null),Bd(a,t=$d(a,b,!0),b),Bd(a,t=$d(a,b,!1),b),e=a.Df(b),Array.isArray(e))for(var n=e.length,o=0;o<n;o++)Bd(a,t=e[o],b)}function np(a,b){var t=$d(a,b,!0);t=a.Em(t),null===a.Lb(t)&&Fd(a,t,b),t=$d(a,b,!1),t=a.Em(t),null===a.Lb(t)&&Fd(a,t,b);var e=a.Df(b);if(Array.isArray(e))for(var n=e.length,o=0;o<n;o++)t=e[o],null===a.Lb(t)&&Fd(a,t,b)}function op(a,b,t){a.br(t,a.Kt(b)),a.Bw(t,a.yy(b)),a.Gw(t,a.By(b)),a.hu(t,a.Df(b)),a.Cw(t,a.zy(b)),a.Hw(t,a.Cy(b))}Ud.className="Binding",Ud.parseEnum=function(a,b){return function(t){return null===(t=tt(a,t))?b:t}},Ud.toString=z,Ud.OneWay=Wd,Ud.TwoWay=Jd,m(tr,vd),tr.constructGraphLinksModel=vd.constructGraphLinksModel,tr.prototype.cloneProtected=function(a){vd.prototype.cloneProtected.call(this,a),a.Fi=this.Fi,a.Pl=this.Pl,a.fl=this.fl,a.bf=this.bf,a.cf=this.cf,a.Sj=this.Sj,a.Tj=this.Tj,a.Rj=this.Rj,a.Yd=this.Yd,a.Tl=this.Tl,a.xe=this.xe,a.Bn=this.Bn},(n=tr.prototype).clear=function(){vd.prototype.clear.call(this),this.bd=[],this.gb.clear(),this.cg.clear()},n.toString=function(a){if(void 0===a&&(a=0),2<=a)return this.fr();var b=(""!==this.name?this.name:"")+" GraphLinksModel";if(0<a){b+="\n node data:";var t,e=(a=this.nodeDataArray).length;for(t=0;t<e;t++){var n=a[t];b+=" "+this.ja(n)+":"+z(n)}for(b+="\n link data:",e=(a=this.linkDataArray).length,t=0;t<e;t++)b+=" "+$d(this,n=a[t],!0)+"--\x3e"+$d(this,n,!1)}return b},n.Yw=function(a,b){""===this.linkKeyProperty&&N("GraphLinksModel.linkKeyProperty must not be an empty string for .toIncrementalData() to succeed.");var t=vd.prototype.Yw.call(this,a,b),e=this,n=new ft,o=new ft,g=new ft,r=this.Xh;a.changes.each((function(a){a.model===e&&("linkDataArray"===a.modelChange?a.change===Be?n.add(a.newValue):a.change===Ie&&g.add(a.oldValue):e.xc(a.object)?o.add(a.object):null!==a.object&&(null!==a.object&&r&&r.contains(a.object)?r.get(a.object).each((function(a){e.xc(a)&&o.add(a)})):a.object instanceof vd||e.$a(a.object)||Zd(e,a.object).each((function(a){o.add(a)}))))}));var h=this.Ji;h.clear(),n.each((function(a){h.add(e.Wb(a)),b||o.add(a)}));var l=this.Mi;return l.clear(),g.each((function(a){l.add(e.Wb(a)),b&&o.add(a)})),a=e.cloneDeep(o.ma()),0<h.count&&(null===t&&(t={}),b?t.removedLinkKeys=h.ma():t.insertedLinkKeys=h.ma()),0<a.length&&(null===t&&(t={}),t.modifiedLinkData=a),0<l.count&&(null===t&&(t={}),b?t.insertedLinkKeys=l.ma():t.removedLinkKeys=l.ma()),l.clear(),h.clear(),t},n.Sk=function(){var a=vd.prototype.Sk.call(this),b="";return"category"!==this.linkCategoryProperty&&"string"==typeof this.linkCategoryProperty&&(b+=',\n  "linkCategoryProperty": '+this.quote(this.linkCategoryProperty)),""!==this.linkKeyProperty&&"string"==typeof this.linkKeyProperty&&(b+=',\n  "linkKeyProperty": '+this.quote(this.linkKeyProperty)),"from"!==this.linkFromKeyProperty&&"string"==typeof this.linkFromKeyProperty&&(b+=',\n  "linkFromKeyProperty": '+this.quote(this.linkFromKeyProperty)),"to"!==this.linkToKeyProperty&&"string"==typeof this.linkToKeyProperty&&(b+=',\n  "linkToKeyProperty": '+this.quote(this.linkToKeyProperty)),""!==this.linkFromPortIdProperty&&"string"==typeof this.linkFromPortIdProperty&&(b+=',\n  "linkFromPortIdProperty": '+this.quote(this.linkFromPortIdProperty)),""!==this.linkToPortIdProperty&&"string"==typeof this.linkToPortIdProperty&&(b+=',\n  "linkToPortIdProperty": '+this.quote(this.linkToPortIdProperty)),""!==this.linkLabelKeysProperty&&"string"==typeof this.linkLabelKeysProperty&&(b+=',\n  "linkLabelKeysProperty": '+this.quote(this.linkLabelKeysProperty)),"isGroup"!==this.nodeIsGroupProperty&&"string"==typeof this.nodeIsGroupProperty&&(b+=',\n  "nodeIsGroupProperty": '+this.quote(this.nodeIsGroupProperty)),"group"!==this.nodeGroupKeyProperty&&"string"==typeof this.nodeGroupKeyProperty&&(b+=',\n  "nodeGroupKeyProperty": '+this.quote(this.nodeGroupKeyProperty)),a+b},n.Wq=function(a){vd.prototype.Wq.call(this,a),a.linkKeyProperty&&(this.linkKeyProperty=a.linkKeyProperty),a.linkFromKeyProperty&&(this.linkFromKeyProperty=a.linkFromKeyProperty),a.linkToKeyProperty&&(this.linkToKeyProperty=a.linkToKeyProperty),a.linkFromPortIdProperty&&(this.linkFromPortIdProperty=a.linkFromPortIdProperty),a.linkToPortIdProperty&&(this.linkToPortIdProperty=a.linkToPortIdProperty),a.linkCategoryProperty&&(this.linkCategoryProperty=a.linkCategoryProperty),a.linkLabelKeysProperty&&(this.linkLabelKeysProperty=a.linkLabelKeysProperty),a.nodeIsGroupProperty&&(this.nodeIsGroupProperty=a.nodeIsGroupProperty),a.nodeGroupKeyProperty&&(this.nodeGroupKeyProperty=a.nodeGroupKeyProperty)},n.Zw=function(){return vd.prototype.Zw.call(this)+(',\n  "linkDataArray": '+Pd(this,this.linkDataArray,!0))},n.pw=function(a){vd.prototype.pw.call(this,a),a=a.linkDataArray,Array.isArray(a)&&(this.Mm(a),this.linkDataArray=a)},n.kr=function(a){if(!(a instanceof tr))return N("Model.computeJsonDifference: newmodel must be a GraphLinksModel"),"";""===this.linkKeyProperty&&N("GraphLinksModel.linkKeyProperty must not be an empty string for .computeJsonDifference() to succeed.");var b=vd.prototype.kr.call(this,a);hr(this,a,"linkKeyProperty"),hr(this,a,"linkFromKeyProperty"),hr(this,a,"linkToKeyProperty"),hr(this,a,"linkLabelKeysProperty"),hr(this,a,"nodeIsGroupProperty"),hr(this,a,"nodeGroupKeyProperty");var t=this.Ji;t.clear();var e=new ft,n=this.Mi;n.clear(),n.addAll(this.gb.iteratorKeys);for(var o=new Mt,g=a.linkDataArray,r=g.length,h=0;h<r;h++){var l=g[h],c=a.Wb(l);if(void 0!==c){n.remove(c);var f=this.Eg(c);null===f?(t.add(c),e.add(l)):wd(this,f,l,o)||e.add(l)}else this.Pq(l),c=this.Wb(l),t.add(c),e.add(l)}return a=b,0<t.count&&(a+=this.pu+Pd(this,t.ma(),!0)),0<e.count&&(a+=this.kx+Pd(this,e.ma(),!0)),0<n.count&&(a+=this.ru+Pd(this,n.ma(),!0)),n.clear(),t.clear(),a},n.Xw=function(a,b){""===this.linkKeyProperty&&N("GraphLinksModel.linkKeyProperty must not be an empty string for .toIncrementalJson() to succeed.");var t=vd.prototype.Xw.call(this,a,b),e=this,n=new ft,o=new ft,g=new ft,r=this.Xh;a.changes.each((function(a){a.model===e&&("linkDataArray"===a.modelChange?a.change===Be?n.add(a.newValue):a.change===Ie&&g.add(a.oldValue):e.xc(a.object)?o.add(a.object):null!==a.object&&(null!==a.object&&r&&r.contains(a.object)?r.get(a.object).each((function(a){e.xc(a)&&o.add(a)})):a.object instanceof vd||e.$a(a.object)||Zd(e,a.object).each((function(a){o.add(a)}))))}));var h=this.Ji;h.clear(),n.each((function(a){h.add(e.Wb(a)),b||o.add(a)}));var l=this.Mi;return l.clear(),g.each((function(a){l.add(e.Wb(a)),b&&o.add(a)})),a=t,0<h.count&&(a+=(b?this.ru:this.pu)+Pd(this,h.ma(),!0)),0<o.count&&(a+=this.kx+Pd(this,o.ma(),!0)),0<l.count&&(a+=(b?this.pu:this.ru)+Pd(this,l.ma(),!0)),l.clear(),h.clear(),a},n.Vq=function(a){(void 0!==a.linkCategoryProperty&&a.linkCategoryProperty!==this.linkCategoryProperty||void 0!==a.linkKeyProperty&&a.linkKeyProperty!==this.linkKeyProperty||void 0!==a.linkFromKeyProperty&&a.linkFromKeyProperty!==this.linkFromKeyProperty||void 0!==a.linkToKeyProperty&&a.linkToKeyProperty!==this.linkToKeyProperty||void 0!==a.linkFromPortIdProperty&&a.linkFromPortIdProperty!==this.linkFromPortIdProperty||void 0!==a.linkToPortIdProperty&&a.linkToPortIdProperty!==this.linkToPortIdProperty||void 0!==a.linkLabelKeysProperty&&a.linkLabelKeysProperty!==this.linkLabelKeysProperty||void 0!==a.nodeIsGroupProperty&&a.nodeIsGroupProperty!==this.nodeIsGroupProperty||void 0!==a.nodeGroupKeyProperty&&a.nodeGroupKeyProperty!==this.nodeGroupKeyProperty)&&N("applyIncrementalJson cannot change Model properties"),vd.prototype.Vq.call(this,a);var b=a.insertedLinkKeys;if(Array.isArray(b))for(var t=b.length,e=0;e<t;e++){var n=b[e],o=this.Eg(n);null===o&&(o=this.wq({}),this.gu(o,n),this.aj(o))}if(b=a.modifiedLinkData,Array.isArray(b))for(t=b.length,e=0;e<t;e++)if(n=b[e],o=this.Wb(n),null!==(o=this.Eg(o))){for(var g in n)"__gohashid"!==g&&g!==this.linkKeyProperty&&this.setDataProperty(o,g,n[g]);op(this,n,o)}if(a=a.removedLinkKeys,Array.isArray(a))for(g=a.length,b=0;b<g;b++)null!==(t=this.Eg(a[b]))&&this.Km(t)},tr.prototype.changeState=function(a,b){if(null!==a&&a.model===this){if(a.change===Fe){var t=a.object,e=a.propertyName;if(e===this.linkKeyProperty&&this.xc(t)){var n=a.H(b);return void 0!==(b=a.H(!b))&&this.gb.remove(b),void 0!==n&&this.gb.add(n,t),void Yd(t,e,n)}}else if(a.change===Be){if(t=a.newParam,"linkDataArray"===a.modelChange)return void(j(a=a.newValue)&&"number"==typeof t&&(e=this.Wb(a),b?(this.cg.remove(a),this.bd[t]===a&&this.bd.splice(t,1),void 0!==e&&this.gb.remove(e)):(this.cg.add(a),this.bd[t]!==a&&this.bd.splice(t,0,a),void 0!==e&&this.gb.add(e,a))));if("linkLabelKeys"===a.modelChange)return e=this.Df(a.object),void(Array.isArray(e)&&"number"==typeof t&&(b?(t=e.indexOf(a.newValue),0<=t&&e.splice(t,1)):0>e.indexOf(a.newValue)&&e.splice(t,0,a.newValue)))}else if(a.change===Ie){if(t=a.oldParam,"linkDataArray"===a.modelChange)return void(j(a=a.oldValue)&&"number"==typeof t&&(e=this.Wb(a),b?(this.cg.add(a),this.bd[t]!==a&&this.bd.splice(t,0,a),void 0!==e&&this.gb.add(e,a)):(this.cg.remove(a),this.bd[t]===a&&this.bd.splice(t,1),void 0!==e&&this.gb.remove(e))));if("linkLabelKeys"===a.modelChange)return e=this.Df(a.object),void(Array.isArray(e)&&"number"==typeof t&&(b?0>e.indexOf(a.newValue)&&e.splice(t,0,a.newValue):(t=e.indexOf(a.newValue),0<=t&&e.splice(t,1))))}vd.prototype.changeState.call(this,a,b)}},(n=tr.prototype).Em=function(a){if(void 0!==a){var b=this.yj;if(null!==b){var t=this.Lb(a);null===t&&(Yd(t=this.copyNodeData(b),this.nodeKeyProperty,a),this.wf(t))}return a}},n.yy=function(a){return $d(this,a,!0)},n.Bw=function(a,b){Qd(this,a,b,!0)},n.By=function(a){return $d(this,a,!1)},n.Gw=function(a,b){Qd(this,a,b,!1)},n.zy=function(a){return _d(this,a,!0)},n.Cw=function(a,b){tp(this,a,b,!0)},n.Cy=function(a){return _d(this,a,!1)},n.Hw=function(a,b){tp(this,a,b,!1)},n.Df=function(a){if(null===a)return sp;var b=this.Yd;return""===b||void 0===(a=Gd(a,b))?sp:a},n.hu=function(a,b){if(null!==a){var t=this.Yd;if(""!==t)if(this.xc(a)){var e=Gd(a,t);if(void 0===e&&(e=sp),e!==b){if(Array.isArray(e))for(var n=e.length,o=0;o<n;o++)Bd(this,e[o],a);for(Yd(a,t,b),n=b.length,o=0;o<n;o++){var g=b[o];null===this.Lb(g)&&Fd(this,g,a)}Ad(this,"linkLabelKeys",Fe,t,a,e,b),"string"==typeof t&&this.Ca(a,t)}}else Yd(a,t,b)}},n.Bv=function(a,b){if(null!=b&&null!==a){var t=this.Yd;if(""!==t){var e=Gd(a,t);if(void 0===e)(t=[]).push(b),this.hu(a,t);else if(Array.isArray(e)){var n=e.indexOf(b);0<=n||(n=e.length,e.push(b),this.xc(a)&&(null===this.Lb(b)&&Fd(this,b,a),Ad(this,"linkLabelKeys",Be,t,a,null,b,null,n)))}else N(t+" property is not an Array; cannot addLabelKeyForLinkData: "+a)}}},n.Qy=function(a,b){if(null!=b&&null!==a){var t=this.Yd;if(""!==t){var e=Gd(a,t);if(Array.isArray(e)){var n=e.indexOf(b);0>n||(e.splice(n,1),this.xc(a)&&(Bd(this,b,a),Ad(this,"linkLabelKeys",Ie,t,a,b,null,n,null)))}else void 0!==e&&N(t+" property is not an Array; cannot removeLabelKeyforLinkData: "+a)}}},n.Wb=function(a){if(null!==a){var b=this.Fi;if(""!==b&&void 0!==(b=Gd(a,b))){if(jd(b))return b;N("Key value for link data "+a+" is not a number or a string: "+b)}}},n.gu=function(a,b){if(null!==a){var t=this.Fi;if(""!==t)if(this.xc(a)){var e=Gd(a,t);e!==b&&null===this.Eg(b)&&(Yd(a,t,b),void 0!==e&&this.gb.remove(e),this.gb.add(b,a),Ad(this,"linkKey",Fe,t,a,e,b),"string"==typeof t&&this.Ca(a,t))}else Yd(a,t,b)}},n.Eg=function(a){return null===a&&N("GraphLinksModel.findLinkDataForKey:key must not be null"),void 0!==a&&jd(a)?this.gb.H(a):null},n.Pq=function(a){if(null!==a){var b=this.Fi;if(""!==b){var t=this.Wb(a);if(void 0===t||this.gb.contains(t)){var e=this.Pl;if(null!==e&&(null!=(t=e(this,a))&&!this.gb.contains(t)))return void Yd(a,b,t);if("string"==typeof t){for(e=2;this.gb.contains(t+e);)e++;Yd(a,b,t+e)}else if(void 0===t||"number"==typeof t){for(t=-this.gb.count-1;this.gb.contains(t);)t--;Yd(a,b,t)}}}}},n.xc=function(a){return null!==a&&this.cg.contains(a)},n.aj=function(a){null!==a&&(gt(a),this.xc(a)||ip(this,a,!0))},n.pz=function(a){if(Array.isArray(a))for(var b=a.length,t=0;t<b;t++)this.aj(a[t]);else for(a=a.iterator;a.next();)this.aj(a.value)},n.Km=function(a){null!==a&&ep(this,a,!0)},n.SA=function(a){if(Array.isArray(a))for(var b=a.length,t=0;t<b;t++)this.Km(a[t]);else for(a=a.iterator;a.next();)this.Km(a.value)},n.JA=function(a){if(""===this.linkKeyProperty&&N("GraphLinksModel.linkKeyProperty must not be an empty string for .mergeLinkDataArray() to succeed."),a!==this.linkDataArray&&D(a)){var b=this.Mi;b.clear(),b.addAll(this.gb.iteratorKeys);var t=this.Ji;t.clear();for(var e=a.length,n=0;n<e;n++){var o=a[n],g=this.Wb(o);if(void 0!==g){t.add(g);var r=this.Eg(g);r!==o&&(null!==r?(this.rq(r,o),op(this,o,r)):(o=this.cloneDeep(o),this.gu(o,g),this.aj(o)))}else g=this.cloneDeep(o),this.aj(g),t.add(this.Wb(g))}for(a=b.iterator;a.next();)e=a.value,t.contains(e)||(e=this.Eg(e))&&this.Km(e);b.clear(),t.clear()}},n.wq=function(a){if(null===a)return null;var b=this.fl;return j(a=null!==b?b(a,this):Rd(this,a,!0))&&(pt(a),""!==this.bf&&Yd(a,this.bf,void 0),""!==this.cf&&Yd(a,this.cf,void 0),""!==this.Yd&&Yd(a,this.Yd,[])),a},n.dw=function(a){if(null===a)return!1;var b=this.Tl;return""!==b&&!!Gd(a,b)},n.Kh=function(a){if(null!==a){var b=this.xe;if(""!==b&&void 0!==(b=Gd(a,b))){if(jd(b))return b;N("GroupKey value for node data "+a+" is not a number or a string: "+b)}}},n.cr=function(a,b){if(null===b&&(b=void 0),null!==a){var t=this.xe;if(""!==t)if(this.$a(a)){var e=Gd(a,t);e!==b&&(Bd(this,e,a),Yd(a,t,b),null===this.Lb(b)&&Fd(this,b,a),Ad(this,"nodeGroupKey",Fe,t,a,e,b),"string"==typeof t&&this.Ca(a,t))}else Yd(a,t,b)}},tr.prototype.copyNodeData=function(a){return null===a?null:(a=vd.prototype.copyNodeData.call(this,a),this.pk||""===this.xe||void 0===Gd(a,this.xe)||Yd(a,this.xe,void 0),a)},tr.prototype.setDataProperty=function(a,b,t){if(this.$a(a)){if(b===this.nodeKeyProperty)return void this.Tm(a,t);if(b===this.nodeCategoryProperty)return void this.Sm(a,t);if(b===this.nodeGroupKeyProperty)return void this.cr(a,t)}else if(this.xc(a)){if(b===this.linkFromKeyProperty)return void Qd(this,a,t,!0);if(b===this.linkToKeyProperty)return void Qd(this,a,t,!1);if(b===this.linkFromPortIdProperty)return void tp(this,a,t,!0);if(b===this.linkToPortIdProperty)return void tp(this,a,t,!1);if(b===this.linkKeyProperty)return void this.gu(a,t);if(b===this.linkCategoryProperty)return void this.br(a,t);if(b===this.linkLabelKeysProperty)return void this.hu(a,t)}var e=Gd(a,b);e!==t&&(Yd(a,b,t),this.bu(a,b,e,t))},(n=tr.prototype).rq=function(a,b){if(b){var t,e=this.$a(a),n=this.xc(a);for(t in b)"__gohashid"===t||e&&t===this.nodeKeyProperty||e&&t===this.nodeIsGroupProperty&&Gd(a,t)===b[t]||n&&t===this.linkKeyProperty||this.setDataProperty(a,t,b[t])}},n.$q=function(a,b){vd.prototype.$q.call(this,a,b);for(var t=this.Va.iterator;t.next();)this.vw(t.value,a,b);for(t=this.cg.iterator;t.next();){var e=t.value,n=a,o=b;if($d(this,e,!0)===n){var g=this.bf;Yd(e,g,o),Ad(this,"linkFromKey",Fe,g,e,n,o),"string"==typeof g&&this.Ca(e,g)}if($d(this,e,!1)===n&&(Yd(e,g=this.cf,o),Ad(this,"linkToKey",Fe,g,e,n,o),"string"==typeof g&&this.Ca(e,g)),g=this.Df(e),Array.isArray(g))for(var r=g.length,h=this.Yd,l=0;l<r;l++)g[l]===n&&(g[l]=o,Ad(this,"linkLabelKeys",Be,h,e,n,o,l,l))}},n.vw=function(a,b,t){if(this.Kh(a)===b){var e=this.xe;Yd(a,e,t),Ad(this,"nodeGroupKey",Fe,e,a,b,t),"string"==typeof e&&this.Ca(a,e)}},n.Sw=function(){vd.prototype.Sw.call(this);for(var a=this.linkDataArray,b=a.length,t=0;t<b;t++)np(this,a[t])},n.Om=function(a){vd.prototype.Om.call(this,a);var b=Id(this,a=this.ja(a));if(null!==b){var t=I();for(b=b.iterator;b.next();){var e=b.value;if(this.$a(e)){if(this.Kh(e)===a){var n=this.xe;Ad(this,"nodeGroupKey",Fe,n,e,a,a),"string"==typeof n&&this.Ca(e,n),t.push(e)}}else if($d(this,e,!0)===a&&(n=this.bf,Ad(this,"linkFromKey",Fe,n,e,a,a),"string"==typeof n&&this.Ca(e,n),t.push(e)),$d(this,e,!1)===a&&(n=this.cf,Ad(this,"linkToKey",Fe,n,e,a,a),"string"==typeof n&&this.Ca(e,n),t.push(e)),n=this.Df(e),Array.isArray(n))for(var o=n.length,g=this.Yd,r=0;r<o;r++)n[r]===a&&(Ad(this,"linkLabelKeys",Be,g,e,a,a,r,r),t.push(e))}for(b=0;b<t.length;b++)Bd(this,a,t[b]);R(t)}},n.Nm=function(a){vd.prototype.Nm.call(this,a);var b=this.Kh(a);null===this.Lb(b)&&Fd(this,b,a)},n.hr=function(a){vd.prototype.hr.call(this,a),Bd(this,this.Kh(a),a)},n.Kt=function(a){if(null===a)return"";var b=this.Rj;return""===b||void 0===(b=Gd(a,b))?"":"string"==typeof b?b:(N("getCategoryForLinkData found a non-string category for "+a+": "+b),"")},tr.prototype.getLinkCategoryForData=function(a){return this.Kt(a)},tr.prototype.br=function(a,b){if(null!==a){var t=this.Rj;if(""!==t)if(this.xc(a)){var e=Gd(a,t);void 0===e&&(e=""),e!==b&&(Yd(a,t,b),Ad(this,"linkCategory",Fe,t,a,e,b),"string"==typeof t&&this.Ca(a,t))}else Yd(a,t,b)}},tr.prototype.setLinkCategoryForData=function(a,b){this.br(a,b)},(n=tr.prototype).Um=function(a,b){vd.prototype.Um.call(this,a,b),this.cr(b,this.Kh(a))},n.yk=function(){return!0},n.pj=function(){return!0},n.Tt=function(){return!0},n.zk=function(){return!0},v.Object.defineProperties(tr.prototype,{archetypeNodeData:{get:function(){return this.yj},set:function(a){var b=this.yj;b!==a&&(this.yj=a,this.g("archetypeNodeData",b,a))}},linkFromKeyProperty:{get:function(){return this.bf},set:function(a){var b=this.bf;b!==a&&(this.bf=a,this.g("linkFromKeyProperty",b,a))}},linkToKeyProperty:{get:function(){return this.cf},set:function(a){var b=this.cf;b!==a&&(this.cf=a,this.g("linkToKeyProperty",b,a))}},linkFromPortIdProperty:{get:function(){return this.Sj},set:function(a){var b=this.Sj;b!==a&&(this.Sj=a,this.g("linkFromPortIdProperty",b,a))}},linkToPortIdProperty:{get:function(){return this.Tj},set:function(a){var b=this.Tj;b!==a&&(this.Tj=a,this.g("linkToPortIdProperty",b,a))}},linkLabelKeysProperty:{get:function(){return this.Yd},set:function(a){var b=this.Yd;b!==a&&(this.Yd=a,this.g("linkLabelKeysProperty",b,a))}},linkDataArray:{get:function(){return this.bd},set:function(a){var b=this.bd;if(b!==a){this.gb.clear();for(var t=a.length,e=0;e<t;e++){var n=a[e];if(!j(n))return void N("GraphLinksModel.linkDataArray must only contain Objects, not: "+n);gt(n)}if(this.bd=a,""!==this.linkKeyProperty){for(e=new ut,n=0;n<t;n++){var o=a[n],g=this.Wb(o);void 0===g||null!==this.gb.H(g)?e.add(o):this.gb.add(g,o)}for(e=e.iterator;e.next();)n=e.value,this.Pq(n),void 0!==(o=this.Wb(n))&&this.gb.add(o,n)}for(e=new ft,n=0;n<t;n++)e.add(a[n]);for(this.cg=e,Ad(this,"linkDataArray",Fe,"linkDataArray",this,b,a),b=0;b<t;b++)np(this,a[b])}}},linkKeyProperty:{get:function(){return this.Fi},set:function(a){var b=this.Fi;if(b!==a){this.Fi=a,this.gb.clear();for(var t=this.linkDataArray.length,e=0;e<t;e++){var n=this.linkDataArray[e],o=this.Wb(n);void 0===o&&(this.Pq(n),o=this.Wb(n)),void 0!==o&&this.gb.add(o,n)}this.g("linkKeyProperty",b,a)}}},makeUniqueLinkKeyFunction:{get:function(){return this.Pl},set:function(a){var b=this.Pl;b!==a&&(this.Pl=a,this.g("makeUniqueLinkKeyFunction",b,a))}},copyLinkDataFunction:{get:function(){return this.fl},set:function(a){var b=this.fl;b!==a&&(this.fl=a,this.g("copyLinkDataFunction",b,a))}},nodeIsGroupProperty:{get:function(){return this.Tl},set:function(a){var b=this.Tl;b!==a&&(this.Tl=a,this.g("nodeIsGroupProperty",b,a))}},nodeGroupKeyProperty:{get:function(){return this.xe},set:function(a){var b=this.xe;b!==a&&(this.xe=a,this.g("nodeGroupKeyProperty",b,a))}},pk:{get:function(){return this.Bn},set:function(a){this.Bn!==a&&(this.Bn=a)}},linkCategoryProperty:{get:function(){return this.Rj},set:function(a){var b=this.Rj;b!==a&&(this.Rj=a,this.g("linkCategoryProperty",b,a))}},type:{get:function(){return"GraphLinksModel"}}}),tr.prototype.setCategoryForLinkData=tr.prototype.br,tr.prototype.getCategoryForLinkData=tr.prototype.Kt,tr.prototype.assignAllDataProperties=tr.prototype.rq,tr.prototype.setGroupKeyForNodeData=tr.prototype.cr,tr.prototype.getGroupKeyForNodeData=tr.prototype.Kh,tr.prototype.isGroupForNodeData=tr.prototype.dw,tr.prototype.copyLinkData=tr.prototype.wq,tr.prototype.mergeLinkDataArray=tr.prototype.JA,tr.prototype.removeLinkDataCollection=tr.prototype.SA,tr.prototype.removeLinkData=tr.prototype.Km,tr.prototype.addLinkDataCollection=tr.prototype.pz,tr.prototype.addLinkData=tr.prototype.aj,tr.prototype.containsLinkData=tr.prototype.xc,tr.prototype.makeLinkDataKeyUnique=tr.prototype.Pq,tr.prototype.findLinkDataForKey=tr.prototype.Eg,tr.prototype.setKeyForLinkData=tr.prototype.gu,tr.prototype.getKeyForLinkData=tr.prototype.Wb,tr.prototype.removeLabelKeyForLinkData=tr.prototype.Qy,tr.prototype.addLabelKeyForLinkData=tr.prototype.Bv,tr.prototype.setLabelKeysForLinkData=tr.prototype.hu,tr.prototype.getLabelKeysForLinkData=tr.prototype.Df,tr.prototype.setToPortIdForLinkData=tr.prototype.Hw,tr.prototype.getToPortIdForLinkData=tr.prototype.Cy,tr.prototype.setFromPortIdForLinkData=tr.prototype.Cw,tr.prototype.getFromPortIdForLinkData=tr.prototype.zy,tr.prototype.setToKeyForLinkData=tr.prototype.Gw,tr.prototype.getToKeyForLinkData=tr.prototype.By,tr.prototype.setFromKeyForLinkData=tr.prototype.Bw,tr.prototype.getFromKeyForLinkData=tr.prototype.yy,tr.prototype.clear=tr.prototype.clear;var sp=Object.freeze([]);function ap(a){vd.call(this),this.ye="parent",this.Dn=!1,this.Yj="parentLinkCategory",void 0!==a&&(this.nodeDataArray=a)}function hp(){wf.call(this),this.wx=this.Rn=this.$b=0,this.Ur=360,this.vx=bp,this.Gj=0,this.mx=new St,this.Gr=this.Zd=0,this.st=new Bp,this.yu=this.Xj=0,this.hz=600,this.tp=NaN,this.mn=1,this.Yp=0,this.jm=360,this.Fb=bp,this.K=Sp,this.dd=Dp,this.Yc=Gf,this.mf=6,this.cp=Op}function lp(a,b,t,e,n){var o=a.Ur,g=a.$b;a=a.Zd,e=e*Math.PI/180,t=t*Math.PI/180;for(var r=b.length,h=0;h<r;h++){var l=e+(n===Sp?h*t/(360<=o?r:r-1):-h*t/r),c=b.J(h),f=g*Math.tan(l)/a;f=Math.sqrt((g*g+a*a*f*f)/(1+f*f)),c.centerX=f*Math.cos(l),c.centerY=f*Math.sin(l),c.actualAngle=180*l/Math.PI}}function up(a,b,t,e){var n=a.$b,o=a.Zd,g=a.Gj;t=t*Math.PI/180;for(var r=b.length,h=0;h<r;h++){var l=b.J(h),c=b.J(h===r-1?0:h+1),f=o*Math.sin(t);l.centerX=n*Math.cos(t),l.centerY=f,l.actualAngle=180*t/Math.PI,isNaN(l.diameter)&&Ep(l,0),isNaN(c.diameter)&&Ep(c,0),l=xp(a,n,o,e===Sp?t:-t,(l.diameter+c.diameter)/2+g),t+=e===Sp?l:-l}}function cp(a,b,t,e){var n=a.$b,o=a.Zd,g=a.Gr;t=t*Math.PI/180;for(var r=b.length,h=0;h<r;h++){var l=b.J(h);l.centerX=n*Math.cos(t),l.centerY=o*Math.sin(t),l.actualAngle=180*t/Math.PI,l=xp(a,n,o,e===Sp?t:-t,g),t+=e===Sp?l:-l}}function fp(a,b,t,e,n){var o=a.Ur;if(a.Xj=0,a.st=new Bp,360>t){for(o=e+(n===Sp?o:-o);0>o;)o+=360;180<(o%=360)&&(o-=360),o*=Math.PI/180,a.yu=o,pp(a,b,t,e,n)}else dp(a,b,t,e,n);a.st.commit(b)}function dp(a,b,t,e,n){var o=a.$b,g=a.Gj,r=a.Rn,h=o*Math.cos(e*Math.PI/180),l=a.Zd*Math.sin(e*Math.PI/180),c=b.ma();if(3===c.length)c[0].centerX=o,c[0].centerY=0,c[1].centerX=c[0].centerX-c[0].width/2-c[1].width/2-g,c[1].y=c[0].y,c[2].centerX=(c[0].centerX+c[1].centerX)/2,c[2].y=c[0].y-c[2].height-g;else if(4===c.length)c[0].centerX=o,c[0].centerY=0,c[2].centerX=-c[0].centerX,c[2].centerY=c[0].centerY,c[1].centerX=0,c[1].y=Math.min(c[0].y,c[2].y)-c[1].height-g,c[3].centerX=0,c[3].y=Math.max(c[0].y+c[0].height+g,c[2].y+c[2].height+g);else{o=St.alloc();for(var f=0;f<c.length&&(c[f].centerX=h,c[f].centerY=l,!(f>=c.length-1));f++)gp(a,h,l,c,f,n,o)||yp(a,h,l,c,f,n,o),h=o.x,l=o.y;if(St.free(o),a.Xj++,!(23<a.Xj)){h=c[0].centerX,l=c[0].centerY,o=c[c.length-1].centerX,f=c[c.length-1].centerY;var p=Math.abs(h-o)-((c[0].width+c[c.length-1].width)/2+g),d=Math.abs(l-f)-((c[0].height+c[c.length-1].height)/2+g);g=0,1>Math.abs(d)?Math.abs(h-o)<(c[0].width+c[c.length-1].width)/2&&(g=0):g=0<d?d:1>Math.abs(p)?0:p,h=Math.abs(o)>Math.abs(f)?0<o!=l>f:0<f!=h<o,(h=n===Sp?h:!h)&&(g=-Math.abs(g),g=Math.min(g,-c[c.length-1].width),g=Math.min(g,-c[c.length-1].height)),a.st.compare(g,c),1<Math.abs(g)&&(a.$b=8>a.Xj?a.$b-g/(2*Math.PI):5>c.length&&10<g?a.$b/2:a.$b-(0<g?1.7:-2.3),a.Zd=a.$b*r,dp(a,b,t,e,n))}}}function pp(a,b,t,e,n){for(var o=a.$b,g=a.Zd,r=a.Rn,h=o*Math.cos(e*Math.PI/180),l=g*Math.sin(e*Math.PI/180),c=St.alloc(),f=b.ma(),p=0;p<f.length&&(f[p].centerX=h,f[p].centerY=l,!(p>=f.length-1));p++)gp(a,h,l,f,p,n,c)||yp(a,h,l,f,p,n,c),h=c.x,l=c.y;if(St.free(c),a.Xj++,!(23<a.Xj)){if(h=Math.atan2(l,h),h=n===Sp?a.yu-h:h-a.yu,o=(h=Math.abs(h)<Math.abs(h-2*Math.PI)?h:h-2*Math.PI)*(o+g)/2,g=a.st,Math.abs(o)<Math.abs(g.ym))for(g.ym=o,g.Tk=[],g.$m=[],h=0;h<f.length;h++)g.Tk[h]=f[h].bounds.x,g.$m[h]=f[h].bounds.y;1<Math.abs(o)&&(a.$b=8>a.Xj?a.$b-o/(2*Math.PI):a.$b-(0<o?1.7:-2.3),a.Zd=a.$b*r,pp(a,b,t,e,n))}}function gp(a,b,t,e,n,o,g){var r=a.$b,h=a.Zd,l=0;a=(e[n].width+e[n+1].width)/2+a.Gj;var c=!1;if(0<=t!=(o===Sp)){if((o=b+a)>r){if((o=b-a)<-r)return g.x=o,g.y=l,!1;c=!0}}else if((o=b-a)<-r){if((o=b+a)>r)return g.x=o,g.y=l,!1;c=!0}return l=Math.sqrt(1-Math.min(1,o*o/(r*r)))*h,0>t!==c&&(l=-l),Math.abs(t-l)>(e[n].height+e[n+1].height)/2?(g.x=o,g.y=l,!1):(g.x=o,g.y=l,!0)}function yp(a,b,t,e,n,o,g){var r=a.$b,h=a.Zd,l=0;if(a=(e[n].height+e[n+1].height)/2+a.Gj,e=!1,0<=b!=(o===Sp)){if((o=t-a)<-h){if((o=t+a)>h)return g.x=l,void(g.y=o);e=!0}}else if((o=t+a)>h){if((o=t-a)<-h)return g.x=l,void(g.y=o);e=!0}l=Math.sqrt(1-Math.min(1,o*o/(h*h)))*r,0>b!==e&&(l=-l),g.x=l,g.y=o}function mp(a,b,t,e,n){var o=a.hz;if(.001>Math.abs(a.Rn-1))return void 0!==e&&void 0!==n?n*b:2*Math.PI*b;a=b>t?Math.sqrt(b*b-t*t)/b:Math.sqrt(t*t-b*b)/t;for(var g=0,r=void 0!==e&&void 0!==n?n/(o+1):Math.PI/(2*(o+1)),h=0,l=0;l<=o;l++){h=void 0!==e&&void 0!==n?e+l*n/o:l*Math.PI/(2*o);var c=Math.sin(h);g+=Math.sqrt(1-a*a*c*c)*r}return void 0!==e&&void 0!==n?(b>t?b:t)*g:4*(b>t?b:t)*g}function vp(a,b,t,e,n){return b/(void 0!==e&&void 0!==n?mp(a,1,t,e,n):mp(a,1,t))}function xp(a,b,t,e,n){if(.001>Math.abs(a.Rn-1))return n/b;var o=b>t?Math.sqrt(b*b-t*t)/b:Math.sqrt(t*t-b*b)/t,g=0;a=2*Math.PI/(700*a.network.vertexes.count),b>t&&(e+=Math.PI/2);for(var r=0;;r++){var h=Math.sin(e+r*a);if((g+=(b>t?b:t)*Math.sqrt(1-o*o*h*h)*a)>=n)return r*a}}tr.className="GraphLinksModel",qd.GraphLinksModel=tr,vd.constructGraphLinksModel=vd.constructGraphLinksModel=function(){return new tr},vd.initDiagramModel=Ed=function(){return new tr},m(ap,vd),ap.constructGraphLinksModel=vd.constructGraphLinksModel,ap.prototype.cloneProtected=function(a){vd.prototype.cloneProtected.call(this,a),a.ye=this.ye,a.Dn=this.Dn,a.Yj=this.Yj},(n=ap.prototype).toString=function(a){if(void 0===a&&(a=0),2<=a)return this.fr();var b=(""!==this.name?this.name:"")+" TreeModel";if(0<a){b+="\n node data:";for(var t=(a=this.nodeDataArray).length,e=0;e<t;e++){var n=a[e];b+=" "+this.ja(n)+":"+z(n)}}return b},n.Sk=function(){var a=vd.prototype.Sk.call(this),b="";return"parent"!==this.nodeParentKeyProperty&&"string"==typeof this.nodeParentKeyProperty&&(b+=',\n  "nodeParentKeyProperty": '+this.quote(this.nodeParentKeyProperty)),a+b},n.Wq=function(a){vd.prototype.Wq.call(this,a),a.nodeParentKeyProperty&&(this.nodeParentKeyProperty=a.nodeParentKeyProperty)},n.kr=function(a){return hr(this,a,"nodeParentKeyProperty"),vd.prototype.kr.call(this,a)},n.Vq=function(a){void 0!==a.nodeParentKeyProperty&&a.nodeParentKeyProperty!==this.nodeParentKeyProperty&&N("applyIncrementalJson cannot change Model properties"),vd.prototype.Vq.call(this,a)},n.Em=function(a){return a},n.Lh=function(a){if(null!==a){var b=this.ye;if(""!==b&&void 0!==(b=Gd(a,b))){if(jd(b))return b;N("ParentKey value for node data "+a+" is not a number or a string: "+b)}}},n.de=function(a,b){if(null===b&&(b=void 0),null!==a){var t=this.ye;if(""!==t)if(b=this.Em(b),this.$a(a)){var e=Gd(a,t);e!==b&&(Bd(this,e,a),Yd(a,t,b),null===this.Lb(b)&&Fd(this,b,a),Ad(this,"nodeParentKey",Fe,t,a,e,b),"string"==typeof t&&this.Ca(a,t))}else Yd(a,t,b)}},n.Nt=function(a){if(null===a)return"";var b=this.Yj;return""===b||void 0===(b=Gd(a,b))?"":"string"==typeof b?b:(N("getParentLinkCategoryForNodeData found a non-string category for "+a+": "+b),"")},ap.prototype.getLinkCategoryForData=function(a){return this.Nt(a)},ap.prototype.iu=function(a,b){if(null!==a){var t=this.Yj;if(""!==t)if(this.$a(a)){var e=Gd(a,t);void 0===e&&(e=""),e!==b&&(Yd(a,t,b),Ad(this,"parentLinkCategory",Fe,t,a,e,b),"string"==typeof t&&this.Ca(a,t))}else Yd(a,t,b)}},ap.prototype.setLinkCategoryForData=function(a,b){this.iu(a,b)},ap.prototype.copyNodeData=function(a){return null===a?null:(a=vd.prototype.copyNodeData.call(this,a),this.qk||""===this.ye||void 0===Gd(a,this.ye)||Yd(a,this.ye,void 0),a)},ap.prototype.setDataProperty=function(a,b,t){if(this.$a(a)){if(b===this.nodeKeyProperty)return void this.Tm(a,t);if(b===this.nodeCategoryProperty)return void this.Sm(a,t);if(b===this.nodeParentKeyProperty)return void this.de(a,t)}var e=Gd(a,b);e!==t&&(Yd(a,b,t),this.bu(a,b,e,t))},(n=ap.prototype).$q=function(a,b){vd.prototype.$q.call(this,a,b);for(var t=this.Va.iterator;t.next();)this.vw(t.value,a,b)},n.vw=function(a,b,t){if(this.Lh(a)===b){var e=this.ye;Yd(a,e,t),Ad(this,"nodeParentKey",Fe,e,a,b,t),"string"==typeof e&&this.Ca(a,e)}},n.Om=function(a){vd.prototype.Om.call(this,a);var b=Id(this,a=this.ja(a));if(null!==b){var t=I();for(b=b.iterator;b.next();){var e=b.value;if(this.$a(e)&&this.Lh(e)===a){var n=this.ye;Ad(this,"nodeParentKey",Fe,n,e,a,a),"string"==typeof n&&this.Ca(e,n),t.push(e)}}for(b=0;b<t.length;b++)Bd(this,a,t[b]);R(t)}},n.Nm=function(a){vd.prototype.Nm.call(this,a);var b=this.Lh(a);b=this.Em(b),null===this.Lb(b)&&Fd(this,b,a)},n.hr=function(a){vd.prototype.hr.call(this,a),Bd(this,this.Lh(a),a)},n.Um=function(a,b){vd.prototype.Um.call(this,a,b),this.iu(b,this.Nt(a)),this.de(b,this.Lh(a))},n.Cm=function(){return!0},n.Tt=function(){return!0},v.Object.defineProperties(ap.prototype,{nodeParentKeyProperty:{get:function(){return this.ye},set:function(a){var b=this.ye;b!==a&&(this.ye=a,this.g("nodeParentKeyProperty",b,a))}},qk:{get:function(){return this.Dn},set:function(a){this.Dn!==a&&(this.Dn=a)}},parentLinkCategoryProperty:{get:function(){return this.Yj},set:function(a){var b=this.Yj;b!==a&&(this.Yj=a,this.g("parentLinkCategoryProperty",b,a))}},linkCategoryProperty:{get:function(){return this.parentLinkCategoryProperty},set:function(a){this.parentLinkCategoryProperty=a}},type:{get:function(){return"TreeModel"}}}),ap.prototype.setParentLinkCategoryForNodeData=ap.prototype.iu,ap.prototype.getParentLinkCategoryForNodeData=ap.prototype.Nt,ap.prototype.setParentKeyForNodeData=ap.prototype.de,ap.prototype.getParentKeyForNodeData=ap.prototype.Lh,ap.className="TreeModel",qd.TreeModel=ap,m(hp,wf),hp.prototype.cloneProtected=function(a){wf.prototype.cloneProtected.call(this,a),a.tp=this.tp,a.mn=this.mn,a.Yp=this.Yp,a.jm=this.jm,a.Fb=this.Fb,a.K=this.K,a.dd=this.dd,a.Yc=this.Yc,a.mf=this.mf,a.cp=this.cp},hp.prototype.jb=function(a){a.classType===hp?a===Ap||a===jp||a===Tp||a===Lp||a===Dp?this.sorting=a:a===Np||a===Cp||a===Sp||a===Pp?this.direction=a:a===kp||a===wp||a===bp||a===Mp?this.arrangement=a:a!==Fp&&a!==Op||(this.nodeDiameterFormula=a):wf.prototype.jb.call(this,a)},hp.prototype.createNetwork=function(){return new Ip(this)},hp.prototype.doLayout=function(a){if(null===this.network&&(this.network=this.makeNetwork(a)),this.arrangementOrigin=this.initialOrigin(this.arrangementOrigin),1>=(a=this.network.vertexes).count)1===a.count&&((a=a.first()).centerX=0,a.centerY=0);else{var b=new ut;b.addAll(a.iterator),a=new ut;var t,e,n=new ut,o=this.sort(b),g=this.Gr,r=this.arrangement,h=this.nodeDiameterFormula,l=this.radius;(!isFinite(l)||0>=l)&&(l=NaN);var c=this.aspectRatio;(!isFinite(c)||0>=c)&&(c=1);var f=this.startAngle;isFinite(f)||(f=0);var p=this.sweepAngle;if((!isFinite(p)||360<p||1>p)&&(p=360),b=this.spacing,isFinite(b)||(b=NaN),r===Mp&&h===Fp?r=bp:r===Mp&&h!==Fp&&(r=this.arrangement),(this.direction===Np||this.direction===Cp)&&this.sorting!==Dp){for(h=0;!(h>=o.length)&&(a.add(o.J(h)),!(h+1>=o.length));h+=2)n.add(o.J(h+1));this.direction===Np?(this.arrangement===Mp&&a.reverse(),(o=new ut).addAll(a),o.addAll(n)):(this.arrangement===Mp&&n.reverse(),(o=new ut).addAll(n),o.addAll(a))}h=o.length;for(var d=e=t=0;d<o.length;d++){var q=f+p*e*(this.direction===Sp?1:-1)/h,u=o.J(d).diameter;isNaN(u)&&(u=Ep(o.J(d),q)),360>p&&(0===d||d===o.length-1)&&(u/=2),t+=u,e++}if(isNaN(l)||r===Mp){if(isNaN(b)&&(b=6),r!==bp&&r!==Mp){for(e=-1/0,g=0;g<h;g++)d=o.J(g),t=o.J(g===h-1?0:g+1),isNaN(d.diameter)&&Ep(d,0),isNaN(t.diameter)&&Ep(t,0),e=Math.max(e,(d.diameter+t.diameter)/2);g=e+b,l=r===kp?(e+b)/(2*Math.PI/h):vp(this,g*(360<=p?h:h-1),c,f*Math.PI/180,p*Math.PI/180)}else l=vp(this,t+(360<=p?h:h-1)*(r!==Mp?b:1.6*b),c,f*Math.PI/180,p*Math.PI/180);e=l*c}else if(d=mp(this,l,e=l*c,f*Math.PI/180,p*Math.PI/180),isNaN(b))r!==bp&&r!==Mp||(b=(d-t)/(360<=p?h:h-1));else if(r===bp||r===Mp)(d=(d-t)/(360<=p?h:h-1))<b?e=(l=vp(this,t+b*(360<=p?h:h-1),c,f*Math.PI/180,p*Math.PI/180))*c:b=d;else{for(g=-1/0,t=0;t<h;t++)q=o.J(t),u=o.J(t===h-1?0:t+1),isNaN(q.diameter)&&Ep(q,0),isNaN(u.diameter)&&Ep(u,0),g=Math.max(g,(q.diameter+u.diameter)/2);(t=vp(this,(g+=b)*(360<=p?h:h-1),c,f*Math.PI/180,p*Math.PI/180))>l?e=(l=t)*c:g=d/(360<=p?h:h-1)}if(this.vx=r,this.$b=l,this.Rn=c,this.wx=f,this.Ur=p,this.Gj=b,this.Zd=e,this.Gr=g,b=o,o=this.vx,r=this.$b,l=this.wx,c=this.Ur,f=this.Gj,p=this.Zd,h=this.Gr,this.direction!==Np&&this.direction!==Cp||o!==Mp)if(this.direction===Np||this.direction===Cp){switch(g=0,o){case wp:g=180*xp(this,r,p,l,h)/Math.PI;break;case bp:h=b=0,null!==(g=a.first())&&(b=Ep(g,Math.PI/2)),null!==(g=n.first())&&(h=Ep(g,Math.PI/2)),g=180*xp(this,r,p,l,f+(b+h)/2)/Math.PI;break;case kp:g=c/b.length}if(this.direction===Np){switch(o){case wp:cp(this,a,l,Pp);break;case bp:up(this,a,l,Pp);break;case kp:lp(this,a,c/2,l,Pp)}switch(o){case wp:cp(this,n,l+g,Sp);break;case bp:up(this,n,l+g,Sp);break;case kp:lp(this,n,c/2,l+g,Sp)}}else{switch(o){case wp:cp(this,n,l,Pp);break;case bp:up(this,n,l,Pp);break;case kp:lp(this,n,c/2,l,Pp)}switch(o){case wp:cp(this,a,l+g,Sp);break;case bp:up(this,a,l+g,Sp);break;case kp:lp(this,a,c/2,l+g,Sp)}}}else switch(o){case wp:cp(this,b,l,this.direction);break;case bp:up(this,b,l,this.direction);break;case kp:lp(this,b,c,l,this.direction);break;case Mp:fp(this,b,c,l,this.direction)}else fp(this,b,c,l-c/2,Sp)}this.updateParts(),this.network=null,this.isValidLayout=!0},hp.prototype.commitLayout=function(){this.commitNodes(),this.isRouting&&this.commitLinks()},hp.prototype.commitNodes=function(){var a=null!==this.group&&null!==this.group.placeholder&&this.group.isSubGraphExpanded,b=a?this.group.location.copy():null,t=this.actualCenter;a?t=new St(0,0):(t.x=this.arrangementOrigin.x+this.$b,t.y=this.arrangementOrigin.y+this.Zd);for(var e=this.network.vertexes.iterator;e.next();){var n=e.value;n.x+=t.x,n.y+=t.y,n.commit()}a&&(this.group.Ta(),a=this.group.position.copy(),t=this.group.location.copy(),b=b.ee(t.ee(a)),this.group.move(b),this.mx=b.ee(a))},hp.prototype.commitLinks=function(){for(var a=this.network.edges.iterator;a.next();)a.value.commit()},hp.prototype.sort=function(a){switch(this.sorting){case Tp:break;case Lp:a.reverse();break;case Ap:a.sort(this.comparer);break;case jp:a.sort(this.comparer),a.reverse();break;case Dp:return this.lw(function(a){for(var b=[],t=0;t<a.length;t++)b.push(0);t=new ut;for(var e=0;e<a.length;e++){var n=-1,o=-1;if(0===e)for(var g=0;g<a.length;g++){var r=a.J(g).edgesCount;r>n&&(n=r,o=g)}else for(g=0;g<a.length;g++)(r=b[g])>n&&(n=r,o=g);for(t.add(a.J(o)),b[o]=-1,g=(o=a.J(o)).sourceEdges;g.next();)0>(n=a.indexOf(g.value.fromVertex))||0<=b[n]&&b[n]++;for(o=o.destinationEdges;o.next();)0>(n=a.indexOf(o.value.toVertex))||0<=b[n]&&b[n]++}return t}(a));default:N("Invalid sorting type.")}return a},hp.prototype.lw=function(a){for(var b=[],t=0;t<a.length;t++){var e=a.J(t);b[t]=[];for(var n,o=e.destinationEdges;o.next();)(n=a.indexOf(o.value.toVertex))!==t&&0>b[t].indexOf(n)&&b[t].push(n);for(e=e.sourceEdges;e.next();)(n=a.indexOf(e.value.fromVertex))!==t&&0>b[t].indexOf(n)&&b[t].push(n)}for(o=[],t=0;t<b.length;t++)o[t]=0;t=[];var g=[],r=[];e=[],n=new ut;for(var h=0,l=0;l<b.length;l++){var c=b[l].length;if(1===c)e.push(l);else if(0===c)n.add(a.J(l));else{if(0===h)t.push(l);else{for(var f=c=1/0,p=-1,d=[],q=0;q<t.length;q++)0>b[t[q]].indexOf(t[q===t.length-1?0:q+1])&&d.push(q===t.length-1?0:q+1);if(0===d.length)for(q=0;q<t.length;q++)d.push(q);for(q=0;q<d.length;q++){for(var u=d[q],y=b[l],m=0,v=0;v<g.length;v++){var x=o[g[v]],w=o[r[v]];if(x<w){var k=x;x=w}else k=w;if(k<u&&u<=x)for(w=0;w<y.length;w++){var M=y[w];0>t.indexOf(M)||k<o[M]&&o[M]<x||k===o[M]||x===o[M]||m++}else for(w=0;w<y.length;w++)M=y[w],0>t.indexOf(M)||k<o[M]&&o[M]<x&&k!==o[M]&&x!==o[M]&&m++}for(y=m,v=m=0;v<b[l].length;v++)0<=(k=t.indexOf(b[l][v]))&&(m+=(k=Math.abs(u-(k>=u?k+1:k)))<t.length+1-k?k:t.length+1-k);for(v=0;v<g.length;v++)(k=o[g[v]])>=u&&k++,(x=o[r[v]])>=u&&x++,k>x&&(w=x,x=k,k=w),x-k<(t.length+2)/2==(k<u&&u<=x)&&m++;(y<c||y===c&&m<f)&&(c=y,f=m,p=u)}for(t.splice(p,0,l),c=0;c<t.length;c++)o[t[c]]=c;for(c=0;c<b[l].length;c++)f=b[l][c],0<=t.indexOf(f)&&(g.push(l),r.push(f))}h++}}for(g=t.length;;){for(o=!0,r=0;r<e.length;r++)if(l=b[h=e[r]][0],0<=(c=t.indexOf(l))){for(p=f=0;p<b[l].length;p++)0>(d=t.indexOf(b[l][p]))||d===c||(f+=d<c!=(q=d>c?d-c:c-d)>g-q?1:-1);t.splice(0>f?c:c+1,0,h),e.splice(r,1),r--}else o=!1;if(o)break;t.push(e[0]),e.splice(0,1)}for(b=0;b<t.length;b++)n.add(a.J(t[b]));return n},v.Object.defineProperties(hp.prototype,{radius:{get:function(){return this.tp},set:function(a){this.tp!==a&&(0<a||isNaN(a))&&(this.tp=a,this.C())}},aspectRatio:{get:function(){return this.mn},set:function(a){this.mn!==a&&0<a&&(this.mn=a,this.C())}},startAngle:{get:function(){return this.Yp},set:function(a){this.Yp!==a&&(this.Yp=a,this.C())}},sweepAngle:{get:function(){return this.jm},set:function(a){this.jm!==a&&(this.jm=0<a&&360>=a?a:360,this.C())}},arrangement:{get:function(){return this.Fb},set:function(a){this.Fb===a||a!==Mp&&a!==bp&&a!==wp&&a!==kp||(this.Fb=a,this.C())}},direction:{get:function(){return this.K},set:function(a){this.K===a||a!==Sp&&a!==Pp&&a!==Np&&a!==Cp||(this.K=a,this.C())}},sorting:{get:function(){return this.dd},set:function(a){this.dd===a||a!==Tp&&a!==Lp&&a!==Ap&&!jp&&a!==Dp||(this.dd=a,this.C())}},comparer:{get:function(){return this.Yc},set:function(a){this.Yc!==a&&(this.Yc=a,this.C())}},spacing:{get:function(){return this.mf},set:function(a){this.mf!==a&&(this.mf=a,this.C())}},nodeDiameterFormula:{get:function(){return this.cp},set:function(a){this.cp===a||a!==Op&&a!==Fp||(this.cp=a,this.C())}},actualXRadius:{get:function(){return this.$b}},actualYRadius:{get:function(){return this.Zd}},actualSpacing:{get:function(){return this.Gj}},actualCenter:{get:function(){return this.mx}}});var bp=new _(hp,"ConstantSpacing",0),wp=new _(hp,"ConstantDistance",1),kp=new _(hp,"ConstantAngle",2),Mp=new _(hp,"Packed",3),Sp=new _(hp,"Clockwise",4),Pp=new _(hp,"Counterclockwise",5),Np=new _(hp,"BidirectionalLeft",6),Cp=new _(hp,"BidirectionalRight",7),Tp=new _(hp,"Forwards",8),Lp=new _(hp,"Reverse",9),Ap=new _(hp,"Ascending",10),jp=new _(hp,"Descending",11),Dp=new _(hp,"Optimized",12),Op=new _(hp,"Pythagorean",13),Fp=new _(hp,"Circular",14);function Bp(){this.ym=-1/0,this.$m=this.Tk=null}function Ip(a){Bf.call(this,a)}function Rp(a){Vf.call(this,a),this.I=this.Ej=NaN}function Ep(a,b){var t=a.network;if(null===t)return NaN;if(null===(t=t.layout))return NaN;if(t.arrangement===Mp)if(t.nodeDiameterFormula===Fp)a.Ej=Math.max(a.width,a.height);else{if(t=Math.abs(Math.sin(b)),b=Math.abs(Math.cos(b)),0===t)return a.width;if(0===b)return a.height;a.Ej=Math.min(a.height/t,a.width/b)}else a.Ej=t.nodeDiameterFormula===Fp?Math.max(a.width,a.height):Math.sqrt(a.width*a.width+a.height*a.height);return a.Ej}function zp(a){Yf.call(this,a)}function Vp(){wf.call(this),this.Eh=null,this.yo=0,this.Nd=new Ut(100,100).freeze(),this.ln=!1,this.kf=!0,this.ld=!1,this.Ql=100,this.Un=1,this.Zf=1e3,this.Wo=10,this.vp=Math,this.ml=.05,this.ll=50,this.jl=150,this.kl=0,this.Ln=10,this.Kn=5}function Gp(a,b,t){if(function(a,b){if(10<b||3>a.network.vertexes.count)return!1;for(a.Eh=a.network.vertexes.ma(),(a=a.Eh).sort((function(a,b){return null===a||null===b||a===b?0:b.Jd-a.Jd})),b=a.length-1;0<=b&&1>=a[b].Jd;)b--;return 1<a.length-b}(a,b)){var e=a.Zf;a.Zf*=1+1/(b+1);var n=function(a,b){for(var t=a.network,e=new Wp(a),n=0;n<a.Eh.length;n++){var o=a.Eh[n];if(!(1<o.Jd))break;e.Cg(o);var g=new Hp;g.nu=o.Jd,g.ou=o.width,g.mu=o.height,g.$w=o.focus.x,g.ax=o.focus.y,null===o.Me&&(o.Me=new ut),o.Me.add(g),o.zw=o.Me.count-1}for(o=t.edges.iterator;o.next();){var r=o.value;n=r.fromVertex,g=r.toVertex,n.network===e&&g.network===e?e.qm(r):n.network===e?(null===(r=n.nk)&&(r=new ut,n.nk=r),r.add(g),n.Jd--,n.Rh+=g.Rh):g.network===e&&(null===(r=g.nk)&&(r=new ut,g.nk=r),r.add(n),g.Jd--,g.Rh+=n.Rh)}for(n=e.edges.iterator;n.next();)(o=n.value).length*=Math.max(1,oe.sqrt((o.fromVertex.Rh+o.toVertex.Rh)/(4*b+1)));for(b=e.vertexes.iterator;b.next();){var h=(n=b.value).nk;if(null!==h&&0<h.count&&!(0>=(g=n.Me.J(n.Me.count-1).nu-n.Jd))){for(var l=r=0,c=h.count-g;c<h.count;c++){var f=h.J(c),p=null;for(o=f.edges.iterator;o.next();){var d=o.value;if(d.Ay(f)===n){p=d;break}}null!==p&&(l+=p.length,r+=f.width*f.height)}o=n.centerX,h=n.centerY,c=n.width,f=n.height,p=n.focus,1>(d=c*f)&&(d=1),g=((r=oe.sqrt((r+d+l*l*4/(g*g))/d))-1)*c/2,r=(r-1)*f/2,n.bounds=new Jt(o-p.x-g,h-p.y-r,c+2*g,f+2*r),n.focus=new St(p.x+g,p.y+r)}}return a.network=e,t}(a,b),o=Math.max(0,Math.max(Math.min(a.network.vertexes.count,t*(b+1)/11),10));for(a.maxIterations+=o,Gp(a,b+1,t),Up(a,o),function(a,b){for(var t=a.network.vertexes.iterator;t.next();){var e=t.value;if(e.network=b,null!==e.Me){var n=e.Me.J(e.zw);e.Jd=n.nu;var o=n.$w,g=n.ax;e.bounds=new Jt(e.centerX-o,e.centerY-g,n.ou,n.mu),e.focus=new St(o,g),e.zw--}}for(t=a.network.edges.iterator;t.next();)t.value.network=b;a.network=b}(a,n),(b=n.vertexes.ma()).sort((function(a,b){return null===a||null===b||a===b?0:b.Jd-a.Jd})),t=0;t<b.length;t++)Yp(a,b[t]);a.Zf=e}}function Yp(a,b){var t=b.nk;if(null!==t&&0!==t.count){var e=b.centerX,n=b.centerY,o=b.width,g=b.height;null!==b.Me&&0<b.Me.count&&(o=(g=b.Me.J(0)).ou,g=g.mu),o=oe.sqrt(o*o+g*g)/2;for(var r=!1,h=g=0,l=0,c=b.vertexes.iterator;c.next();){var f=c.value;1>=f.Jd?h++:(r=!0,l++,g+=Math.atan2(b.centerY-f.centerY,b.centerX-f.centerX))}if(0!==h)for(0<l&&(g/=l),l=b=0,b=r?2*Math.PI/(h+1):2*Math.PI/h,0==h%2&&(l=b/2),1<t.count&&t.sort((function(a,b){return null===a||null===b||a===b?0:b.width*b.height-a.width*a.height})),r=0==h%2?0:1,t=t.iterator;t.next();)if(!(1<(h=t.value).Jd||a.isFixed(h))){for(c=null,f=h.edges.iterator;f.next();){c=f.value;break}f=h.width;var p=h.height;f=oe.sqrt(f*f+p*p)/2,c=o+c.length+f,f=g+(b*(r/2>>1)+l)*(0==r%2?1:-1),h.centerX=e+c*Math.cos(f),h.centerY=n+c*Math.sin(f),r++}}}function Xp(a,b,t,e,n,o,g){var r=9e19,h=-1,l=0;t:for(;l<b;l++){var c=a[l],f=c.x-t,p=c.y-e;if((f=f*f+p*p)<r){for(p=l-1;0<=p;p--)if(a[p].y>c.y&&a[p].x-c.x<n+g.width)continue t;for(p=l+1;p<b;p++)if(a[p].x>c.x&&a[p].y-c.y<o+g.height)continue t;h=l,r=f}}return h}function qp(a,b){var t=a.bounds,e=t.x;a=t.y;var n=t.width;t=t.height;var o=b.bounds,g=o.x;b=o.y;var r=o.width;return o=o.height,e+n<g?a>b+o?(t=e+n-g,a=a-b-o,oe.sqrt(t*t+a*a)):a+t<b?(e=e+n-g,a=a+t-b,oe.sqrt(e*e+a*a)):g-(e+n):e>g+r?a>b+o?(t=e-g-r,a=a-b-o,oe.sqrt(t*t+a*a)):a+t<b?(e=e-g-r,a=a+t-b,oe.sqrt(e*e+a*a)):e-(g+r):a>b+o?a-(b+o):a+t<b?b-(a+t):.1}function Up(a,b){for(a.Eh=null,b=a.yo+b;a.yo<b&&(a.yo++,Kp(a)););a.Eh=null}function Kp(a){null===a.Eh&&(a.Eh=a.network.vertexes.ma());var b=a.Eh;if(0>=b.length)return!1;var t=b[0];t.forceX=0,t.forceY=0;for(var e=t.centerX,n=e,o=t=t.centerY,g=1;g<b.length;g++){var r=b[g];r.forceX=0,r.forceY=0;var h=r.centerX;r=r.centerY,e=Math.min(e,h),n=Math.max(n,h),t=Math.min(t,r),o=Math.max(o,r)}(n=n-e>o-t)?b.sort((function(a,b){return null===a||null===b||a===b?0:a.centerX-b.centerX})):b.sort((function(a,b){return null===a||null===b||a===b?0:a.centerY-b.centerY})),t=a.Zf;var l=e=r=0;for(o=0;o<b.length;o++){e=(g=b[o]).bounds,r=g.focus,h=e.x+r.x;var c=e.y+r.y;e=g.charge*a.electricalFieldX(h,c),l=g.charge*a.electricalFieldY(h,c),e+=g.mass*a.gravitationalFieldX(h,c),l+=g.mass*a.gravitationalFieldY(h,c),g.forceX+=e,g.forceY+=l;for(var f=o+1;f<b.length;f++){var p=b[f];if(p!==g){e=p.bounds,r=p.focus,l=e.x+r.x;var d=e.y+r.y;if(h-l>t||l-h>t){if(n)break}else if(c-d>t||d-c>t){if(!n)break}else{var q=qp(g,p);1>q?(null===(e=a.randomNumberGenerator)&&(a.randomNumberGenerator=e=new $p),q=e.random(),r=e.random(),h>l?e=(1+(e=Math.abs(p.bounds.right-g.bounds.x)))*q:h<l?e=-(1+(e=Math.abs(p.bounds.x-g.bounds.right)))*q:e=(1+(e=Math.max(p.width,g.width)))*q-e/2,c>d?l=(1+(l=Math.abs(p.bounds.bottom-g.bounds.y)))*r:h<l?l=-(1+(l=Math.abs(p.bounds.y-g.bounds.bottom)))*r:l=(1+(l=Math.max(p.height,g.height)))*r-l/2):(e=(l-h)/q*(r=-g.charge*p.charge/(q*q)),l=(d-c)/q*r),g.forceX+=e,g.forceY+=l,p.forceX-=e,p.forceY-=l}}}}for(n=a.network.edges.iterator;n.next();)t=(r=n.value).fromVertex,o=r.toVertex,g=t.bounds,h=t.focus,e=g.x+h.x,g=g.y+h.y,c=o.bounds,f=o.focus,h=c.x+f.x,c=c.y+f.y,1>(f=qp(t,o))?(null===(f=a.randomNumberGenerator)&&(a.randomNumberGenerator=f=new $p),r=f.random(),f=f.random(),e=(e>h?1:-1)*(1+(o.width>t.width?o.width:t.width))*r,l=(g>c?1:-1)*(1+(o.height>t.height?o.height:t.height))*f):(e=(h-e)/f*(r=r.stiffness*(f-r.length)),l=(c-g)/f*r),t.forceX+=e,t.forceY+=l,o.forceX-=e,o.forceY-=l;for(n=e=0;n<b.length;n++)t=b[n],a.isFixed(t)?a.moveFixedVertex(t):e=Math.max(e,a.moveVertex(t)||0);return e>a.epsilonDistance*a.epsilonDistance}function Hp(){this.ax=this.$w=this.mu=this.ou=this.nu=0}function Wp(a){Bf.call(this,a)}function Jp(a){Vf.call(this,a),this.Ka=!1,this.eb=this.I=NaN,this.Rh=this.Jd=this.Ja=this.T=0,this.Me=this.nk=null,this.zw=0}function Zp(a){Yf.call(this,a),this.l=this.v=NaN}function $p(){var a=0;void 0===a&&(a=42),this.seed=a,this.az=48271,this.cz=2147483647,this.Q=44488.07041494893,this.dz=3399,this.bz=1/2147483647,this.random()}function Qp(){wf.call(this),this.Zb=this.se=25,this.K=0,this.hl=Ag,this.Ll=Og,this.Al=Ig,this.Pj=4,this.Xk=Vg,this.pg=7,this.kf=!0,this.Go=4,this.Ba=this.Hi=this.ra=-1,this.pc=this.mh=0,this.Ia=this.xd=this.yd=this.Xd=this.Ab=null,this.oh=0,this.Zo=this.Uj=null,this.Fc=0,this.$o=null,this.Xc=new St,this.ve=[],this.ve.length=100}function _p(a){var b=a.fromVertex.node||a.fromVertex.data;return a=a.toVertex.node||a.toVertex.data,null===b&&null===a?8:null===b||null===a?4:1}function tg(a){null===a.Uj&&(a.Uj=[]);for(var b=0,t=a.network.vertexes.iterator;t.next();){var e=t.value;a.Uj[b]=e.layer,b++,a.Uj[b]=e.column,b++,a.Uj[b]=e.index,b++}return a.Uj}function ig(a,b){var t=0;for(a=a.network.vertexes.iterator;a.next();){var e=a.value;e.layer=b[t],t++,e.column=b[t],t++,e.index=b[t],t++}}function eg(a,b,t){var e=Tg(a,b),n=a.Ab[b];(null===a.Zo||a.Zo.length<n*n)&&(a.Zo=[]);for(var o=a.Zo,g=0;g<n;g++){var p,r=0,h=e[g],l=h.near;if(null!==l&&l.layer===h.layer)if((h=l.index)>g)for(var c=g+1;c<h;c++){var f=e[c];f.near===l&&f.yf===l.yf||r++}else for(c=g-1;c>h;c--)(f=e[c]).near===l&&f.yf===l.yf||r++;if(0<=t)for(h=e[g].sourceEdgesArrayAccess,l=0;l<h.length;l++){var d=h[l];if(d.valid&&d.fromVertex.layer!==b)for(f=d.fromVertex.index,c=d.portToPos,d=d.portFromPos,p=l+1;p<h.length;p++){var q=h[p];if(q.valid&&q.fromVertex.layer!==b){var u=q.fromVertex.index,y=q.portToPos;q=q.portFromPos,c<y&&(f>u||f===u&&d>q)&&r++,y<c&&(u>f||u===f&&q>d)&&r++}}}if(0>=t)for(h=e[g].destinationEdgesArrayAccess,l=0;l<h.length;l++)if((d=h[l]).valid&&d.toVertex.layer!==b)for(f=d.toVertex.index,c=d.portToPos,d=d.portFromPos,p=l+1;p<h.length;p++)(q=h[p]).valid&&q.toVertex.layer!==b&&(u=q.toVertex.index,y=q.portToPos,d<(q=q.portFromPos)&&(f>u||f===u&&c>y)&&r++,q<d&&(u>f||u===f&&y>c)&&r++);for(o[g*n+g]=r,h=g+1;h<n;h++){var m=0,v=0;if(0<=t){r=e[g].sourceEdgesArrayAccess;var x=e[h].sourceEdgesArrayAccess;for(l=0;l<r.length;l++)if((d=r[l]).valid&&d.fromVertex.layer!==b)for(f=d.fromVertex.index,d=d.portFromPos,p=0;p<x.length;p++)(q=x[p]).valid&&q.fromVertex.layer!==b&&(u=q.fromVertex.index,q=q.portFromPos,(f<u||f===u&&d<q)&&v++,(u<f||u===f&&q<d)&&m++)}if(0>=t)for(r=e[g].destinationEdgesArrayAccess,x=e[h].destinationEdgesArrayAccess,l=0;l<r.length;l++)if((d=r[l]).valid&&d.toVertex.layer!==b)for(f=d.toVertex.index,c=d.portToPos,p=0;p<x.length;p++)(q=x[p]).valid&&q.toVertex.layer!==b&&(u=q.toVertex.index,y=q.portToPos,(f<u||f===u&&c<y)&&v++,(u<f||u===f&&y<c)&&m++);o[g*n+h]=m,o[h*n+g]=v}}return Lg(a,b,e),o}function ng(a){for(var b=0,t=0;t<=a.ra;t++){for(var e=a,n=t,o=Tg(e,n),g=e.Ab[n],r=0,h=0;h<g;h++){var l=o[h].destinationEdgesArrayAccess;if(null!==l)for(var c=0;c<l.length;c++){var f=l[c];if(f.valid&&f.toVertex.layer!==n){var p=f.fromVertex.column+f.portFromColOffset,d=f.toVertex.column+f.portToColOffset;r+=(Math.abs(p-d)+1)*_p(f)}}}Lg(e,n,o),b+=r}return b}function og(a,b,t){for(var e=Tg(a,b),n=a.Ab[b],o=[],g=0;g<n;g++){var r=e[g],h=null;0>=t&&(h=r.sourceEdgesArrayAccess);var l=null;0<=t&&(l=r.destinationEdgesArrayAccess);var c=0,f=0,p=r.near;if(null!==p&&p.layer===r.layer&&(c+=p.column-1,f++),null!==h)for(p=0;p<h.length;p++){var d=(r=h[p]).fromVertex;r.valid&&!r.rev&&d.layer!==b&&(c+=d.column,f++)}if(null!==l)for(h=0;h<l.length;h++)p=(r=l[h]).toVertex,r.valid&&!r.rev&&p.layer!==b&&(c+=p.column,f++);o[g]=0===f?-1:c/f}return Lg(a,b,e),o}function rg(a,b,t){for(var e=Tg(a,b),n=a.Ab[b],o=[],g=0;g<n;g++){var r=e[g],h=null;0>=t&&(h=r.sourceEdgesArrayAccess);var l=null;0<=t&&(l=r.destinationEdgesArrayAccess);var c=0,f=[],p=r.near;if(null!==p&&p.layer===r.layer&&(f[c]=p.column-1,c++),r=void 0,null!==h)for(p=0;p<h.length;p++){var d=(r=h[p]).fromVertex;r.valid&&!r.rev&&d.layer!==b&&(f[c]=d.column+r.portFromColOffset,c++)}if(null!==l)for(h=0;h<l.length;h++)p=(r=l[h]).toVertex,r.valid&&!r.rev&&p.layer!==b&&(f[c]=p.column+r.portToColOffset,c++);0===c?o[g]=-1:(f.sort((function(a,b){return a-b})),l=c>>1,o[g]=0!=(1&c)?f[l]:f[l-1]+f[l]>>1)}return Lg(a,b,e),o}function sg(a,b,t,e,n,o){if(b.component===e){if(b.component=t,n)for(var g=b.destinationEdges;g.next();){var r=g.value,h=r.toVertex,l=b.layer-h.layer;l===(r=a.linkMinLength(r))&&sg(a,h,t,e,n,o)}if(o)for(g=b.sourceEdges;g.next();)(l=(h=(r=g.value).fromVertex).layer-b.layer)===(r=a.linkMinLength(r))&&sg(a,h,t,e,n,o)}}function ag(a,b,t,e,n,o){if(b.component===e){if(b.component=t,n)for(var g=b.destinationEdges;g.next();)ag(a,g.value.toVertex,t,e,n,o);if(o)for(b=b.sourceEdges;b.next();)ag(a,b.value.fromVertex,t,e,n,o)}}function hg(a){for(a=a.vertexes.iterator;a.next();){var b=a.value;if(b.valid)return b}return null}function lg(a){for(a=a.vertexes.iterator;a.next();){var b=a.value;if(b.valid){for(var t=!0,e=b.destinationEdges;e.next();)if(e.value.toVertex.valid){t=!1;break}if(t)return b}}return null}function ug(a){for(a=a.vertexes.iterator;a.next();){var b=a.value;if(b.valid){for(var t=!0,e=b.sourceEdges;e.next();)if(e.value.fromVertex.valid){t=!1;break}if(t)return b}}return null}function cg(a,b){b.Dg=a.oh,a.oh++;for(var t=b.destinationEdges;t.next();){var e=t.value,n=e.toVertex;-1===n.Dg&&(e.forest=!0,cg(a,n))}b.finish=a.oh,a.oh++}function fg(a){for(var b=a.network.vertexes.iterator;b.next();){var t=dg(a,b.value);a.ra=Math.max(t,a.ra)}}function dg(a,b){var t=0;if(-1===b.layer){for(var e=b.destinationEdges;e.next();){var n=e.value,o=n.toVertex;n=a.linkMinLength(n),t=Math.max(t,dg(a,o)+n)}b.layer=t}else t=b.layer;return t}function pg(a,b){var t=0;if(-1===b.layer){for(var e=b.sourceEdges;e.next();){var n=e.value,o=n.fromVertex;n=a.linkMinLength(n),t=Math.max(t,pg(a,o)+n)}b.layer=t}else t=b.layer;return t}function gg(a,b){if(!b.valid){b.valid=!0;for(var t=b.destinationEdges;t.next();)gg(a,t.value.toVertex);for(t=a.network.vertexes.iterator;t.next();)t.value.component=-1;for(var e=b.sourceEdgesArrayAccess,n=e.length,o=0;o<n;o++){var g=e[o],r=g.fromVertex,h=g.toVertex;g=a.linkMinLength(g),r.layer-h.layer>g&&sg(a,r,0,-1,!0,!1)}for(sg(a,b,1,-1,!0,!0);0!==b.component;){for(o=0,e=1/0,r=0,h=null,g=a.network.vertexes.iterator;g.next();){var l=g.value;if(1===l.component){var c=0,f=!1,p=l.sourceEdgesArrayAccess;n=p.length;for(var d=0;d<n;d++){var q=p[d],u=q.fromVertex;c+=1,1!==u.component&&(o+=1,u=u.layer-l.layer,q=a.linkMinLength(q),e=Math.min(e,u-q))}for(n=(p=l.destinationEdgesArrayAccess).length,d=0;d<n;d++)--c,1!==(q=p[d].toVertex).component?--o:f=!0;(null===h||c<r)&&!f&&(h=l,r=c)}}if(0<o){for(t.reset();t.next();)1===(n=t.value).component&&(n.layer+=e);b.component=0}else h.component=0}for(t=a.network.vertexes.iterator;t.next();)t.value.component=-1;for(sg(a,b,1,-1,!0,!1);0!==b.component;){for(e=0,n=1/0,o=0,r=null,h=a.network.vertexes.iterator;h.next();)if(1===(g=h.value).component){for(l=0,c=!1,f=(p=g.sourceEdgesArrayAccess).length,d=0;d<f;d++)l+=1,1!==(q=p[d].fromVertex).component?e+=1:c=!0;for(f=(p=g.destinationEdgesArrayAccess).length,d=0;d<f;d++)--l,1!==(u=(q=p[d]).toVertex).component&&(--e,u=g.layer-u.layer,q=a.linkMinLength(q),n=Math.min(n,u-q));(null===r||l>o)&&!c&&(r=g,o=l)}if(0>e){for(t.reset();t.next();)1===(e=t.value).component&&(e.layer-=n);b.component=0}else r.component=0}}}function yg(a,b,t){return 90===a.K?t&&!b.rev||!t&&b.rev?270:90:180===a.K?t&&!b.rev||!t&&b.rev?0:180:270===a.K?t&&!b.rev||!t&&b.rev?90:270:t&&!b.rev||!t&&b.rev?180:0}function mg(a,b){var t=b.layer;for(b.index=a.Ab[t],a.Ab[t]++,b=b.destinationEdgesArrayAccess,t=!0;t;){t=!1;for(var e=0;e<b.length-1;e++){var n=b[e],o=b[e+1];n.portFromColOffset>o.portFromColOffset&&(t=!0,b[e]=o,b[e+1]=n)}}for(t=0;t<b.length;t++)(e=b[t]).valid&&(-1===(e=e.toVertex).index&&mg(a,e))}function vg(a,b){var t=b.layer;b.index=a.Ab[t],a.Ab[t]++,b=b.sourceEdgesArrayAccess;for(var e=!0;e;)for(e=!1,t=0;t<b.length-1;t++){var n=b[t],o=b[t+1];n.portToColOffset>o.portToColOffset&&(e=!0,b[t]=o,b[t+1]=n)}for(t=0;t<b.length;t++)(e=b[t]).valid&&(-1===(e=e.fromVertex).index&&vg(a,e))}function xg(a,b,t){var e=Tg(a,b),n=a.Ab[b],o=rg(a,b,t),g=og(a,b,t);for(t=0;t<n;t++)-1===g[t]&&(g[t]=e[t].column),-1===o[t]&&(o[t]=e[t].column);for(var r,h=!0;h;)for(h=!1,t=0;t<n-1;t++)(o[t+1]<o[t]||o[t+1]===o[t]&&g[t+1]<g[t])&&(h=!0,r=o[t],o[t]=o[t+1],o[t+1]=r,r=g[t],g[t]=g[t+1],g[t+1]=r,r=e[t],e[t]=e[t+1],e[t+1]=r);for(t=o=0;t<n;t++)(r=e[t]).index=t,o+=a.nodeMinColumnSpace(r,!0),r.column=o,o+=1,o+=a.nodeMinColumnSpace(r,!1);Lg(a,b,e)}function dt(a,b,t){var e,n=Tg(a,b),o=a.Ab[b];t=eg(a,b,t);var g=[];for(e=0;e<o;e++)g[e]=-1;var r=[];for(e=0;e<o;e++)r[e]=-1;for(var h=!1,l=!0;l;)for(l=!1,e=0;e<o-1;e++){var c=t[n[e].index*o+n[e+1].index],f=t[n[e+1].index*o+n[e].index],p=0,d=0,q=n[e].column,u=n[e+1].column,y=a.nodeMinColumnSpace(n[e],!0),m=a.nodeMinColumnSpace(n[e],!1),v=a.nodeMinColumnSpace(n[e+1],!0),x=a.nodeMinColumnSpace(n[e+1],!1);y=q-y+v,m=u-m+x;var w=n[e].sourceEdges.iterator;for(w.reset();w.next();)if(x=(v=w.value).fromVertex,v.valid&&x.layer===b){for(v=0;n[v]!==x;)v++;v<e&&(p+=2*(e-v),d+=2*(e+1-v)),v===e+1&&(p+=1),v>e+1&&(p+=4*(v-e),d+=4*(v-(e+1)))}for((w=n[e].destinationEdges.iterator).reset();w.next();)if(x=(v=w.value).toVertex,v.valid&&x.layer===b){for(v=0;n[v]!==x;)v++;v===e+1&&(d+=1)}for((w=n[e+1].sourceEdges.iterator).reset();w.next();)if(x=(v=w.value).fromVertex,v.valid&&x.layer===b){for(v=0;n[v]!==x;)v++;v<e&&(p+=2*(e+1-v),d+=2*(e-v)),v===e&&(d+=1),v>e+1&&(p+=4*(v-(e+1)),d+=4*(v-e))}for((w=n[e+1].destinationEdges.iterator).reset();w.next();)if(x=(v=w.value).toVertex,v.valid&&x.layer===b){for(v=0;n[v]!==x;)v++;v===e&&(p+=1)}v=x=0,w=g[n[e].index];var k=r[n[e].index],M=g[n[e+1].index],S=r[n[e+1].index];-1!==w&&(x+=Math.abs(w-q),v+=Math.abs(w-m)),-1!==k&&(x+=Math.abs(k-q),v+=Math.abs(k-m)),-1!==M&&(x+=Math.abs(M-u),v+=Math.abs(M-y)),-1!==S&&(x+=Math.abs(S-u),v+=Math.abs(S-y)),(d<p-.5||d===p&&f<c-.5||d===p&&f===c&&v<x-.5)&&(l=h=!0,n[e].column=m,n[e+1].column=y,c=n[e],n[e]=n[e+1],n[e+1]=c)}for(e=0;e<o;e++)n[e].index=e;return Lg(a,b,n),h}function bg(a,b,t){for(var e=!1;wg(a,b,t);)e=!0;return e}function wg(a,b,t){var e,n=Tg(a,b),o=a.Ab[b],g=og(a,b,-1);if(0<t)for(e=0;e<o;e++)g[e]=-1;var r=og(a,b,1);if(0>t)for(e=0;e<o;e++)r[e]=-1;for(var h=!1,l=!0;l;)for(l=!1,e=0;e<o;e++){var c=n[e].column,f=a.nodeMinColumnSpace(n[e],!0),p=a.nodeMinColumnSpace(n[e],!1),d=0;d=0>e-1||c-n[e-1].column-1>f+a.nodeMinColumnSpace(n[e-1],!1)?c-1:c,f=e+1>=o||n[e+1].column-c-1>p+a.nodeMinColumnSpace(n[e+1],!0)?c+1:c;var q=p=0,u=0;if(0>=t)for(var y=n[e].sourceEdges.iterator;y.next();){var m=y.value,v=m.fromVertex;if(m.valid&&v.layer!==b){var x=_p(m),w=m.portFromColOffset;m=m.portToColOffset,v=v.column,p+=(Math.abs(c+m-(v+w))+1)*x,q+=(Math.abs(d+m-(v+w))+1)*x,u+=(Math.abs(f+m-(v+w))+1)*x}}if(0<=t)for(y=n[e].destinationEdges.iterator;y.next();)v=(m=y.value).toVertex,m.valid&&v.layer!==b&&(x=_p(m),w=m.portFromColOffset,m=m.portToColOffset,v=v.column,p+=(Math.abs(c+w-(v+m))+1)*x,q+=(Math.abs(d+w-(v+m))+1)*x,u+=(Math.abs(f+w-(v+m))+1)*x);m=w=x=0,y=g[n[e].index],v=r[n[e].index],-1!==y&&(x+=Math.abs(y-c),w+=Math.abs(y-d),m+=Math.abs(y-f)),-1!==v&&(x+=Math.abs(v-c),w+=Math.abs(v-d),m+=Math.abs(v-f)),q<p||q===p&&w<x?(l=h=!0,n[e].column=d):(u<p||u===p&&m<x)&&(l=h=!0,n[e].column=f)}return Lg(a,b,n),a.normalize(),h}function kg(a,b,t){var e=Tg(a,b),n=a.Ab[b],o=rg(a,b,t),g=[];for(t=0;t<n;t++)g[t]=o[t];for(o=!0;o;)for(o=!1,t=0;t<n;t++){var r=e[t].column,h=a.nodeMinColumnSpace(e[t],!0),l=a.nodeMinColumnSpace(e[t],!1),c=0;if(-1===g[t])if(0===t&&t===n-1)c=r;else if(0===t){var f=e[t+1].column;c=f-r===l+a.nodeMinColumnSpace(e[t+1],!0)?r-1:r}else t===n-1?c=r-(f=e[t-1].column)===h+a.nodeMinColumnSpace(e[t-1],!1)?r+1:r:c=((h=(f=e[t-1].column)+a.nodeMinColumnSpace(e[t-1],!1)+h+1)+(l=(f=e[t+1].column)-a.nodeMinColumnSpace(e[t+1],!0)-l-1))/2|0;else 0===t&&t===n-1?c=g[t]:0===t?(l=(f=e[t+1].column)-a.nodeMinColumnSpace(e[t+1],!0)-l-1,c=Math.min(g[t],l)):t===n-1?(h=(f=e[t-1].column)+a.nodeMinColumnSpace(e[t-1],!1)+h+1,c=Math.max(g[t],h)):(h=(f=e[t-1].column)+a.nodeMinColumnSpace(e[t-1],!1)+h+1,l=(f=e[t+1].column)-a.nodeMinColumnSpace(e[t+1],!0)-l-1,h<g[t]&&g[t]<l?c=g[t]:h>=g[t]?c=h:l<=g[t]&&(c=l));c!==r&&(o=!0,e[t].column=c)}Lg(a,b,e),a.normalize()}function Mg(a,b){for(var t=!0,e=a.network.vertexes.iterator;e.next();){var n=e.value,o=a.nodeMinColumnSpace(n,!0),g=a.nodeMinColumnSpace(n,!1);if(n.column-o<=b&&n.column+g>=b){t=!1;break}}if(a=!1,t)for(e.reset();e.next();)(t=e.value).column>b&&(--t.column,a=!0);return a}function Sg(a,b){var t,e=b+1,n=[],o=[];for(t=0;t<=a.ra;t++)n[t]=!1,o[t]=!1;for(var g=a.network.vertexes.iterator;g.next();){var r=(t=g.value).column-a.nodeMinColumnSpace(t,!0),h=t.column+a.nodeMinColumnSpace(t,!1);r<=b&&h>=b&&(n[t.layer]=!0),r<=e&&h>=e&&(o[t.layer]=!0)}for(r=!0,e=!1,t=0;t<=a.ra;t++)r=r&&!(n[t]&&o[t]);if(r)for(g.reset();g.next();)(a=g.value).column>b&&(--a.column,e=!0);return e}function Pg(a,b){for(var t=0;t<=a.Ba;t++)for(;Mg(a,t););for(a.normalize(),t=0;t<a.Ba;t++)for(;Sg(a,t););var e;if(a.normalize(),0<b)for(t=0;t<=a.Ba;t++){var n=tg(a),o=ng(a);for(e=o+1;o<e;){e=o,Ng(a,t,1);var g=ng(a);g>o?ig(a,n):g<o&&(o=g,n=tg(a))}}if(0>b)for(t=a.Ba;0<=t;t--)for(n=tg(a),e=(o=ng(a))+1;o<e;)e=o,Ng(a,t,-1),(g=ng(a))>o?ig(a,n):g<o&&(o=g,n=tg(a));a.normalize()}function Ng(a,b,t){a.Fc=0;for(var e=a.network.vertexes.iterator;e.next();)e.value.component=-1;if(0<t)for(e.reset();e.next();){var n=e.value;n.column-a.nodeMinColumnSpace(n,!0)<=b&&(n.component=a.Fc)}if(0>t)for(e.reset();e.next();)(n=e.value).column+a.nodeMinColumnSpace(n,!1)>=b&&(n.component=a.Fc);for(a.Fc++,e.reset();e.next();)-1===(b=e.value).component&&(ag(a,b,a.Fc,-1,!0,!0),a.Fc++);var o;for(b=[],o=0;o<a.Fc*a.Fc;o++)b[o]=!1;for(n=[],o=0;o<(a.ra+1)*(a.Ba+1);o++)n[o]=-1;for(e.reset();e.next();)for(var g=(o=e.value).layer,r=Math.max(0,o.column-a.nodeMinColumnSpace(o,!0)),h=Math.min(a.Ba,o.column+a.nodeMinColumnSpace(o,!1));r<=h;r++)n[g*(a.Ba+1)+r]=o.component;for(o=0;o<=a.ra;o++){if(0<t)for(g=0;g<a.Ba;g++)-1!==n[o*(a.Ba+1)+g]&&-1!==n[o*(a.Ba+1)+g+1]&&n[o*(a.Ba+1)+g]!==n[o*(a.Ba+1)+g+1]&&(b[n[o*(a.Ba+1)+g]*a.Fc+n[o*(a.Ba+1)+g+1]]=!0);if(0>t)for(g=a.Ba;0<g;g--)-1!==n[o*(a.Ba+1)+g]&&-1!==n[o*(a.Ba+1)+g-1]&&n[o*(a.Ba+1)+g]!==n[o*(a.Ba+1)+g-1]&&(b[n[o*(a.Ba+1)+g]*a.Fc+n[o*(a.Ba+1)+g-1]]=!0)}for(n=[],o=0;o<a.Fc;o++)n[o]=!0;for((g=[]).push(0);0!==g.length;)if(h=g[g.length-1],g.pop(),n[h])for(n[h]=!1,o=0;o<a.Fc;o++)b[h*a.Fc+o]&&g.splice(0,0,o);if(0<t)for(e.reset();e.next();)n[(a=e.value).component]&&--a.column;if(0>t)for(e.reset();e.next();)n[(t=e.value).component]&&(t.column+=1)}function Cg(a,b){return 270===a.K?b?dd:Hi:90===a.K?b?Hi:dd:180===a.K?b?Ui:Ki:b?Ki:Ui}function Tg(a,b){var t=a.Ab[b];if(t>=a.ve.length){for(var e=[],n=0;n<a.ve.length;n++)e[n]=a.ve[n];a.ve=e}for(void 0===a.ve[t]||null===a.ve[t]?e=[]:(e=a.ve[t],a.ve[t]=null),a=a.$o[b],b=0;b<a.length;b++)e[(t=a[b]).index]=t;return e}function Lg(a,b,t){a.ve[a.Ab[b]]=t}hp.className="CircularLayout",hp.ConstantSpacing=bp,hp.ConstantDistance=wp,hp.ConstantAngle=kp,hp.Packed=Mp,hp.Clockwise=Sp,hp.Counterclockwise=Pp,hp.BidirectionalLeft=Np,hp.BidirectionalRight=Cp,hp.Forwards=Tp,hp.Reverse=Lp,hp.Ascending=Ap,hp.Descending=jp,hp.Optimized=Dp,hp.Pythagorean=Op,hp.Circular=Fp,Bp.prototype.compare=function(a,b){if(0<a&&0>this.ym||Math.abs(a)<Math.abs(this.ym)&&!(0>a&&0<this.ym))for(this.ym=a,this.Tk=[],this.$m=[],a=0;a<b.length;a++)this.Tk[a]=b[a].bounds.x,this.$m[a]=b[a].bounds.y},Bp.prototype.commit=function(a){if(null!==this.Tk&&null!==this.$m)for(var b=0;b<this.Tk.length;b++){var t=a.J(b);t.x=this.Tk[b],t.y=this.$m[b]}},Bp.className="VertexArrangement",m(Ip,Bf),Ip.prototype.createVertex=function(){return new Rp(this)},Ip.prototype.createEdge=function(){return new zp(this)},Ip.className="CircularNetwork",m(Rp,Vf),v.Object.defineProperties(Rp.prototype,{diameter:{get:function(){return this.Ej},set:function(a){this.Ej!==a&&(this.Ej=a)}},actualAngle:{get:function(){return this.I},set:function(a){this.I!==a&&(this.I=a)}}}),Rp.className="CircularVertex",m(zp,Yf),zp.className="CircularEdge",m(Vp,wf),Vp.prototype.cloneProtected=function(a){wf.prototype.cloneProtected.call(this,a),a.Nd.assign(this.Nd),a.ln=this.ln,a.kf=this.kf,a.ld=this.ld,a.Ql=this.Ql,a.Un=this.Un,a.Zf=this.Zf,a.Wo=this.Wo,a.vp=this.vp,a.ml=this.ml,a.ll=this.ll,a.jl=this.jl,a.kl=this.kl,a.Ln=this.Ln,a.Kn=this.Kn},Vp.prototype.serializeLayoutProperties=function(a,b){wf.prototype.serializeLayoutProperties.call(this,a,b),a.arrangementSpacing={width:this.arrangementSpacing.width,height:this.arrangementSpacing.height},a.arrangesToOrigin=this.arrangesToOrigin,a.setsPortSpots=this.setsPortSpots,a.comments=this.comments,a.maxIterations=this.maxIterations,a.epsilonDistance=this.epsilonDistance,a.infinityDistance=this.infinityDistance,a.moveLimit=this.moveLimit,a.defaultSpringStiffness=this.defaultSpringStiffness,a.defaultSpringLength=this.defaultSpringLength,a.defaultElectricalCharge=this.defaultElectricalCharge,a.defaultGravitationalMass=this.defaultGravitationalMass,a.defaultCommentSpringLength=this.defaultCommentSpringLength,a.defaultCommentElectricalCharge=this.defaultCommentElectricalCharge},Vp.prototype.deserializeLayoutProperties=function(a,b,t,e){wf.prototype.deserializeLayoutProperties.call(this,a,b,t,e),this.arrangementSpacing=new Ut(a.arrangementSpacing.width,a.arrangementSpacing.height),this.arrangesToOrigin=a.arrangesToOrigin,this.setsPortSpots=a.setsPortSpots,this.comments=a.comments,this.maxIterations=a.maxIterations,this.epsilonDistance=a.epsilonDistance,this.infinityDistance=a.infinityDistance,this.moveLimit=a.moveLimit,this.defaultSpringStiffness=a.defaultSpringStiffness,this.defaultSpringLength=a.defaultSpringLength,this.defaultElectricalCharge=a.defaultElectricalCharge,this.defaultGravitationalMass=a.defaultGravitationalMass,this.defaultCommentSpringLength=a.defaultCommentSpringLength,this.defaultCommentElectricalCharge=a.defaultCommentElectricalCharge},Vp.prototype.createNetwork=function(){return new Wp(this)},Vp.prototype.doLayout=function(a){if(null===this.network&&(this.network=this.makeNetwork(a)),!this.Uw()){if(a=this.maxIterations,0<this.network.vertexes.count){this.network.xq();for(var b=this.network.vertexes.iterator;b.next();){var t=b.value;t.charge=this.electricalCharge(t),t.mass=this.gravitationalMass(t)}for(b=this.network.edges.iterator;b.next();)(t=b.value).stiffness=this.springStiffness(t),t.length=this.springLength(t);if(this.Dv(),this.yo=0,this.needsClusterLayout()){for(var e=(t=(b=this.network).Zy()).iterator;e.next();){this.network=e.value;for(var n=this.network.vertexes.iterator;n.next();){var o=n.value;o.Jd=o.vertexes.count,o.Rh=1,o.nk=null,o.Me=null}Gp(this,0,a)}this.network=b;var g=e=t.iterator;e=this.arrangementSpacing;var r=g.count,h=!0;o=n=0;for(var l=I(),c=0;c<r+b.vertexes.count+2;c++)l[c]=null;r=0,g.reset();for(var f=Jt.alloc();g.next();)if(c=g.value,this.computeBounds(c,f),h)h=!1,n=f.x+f.width/2,o=f.y+f.height/2,l[0]=new St(f.x+f.width+e.width,f.y),l[1]=new St(f.x,f.y+f.height+e.height),r=2;else{var p=Xp(l,r,n,o,f.width,f.height,e),d=l[p],q=new St(d.x+f.width+e.width,d.y),u=new St(d.x,d.y+f.height+e.height);for(p+1<r&&l.splice(p+1,0,null),l[p]=q,l[p+1]=u,r++,p=d.x-f.x,d=d.y-f.y,c=c.vertexes.iterator;c.next();)(q=c.value).centerX+=p,q.centerY+=d}for(Jt.free(f),c=b.vertexes.iterator;c.next();)p=(g=c.value).bounds,2>r?(n=p.x+p.width/2,o=p.y+p.height/2,l[0]=new St(p.x+p.width+e.width,p.y),l[1]=new St(p.x,p.y+p.height+e.height),r=2):(d=new St((f=l[h=Xp(l,r,n,o,p.width,p.height,e)]).x+p.width+e.width,f.y),p=new St(f.x,f.y+p.height+e.height),h+1<r&&l.splice(h+1,0,null),l[h]=d,l[h+1]=p,r++,g.centerX=f.x+g.width/2,g.centerY=f.y+g.height/2);for(R(l),e=t.iterator;e.next();){for(n=(t=e.value).vertexes.iterator;n.next();)b.Cg(n.value);for(t=t.edges.iterator;t.next();)b.qm(t.value)}}Up(this,a),this.updateParts()}this.Ql=a,this.network=null,this.isValidLayout=!0}},Vp.prototype.needsClusterLayout=function(){if(3>this.network.vertexes.count)return!1;for(var a=0,b=0,t=this.network.vertexes.first().bounds,e=this.network.vertexes.iterator;e.next();){if(e.value.bounds.Nc(t)&&2<++a)return!0;if(10<b)break;b++}return!1},Vp.prototype.computeBounds=function(a,b){var t=!0;for(a=a.vertexes.iterator;a.next();){var e=a.value;t?(t=!1,b.set(e.bounds)):b.Tc(e.bounds)}return b},Vp.prototype.Dv=function(){if(this.comments)for(var a=this.network.vertexes.iterator;a.next();)this.addComments(a.value)},Vp.prototype.addComments=function(a){var b=a.node;if(null!==b)for(b=b.Qv();b.next();){var t=b.value;if("Comment"===t.category&&t.isVisible()){var e=this.network.jj(t);null===e&&(e=this.network.kk(t)),e.charge=this.defaultCommentElectricalCharge,t=null;for(var n=e.destinationEdges;n.next();){var o=n.value;if(o.toVertex===a){t=o;break}}if(null===t)for(n=e.sourceEdges;n.next();)if((o=n.value).fromVertex===a){t=o;break}null===t&&(t=this.network.Bk(a,e,null)),t.length=this.defaultCommentSpringLength}}},Vp.prototype.moveVertex=function(a){var b=a.forceX,t=a.forceY,e=this.moveLimit;return b<-e?b=-e:b>e&&(b=e),t<-e?t=-e:t>e&&(t=e),a.centerX+=b,a.centerY+=t,b*b+t*t},Vp.prototype.moveFixedVertex=function(){},Vp.prototype.commitLayout=function(){this.Dw(),this.commitNodes(),this.isRouting&&this.commitLinks()},Vp.prototype.Dw=function(){if(this.setsPortSpots)for(var a=this.network.edges.iterator;a.next();){var b=a.value.link;null!==b&&(b.fromSpot=Vi,b.toSpot=Vi)}},Vp.prototype.commitNodes=function(){var a=0,b=0;if(this.arrangesToOrigin){var t=Jt.alloc();this.computeBounds(this.network,t),a=(b=this.arrangementOrigin).x-t.x,b=b.y-t.y,Jt.free(t)}t=Jt.alloc();for(var e=this.network.vertexes.iterator;e.next();){var n=e.value;0===a&&0===b||(t.assign(n.bounds),t.x+=a,t.y+=b,n.bounds=t),n.commit()}Jt.free(t)},Vp.prototype.commitLinks=function(){for(var a=this.network.edges.iterator;a.next();)a.value.commit()},Vp.prototype.springStiffness=function(a){return a=a.stiffness,isNaN(a)?this.ml:a},Vp.prototype.springLength=function(a){return a=a.length,isNaN(a)?this.ll:a},Vp.prototype.electricalCharge=function(a){return a=a.charge,isNaN(a)?this.jl:a},Vp.prototype.electricalFieldX=function(){return 0},Vp.prototype.electricalFieldY=function(){return 0},Vp.prototype.gravitationalMass=function(a){return a=a.mass,isNaN(a)?this.kl:a},Vp.prototype.gravitationalFieldX=function(){return 0},Vp.prototype.gravitationalFieldY=function(){return 0},Vp.prototype.isFixed=function(a){return a.isFixed},v.Object.defineProperties(Vp.prototype,{currentIteration:{get:function(){return this.yo}},arrangementSpacing:{get:function(){return this.Nd},set:function(a){this.Nd.w(a)||(this.Nd.assign(a),this.C())}},arrangesToOrigin:{get:function(){return this.ln},set:function(a){this.ln!==a&&(this.ln=a,this.C())}},setsPortSpots:{get:function(){return this.kf},set:function(a){this.kf!==a&&(this.kf=a,this.C())}},comments:{get:function(){return this.ld},set:function(a){this.ld!==a&&(this.ld=a,this.C())}},maxIterations:{get:function(){return this.Ql},set:function(a){this.Ql!==a&&0<=a&&(this.Ql=a,this.C())}},epsilonDistance:{get:function(){return this.Un},set:function(a){this.Un!==a&&0<a&&(this.Un=a,this.C())}},infinityDistance:{get:function(){return this.Zf},set:function(a){this.Zf!==a&&1<a&&(this.Zf=a,this.C())}},moveLimit:{get:function(){return this.Wo},set:function(a){this.Wo!==a&&1<a&&(this.Wo=a,this.C())}},randomNumberGenerator:{get:function(){return this.vp},set:function(a){this.vp!==a&&(null!==a&&"function"!=typeof a.random&&N('ForceDirectedLayout.randomNumberGenerator must have a "random()" function on it: '+a),this.vp=a)}},defaultSpringStiffness:{get:function(){return this.ml},set:function(a){this.ml!==a&&(this.ml=a,this.C())}},defaultSpringLength:{get:function(){return this.ll},set:function(a){this.ll!==a&&(this.ll=a,this.C())}},defaultElectricalCharge:{get:function(){return this.jl},set:function(a){this.jl!==a&&(this.jl=a,this.C())}},defaultGravitationalMass:{get:function(){return this.kl},set:function(a){this.kl!==a&&(this.kl=a,this.C())}},defaultCommentSpringLength:{get:function(){return this.Ln},set:function(a){this.Ln!==a&&(this.Ln=a,this.C())}},defaultCommentElectricalCharge:{get:function(){return this.Kn},set:function(a){this.Kn!==a&&(this.Kn=a,this.C())}}}),Vp.className="ForceDirectedLayout",Hp.className="ForceDirectedSubnet",m(Wp,Bf),Wp.prototype.createVertex=function(){return new Jp(this)},Wp.prototype.createEdge=function(){return new Zp(this)},Wp.className="ForceDirectedNetwork",m(Jp,Vf),Jp.prototype.serializeVertexProperties=function(a,b){Vf.prototype.serializeVertexProperties.call(this,a,b),a.isFixed=this.isFixed,a.charge=this.charge,a.mass=this.mass},Jp.prototype.yq=function(a,b,t,e){Vf.prototype.yq.call(this,a,b,t,e),this.isFixed=a.isFixed,this.charge=a.charge,this.mass=a.mass},v.Object.defineProperties(Jp.prototype,{isFixed:{get:function(){return this.Ka},set:function(a){this.Ka!==a&&(this.Ka=a)}},charge:{get:function(){return this.I},set:function(a){this.I!==a&&(this.I=a)}},mass:{get:function(){return this.eb},set:function(a){this.eb!==a&&(this.eb=a)}},forceX:{get:function(){return this.T},set:function(a){this.T!==a&&(this.T=a)}},forceY:{get:function(){return this.Ja},set:function(a){this.Ja!==a&&(this.Ja=a)}}}),Jp.className="ForceDirectedVertex",m(Zp,Yf),Zp.prototype.serializeEdgeProperties=function(a,b){Yf.prototype.serializeEdgeProperties.call(this,a,b),a.stiffness=this.stiffness,a.length=this.length},Zp.prototype.deserializeEdgeProperties=function(a,b,t,e){Yf.prototype.deserializeEdgeProperties.call(this,a,b,t,e),this.stiffness=a.stiffness,this.length=a.length},v.Object.defineProperties(Zp.prototype,{stiffness:{get:function(){return this.v},set:function(a){this.v!==a&&(this.v=a)}},length:{get:function(){return this.l},set:function(a){this.l!==a&&(this.l=a)}}}),Zp.className="ForceDirectedEdge",$p.prototype.random=function(){var a=this.seed%this.Q*this.az-this.seed/this.Q*this.dz;return this.seed=0<a?a:a+this.cz,this.seed*this.bz},$p.className="RandomNumberGenerator",m(Qp,wf),Qp.prototype.cloneProtected=function(a){wf.prototype.cloneProtected.call(this,a),a.se=this.se,a.Zb=this.Zb,a.K=this.K,a.hl=this.hl,a.Ll=this.Ll,a.Al=this.Al,a.Pj=this.Pj,a.Xk=this.Xk,a.pg=this.pg,a.kf=this.kf,a.Go=this.Go},Qp.prototype.serializeLayoutProperties=function(a,b){wf.prototype.serializeLayoutProperties.call(this,a,b),a.layerSpacing=this.layerSpacing,a.columnSpacing=this.columnSpacing,a.direction=this.direction,a.cycleRemoveOption=this.cycleRemoveOption.name,a.layeringOption=this.layeringOption.name,a.initializeOption=this.initializeOption.name,a.iterations=this.iterations,a.aggressiveOption=this.aggressiveOption.name,a.packOption=this.packOption,a.setsPortSpots=this.setsPortSpots,a.linkSpacing=this.linkSpacing,a.ra=this.ra,a.Hi=this.Hi,a.Ba=this.Ba,a.mh=this.mh,a.pc=this.pc,a.Ab=this.Ab,a.oh=this.oh,a.Fc=this.Fc,a.Xc={x:this.Xc.x,y:this.Xc.y}},Qp.prototype.deserializeLayoutProperties=function(a,b,t,e){wf.prototype.deserializeLayoutProperties.call(this,a,b,t,e),this.layerSpacing=a.layerSpacing,this.columnSpacing=a.columnSpacing,this.direction=a.direction,this.cycleRemoveOption=tt(Qp,a.cycleRemoveOption),this.layeringOption=tt(Qp,a.layeringOption),this.initializeOption=tt(Qp,a.initializeOption),this.iterations=a.iterations,this.aggressiveOption=tt(Qp,a.aggressiveOption),this.packOption=a.packOption,this.setsPortSpots=a.setsPortSpots,this.linkSpacing=a.linkSpacing,this.ra=a.ra,this.Hi=a.Hi,this.Ba=a.Ba,this.mh=a.mh,this.pc=a.pc,this.Ab=a.Ab,this.oh=a.oh,this.Fc=a.Fc,this.Xc=new St(this.Xc.x,this.Xc.y)},Qp.prototype.jb=function(a){a.classType===Qp?0===a.name.indexOf("Aggressive")?this.aggressiveOption=a:0===a.name.indexOf("Cycle")?this.cycleRemoveOption=a:0===a.name.indexOf("Init")?this.initializeOption=a:0===a.name.indexOf("Layer")?this.layeringOption=a:N("Unknown enum value: "+a):wf.prototype.jb.call(this,a)},Qp.prototype.createNetwork=function(){return new Xg(this)},Qp.prototype.doLayout=function(a){for(null===this.network&&(this.network=this.makeNetwork(a)),this.arrangementOrigin=this.initialOrigin(this.arrangementOrigin),this.Hi=-1,this.pc=this.mh=0,this.$o=this.Zo=this.Uj=null,a=0;a<this.ve.length;a++)this.ve[a]=null;if(0<this.network.vertexes.count){if(this.network.xq(),this.Uw())return;for(this.cycleRemoveOption!==Dg&&this.removeCycles(),a=this.network.vertexes.iterator;a.next();)a.value.layer=-1;for(this.ra=-1,this.assignLayers(),a.reset();a.next();)this.ra=Math.max(this.ra,a.value.layer);this.cycleRemoveOption===Dg&&this.removeCycles();for(var b=[],t=(a=this.network).edges.iterator;t.next();){var e=t.value;e.valid=!1,b.push(e)}for(t=0;t<b.length;t++){var n=(e=b[t]).fromVertex,o=e.toVertex;if(!(e.valid||(null===n.node&&null===n.data||null===o.node&&null===o.data)&&n.layer===o.layer)){var g=0,r=0,h=0,l=0;if(null!==e.link){if(null===(r=e.link))continue;var c=n.node;if(g=o.node,null===c||null===g)continue;var f=r.fromNode;h=r.toNode;var p=r.fromPort;if(r=r.toPort,e.rev){l=f;var d=p;f=h,p=r,h=l,r=d}var q=n.focus;l=o.focus;var u=e.rev?o.bounds:n.bounds;d=St.alloc(),c!==f?u.u()&&f.isVisible()?f.actualBounds.u()?(f.Ff(p,bi,d),d.x+=f.actualBounds.x-u.x,d.y+=f.actualBounds.y-u.y):(f.Ff(p,bi,d),d.u()||d.assign(q)):d.assign(q):u.u()?(f.Ff(p,bi,d),d.u()||d.assign(q)):d.assign(q),f=e.rev?n.bounds:o.bounds,c=St.alloc(),g!==h?f.u()&&h.isVisible()?h.actualBounds.u()?(h.Ff(r,bi,c),c.x+=h.actualBounds.x-f.x,c.y+=h.actualBounds.y-f.y):(h.Ff(r,bi,c),c.u()||c.assign(l)):c.assign(l):f.u()?(h.Ff(r,bi,c),c.u()||c.assign(l)):c.assign(l),90===this.K||270===this.K?(g=Math.round((d.x-q.x)/this.Zb),h=d.x,r=Math.round((c.x-l.x)/this.Zb),l=c.x):(g=Math.round((d.y-q.y)/this.Zb),h=d.y,r=Math.round((c.y-l.y)/this.Zb),l=c.y),St.free(d),St.free(c),e.portFromColOffset=g,e.portFromPos=h,e.portToColOffset=r,e.portToPos=l}else e.portFromColOffset=0,e.portFromPos=0,e.portToColOffset=0,e.portToPos=0;if(d=n.layer,c=o.layer,f=0,null!==(u=e.link)){var y=u.fromPort,m=u.toPort;if(null!==y&&null!==m){var v=u.fromNode;if(p=u.toNode,null!==v&&null!==p){var x=Cg(this,!0),w=Cg(this,!1),k=this.setsPortSpots?x:u.computeSpot(!0,y);q=this.setsPortSpots?w:u.computeSpot(!1,m);var M=u.isOrthogonal;k.Pc()&&k.Gf(w)&&q.Pc()&&q.Gf(x)?f=0:(x=u.getLinkPoint(v,y,k,!0,M,p,m,St.alloc()),w=u.getLinkDirection(v,y,x,k,!0,M,p,m),St.free(x),k.Ut()||w!==yg(this,e,!0)?this.setsPortSpots&&null!==v&&1===v.ports.count&&e.rev&&(f+=1):f+=1,k=u.getLinkPoint(p,m,q,!1,M,v,y,St.alloc()),u=u.getLinkDirection(p,m,k,q,!1,M,v,y),St.free(k),q.Ut()||u!==yg(this,e,!1)?this.setsPortSpots&&null!==p&&1===p.ports.count&&e.rev&&(f+=2):f+=2)}}}if(f=1===(p=f)||3===p,(p=2===p||3===p)&&((q=a.createVertex()).node=null,q.yf=1,q.layer=d,q.near=n,a.Cg(q),(n=a.Bk(n,q,e.link)).valid=!1,n.rev=e.rev,n.portFromColOffset=g,n.portToColOffset=0,n.portFromPos=h,n.portToPos=0,n=q),u=1,f&&u--,d-c>u&&0<d){for(e.valid=!1,(q=a.createVertex()).node=null,q.yf=2,q.layer=d-1,a.Cg(q),(n=a.Bk(n,q,e.link)).valid=!0,n.rev=e.rev,n.portFromColOffset=p?0:g,n.portToColOffset=0,n.portFromPos=p?0:h,n.portToPos=0,n=q,d--;d-c>u&&0<d;)(q=a.createVertex()).node=null,q.yf=3,q.layer=d-1,a.Cg(q),(n=a.Bk(n,q,e.link)).valid=!0,n.rev=e.rev,n.portFromColOffset=0,n.portToColOffset=0,n.portFromPos=0,n.portToPos=0,n=q,d--;(n=a.Bk(q,o,e.link)).valid=!f,f&&(q.near=o),n.rev=e.rev,n.portFromColOffset=0,n.portToColOffset=r,n.portFromPos=0,n.portToPos=l}else e.valid=!0}}for(a=this.Ab=[],b=0;b<=this.ra;b++)a[b]=0;for(b=this.network.vertexes.iterator;b.next();)b.value.index=-1;for(this.initializeIndices(),this.Hi=-1,t=this.pc=this.mh=0;t<=this.ra;t++)a[t]>a[this.pc]&&(this.Hi=a[t]-1,this.pc=t),a[t]<a[this.mh]&&(this.mh=t);for(this.$o=[],t=0;t<a.length;t++)this.$o[t]=[];for(b.reset();b.next();)a=b.value,this.$o[a.layer][a.index]=a;for(this.Ba=-1,a=0;a<=this.ra;a++){for(b=Tg(this,a),t=0,e=this.Ab[a],o=0;o<e;o++)n=b[o],t+=this.nodeMinColumnSpace(n,!0),n.column=t,t+=1,t+=this.nodeMinColumnSpace(n,!1);this.Ba=Math.max(this.Ba,t-1),Lg(this,a,b)}this.reduceCrossings(),this.straightenAndPack(),this.updateParts()}this.network=null,this.isValidLayout=!0},Qp.prototype.linkMinLength=function(){return 1},Qp.prototype.nodeMinLayerSpace=function(a,b){return null===a.node&&null===a.data?0:90===this.K||270===this.K?b?a.focus.y+10:a.bounds.height-a.focus.y+10:b?a.focus.x+10:a.bounds.width-a.focus.x+10},Qp.prototype.nodeMinColumnSpace=function(a,b){if(null===a.node&&null===a.data)return 0;var t=b?a.Jk:a.Ik;return null!==t?t:90===(t=this.K)||270===t?b?a.Jk=a.focus.x/this.Zb+1|0:a.Ik=(a.bounds.width-a.focus.x)/this.Zb+1|0:b?a.Jk=a.focus.y/this.Zb+1|0:a.Ik=(a.bounds.height-a.focus.y)/this.Zb+1|0},Qp.prototype.countCrossings=function(){for(var a=0,b=0;b<=this.ra;b++)for(var t=eg(this,b,1),e=this.Ab[b],n=0;n<e;n++)for(var o=n;o<e;o++)a+=t[n*e+o];return a},Qp.prototype.normalize=function(){var a=1/0;this.Ba=-1;for(var b=this.network.vertexes.iterator;b.next();){var t=b.value;a=Math.min(a,t.column-this.nodeMinColumnSpace(t,!0)),this.Ba=Math.max(this.Ba,t.column+this.nodeMinColumnSpace(t,!1))}for(b.reset();b.next();)b.value.column-=a;this.Ba-=a},Qp.prototype.removeCycles=function(){for(var a=this.network.edges.iterator;a.next();)a.value.rev=!1;switch(this.hl){default:case jg:var b=0,t=(a=this.network).vertexes.count-1,e=[];e.length=t+1;for(var n=a.vertexes.iterator;n.next();)n.value.valid=!0;for(;null!==hg(a);){for(n=lg(a);null!==n;)e[t]=n,t--,n.valid=!1,n=lg(a);for(n=ug(a);null!==n;)e[b]=n,b++,n.valid=!1,n=ug(a);n=null;for(var o=0,g=this.network.vertexes.iterator;g.next();){var r=g.value;if(r.valid){for(var h=0,l=r.destinationEdges;l.next();)l.value.toVertex.valid&&h++;l=0;for(var c=r.sourceEdges;c.next();)c.value.fromVertex.valid&&l++;(null===n||o<h-l)&&(n=r,o=h-l)}}null!==n&&(e[b]=n,b++,n.valid=!1)}for(b=0;b<a.vertexes.count;b++)e[b].index=b;for(e=a.edges.iterator;e.next();)(b=e.value).fromVertex.index>b.toVertex.index&&(a.Pm(b),b.rev=!0);break;case Ag:for(e=this.network.vertexes.iterator;e.next();)(a=e.value).Dg=-1,a.finish=-1;for(a=this.network.edges.iterator;a.next();)a.value.forest=!1;for(this.oh=0,e.reset();e.next();)0===(b=e.value).sourceEdges.count&&cg(this,b);for(e.reset();e.next();)-1===(b=e.value).Dg&&cg(this,b);for(a.reset();a.next();)(e=a.value).forest||(t=(b=e.fromVertex).finish,o=(n=e.toVertex).finish,n.Dg<b.Dg&&t<o&&(this.network.Pm(e),e.rev=!0));break;case Dg:for(b=(a=this.network).vertexes.iterator,e=1/0;b.next();)e=Math.min(e,b.value.layer);if(1/0>e){if(0>e)for(b.reset();b.next();)b.value.layer-=e;for(e=[],b.reset();b.next();)void 0===(n=e[(t=b.value).layer])?e[t.layer]=[t]:n.push(t);for(t=b=0;t<e.length;t++)if((n=e[t])&&0!==n.length){if(0<t)for(o=0;o<n.length;o++)n[o].layer-=b}else b++;for(e=a.edges.iterator;e.next();)(b=e.value).fromVertex.layer<b.toVertex.layer&&(a.Pm(b),b.rev=!0)}}},Qp.prototype.assignLayers=function(){switch(this.Ll){case Fg:fg(this);break;case Bg:for(var a,b=this.network.vertexes.iterator;b.next();)a=pg(this,b.value),this.ra=Math.max(a,this.ra);for(b.reset();b.next();)(a=b.value).layer=this.ra-a.layer;break;default:case Og:for(fg(this),b=this.network.vertexes.iterator;b.next();)b.value.valid=!1;for(b.reset();b.next();)0===(a=b.value).sourceEdges.count&&gg(this,a);for(a=1/0,b.reset();b.next();)a=Math.min(a,b.value.layer);for(this.ra=-1,b.reset();b.next();){var t=b.value;t.layer-=a,this.ra=Math.max(this.ra,t.layer)}}},Qp.prototype.initializeIndices=function(){switch(this.Al){default:case Eg:for(var a=this.network.vertexes.iterator;a.next();){var b=a.value,t=b.layer;b.index=this.Ab[t],this.Ab[t]++}break;case Ig:for(a=this.network.vertexes.iterator,b=this.ra;0<=b;b--)for(a.reset();a.next();)(t=a.value).layer===b&&-1===t.index&&mg(this,t);break;case Rg:for(a=this.network.vertexes.iterator,b=0;b<=this.ra;b++)for(a.reset();a.next();)(t=a.value).layer===b&&-1===t.index&&vg(this,t)}},Qp.prototype.reduceCrossings=function(){var t,e,n,g,o,a=this.countCrossings(),b=tg(this);for(t=0;t<this.Pj;t++){for(e=0;e<=this.ra;e++)xg(this,e,1),dt(this,e,1);var r=this.countCrossings();for(r<a&&(a=r,b=tg(this)),e=this.ra;0<=e;e--)xg(this,e,-1),dt(this,e,-1);(r=this.countCrossings())<a&&(a=r,b=tg(this))}for(ig(this,b),t=0;t<this.Pj;t++){for(e=0;e<=this.ra;e++)xg(this,e,0),dt(this,e,0);for((r=this.countCrossings())<a&&(a=r,b=tg(this)),e=this.ra;0<=e;e--)xg(this,e,0),dt(this,e,0);(r=this.countCrossings())<a&&(a=r,b=tg(this))}switch(ig(this,b),this.Xk){case zg:break;case Gg:for(o=a+1;(e=this.countCrossings())<o;)for(o=e,t=this.ra;0<=t;t--)for(g=0;g<=t;g++){for(n=!0;n;)for(n=!1,e=t;e>=g;e--)n=dt(this,e,-1)||n;for((r=this.countCrossings())>=a?ig(this,b):(a=r,b=tg(this)),n=!0;n;)for(n=!1,e=t;e>=g;e--)n=dt(this,e,1)||n;for((r=this.countCrossings())>=a?ig(this,b):(a=r,b=tg(this)),n=!0;n;)for(n=!1,e=g;e<=t;e++)n=dt(this,e,1)||n;for(r>=a?ig(this,b):(a=r,b=tg(this)),n=!0;n;)for(n=!1,e=g;e<=t;e++)n=dt(this,e,-1)||n;for(r>=a?ig(this,b):(a=r,b=tg(this)),n=!0;n;)for(n=!1,e=t;e>=g;e--)n=dt(this,e,0)||n;for(r>=a?ig(this,b):(a=r,b=tg(this)),n=!0;n;)for(n=!1,e=g;e<=t;e++)n=dt(this,e,0)||n;r>=a?ig(this,b):(a=r,b=tg(this))}break;default:case Vg:for(t=this.ra,g=0,o=a+1;(e=this.countCrossings())<o;){for(o=e,n=!0;n;)for(n=!1,e=t;e>=g;e--)n=dt(this,e,-1)||n;for((r=this.countCrossings())>=a?ig(this,b):(a=r,b=tg(this)),n=!0;n;)for(n=!1,e=t;e>=g;e--)n=dt(this,e,1)||n;for((r=this.countCrossings())>=a?ig(this,b):(a=r,b=tg(this)),n=!0;n;)for(n=!1,e=g;e<=t;e++)n=dt(this,e,1)||n;for(r>=a?ig(this,b):(a=r,b=tg(this)),n=!0;n;)for(n=!1,e=g;e<=t;e++)n=dt(this,e,-1)||n;for(r>=a?ig(this,b):(a=r,b=tg(this)),n=!0;n;)for(n=!1,e=t;e>=g;e--)n=dt(this,e,0)||n;for(r>=a?ig(this,b):(a=r,b=tg(this)),n=!0;n;)for(n=!1,e=g;e<=t;e++)n=dt(this,e,0)||n;r>=a?ig(this,b):(a=r,b=tg(this))}}ig(this,b)},Qp.prototype.straightenAndPack=function(){var a=0!=(1&this.pg),b=7===this.pg;if(1e3<this.network.edges.count&&!b&&(a=!1),a){var t=[];for(b=0;b<=this.ra;b++)t[b]=0;for(var e,n=this.network.vertexes.iterator;n.next();){var o=n.value;b=o.layer,e=o.column,o=this.nodeMinColumnSpace(o,!1),t[b]=Math.max(t[b],e+o)}for(n.reset();n.next();)b=(o=n.value).layer,e=o.column,o.column=(8*(this.Ba-t[b])>>1)+8*e;this.Ba*=8}if(0!=(2&this.pg))for(t=!0;t;){for(t=!1,b=this.pc+1;b<=this.ra;b++)t=bg(this,b,1)||t;for(b=this.pc-1;0<=b;b--)t=bg(this,b,-1)||t;t=bg(this,this.pc,0)||t}if(0!=(4&this.pg)){for(b=this.pc+1;b<=this.ra;b++)kg(this,b,1);for(b=this.pc-1;0<=b;b--)kg(this,b,-1);kg(this,this.pc,0)}if(a&&(Pg(this,-1),Pg(this,1)),0!=(2&this.pg))for(t=!0;t;){for(t=!1,t=bg(this,this.pc,0)||t,b=this.pc+1;b<=this.ra;b++)t=bg(this,b,0)||t;for(b=this.pc-1;0<=b;b--)t=bg(this,b,0)||t}},Qp.prototype.commitLayout=function(){if(this.setsPortSpots)for(var a=Cg(this,!0),b=Cg(this,!1),t=this.network.edges.iterator;t.next();){var e=t.value.link;null!==e&&(e.fromSpot=a,e.toSpot=b)}this.commitNodes(),this.Gv(),this.isRouting&&this.commitLinks()},Qp.prototype.commitNodes=function(){this.Xd=[],this.yd=[],this.xd=[],this.Ia=[];for(var a=0;a<=this.ra;a++)this.Xd[a]=0,this.yd[a]=0,this.xd[a]=0,this.Ia[a]=0;for(a=this.network.vertexes.iterator;a.next();){var b=a.value,t=b.layer;this.Xd[t]=Math.max(this.Xd[t],this.nodeMinLayerSpace(b,!0)),this.yd[t]=Math.max(this.yd[t],this.nodeMinLayerSpace(b,!1))}b=0,t=this.se;for(var e=0;e<=this.ra;e++){var n=t;0>=this.Xd[e]+this.yd[e]&&(n=0),0<e&&(b+=n/2),90===this.K||0===this.K?(b+=this.yd[e],this.xd[e]=b,b+=this.Xd[e]):(b+=this.Xd[e],this.xd[e]=b,b+=this.yd[e]),e<this.ra&&(b+=n/2),this.Ia[e]=b}for(t=b,b=this.arrangementOrigin,e=0;e<=this.ra;e++)270===this.K?this.xd[e]=b.y+this.xd[e]:90===this.K?(this.xd[e]=b.y+t-this.xd[e],this.Ia[e]=t-this.Ia[e]):180===this.K?this.xd[e]=b.x+this.xd[e]:(this.xd[e]=b.x+t-this.xd[e],this.Ia[e]=t-this.Ia[e]);for(a.reset(),t=e=1/0;a.next();){var o=(n=a.value).layer,g=0|n.column;if(270===this.K||90===this.K){var r=b.x+this.Zb*g;o=this.xd[o]}else r=this.xd[o],o=b.y+this.Zb*g;n.centerX=r,n.centerY=o,e=Math.min(n.x,e),t=Math.min(n.y,t)}for(e=b.x-e,b=b.y-t,this.Xc=new St(e,b),a.reset();a.next();)(t=a.value).x+=e,t.y+=b,t.commit()},Qp.prototype.Gv=function(){for(var a=0,b=this.se,t=0;t<=this.ra;t++)a+=this.Xd[t],a+=this.yd[t];a+=this.ra*b,b=[],t=this.Zb*this.Ba;for(var e=this.maxLayer;0<=e;e--)270===this.K?0===e?b.push(new Jt(0,0,t,Math.abs(this.Ia[0]))):b.push(new Jt(0,this.Ia[e-1],t,Math.abs(this.Ia[e-1]-this.Ia[e]))):90===this.K?0===e?b.push(new Jt(0,this.Ia[0],t,Math.abs(this.Ia[0]-a))):b.push(new Jt(0,this.Ia[e],t,Math.abs(this.Ia[e-1]-this.Ia[e]))):180===this.K?0===e?b.push(new Jt(0,0,Math.abs(this.Ia[0]),t)):b.push(new Jt(this.Ia[e-1],0,Math.abs(this.Ia[e-1]-this.Ia[e]),t)):0===e?b.push(new Jt(this.Ia[0],0,Math.abs(this.Ia[0]-a),t)):b.push(new Jt(this.Ia[e],0,Math.abs(this.Ia[e-1]-this.Ia[e]),t));this.commitLayers(b,this.Xc)},Qp.prototype.commitLayers=function(){},Qp.prototype.commitLinks=function(){for(var b,a=this.network.edges.iterator;a.next();)null!==(b=a.value.link)&&(b.Sh(),b.mk(),b.zf());for(a.reset();a.next();)null!==(b=a.value.link)&&b.wj();for(a.reset();a.next();){var t=a.value;if(null!==(b=t.link)){b.Sh();var e=b,n=e.fromNode,o=e.toNode,g=e.fromPort,r=e.toPort;if(null!==n){var h=n.findVisibleNode();null!==h&&h!==n&&(n=h,g=h.port)}null!==o&&(null!==(h=o.findVisibleNode())&&h!==o&&(o=h,r=h.port));var l=b.computeSpot(!0,g);h=b.computeSpot(!1,r);var c=t.fromVertex,f=t.toVertex;if(t.valid){if(b.curve===Rc&&4===b.pointsCount)if(c.column===f.column)t=b.getLinkPoint(n,g,l,!0,!1,o,r),g=b.getLinkPoint(o,r,h,!1,!1,n,g),t.u()||t.set(n.actualBounds.center),g.u()||g.set(o.actualBounds.center),b.mk(),b.xf(t.x,t.y),b.xf((2*t.x+g.x)/3,(2*t.y+g.y)/3),b.xf((t.x+2*g.x)/3,(t.y+2*g.y)/3),b.xf(g.x,g.y);else{var p=!1,d=!1;if(null!==g&&l===gi&&(p=!0),null!==r&&h===gi&&(d=!0),p||d){var q=b.i(0).x;t=b.i(0).y,c=b.i(3).x,e=b.i(3).y,p&&(90===this.K||270===this.K?(p=q,f=(t+e)/2):(p=(q+c)/2,f=t),b.L(1,p,f),(l=b.getLinkPoint(n,g,l,!0,!1,o,r)).u()||l.set(n.actualBounds.center),b.L(0,l.x,l.y)),d&&(90===this.K||270===this.K?(l=c,t=(t+e)/2):(l=(q+c)/2,t=e),b.L(2,l,t),(n=b.getLinkPoint(o,r,h,!1,!1,n,g)).u()||n.set(o.actualBounds.center),b.L(3,n.x,n.y))}}b.zf()}else if(c.layer===f.layer)b.zf();else{if(p=d=!1,q=b.firstPickIndex+1,b.isOrthogonal){p=!0;var u=b.pointsCount;4<u&&b.points.removeRange(2,u-3)}else if(b.curve===Rc)d=!0,4<(u=b.pointsCount)&&b.points.removeRange(2,u-3),4===u&&(q=2);else{u=b.pointsCount;var y=l===gi,m=h===gi;2<u&&y&&m?b.points.removeRange(1,u-2):3<u&&y&&!m?b.points.removeRange(1,u-3):3<u&&!y&&m?b.points.removeRange(2,u-2):4<u&&!y&&!m&&b.points.removeRange(2,u-3)}if(t.rev){for(;null!==f&&c!==f;){var v=u=null;for(y=f.sourceEdges.iterator;y.next()&&((m=y.value).link!==t.link||(u=m.fromVertex,v=m.toVertex,null!==u.node)););if(u!==c){y=b.i(q-1).x,m=b.i(q-1).y;var x=u.centerX,w=u.centerY;if(p)180===this.K||0===this.K?q===b.firstPickIndex+1?(b.m(q++,y,m),b.m(q++,y,w)):(null!==v?v.centerY:m)!==w&&(v=this.Ia[u.layer-1]+this.Xc.x,b.m(q++,v,m),b.m(q++,v,w)):q===b.firstPickIndex+1?(b.m(q++,y,m),b.m(q++,x,m)):(null!==v?v.centerX:y)!==x&&(v=this.Ia[u.layer-1]+this.Xc.y,b.m(q++,y,v),b.m(q++,x,v));else if(q===b.firstPickIndex+1){v=Math.max(10,this.Xd[f.layer]);var k=Math.max(10,this.yd[f.layer]);if(d)180===this.K?x<=f.bounds.x?(f=f.bounds.x,b.m(q++,f-v,w),b.m(q++,f,w),b.m(q++,f+k,w)):(b.m(q++,x-v,w),b.m(q++,x,w),b.m(q++,x+k,w)):90===this.K?w>=f.bounds.bottom?(f=f.bounds.y+f.bounds.height,b.m(q++,x,f+k),b.m(q++,x,f),b.m(q++,x,f-v)):(b.m(q++,x,w+k),b.m(q++,x,w),b.m(q++,x,w-v)):270===this.K?w<=f.bounds.y?(f=f.bounds.y,b.m(q++,x,f-v),b.m(q++,x,f),b.m(q++,x,f+k)):(b.m(q++,x,w-v),b.m(q++,x,w),b.m(q++,x,w+k)):0===this.K&&(x>=f.bounds.right?(f=f.bounds.x+f.bounds.width,b.m(q++,f+k,w),b.m(q++,f,w),b.m(q++,f-v,w)):(b.m(q++,x+k,w),b.m(q++,x,w),b.m(q++,x-v,w)));else{b.m(q++,y,m);var M=0;180===this.K||0===this.K?((180===this.K?x>=f.bounds.right:x<=f.bounds.x)&&(M=(0===this.K?-v:k)/2),b.m(q++,y+M,w)):((270===this.K?w>=f.bounds.bottom:w<=f.bounds.y)&&(M=(90===this.K?-v:k)/2),b.m(q++,x,m+M)),b.m(q++,x,w)}}else v=Math.max(10,this.Xd[u.layer]),k=Math.max(10,this.yd[u.layer]),180===this.K?(d&&b.m(q++,x-v,w),b.m(q++,x,w),d&&b.m(q++,x+k,w)):90===this.K?(d&&b.m(q++,x,w+k),b.m(q++,x,w),d&&b.m(q++,x,w-v)):270===this.K?(d&&b.m(q++,x,w-v),b.m(q++,x,w),d&&b.m(q++,x,w+k)):(d&&b.m(q++,x+k,w),b.m(q++,x,w),d&&b.m(q++,x-v,w))}f=u}(null===r||l!==gi||p)&&(y=b.i(q-1).x,m=b.i(q-1).y,x=b.i(q).x,w=b.i(q).y,p?(f=this.yd[c.layer],180===this.K||0===this.K?((p=m)>=c.bounds.y&&p<=c.bounds.bottom&&(180===this.K?x>=c.bounds.x:x<=c.bounds.right)&&(f=c.centerX+(180===this.K?-f:f),p=p<c.bounds.y+c.bounds.height/2?c.bounds.y-this.Zb/2:c.bounds.bottom+this.Zb/2,b.m(q++,f,m),b.m(q++,f,p)),b.m(q++,x,p)):((p=y)>=c.bounds.x&&p<=c.bounds.right&&(270===this.K?w>=c.bounds.y:w<=c.bounds.bottom)&&(f=c.centerY+(270===this.K?-f:f),p=p<c.bounds.x+c.bounds.width/2?c.bounds.x-this.Zb/2:c.bounds.right+this.Zb/2,b.m(q++,y,f),b.m(q++,p,f)),b.m(q++,p,w)),b.m(q++,x,w)):d?(v=Math.max(10,this.Xd[c.layer]),k=Math.max(10,this.yd[c.layer]),180===this.K&&x>=c.bounds.x?(f=c.bounds.x+c.bounds.width,b.L(q-2,f,m),b.L(q-1,f+k,m)):90===this.K&&w<=c.bounds.bottom?(f=c.bounds.y,b.L(q-2,y,f),b.L(q-1,y,f-v)):270===this.K&&w>=c.bounds.y?(f=c.bounds.y+c.bounds.height,b.L(q-2,y,f),b.L(q-1,y,f+k)):0===this.K&&x<=c.bounds.right&&(f=c.bounds.x,b.L(q-2,f,m),b.L(q-1,f-v,m))):(v=Math.max(10,this.Xd[c.layer]),k=Math.max(10,this.yd[c.layer]),p=0,180===this.K||0===this.K?((180===this.K?x<=c.bounds.x:x>=c.bounds.right)&&(p=(0===this.K?k:-v)/2),b.m(q++,x+p,m)):((270===this.K?w<=c.bounds.y:w>=c.bounds.bottom)&&(p=(90===this.K?k:-v)/2),b.m(q++,y,w+p)),b.m(q++,x,w)))}else{for(;null!==c&&c!==f;){for(v=u=null,c=c.destinationEdges.iterator;c.next()&&((y=c.value).link!==t.link||(u=y.toVertex,null!==(v=y.fromVertex).node&&(v=null),null!==u.node)););u!==f&&(y=b.i(q-1).x,m=b.i(q-1).y,x=u.centerX,w=u.centerY,p?180===this.K||0===this.K?(null!==v?v.centerY:m)!==w&&(v=this.Ia[u.layer]+this.Xc.x,q===b.firstPickIndex+1&&(v=0===this.K?Math.max(v,y):Math.min(v,y)),b.m(q++,v,m),b.m(q++,v,w)):(null!==v?v.centerX:y)!==x&&(v=this.Ia[u.layer]+this.Xc.y,q===b.firstPickIndex+1&&(v=90===this.K?Math.max(v,m):Math.min(v,m)),b.m(q++,y,v),b.m(q++,x,v)):(v=Math.max(10,this.Xd[u.layer]),k=Math.max(10,this.yd[u.layer]),180===this.K?(b.m(q++,x+k,w),d&&b.m(q++,x,w),b.m(q++,x-v,w)):90===this.K?(b.m(q++,x,w-v),d&&b.m(q++,x,w),b.m(q++,x,w+k)):270===this.K?(b.m(q++,x,w+k),d&&b.m(q++,x,w),b.m(q++,x,w-v)):(b.m(q++,x-v,w),d&&b.m(q++,x,w),b.m(q++,x+k,w)))),c=u}p&&(y=b.i(q-1).x,m=b.i(q-1).y,x=b.i(q).x,w=b.i(q).y,180===this.K||0===this.K?m!==w&&(v=0===this.K?Math.min(Math.max((x+y)/2,this.Ia[f.layer]+this.Xc.x),x):Math.max(Math.min((x+y)/2,this.Ia[f.layer]+this.Xc.x),x),b.m(q++,v,m),b.m(q++,v,w)):y!==x&&(v=90===this.K?Math.min(Math.max((w+m)/2,this.Ia[f.layer]+this.Xc.y),w):Math.max(Math.min((w+m)/2,this.Ia[f.layer]+this.Xc.y),w),b.m(q++,y,v),b.m(q++,x,v)))}null!==e&&d&&(null!==g&&(l===gi&&(l=b.i(0),e=b.i(2),l.w(e)||b.L(1,(l.x+e.x)/2,(l.y+e.y)/2)),(l=b.getLinkPoint(n,g,gi,!0,!1,o,r)).u()||l.set(n.actualBounds.center),b.L(0,l.x,l.y)),null!==r&&(h===gi&&(h=b.i(b.pointsCount-1),l=b.i(b.pointsCount-3),h.w(l)||b.L(b.pointsCount-2,(h.x+l.x)/2,(h.y+l.y)/2)),(n=b.getLinkPoint(o,r,gi,!1,!1,n,g)).u()||n.set(o.actualBounds.center),b.L(b.pointsCount-1,n.x,n.y))),b.zf(),t.commit()}}}this.avoidOrthogonalOverlaps()},Qp.prototype.avoidOrthogonalOverlaps=function(){if(!(0>=this.linkSpacing)){for(var a=new ut,b=this.network.edges.iterator;b.next();){var t=b.value.link;null!==t&&t.isOrthogonal&&!a.contains(t)&&a.add(t)}if(0<a.count)if(90===this.K||270===this.K){for(b=0,t=[],a=a.iterator;a.next();){var e=a.value;if(null!==e&&e.isOrthogonal)for(var n=2;n<e.pointsCount-3;n++){var o=e.i(n),g=e.i(n+1);if(this.A(o.y,g.y)&&!this.A(o.x,g.x)){var r=new Yg;r.layer=Math.floor(o.y/2);var h=e.i(0),l=e.i(e.pointsCount-1);if(r.first=h.x*h.x+h.y,r.Xb=l.x*l.x+l.y,r.hd=Math.min(o.x,g.x),r.vc=Math.max(o.x,g.x),r.index=n,r.link=e,n+2<e.pointsCount){h=e.i(n-1),l=e.i(n+2);var c=0;h.y<o.y?c=l.y<o.y?3:o.x<g.x?2:1:h.y>o.y&&(c=l.y>o.y?0:g.x<o.x?2:1),r.l=c}t.push(r)}}}if(1<t.length)for(t.sort(this.Ty),a=0;a<t.length;){for(o=t[a].layer,e=a+1;e<t.length&&t[e].layer===o;)e++;if(1<e-a)for(o=a;o<e;){for(g=t[o].vc,n=a+1;n<e&&t[n].hd<g;)g=Math.max(g,t[n].vc),n++;if(1<(g=n-o)){for(this.tj(t,this.fu,o,o+g),c=1,r=t[o].Xb,h=o;h<n;h++)(l=t[h]).Xb!==r&&(c++,r=l.Xb);this.tj(t,this.Sy,o,o+g);var f=1;for(r=t[o].first,h=o;h<n;h++)(l=t[h]).first!==r&&(f++,r=l.first);for(h=!0,l=f,c<f?(h=!1,l=c,r=t[o].Xb,this.tj(t,this.fu,o,o+g)):r=t[o].first,c=0,f=o;f<n;f++){var p=t[f];(h?p.first:p.Xb)!==r&&(c++,r=h?p.first:p.Xb);var d=p.link;o=d.i(p.index),g=d.i(p.index+1);var q=this.linkSpacing*(c-(l-1)/2);b++,d.Sh(),d.L(p.index,o.x,o.y+q),d.L(p.index+1,g.x,g.y+q),d.zf()}}o=n}a=e}}else{for(b=0,t=[],a=a.iterator;a.next();)if(null!==(e=a.value)&&e.isOrthogonal)for(n=2;n<e.pointsCount-3;n++)o=e.i(n),g=e.i(n+1),this.A(o.x,g.x)&&!this.A(o.y,g.y)&&((r=new Yg).layer=Math.floor(o.x/2),h=e.i(0),l=e.i(e.pointsCount-1),r.first=h.x+h.y*h.y,r.Xb=l.x+l.y*l.y,r.hd=Math.min(o.y,g.y),r.vc=Math.max(o.y,g.y),r.index=n,r.link=e,n+2<e.pointsCount&&(h=e.i(n-1),l=e.i(n+2),c=0,h.x<o.x?c=l.x<o.x?3:o.y<g.y?2:1:h.x>o.x&&(c=l.x>o.x?0:g.y<o.y?2:1),r.l=c),t.push(r));if(1<t.length)for(t.sort(this.Ty),a=0;a<t.length;){for(o=t[a].layer,e=a+1;e<t.length&&t[e].layer===o;)e++;if(1<e-a)for(o=a;o<e;){for(g=t[o].vc,n=a+1;n<e&&t[n].hd<g;)g=Math.max(g,t[n].vc),n++;if(1<(g=n-o)){for(this.tj(t,this.fu,o,o+g),c=1,r=t[o].Xb,h=o;h<n;h++)(l=t[h]).Xb!==r&&(c++,r=l.Xb);for(this.tj(t,this.Sy,o,o+g),f=1,r=t[o].first,h=o;h<n;h++)(l=t[h]).first!==r&&(f++,r=l.first);for(h=!0,l=f,c<f?(h=!1,l=c,r=t[o].Xb,this.tj(t,this.fu,o,o+g)):r=t[o].first,c=0,f=o;f<n;f++)p=t[f],(h?p.first:p.Xb)!==r&&(c++,r=h?p.first:p.Xb),o=(d=p.link).i(p.index),g=d.i(p.index+1),q=this.linkSpacing*(c-(l-1)/2),b++,d.Sh(),d.L(p.index,o.x+q,o.y),d.L(p.index+1,g.x+q,g.y),d.zf()}o=n}a=e}}}},(n=Qp.prototype).Ty=function(a,b){return a instanceof Yg&&b instanceof Yg&&a!==b?a.layer<b.layer?-1:a.layer>b.layer?1:a.hd<b.hd?-1:a.hd>b.hd?1:a.vc<b.vc?-1:a.vc>b.vc?1:0:0},n.Sy=function(a,b){return a instanceof Yg&&b instanceof Yg&&a!==b?a.first<b.first?-1:a.first>b.first||a.l<b.l?1:a.l>b.l||a.hd<b.hd?-1:a.hd>b.hd?1:a.vc<b.vc?-1:a.vc>b.vc?1:0:0},n.fu=function(a,b){return a instanceof Yg&&b instanceof Yg&&a!==b?a.Xb<b.Xb?-1:a.Xb>b.Xb||a.l<b.l?1:a.l>b.l||a.hd<b.hd?-1:a.hd>b.hd?1:a.vc<b.vc?-1:a.vc>b.vc?1:0:0},n.A=function(a,b){return-1<(a-=b)&&1>a},n.tj=function(a,b,t,e){var n=a.length,o=e-t;if(!(1>=o))if((0>t||t>=n-1)&&N("not in range 0 <= from < length: "+t),2===o)0<b(e=a[t],n=a[t+1])&&(a[t]=n,a[t+1]=e);else if(0===t)if(e>=n)a.sort(b);else for((t=a.slice(0,e)).sort(b),b=0;b<e;b++)a[b]=t[b];else if(e>=n)for((e=a.slice(t)).sort(b),b=t;b<n;b++)a[b]=e[b-t];else for((n=a.slice(t,e)).sort(b),b=t;b<e;b++)a[b]=n[b-t]},v.Object.defineProperties(Qp.prototype,{layerSpacing:{get:function(){return this.se},set:function(a){this.se!==a&&0<=a&&(this.se=a,this.C())}},columnSpacing:{get:function(){return this.Zb},set:function(a){this.Zb!==a&&0<a&&(this.Zb=a,this.C())}},direction:{get:function(){return this.K},set:function(a){this.K!==a&&(0===a||90===a||180===a||270===a?(this.K=a,this.C()):N("LayeredDigraphLayout.direction must be 0, 90, 180, or 270"))}},cycleRemoveOption:{get:function(){return this.hl},set:function(a){this.hl===a||a!==jg&&a!==Ag&&a!==Dg||(this.hl=a,this.C())}},layeringOption:{get:function(){return this.Ll},set:function(a){this.Ll===a||a!==Og&&a!==Fg&&a!==Bg||(this.Ll=a,this.C())}},initializeOption:{get:function(){return this.Al},set:function(a){this.Al===a||a!==Ig&&a!==Rg&&a!==Eg||(this.Al=a,this.C())}},iterations:{get:function(){return this.Pj},set:function(a){this.Pj!==a&&0<=a&&(this.Pj=a,this.C())}},aggressiveOption:{get:function(){return this.Xk},set:function(a){this.Xk===a||a!==zg&&a!==Vg&&a!==Gg||(this.Xk=a,this.C())}},packOption:{get:function(){return this.pg},set:function(a){this.pg!==a&&0<=a&&8>a&&(this.pg=a,this.C())}},setsPortSpots:{get:function(){return this.kf},set:function(a){this.kf!==a&&(this.kf=a,this.C())}},linkSpacing:{get:function(){return this.Go},set:function(a){this.Go!==a&&0<=a&&(this.Go=a,this.C())}},maxLayer:{get:function(){return this.ra}},maxIndex:{get:function(){return this.Hi}},maxColumn:{get:function(){return this.Ba}},minIndexLayer:{get:function(){return this.mh}},maxIndexLayer:{get:function(){return this.pc}}});var Ag=new _(Qp,"CycleDepthFirst",0),jg=new _(Qp,"CycleGreedy",1),Dg=new _(Qp,"CycleFromLayers",2),Og=new _(Qp,"LayerOptimalLinkLength",0),Fg=new _(Qp,"LayerLongestPathSink",1),Bg=new _(Qp,"LayerLongestPathSource",2),Ig=new _(Qp,"InitDepthFirstOut",0),Rg=new _(Qp,"InitDepthFirstIn",1),Eg=new _(Qp,"InitNaive",2),zg=new _(Qp,"AggressiveNone",0),Vg=new _(Qp,"AggressiveLess",1),Gg=new _(Qp,"AggressiveMore",2);function Yg(){this.index=this.vc=this.hd=this.Xb=this.first=this.layer=0,this.link=null,this.l=0}function Xg(a){Bf.call(this,a)}function qg(a){Vf.call(this,a),this.Pa=this.Sg=this.Di=-1,this.I=NaN,this.T=null,this.valid=!1,this.finish=this.Dg=NaN,this.yf=0,this.Ik=this.Jk=null}function Ug(a){Yf.call(this,a),this.l=this.Ka=this.eb=!1,this.Ja=this.I=NaN,this.T=this.v=0}function Kg(){wf.call(this),this.Kb=new ft,this.op=rt,this.md=My,this.kq=zy,this.ts=Ky,this.nx=[],this.ld=!0,this.Fb=Xy,this.Nd=new Ut(10,10).freeze();var a=new Jy(this);this.U=new Zy(a),this.V=new Zy(a),this.sv=[]}function Hg(a){var b=new ft;for(a=a.iterator;a.next();){var t=a.value;t.initialized||b.add(t)}return b}function Wg(a,b){var t=999999,e=null;for(b=b.iterator;b.next();){var n=b.value;switch(a.md){case My:n.sourceEdges.count<t&&(t=n.sourceEdges.count,e=n);break;case Sy:n.destinationEdges.count<t&&(t=n.destinationEdges.count,e=n);break;default:N("Unhandled path value "+a.md.toString())}}return e}function Jg(a,b){if(null!==b){switch(a.md){case My:if(0<b.destinationEdges.count){for(var t=new ut,e=b.destinationVertexes;e.next();){var n=e.value;Zg(a,b,n)&&t.add(n)}0<t.count&&(b.children=t.ma())}break;case Sy:if(0<b.sourceEdges.count){for(t=new ut,e=b.sourceVertexes;e.next();)Zg(a,b,n=e.value)&&t.add(n);0<t.count&&(b.children=t.ma())}break;default:N("Unhandled path value"+a.md.toString())}for(e=(t=b.children).length,n=0;n<e;n++){var o=t[n];o.initialized=!0,o.level=b.level+1,o.parent=b,a.Kb.remove(o)}for(b=0;b<e;b++)Jg(a,t[b])}}function Zg(a,b,t){if(t.initialized){if(null===b)var e=!1;else{for(e=b.parent;null!==e&&e!==t;)e=e.parent;e=e===t}if(e||t.level>b.level)return!1;a.removeChild(t.parent,t)}return!0}function $g(a,b){if(null!==b){a.initializeTreeVertexValues(b),b.alignment===Fy&&a.sortTreeVertexChildren(b);for(var t=0,e=b.childrenCount,n=0,o=b.children,g=o.length,r=0;r<g;r++){var h=o[r];$g(a,h),t+=h.descendantCount+1,e=Math.max(e,h.maxChildrenCount),n=Math.max(n,h.maxGenerationCount)}b.descendantCount=t,b.maxChildrenCount=e,b.maxGenerationCount=0<e?n+1:0}}function Qg(a,b){if(null!==b){a.assignTreeVertexValues(b);for(var t=(b=b.children).length,e=0;e<t;e++)Qg(a,b[e])}}function _g(a,b){if(null!==b){b.alignment!==Fy&&a.sortTreeVertexChildren(b);for(var t=(b=b.children).length,e=0;e<t;e++)_g(a,b[e])}}function ty(a){return a===Oy||a===Fy||a===By||a===Iy}function iy(a){return a===Oy||a===Fy}function ey(a){var b=a.parent;if(null!==b){var t=b.alignment;if(ty(t)){if(iy(t)){for(b=b.children,t=0;t<b.length&&a!==b[t];)t++;return 0==t%2}if(t===By)return!0}}return!1}function ny(a,b){if(0===b.childrenCount){var t=!1,e=0;null!==b.parent&&(e=b.parent.angle,t=ty(t=b.parent.alignment));var n=ey(b);b.S.h(0,0),b.wa.h(b.width,b.height),null===b.parent||null===b.comments||(180!==e&&270!==e||t)&&!n?b.fa.h(0,0):180===e&&!t||(90===e||270===e)&&n?b.fa.h(b.width-2*b.focus.x,0):b.fa.h(0,b.height-2*b.focus.y)}else{t=90===(e=by(b))||270===e;for(var o=0,g=(n=b.children).length,r=0;r<g;r++){var h=n[r];o=Math.max(o,t?h.wa.width:h.wa.height)}var l=b.alignment,c=l===jy,f=l===Dy;r=ty(l);var p=Math.max(0,b.breadthLimit);h=wy(b);var d=b.nodeSpacing,q=ky(b),u=c||f?0:q/2,y=b.rowSpacing,m=0;(c||f||b.Qm||b.Rm&&1===b.maxGenerationCount)&&(m=Math.max(0,b.rowIndent)),c=b.width;var v=b.height,x=0,w=0,k=0,M=0,S=0,P=0,C=0,T=0,L=0;if(r&&!iy(l)&&135<e&&n.reverse(),iy(l))if(1<g)for(var A=0;A<g;A++){var j=n[A],D=j.wa;0==A%2&&A!==g-1&&(L=Math.max(L,(t?D.width:D.height)+sy(j)-d))}else 1===g&&(L=t?n[0].wa.width:n[0].wa.height);if(r)switch(l){case Oy:case Fy:L=(w=135>e?oy(b,n,L,x,w):ry(b,n,L,x,w)).x,x=w.width,w=w.height;break;case By:for(a=0;a<g;a++)u=(p=n[a]).wa,k=0===C?0:y,t?(p.S.h(o-u.width,S+k),x=Math.max(x,u.width),w=Math.max(w,S+k+u.height),S+=k+u.height):(p.S.h(M+k,o-u.height),x=Math.max(x,M+k+u.width),w=Math.max(w,u.height),M+=k+u.width),C++;break;case Iy:for(o=0;o<g;o++)p=(a=n[o]).wa,u=0===C?0:y,t?(a.S.h(d/2+b.focus.x,S+u),x=Math.max(x,p.width),w=Math.max(w,S+u+p.height),S+=u+p.height):(a.S.h(M+u,d/2+b.focus.y),x=Math.max(x,M+u+p.width),w=Math.max(w,p.height),M+=u+p.width),C++}else for(A=0;A<g;A++){if(D=(j=n[A]).wa,t){0<p&&0<C&&M+d+D.width>p&&(M<o&&cy(b,l,o-M,0,T,A-1),P++,C=0,T=A,k=w,M=0,S=135<e?-w-y:w+y);var O=0===C?u:d;dy(a,j,0,S),j.S.h(M+O,S),x=Math.max(x,M+O+D.width),w=Math.max(w,k+(0===P?0:y)+D.height),M+=O+D.width}else 0<p&&0<C&&S+d+D.height>p&&(S<o&&cy(b,l,0,o-S,T,A-1),P++,C=0,T=A,k=x,S=0,M=135<e?-x-y:x+y),O=0===C?u:d,dy(a,j,M,0),j.S.h(M,S+O),w=Math.max(w,S+O+D.height),x=Math.max(x,k+(0===P?0:y)+D.width),S+=O+D.height;C++}switch(0<P&&(t?(w+=Math.max(0,h),M<x&&cy(b,l,x-M,0,T,g-1),0<m&&(f||fy(b,m,0,0,g-1),x+=m)):(x+=Math.max(0,h),S<w&&cy(b,l,0,w-S,T,g-1),0<m&&(f||fy(b,0,m,0,g-1),w+=m))),m=f=0,l){case Ly:t?f+=x/2-b.focus.x-q/2:m+=w/2-b.focus.y-q/2;break;case Ay:0<P?t?f+=x/2-b.focus.x-q/2:m+=w/2-b.focus.y-q/2:t?f+=(l=n[0].S.x+n[0].fa.x)+(n[g-1].S.x+n[g-1].fa.x+2*n[g-1].focus.x-l)/2-b.focus.x-q/2:m+=(l=n[0].S.y+n[0].fa.y)+(n[g-1].S.y+n[g-1].fa.y+2*n[g-1].focus.y-l)/2-b.focus.y-q/2;break;case jy:t?(f-=q,x+=q):(m-=q,w+=q);break;case Dy:t?(f+=x-b.width+q,x+=q):(m+=w-b.height+q,w+=q);break;case Oy:case Fy:t?f+=1<g?L+d/2-b.focus.x:n[0].focus.x-b.focus.x+n[0].fa.x:m+=1<g?L+d/2-b.focus.y:n[0].focus.y-b.focus.y+n[0].fa.y;break;case By:t?f+=x+d/2-b.focus.x:m+=w+d/2-b.focus.y;break;case Iy:break;default:N("Unhandled alignment value "+l.toString())}for(q=0;q<g;q++)l=n[q],t?l.S.h(l.S.x+l.fa.x-f,l.S.y+(135<e?(r?-w:-l.wa.height)+l.fa.y-h:v+h+l.fa.y)):l.S.h(l.S.x+(135<e?(r?-x:-l.wa.width)+l.fa.x-h:c+h+l.fa.x),l.S.y+l.fa.y-m);t?(x=hy(b,x,f),0>f&&(f=0),135<e&&(m+=w+h),w=Math.max(Math.max(w,v),w+v+h)):(135<e&&(f+=x+h),x=Math.max(Math.max(x,c),x+c+h),w=ly(b,w,m),0>m&&(m=0)),b.fa.h(f,m),b.wa.h(x,w)}}function oy(a,b,t,e,n){var o=b.length;if(0===o)return new Jt(t,0,e,n);if(1===o)return new Jt(t,0,e=(a=b[0]).wa.width,n=a.wa.height);for(var g=a.nodeSpacing,r=a.rowSpacing,h=90===by(a),l=0,c=0,f=0,p=0;p<o;p++)if(!(0!=p%2||1<o&&p===o-1)){var d=b[p],q=d.wa,u=0===l?0:r;if(h){var y=sy(d)-g;d.S.h(t-(q.width+y),f+u),e=Math.max(e,q.width+y),n=Math.max(n,f+u+q.height),f+=u+q.height}else y=sy(d)-g,d.S.h(c+u,t-(q.height+y)),n=Math.max(n,q.height+y),e=Math.max(e,c+u+q.width),c+=u+q.width;l++}for(l=0,d=c,p=f,h?(c=t+g,f=0):(c=0,f=t+g),q=0;q<o;q++)if(0!=q%2){y=(u=b[q]).wa;var m=0===l?0:r;if(h){var v=sy(u)-g;u.S.h(c+v,f+m),e=Math.max(e,c+y.width+v),n=Math.max(n,f+m+y.height),f+=m+y.height}else v=sy(u)-g,u.S.h(c+m,f+v),e=Math.max(e,c+m+y.width),n=Math.max(n,f+y.height+v),c+=m+y.width;l++}return 1<o&&1==o%2&&(o=(b=b[o-1]).wa,r=null===b.parent?0:b.parent.rowSpacing,h?(b.S.h(t+g/2-b.focus.x-b.fa.x,n+r),h=t+g/2-b.focus.x-b.fa.x,e=Math.max(e,h+o.width),0>h&&(e-=h),n=Math.max(n,Math.max(p,f)+r+o.height),0>b.S.x&&(t=ay(a,b.S.x,!1,t,g))):(b.S.h(e+r,t+g/2-b.focus.y-b.fa.y),e=Math.max(e,Math.max(d,c)+r+o.width),f=t+g/2-b.focus.y-b.fa.y,n=Math.max(n,f+o.height),0>f&&(n-=f),0>b.S.y&&(t=ay(a,b.S.y,!0,t,g)))),new Jt(t,0,e,n)}function ry(a,b,t,e,n){var o=b.length;if(0===o)return new Jt(t,0,e,n);if(1===o)return new Jt(t,0,e=(b=b[0]).wa.width,n=b.wa.height);for(var g=a.nodeSpacing,r=a.rowSpacing,h=270===by(a),l=0,c=0,f=0,p=0;p<o;p++)if(!(0!=p%2||1<o&&p===o-1)){var d=b[p],q=d.wa,u=0===l?0:r;if(h){var y=sy(d)-g;f-=u+q.height,d.S.h(t-(q.width+y),f),e=Math.max(e,q.width+y),n=Math.max(n,Math.abs(f))}else y=sy(d)-g,c-=u+q.width,d.S.h(c,t-(q.height+y)),n=Math.max(n,q.height+y),e=Math.max(e,Math.abs(c));l++}for(l=0,d=c,p=f,h?(c=t+g,f=0):(c=0,f=t+g),q=0;q<o;q++)if(0!=q%2){y=(u=b[q]).wa;var m=0===l?0:r;if(h){var v=sy(u)-g;f-=m+y.height,u.S.h(c+v,f),e=Math.max(e,c+y.width+v),n=Math.max(n,Math.abs(f))}else v=sy(u)-g,c-=m+y.width,u.S.h(c,f+v),n=Math.max(n,f+y.height+v),e=Math.max(e,Math.abs(c));l++}for(1<o&&1==o%2&&(l=(r=b[o-1]).wa,q=null===r.parent?0:r.parent.rowSpacing,h?(r.S.h(t+g/2-r.focus.x-r.fa.x,-n-l.height-q),c=t+g/2-r.focus.x-r.fa.x,e=Math.max(e,c+l.width),0>c&&(e-=c),n=Math.max(n,Math.abs(Math.min(p,f))+q+l.height),0>r.S.x&&(t=ay(a,r.S.x,!1,t,g))):(r.S.h(-e-l.width-q,t+g/2-r.focus.y-r.fa.y),e=Math.max(e,Math.abs(Math.min(d,c))+q+l.width),f=t+g/2-r.focus.y-r.fa.y,n=Math.max(n,f+l.height),0>f&&(n-=f),0>r.S.y&&(t=ay(a,r.S.y,!0,t,g)))),a=0;a<o;a++)g=b[a],h?g.S.h(g.S.x,g.S.y+n):g.S.h(g.S.x+e,g.S.y);return new Jt(t,0,e,n)}function sy(a){return null===a.parent?0:a.parent.nodeSpacing}function ay(a,b,t,e,n){for(var o=(a=a.children).length,g=0;g<o;g++)t?a[g].S.h(a[g].S.x,a[g].S.y-b):a[g].S.h(a[g].S.x-b,a[g].S.y);return b=a[o-1],Math.max(e,t?b.fa.y+b.focus.y-n/2:b.fa.x+b.focus.x-n/2)}function hy(a,b,t){switch(a.alignment){case Ay:case Ly:return t+a.width>b&&(b=t+a.width),0>t&&(b-=t),b;case jy:return a.width>b?a.width:b;case Dy:return 2*a.focus.x>b?a.width:b+a.width-2*a.focus.x;case Oy:case Fy:return Math.max(a.width,Math.max(b,t+a.width)-Math.min(0,t));case By:return a.width-a.focus.x+a.nodeSpacing/2+b;case Iy:return Math.max(a.width,a.focus.x+a.nodeSpacing/2+b);default:return b}}function ly(a,b,t){switch(a.alignment){case Ay:case Ly:return t+a.height>b&&(b=t+a.height),0>t&&(b-=t),b;case jy:return a.height>b?a.height:b;case Dy:return 2*a.focus.y>b?a.height:b+a.height-2*a.focus.y;case Oy:case Fy:return Math.max(a.height,Math.max(b,t+a.height)-Math.min(0,t));case By:return a.height-a.focus.y+a.nodeSpacing/2+b;case Iy:return Math.max(a.height,a.focus.y+a.nodeSpacing/2+b);default:return b}}function uy(a,b,t){switch(a){case Ly:case Ay:b/=2,t/=2;break;case jy:t=b=0;break;case Dy:break;default:N("Unhandled alignment value "+a.toString())}return new St(b,t)}function cy(a,b,t,e,n,o){fy(a,(b=uy(b,t,e)).x,b.y,n,o)}function fy(a,b,t,e,n){if(0!==b||0!==t)for(a=a.children;e<=n;e++){var o=a[e].S;o.x+=b,o.y+=t}}function dy(a,b,t,e){var n=b.parent;switch(a.md){case My:for(a=b.sourceEdges;a.next();)(b=a.value).fromVertex===n&&b.relativePoint.h(t,e);break;case Sy:for(a=b.destinationEdges;a.next();)(b=a.value).toVertex===n&&b.relativePoint.h(t,e);break;default:N("Unhandled path value "+a.md.toString())}}function py(a,b,t){for(var e=0;e<a.length;e++){var n=a[e];n.x+=b,n.y+=t}}function gy(a,b,t,e,n,o,g,r){var h=by(b),l=90===h||270===h,c=b.nodeSpacing;b=e;var f=n;e=o;var p=g,d=t.Nq,q=t.ar;g=t.wa;var u=l?Math.max(p,g.height):Math.max(e,g.width);if(null!==d&&h===by(t)||(d=yy(a,2),q=yy(a,2),l?(d[0].h(0,0),d[1].h(0,g.height),q[0].h(g.width,0),q[1].h(q[0].x,d[1].y)):(d[0].h(0,0),d[1].h(g.width,0),q[0].h(0,g.height),q[1].h(d[1].x,q[0].y))),l){if(p=9999999,!(null===f||2>f.length||null===d||2>d.length))for(n=t=0;t<f.length&&n<d.length;){o=f[t];var y=d[n];h=y.x,l=y.y,h+=e;var m=o;t+1<f.length&&(m=f[t+1]);var v=y;y=v.x,v=v.y,n+1<d.length&&(y=(v=d[n+1]).x,v=v.y,y+=e);var x=p;o.y===l?x=h-o.x:o.y>l&&o.y<v?x=h+(o.y-l)/(v-l)*(y-h)-o.x:l>o.y&&l<m.y&&(x=h-(o.x+(l-o.y)/(m.y-o.y)*(m.x-o.x))),x<p&&(p=x),m.y<=o.y?t++:v<=l?n++:(m.y<=v&&t++,v<=m.y&&n++)}if(p=e-p,t=d,n=p+=c,null===b||2>b.length||null===t||2>t.length)e=null;else{for(c=yy(a,b.length+t.length),e=o=h=0;o<t.length&&t[o].y<b[0].y;)l=t[o++],c[e++].h(l.x+n,l.y);for(;h<b.length;)l=b[h++],c[e++].h(l.x,l.y);for(h=b[b.length-1].y;o<t.length&&t[o].y<=h;)o++;for(;o<t.length&&t[o].y>h;)l=t[o++],c[e++].h(l.x+n,l.y);for(t=yy(a,e),h=0;h<e;h++)t[h].assign(c[h]);my(a,c),e=t}if(o=q,h=p,null===f||2>f.length||null===o||2>o.length)n=null;else{for(c=yy(a,f.length+o.length),n=l=t=0;t<f.length&&f[t].y<o[0].y;)m=f[t++],c[n++].h(m.x,m.y);for(;l<o.length;)m=o[l++],c[n++].h(m.x+h,m.y);for(o=o[o.length-1].y;t<f.length&&f[t].y<=o;)t++;for(;t<f.length&&f[t].y>o;)h=f[t++],c[n++].h(h.x,h.y);for(o=yy(a,n),t=0;t<n;t++)o[t].assign(c[t]);my(a,c),n=o}return o=Math.max(0,p)+g.width,g=u,my(a,b),my(a,d),my(a,f),my(a,q),r[0]=e,r[1]=n,new Jt(p,0,o,g)}if(e=9999999,!(null===f||2>f.length||null===d||2>d.length))for(n=t=0;t<f.length&&n<d.length;)o=f[t],h=(y=d[n]).x,l=y.y,l+=p,m=o,t+1<f.length&&(m=f[t+1]),y=(v=y).x,v=v.y,n+1<d.length&&(y=(v=d[n+1]).x,v=v.y,v+=p),x=e,o.x===h?x=l-o.y:o.x>h&&o.x<y?x=l+(o.x-h)/(y-h)*(v-l)-o.y:h>o.x&&h<m.x&&(x=l-(o.y+(h-o.x)/(m.x-o.x)*(m.y-o.y))),x<e&&(e=x),m.x<=o.x?t++:y<=h?n++:(m.x<=y&&t++,y<=m.x&&n++);if(p-=e,t=d,n=p+=c,null===b||2>b.length||null===t||2>t.length)e=null;else{for(c=yy(a,b.length+t.length),e=o=h=0;o<t.length&&t[o].x<b[0].x;)l=t[o++],c[e++].h(l.x,l.y+n);for(;h<b.length;)l=b[h++],c[e++].h(l.x,l.y);for(h=b[b.length-1].x;o<t.length&&t[o].x<=h;)o++;for(;o<t.length&&t[o].x>h;)l=t[o++],c[e++].h(l.x,l.y+n);for(t=yy(a,e),h=0;h<e;h++)t[h].assign(c[h]);my(a,c),e=t}if(o=q,h=p,null===f||2>f.length||null===o||2>o.length)n=null;else{for(c=yy(a,f.length+o.length),n=l=t=0;t<f.length&&f[t].x<o[0].x;)m=f[t++],c[n++].h(m.x,m.y);for(;l<o.length;)m=o[l++],c[n++].h(m.x,m.y+h);for(o=o[o.length-1].x;t<f.length&&f[t].x<=o;)t++;for(;t<f.length&&f[t].x>o;)h=f[t++],c[n++].h(h.x,h.y);for(o=yy(a,n),t=0;t<n;t++)o[t].assign(c[t]);my(a,c),n=o}return o=u,g=Math.max(0,p)+g.height,my(a,b),my(a,d),my(a,f),my(a,q),r[0]=e,r[1]=n,new Jt(p,0,o,g)}function yy(a,b){if(void 0!==(a=a.sv[b])&&void 0!==(a=a.pop()))return a;a=[];for(var t=0;t<b;t++)a[t]=new St;return a}function my(a,b){var t=b.length,e=a.sv[t];void 0===e&&(e=[],a.sv[t]=e),e.push(b)}function vy(a,b,t,e){if(null!==b){b.x=t,b.y=e;for(var n=(b=b.children).length,o=0;o<n;o++){var g=b[o];vy(a,g,t+g.S.x,e+g.S.y)}}}function xy(a,b){if(null!==b){a.setPortSpots(b);for(var t=(b=b.children).length,e=0;e<t;e++)xy(a,b[e])}}function by(a){return 45>=(a=a.angle)?0:135>=a?90:225>=a?180:315>=a?270:0}function wy(a){var b=by(a);b=90===b||270===b;var t=a.layerSpacing;if(0<a.layerSpacingParentOverlap){var e=Math.min(1,a.layerSpacingParentOverlap);t-=b?a.height*e:a.width*e}return t<(b?-a.height:-a.width)&&(t=b?-a.height:-a.width),t}function ky(a){var b=by(a),t=a.nodeIndent;if(0<a.nodeIndentPastParent){var e=Math.min(1,a.nodeIndentPastParent);t+=90===b||270===b?a.width*e:a.height*e}return Math.max(0,t)}Qp.className="LayeredDigraphLayout",Qp.CycleDepthFirst=Ag,Qp.CycleGreedy=jg,Qp.CycleFromLayers=Dg,Qp.LayerOptimalLinkLength=Og,Qp.LayerLongestPathSink=Fg,Qp.LayerLongestPathSource=Bg,Qp.InitDepthFirstOut=Ig,Qp.InitDepthFirstIn=Rg,Qp.InitNaive=Eg,Qp.AggressiveNone=zg,Qp.AggressiveLess=Vg,Qp.AggressiveMore=Gg,Qp.PackNone=0,Qp.PackExpand=1,Qp.PackStraighten=2,Qp.PackMedian=4,Qp.PackAll=7,Yg.className="SegInfo",m(Xg,Bf),Xg.prototype.createVertex=function(){return new qg(this)},Xg.prototype.createEdge=function(){return new Ug(this)},Xg.className="LayeredDigraphNetwork",m(qg,Vf),qg.prototype.serializeVertexProperties=function(a,b){Vf.prototype.serializeVertexProperties.call(this,a,b),a.layer=this.layer,a.column=this.column,a.index=this.index,a.component=this.component,a.near=this.near?yt(this.near):null,a.valid=this.valid,a.Dg=this.Dg,a.finish=this.finish,a.yf=this.yf,a.Jk=this.Jk,a.Ik=this.Ik},qg.prototype.yq=function(a,b,t,e){Vf.prototype.yq.call(this,a,b,t,e),this.layer=a.layer,this.column=a.column,this.index=a.index,this.component=a.component,(b=b.get(a.near))&&(this.near=b),this.valid=a.valid,this.Dg=a.Dg,this.finish=a.finish,this.yf=a.yf,this.Jk=a.Jk,this.Ik=a.Ik},v.Object.defineProperties(qg.prototype,{layer:{get:function(){return this.Di},set:function(a){this.Di!==a&&(this.Di=a)}},column:{get:function(){return this.Sg},set:function(a){this.Sg!==a&&(this.Sg=a)}},index:{get:function(){return this.Pa},set:function(a){this.Pa!==a&&(this.Pa=a)}},component:{get:function(){return this.I},set:function(a){this.I!==a&&(this.I=a)}},near:{get:function(){return this.T},set:function(a){this.T!==a&&(this.T=a)}}}),qg.className="LayeredDigraphVertex",m(Ug,Yf),Ug.prototype.serializeEdgeProperties=function(a,b){Yf.prototype.serializeEdgeProperties.call(this,a,b),a.valid=this.valid,a.rev=this.rev,a.forest=this.forest,a.portFromPos=this.portFromPos,a.portToPos=this.portToPos,a.portFromColOffset=this.portFromColOffset,a.portToColOffset=this.portToColOffset},Ug.prototype.deserializeEdgeProperties=function(a,b,t,e){Yf.prototype.deserializeEdgeProperties.call(this,a,b,t,e),this.valid=a.valid,this.rev=a.rev,this.forest=a.forest,this.portFromPos=a.portFromPos,this.portToPos=a.portToPos,this.portFromColOffset=a.portFromColOffset,this.portToColOffset=a.portToColOffset},v.Object.defineProperties(Ug.prototype,{fromVertex:{get:function(){return this.$c},set:function(a){this.$c!==a&&(this.$c=a)}},toVertex:{get:function(){return this.gd},set:function(a){this.gd!==a&&(this.gd=a)}},valid:{get:function(){return this.eb},set:function(a){this.eb!==a&&(this.eb=a)}},rev:{get:function(){return this.Ka},set:function(a){this.Ka!==a&&(this.Ka=a)}},forest:{get:function(){return this.l},set:function(a){this.l!==a&&(this.l=a)}},portFromPos:{get:function(){return this.I},set:function(a){this.I!==a&&(this.I=a)}},portToPos:{get:function(){return this.Ja},set:function(a){this.Ja!==a&&(this.Ja=a)}},portFromColOffset:{get:function(){return this.v},set:function(a){this.v!==a&&(this.v=a)}},portToColOffset:{get:function(){return this.T},set:function(a){this.T!==a&&(this.T=a)}}}),Ug.className="LayeredDigraphEdge",m(Kg,wf),Kg.prototype.cloneProtected=function(a){wf.prototype.cloneProtected.call(this,a),a.op=this.op,a.kq=this.kq,a.ts=this.ts,a.ld=this.ld,a.Fb=this.Fb,a.Nd.assign(this.Nd),a.U.copyInheritedPropertiesFrom(this.U),a.V.copyInheritedPropertiesFrom(this.V)},Kg.prototype.jb=function(a){a.classType===Kg?0===a.name.indexOf("Alignment")?this.alignment=a:0===a.name.indexOf("Arrangement")?this.arrangement=a:0===a.name.indexOf("Compaction")?this.compaction=a:0===a.name.indexOf("Path")?this.path=a:0===a.name.indexOf("Sorting")?this.sorting=a:0===a.name.indexOf("Style")?this.treeStyle=a:N("Unknown enum value: "+a):wf.prototype.jb.call(this,a)},Kg.prototype.createNetwork=function(){return new Jy(this)},Kg.prototype.makeNetwork=function(a){function b(a){if(a instanceof zu)return!a.isLinkLabel&&"Comment"!==a.category;if(a instanceof uc){var b=a.fromNode;return null!==b&&!b.isLinkLabel&&"Comment"!==b.category&&(null!==(a=a.toNode)&&!a.isLinkLabel&&"Comment"!==a.category)}return!1}var t=this.createNetwork();return a instanceof Xo?(t.Bg(a.nodes,!0,b),t.Bg(a.links,!0,b)):a instanceof oc?t.Bg(a.memberParts,!1,b):t.Bg(a.iterator,!1,b),t},Kg.prototype.doLayout=function(a){null===this.network&&(this.network=this.makeNetwork(a)),this.arrangement!==Uy&&(this.arrangementOrigin=this.initialOrigin(this.arrangementOrigin));var b=this.diagram;if(null===b&&a instanceof Xo&&(b=a),this.path===rt&&null!==b?this.md=b.isTreePathToChildren?My:Sy:this.md=this.path===rt?My:this.path,0<this.network.vertexes.count){for(this.network.xq(),a=this.network.vertexes.iterator;a.next();)(b=a.value).initialized=!1,b.level=0,b.parent=null,b.children=[];if(0<this.Kb.count){for(a=new ft,b=this.Kb.iterator;b.next();){var t=b.value;t instanceof zu?null!==(t=this.network.jj(t))&&a.add(t):t instanceof Zy&&a.add(t)}this.Kb=a}for(0===this.Kb.count&&this.findRoots(),a=this.Kb.copy().iterator;a.next();)(b=a.value).initialized||(b.initialized=!0,Jg(this,b));for(b=this.network.vertexes,a=null;0<(a=Hg(b)).count;)null!==(b=Wg(this,a))&&this.Kb.add(b),b.initialized=!0,Jg(this,b),b=a;for(a=this.Kb.iterator;a.next();)(b=a.value)instanceof Zy&&$g(this,b);for(a=this.Kb.iterator;a.next();)(b=a.value)instanceof Zy&&Qg(this,b);for(a=this.Kb.iterator;a.next();)(b=a.value)instanceof Zy&&_g(this,b);if(this.Dv(),this.layerStyle===Wy){for(a=[],b=this.network.vertexes.iterator;b.next();){var e=(t=b.value).parent;null===e&&(e=t),e=0===e.angle||180===e.angle;var n=a[t.level];void 0===n&&(n=0),a[t.level]=Math.max(n,e?t.width:t.height)}for(b=0;b<a.length;b++)void 0===a[b]&&(a[b]=0);for(this.nx=a,b=this.network.vertexes.iterator;b.next();)null===(e=(t=b.value).parent)&&(e=t),0===e.angle||180===e.angle?(180===e.angle&&(t.focusX+=a[t.level]-t.width),t.width=a[t.level]):(270===e.angle&&(t.focusY+=a[t.level]-t.height),t.height=a[t.level])}else if(this.layerStyle===Hy)for(a=this.network.vertexes.iterator;a.next();){for(t=0===(b=a.value).angle||180===b.angle,e=-1,n=0;n<b.children.length;n++){var o=b.children[n];e=Math.max(e,t?o.width:o.height)}if(0<=e)for(n=0;n<b.children.length;n++)o=b.children[n],t?(180===b.angle&&(o.focusX+=e-o.width),o.width=e):(270===b.angle&&(o.focusY+=e-o.height),o.height=e)}for(a=this.Kb.iterator;a.next();)(b=a.value)instanceof Zy&&this.layoutTree(b);this.arrangeTrees(),this.updateParts()}this.network=null,this.Kb=new ft,this.isValidLayout=!0},Kg.prototype.findRoots=function(){for(var a=this.network.vertexes,b=a.iterator;b.next();){var t=b.value;switch(this.md){case My:0===t.sourceEdges.count&&this.Kb.add(t);break;case Sy:0===t.destinationEdges.count&&this.Kb.add(t);break;default:N("Unhandled path value "+this.md.toString())}}0===this.Kb.count&&(null!==(a=Wg(this,a))&&this.Kb.add(a))},Kg.prototype.removeChild=function(a,b){if(null!==a&&null!==b){for(var t=a.children,e=0,n=0;n<t.length;n++)t[n]===b&&e++;if(0<e){e=Array(t.length-e);for(var o=n=0;o<t.length;o++)t[o]!==b&&(e[n++]=t[o]);a.children=e}}},Kg.prototype.initializeTreeVertexValues=function(a){if(a.copyInheritedPropertiesFrom(function(a,b){switch(a.kq){default:case zy:return null!==b.parent?b.parent:a.U;case Yy:return null===b.parent?a.U:null===b.parent.parent?a.V:b.parent;case Gy:return null!==b.parent?null!==b.parent.parent?b.parent.parent:a.V:a.U;case Vy:var t=!0;if(0===b.childrenCount)t=!1;else for(var e=b.children,n=e.length,o=0;o<n;o++)if(0<e[o].childrenCount){t=!1;break}return t&&null!==b.parent?a.V:null!==b.parent?b.parent:a.U}}(this,a)),null!==a.parent&&a.parent.alignment===Fy){for(var b=a.angle,t=a.parent.children,e=0;e<t.length&&a!==t[e];)e++;0==e%2?e!==t.length-1&&(b=90===b?180:180===b?270:270===b?180:270):b=90===b?0:180===b?90:270===b?0:90,a.angle=b}a.initialized=!0},Kg.prototype.assignTreeVertexValues=function(){},Kg.prototype.sortTreeVertexChildren=function(a){switch(a.sorting){case Py:break;case Ny:a.children.reverse();break;case Cy:a.children.sort(a.comparer);break;case Ty:a.children.sort(a.comparer),a.children.reverse();break;default:N("Unhandled sorting value "+a.sorting.toString())}},Kg.prototype.Dv=function(){if(this.comments)for(var a=this.network.vertexes.iterator;a.next();)this.addComments(a.value)},Kg.prototype.addComments=function(a){var b=a.angle,t=a.parent,e=0,n=!1;null!==t&&(e=t.angle,n=ty(n=t.alignment)),b=90===b||270===b,e=90===e||270===e,t=0===a.childrenCount;var o=0,g=0,r=0,h=a.commentSpacing;if(null!==a.node)for(var l=a.node.Qv();l.next();){var c=l.value;"Comment"===c.category&&c.canLayout()&&(null===a.comments&&(a.comments=[]),a.comments.push(c),c.Ta(),c=c.measuredBounds,b&&!t||!n&&!e&&t||n&&e&&t?(o=Math.max(o,c.width),g+=c.height+Math.abs(r)):(o+=c.width+Math.abs(r),g=Math.max(g,c.height)),r=h)}null!==a.comments&&(b&&!t||!n&&!e&&t||n&&e&&t?(o+=Math.abs(a.commentMargin),g=Math.max(0,g-a.height)):(g+=Math.abs(a.commentMargin),o=Math.max(0,o-a.width)),n=Jt.allocAt(0,0,a.bounds.width+o,a.bounds.height+g),a.bounds=n,Jt.free(n))},Kg.prototype.layoutComments=function(a){if(null!==a.comments){var b=a.node.measuredBounds,t=a.parent,e=a.angle,n=0,o=!1;null!==t&&(n=t.angle,o=ty(o=t.alignment)),e=90===e||270===e,t=90===n||270===n;for(var g=0===a.childrenCount,r=ey(a),h=0,l=a.comments,c=l.length,f=St.alloc(),p=0;p<c;p++){var d=l[p],q=d.measuredBounds;if(e&&!g||!o&&!t&&g||o&&t&&g){if(135<n&&!o||t&&r)if(0<=a.commentMargin)for(f.h(a.bounds.x-a.commentMargin-q.width,a.bounds.y+h),d.move(f),d=d.Fd();d.next();){var u=d.value;u.fromSpot=Ui,u.toSpot=Ki}else for(f.h(a.bounds.x+2*a.focus.x-a.commentMargin,a.bounds.y+h),d.move(f),d=d.Fd();d.next();)(u=d.value).fromSpot=Ki,u.toSpot=Ui;else if(0<=a.commentMargin)for(f.h(a.bounds.x+2*a.focus.x+a.commentMargin,a.bounds.y+h),d.move(f),d=d.Fd();d.next();)(u=d.value).fromSpot=Ki,u.toSpot=Ui;else for(f.h(a.bounds.x+a.commentMargin-q.width,a.bounds.y+h),d.move(f),d=d.Fd();d.next();)(u=d.value).fromSpot=Ui,u.toSpot=Ki;h=0<=a.commentSpacing?h+(q.height+a.commentSpacing):h+(a.commentSpacing-q.height)}else{if(135<n&&!o||!t&&r)if(0<=a.commentMargin)for(f.h(a.bounds.x+h,a.bounds.y-a.commentMargin-q.height),d.move(f),d=d.Fd();d.next();)(u=d.value).fromSpot=dd,u.toSpot=Hi;else for(f.h(a.bounds.x+h,a.bounds.y+2*a.focus.y-a.commentMargin),d.move(f),d=d.Fd();d.next();)(u=d.value).fromSpot=Hi,u.toSpot=dd;else if(0<=a.commentMargin)for(f.h(a.bounds.x+h,a.bounds.y+2*a.focus.y+a.commentMargin),d.move(f),d=d.Fd();d.next();)(u=d.value).fromSpot=Hi,u.toSpot=dd;else for(f.h(a.bounds.x+h,a.bounds.y+a.commentMargin-q.height),d.move(f),d=d.Fd();d.next();)(u=d.value).fromSpot=dd,u.toSpot=Hi;h=0<=a.commentSpacing?h+(q.width+a.commentSpacing):h+(a.commentSpacing-q.width)}}if(St.free(f),b=h-a.commentSpacing-(e?b.height:b.width),this.md===My)for(a=a.destinationEdges;a.next();)null===(n=a.value.link)||n.isAvoiding||(n.fromEndSegmentLength=0<b?b:NaN);else for(a=a.sourceEdges;a.next();)null===(n=a.value.link)||n.isAvoiding||(n.toEndSegmentLength=0<b?b:NaN)}},Kg.prototype.layoutTree=function(a){if(null!==a){for(var b=a.children,t=b.length,e=0;e<t;e++)this.layoutTree(b[e]);switch(a.compaction){case Ry:ny(this,a);break;case Ey:if(a.alignment===Fy)ny(this,a);else if(0===a.childrenCount)t=!1,b=0,null!==(e=a.parent)&&(b=e.angle,t=ty(t=e.alignment)),e=ey(a),a.S.h(0,0),a.wa.h(a.width,a.height),null===a.parent||null===a.comments||(180!==b&&270!==b||t)&&!e?a.fa.h(0,0):180===b&&!t||(90===b||270===b)&&e?a.fa.h(a.width-2*a.focus.x,0):a.fa.h(0,a.height-2*a.focus.y),a.Nq=null,a.ar=null;else{var n=by(a);b=90===n||270===n;var o=0,g=a.children,r=g.length;for(t=0;t<r;t++)e=g[t],o=Math.max(o,b?e.wa.width:e.wa.height);var h=a.alignment,l=h===Dy,c=ty(h),f=Math.max(0,a.breadthLimit);t=wy(a);var p=a.nodeSpacing,d=ky(a),q=a.rowSpacing,u=0;(h===jy||l||a.Qm||a.Rm&&1===a.maxGenerationCount)&&(u=Math.max(0,a.rowIndent)),e=a.width;var y=a.height,m=0,v=0,x=0,w=null,k=null,M=0,S=0,P=0,C=0,T=0,L=0,A=0,j=0;if(c&&!iy(h)&&135<n&&g.reverse(),iy(h))if(1<r)for(var D=0;D<r;D++)0==D%2&&D!==r-1&&(j=Math.max(j,b?g[D].wa.width:g[D].wa.height));else 1===r&&(j=b?g[0].wa.width:g[0].wa.height);if(c){switch(h){case Oy:j=(v=135>n?oy(a,g,j,m,v):ry(a,g,j,m,v)).x,m=v.width,v=v.height;break;case By:for(w=0;w<r;w++)f=(k=g[w]).wa,x=0===L?0:q,b?(k.S.h(o-f.width,C+x),m=Math.max(m,f.width),v=Math.max(v,C+x+f.height),C+=x+f.height):(k.S.h(P+x,o-f.height),m=Math.max(m,P+x+f.width),v=Math.max(v,f.height),P+=x+f.width),L++;break;case Iy:for(w=0;w<r;w++)o=(k=g[w]).wa,f=0===L?0:q,b?(k.S.h(p/2+a.focus.x,C+f),m=Math.max(m,o.width),v=Math.max(v,C+f+o.height),C+=f+o.height):(k.S.h(P+f,p/2+a.focus.y),m=Math.max(m,P+f+o.width),v=Math.max(v,o.height),P+=f+o.width),L++}w=yy(this,2),k=yy(this,2),b?(w[0].h(0,0),w[1].h(0,v),k[0].h(m,0)):(w[0].h(0,0),w[1].h(m,0),k[0].h(0,v)),k[1].h(m,v)}else for(D=0;D<r;D++){var O=g[D],F=O.wa;if(b){0<f&&0<L&&P+p+F.width>f&&(P<o&&cy(a,h,o-P,0,A,D-1),T++,L=0,A=D,x=v,P=0,C=135<n?-v-q:v+q),dy(this,O,0,C);var B=0;if(0===L)w=O.Nq,k=O.ar,M=F.width,S=F.height,(null===w||null===k||n!==by(O))&&(w=yy(this,2),k=yy(this,2),w[0].h(0,0),w[1].h(0,S),k[0].h(M,0),k[1].h(M,S));else{var E=I();B=(S=gy(this,a,O,w,k,M,S,E)).x,w=E[0],k=E[1],M=S.width,S=S.height,R(E),P<F.width&&0>B&&(fy(a,-B,0,A,D-1),py(w,-B,0),py(k,-B,0),B=0)}O.S.h(B,C),m=Math.max(m,M),v=Math.max(v,x+(0===T?0:q)+F.height),P=M}else 0<f&&0<L&&C+p+F.height>f&&(C<o&&cy(a,h,0,o-C,A,D-1),T++,L=0,A=D,x=m,C=0,P=135<n?-m-q:m+q),dy(this,O,P,0),B=0,0===L?(w=O.Nq,k=O.ar,M=F.width,S=F.height,(null===w||null===k||n!==by(O))&&(w=yy(this,2),k=yy(this,2),w[0].h(0,0),w[1].h(M,0),k[0].h(0,S),k[1].h(M,S))):(B=(S=gy(this,a,O,w,k,M,S,E=I())).x,w=E[0],k=E[1],M=S.width,S=S.height,R(E),C<F.height&&0>B&&(fy(a,0,-B,A,D-1),py(w,0,-B),py(k,0,-B),B=0)),O.S.h(P,B),v=Math.max(v,S),m=Math.max(m,x+(0===T?0:q)+F.width),C=S;L++}switch(0<T&&(b?(v+=Math.max(0,t),P<m&&cy(a,h,m-P,0,A,r-1),0<u&&(l||fy(a,u,0,0,r-1),m+=u)):(m+=Math.max(0,t),C<v&&cy(a,h,0,v-C,A,r-1),0<u&&(l||fy(a,0,u,0,r-1),v+=u))),u=l=0,h){case Ly:b?l+=m/2-a.focus.x-d/2:u+=v/2-a.focus.y-d/2;break;case Ay:0<T?b?l+=m/2-a.focus.x-d/2:u+=v/2-a.focus.y-d/2:b?l+=(j=g[0].S.x+g[0].fa.x)+(g[r-1].S.x+g[r-1].fa.x+2*g[r-1].focus.x-j)/2-a.focus.x-d/2:u+=(j=g[0].S.y+g[0].fa.y)+(g[r-1].S.y+g[r-1].fa.y+2*g[r-1].focus.y-j)/2-a.focus.y-d/2;break;case jy:b?(l-=d,m+=d):(u-=d,v+=d);break;case Dy:b?(l+=m-a.width+d,m+=d):(u+=v-a.height+d,v+=d);break;case Oy:b?l+=1<r?j+p/2-a.focus.x:g[0].focus.x-a.focus.x+g[0].fa.x:u+=1<r?j+p/2-a.focus.y:g[0].focus.y-a.focus.y+g[0].fa.y;break;case By:b?l+=m+p/2-a.focus.x:u+=v+p/2-a.focus.y;break;case Iy:break;default:N("Unhandled alignment value "+h.toString())}for(d=0;d<r;d++)j=g[d],b?j.S.h(j.S.x+j.fa.x-l,j.S.y+(135<n?(c?-v:-j.wa.height)+j.fa.y-t:y+t+j.fa.y)):j.S.h(j.S.x+(135<n?(c?-m:-j.wa.width)+j.fa.x-t:e+t+j.fa.x),j.S.y+j.fa.y-u);if(r=g=0,c?b?(m=hy(a,m,l),0>l&&(l=0),135<n&&(u+=v+t),v+=y+t,h===Iy&&(g+=p/2+a.focus.x),r+=y+t):(135<n&&(l+=m+t),m+=e+t,v=ly(a,v,u),0>u&&(u=0),h===Iy&&(r+=p/2+a.focus.y),g+=e+t):b?(null===a.comments?e>m&&(g=(m=uy(h,e-m,0)).x,r=m.y,m=e,l=0):m=hy(a,m,l),0>l&&(g-=l,l=0),135<n&&(u+=v+t),v=Math.max(Math.max(v,y),v+y+t),r+=y+t):(135<n&&(l+=m+t),m=Math.max(Math.max(m,e),m+e+t),null===a.comments?y>v&&(g=(v=uy(h,0,y-v)).x,r=v.y,v=y,u=0):v=ly(a,v,u),0>u&&(r-=u,u=0),g+=e+t),0<T)n=yy(this,4),T=yy(this,4),b?(n[2].h(0,y+t),n[3].h(n[2].x,v),T[2].h(m,n[2].y),T[3].h(T[2].x,n[3].y)):(n[2].h(e+t,0),n[3].h(m,n[2].y),T[2].h(n[2].x,v),T[3].h(n[3].x,T[2].y));else{for(n=yy(this,w.length+2),T=yy(this,k.length+2),h=0;h<w.length;h++)c=w[h],n[h+2].h(c.x+g,c.y+r);for(h=0;h<k.length;h++)c=k[h],T[h+2].h(c.x+g,c.y+r)}b?(n[0].h(l,0),n[1].h(n[0].x,y),n[2].y<n[1].y&&(n[2].x>n[0].x?n[2].assign(n[1]):n[1].assign(n[2])),n[3].y<n[2].y&&(n[3].x>n[0].x?n[3].assign(n[2]):n[2].assign(n[3])),T[0].h(l+e,0),T[1].h(T[0].x,y),T[2].y<T[1].y&&(T[2].x<T[0].x?T[2].assign(T[1]):T[1].assign(T[2])),T[3].y<T[2].y&&(T[3].x<T[0].x?T[3].assign(T[2]):T[2].assign(T[3])),n[2].y-=t/2,T[2].y-=t/2):(n[0].h(0,u),n[1].h(e,n[0].y),n[2].x<n[1].x&&(n[2].y>n[0].y?n[2].assign(n[1]):n[1].assign(n[2])),n[3].x<n[2].x&&(n[3].y>n[0].y?n[3].assign(n[2]):n[2].assign(n[3])),T[0].h(0,u+y),T[1].h(e,T[0].y),T[2].x<T[1].x&&(T[2].y<T[0].y?T[2].assign(T[1]):T[1].assign(T[2])),T[3].x<T[2].x&&(T[3].y<T[0].y?T[3].assign(T[2]):T[2].assign(T[3])),n[2].x-=t/2,T[2].x-=t/2),my(this,w),my(this,k),a.Nq=n,a.ar=T,a.fa.h(l,u),a.wa.h(m,v)}break;default:N("Unhandled compaction value "+a.compaction.toString())}}},Kg.prototype.arrangeTrees=function(){if(this.Fb===Uy)for(var a=this.Kb.iterator;a.next();){var b=a.value;if(b instanceof Zy){var t=b.node;if(null!==t){var e=t.position;t=e.x,e=e.y,isFinite(t)||(t=0),isFinite(e)||(e=0),vy(this,b,t,e)}}}else{for(a=[],b=this.Kb.iterator;b.next();)(t=b.value)instanceof Zy&&a.push(t);switch(this.sorting){case Py:break;case Ny:a.reverse();break;case Cy:a.sort(this.comparer);break;case Ty:a.sort(this.comparer),a.reverse();break;default:N("Unhandled sorting value "+this.sorting.toString())}for(b=(t=this.arrangementOrigin).x,t=t.y,e=0;e<a.length;e++){var n=a[e];switch(vy(this,n,b+n.fa.x,t+n.fa.y),this.Fb){case Xy:t+=n.wa.height+this.Nd.height;break;case qy:b+=n.wa.width+this.Nd.width;break;default:N("Unhandled arrangement value "+this.Fb.toString())}}}},Kg.prototype.commitLayout=function(){this.Dw(),this.commitNodes(),this.Gv(),this.isRouting&&this.commitLinks()},Kg.prototype.commitNodes=function(){for(var a=this.network.vertexes.iterator;a.next();)a.value.commit();for(a.reset();a.next();)this.layoutComments(a.value)},Kg.prototype.Gv=function(){if(this.layerStyle===Wy){for(var a=this.nx,b=[],t=null,e=this.network.vertexes.iterator;e.next();){var n=e.value;null===t?t=n.bounds.copy():t.Tc(n.bounds);var o=b[n.level];o=void 0===o?wy(n):Math.max(o,wy(n)),b[n.level]=o}for(e=0;e<b.length;e++)void 0===b[e]&&(b[e]=0);if(90===this.angle||270===this.angle?(t.Kc(this.nodeSpacing/2,this.layerSpacing),e=new St(-this.nodeSpacing/2,-this.layerSpacing/2)):(t.Kc(this.layerSpacing,this.nodeSpacing/2),e=new St(-this.layerSpacing/2,-this.nodeSpacing/2)),n=[],t=90===this.angle||270===this.angle?t.width:t.height,o=0,180===this.angle||270===this.angle)for(var g=0;g<a.length;g++)o+=a[g]+b[g];for(g=0;g<a.length;g++){var r=a[g]+b[g];270===this.angle?(o-=r,n.push(new Jt(0,o,t,r))):90===this.angle?(n.push(new Jt(0,o,t,r)),o+=r):180===this.angle?(o-=r,n.push(new Jt(o,0,r,t))):(n.push(new Jt(o,0,r,t)),o+=r)}this.commitLayers(n,e)}},Kg.prototype.commitLayers=function(){},Kg.prototype.commitLinks=function(){for(var a=this.network.edges.iterator;a.next();)a.value.commit()},Kg.prototype.Dw=function(){for(var a=this.Kb.iterator;a.next();){var b=a.value;b instanceof Zy&&xy(this,b)}},Kg.prototype.setPortSpots=function(a){var b=a.alignment;if(ty(b)){var t=this.md===My,e=by(a);switch(e){case 0:var n=Ki;break;case 90:n=Hi;break;case 180:n=Ui;break;default:n=dd}var o=a.children,g=o.length;switch(b){case Oy:case Fy:for(b=0;b<g;b++){var r=o[b];if(null!==(r=(t?r.sourceEdges:r.destinationEdges).first())&&null!==(r=r.link)){var h=90===e||270===e?Ui:dd;if(1===g||b===g-1&&1==g%2)switch(e){case 0:h=Ui;break;case 90:h=dd;break;case 180:h=Ki;break;default:h=Hi}else 0==b%2&&(h=90===e||270===e?Ki:Hi);t?(a.setsPortSpot&&(r.fromSpot=n),a.setsChildPortSpot&&(r.toSpot=h)):(a.setsPortSpot&&(r.fromSpot=h),a.setsChildPortSpot&&(r.toSpot=n))}}break;case By:for(e=90===e||270===e?Ki:Hi,o=t?a.destinationEdges:a.sourceEdges;o.next();)null!==(g=o.value.link)&&(t?(a.setsPortSpot&&(g.fromSpot=n),a.setsChildPortSpot&&(g.toSpot=e)):(a.setsPortSpot&&(g.fromSpot=e),a.setsChildPortSpot&&(g.toSpot=n)));break;case Iy:for(e=90===e||270===e?Ui:dd,o=t?a.destinationEdges:a.sourceEdges;o.next();)null!==(g=o.value.link)&&(t?(a.setsPortSpot&&(g.fromSpot=n),a.setsChildPortSpot&&(g.toSpot=e)):(a.setsPortSpot&&(g.fromSpot=e),a.setsChildPortSpot&&(g.toSpot=n)))}}else if(t=by(a),this.md===My){for(n=a.destinationEdges;n.next();)if(null!==(e=n.value.link)){if(a.setsPortSpot)if(a.portSpot.Nb())switch(t){case 0:e.fromSpot=Ki;break;case 90:e.fromSpot=Hi;break;case 180:e.fromSpot=Ui;break;default:e.fromSpot=dd}else e.fromSpot=a.portSpot;if(a.setsChildPortSpot)if(a.childPortSpot.Nb())switch(t){case 0:e.toSpot=Ui;break;case 90:e.toSpot=dd;break;case 180:e.toSpot=Ki;break;default:e.toSpot=Hi}else e.toSpot=a.childPortSpot}}else for(n=a.sourceEdges;n.next();)if(null!==(e=n.value.link)){if(a.setsPortSpot)if(a.portSpot.Nb())switch(t){case 0:e.toSpot=Ki;break;case 90:e.toSpot=Hi;break;case 180:e.toSpot=Ui;break;default:e.toSpot=dd}else e.toSpot=a.portSpot;if(a.setsChildPortSpot)if(a.childPortSpot.Nb())switch(t){case 0:e.fromSpot=Ui;break;case 90:e.fromSpot=dd;break;case 180:e.fromSpot=Ki;break;default:e.fromSpot=Hi}else e.fromSpot=a.childPortSpot}},v.Object.defineProperties(Kg.prototype,{roots:{get:function(){return this.Kb},set:function(a){this.Kb!==a&&(this.Kb=a,this.C())}},path:{get:function(){return this.op},set:function(a){this.op!==a&&(this.op=a,this.C())}},treeStyle:{get:function(){return this.kq},set:function(a){this.Fb===a||a!==zy&&a!==Gy&&a!==Vy&&a!==Yy||(this.kq=a,this.C())}},layerStyle:{get:function(){return this.ts},set:function(a){this.Fb===a||a!==Ky&&a!==Hy&&a!==Wy||(this.ts=a,this.C())}},comments:{get:function(){return this.ld},set:function(a){this.ld!==a&&(this.ld=a,this.C())}},arrangement:{get:function(){return this.Fb},set:function(a){this.Fb===a||a!==Xy&&a!==qy&&a!==Uy||(this.Fb=a,this.C())}},arrangementSpacing:{get:function(){return this.Nd},set:function(a){this.Nd.w(a)||(this.Nd.assign(a),this.C())}},rootDefaults:{get:function(){return this.U},set:function(a){this.U!==a&&(this.U=a,this.C())}},alternateDefaults:{get:function(){return this.V},set:function(a){this.V!==a&&(this.V=a,this.C())}},sorting:{get:function(){return this.U.sorting},set:function(a){this.U.sorting===a||a!==Py&&a!==Ny&&a!==Cy&&!Ty||(this.U.sorting=a,this.C())}},comparer:{get:function(){return this.U.comparer},set:function(a){this.U.comparer!==a&&(this.U.comparer=a,this.C())}},angle:{get:function(){return this.U.angle},set:function(a){this.U.angle!==a&&(0===a||90===a||180===a||270===a?(this.U.angle=a,this.C()):N("TreeLayout.angle must be 0, 90, 180, or 270"))}},alignment:{get:function(){return this.U.alignment},set:function(a){this.U.alignment!==a&&(this.U.alignment=a,this.C())}},nodeIndent:{get:function(){return this.U.nodeIndent},set:function(a){this.U.nodeIndent!==a&&0<=a&&(this.U.nodeIndent=a,this.C())}},nodeIndentPastParent:{get:function(){return this.U.nodeIndentPastParent},set:function(a){this.U.nodeIndentPastParent!==a&&0<=a&&1>=a&&(this.U.nodeIndentPastParent=a,this.C())}},nodeSpacing:{get:function(){return this.U.nodeSpacing},set:function(a){this.U.nodeSpacing!==a&&(this.U.nodeSpacing=a,this.C())}},layerSpacing:{get:function(){return this.U.layerSpacing},set:function(a){this.U.layerSpacing!==a&&(this.U.layerSpacing=a,this.C())}},layerSpacingParentOverlap:{get:function(){return this.U.layerSpacingParentOverlap},set:function(a){this.U.layerSpacingParentOverlap!==a&&0<=a&&1>=a&&(this.U.layerSpacingParentOverlap=a,this.C())}},compaction:{get:function(){return this.U.compaction},set:function(a){this.U.compaction===a||a!==Ry&&a!==Ey||(this.U.compaction=a,this.C())}},breadthLimit:{get:function(){return this.U.breadthLimit},set:function(a){this.U.breadthLimit!==a&&0<=a&&(this.U.breadthLimit=a,this.C())}},rowSpacing:{get:function(){return this.U.rowSpacing},set:function(a){this.U.rowSpacing!==a&&(this.U.rowSpacing=a,this.C())}},rowIndent:{get:function(){return this.U.rowIndent},set:function(a){this.U.rowIndent!==a&&0<=a&&(this.U.rowIndent=a,this.C())}},commentSpacing:{get:function(){return this.U.commentSpacing},set:function(a){this.U.commentSpacing!==a&&(this.U.commentSpacing=a,this.C())}},commentMargin:{get:function(){return this.U.commentMargin},set:function(a){this.U.commentMargin!==a&&(this.U.commentMargin=a,this.C())}},setsPortSpot:{get:function(){return this.U.setsPortSpot},set:function(a){this.U.setsPortSpot!==a&&(this.U.setsPortSpot=a,this.C())}},portSpot:{get:function(){return this.U.portSpot},set:function(a){this.U.portSpot.w(a)||(this.U.portSpot=a,this.C())}},setsChildPortSpot:{get:function(){return this.U.setsChildPortSpot},set:function(a){this.U.setsChildPortSpot!==a&&(this.U.setsChildPortSpot=a,this.C())}},childPortSpot:{get:function(){return this.U.childPortSpot},set:function(a){this.U.childPortSpot.w(a)||(this.U.childPortSpot=a,this.C())}},alternateSorting:{get:function(){return this.V.sorting},set:function(a){this.V.sorting===a||a!==Py&&a!==Ny&&a!==Cy&&!Ty||(this.V.sorting=a,this.C())}},alternateComparer:{get:function(){return this.V.comparer},set:function(a){this.V.comparer!==a&&(this.V.comparer=a,this.C())}},alternateAngle:{get:function(){return this.V.angle},set:function(a){this.V.angle===a||0!==a&&90!==a&&180!==a&&270!==a||(this.V.angle=a,this.C())}},alternateAlignment:{get:function(){return this.V.alignment},set:function(a){this.V.alignment!==a&&(this.V.alignment=a,this.C())}},alternateNodeIndent:{get:function(){return this.V.nodeIndent},set:function(a){this.V.nodeIndent!==a&&0<=a&&(this.V.nodeIndent=a,this.C())}},alternateNodeIndentPastParent:{get:function(){return this.V.nodeIndentPastParent},set:function(a){this.V.nodeIndentPastParent!==a&&0<=a&&1>=a&&(this.V.nodeIndentPastParent=a,this.C())}},alternateNodeSpacing:{get:function(){return this.V.nodeSpacing},set:function(a){this.V.nodeSpacing!==a&&(this.V.nodeSpacing=a,this.C())}},alternateLayerSpacing:{get:function(){return this.V.layerSpacing},set:function(a){this.V.layerSpacing!==a&&(this.V.layerSpacing=a,this.C())}},alternateLayerSpacingParentOverlap:{get:function(){return this.V.layerSpacingParentOverlap},set:function(a){this.V.layerSpacingParentOverlap!==a&&0<=a&&1>=a&&(this.V.layerSpacingParentOverlap=a,this.C())}},alternateCompaction:{get:function(){return this.V.compaction},set:function(a){this.V.compaction===a||a!==Ry&&a!==Ey||(this.V.compaction=a,this.C())}},alternateBreadthLimit:{get:function(){return this.V.breadthLimit},set:function(a){this.V.breadthLimit!==a&&0<=a&&(this.V.breadthLimit=a,this.C())}},alternateRowSpacing:{get:function(){return this.V.rowSpacing},set:function(a){this.V.rowSpacing!==a&&(this.V.rowSpacing=a,this.C())}},alternateRowIndent:{get:function(){return this.V.rowIndent},set:function(a){this.V.rowIndent!==a&&0<=a&&(this.V.rowIndent=a,this.C())}},alternateCommentSpacing:{get:function(){return this.V.commentSpacing},set:function(a){this.V.commentSpacing!==a&&(this.V.commentSpacing=a,this.C())}},alternateCommentMargin:{get:function(){return this.V.commentMargin},set:function(a){this.V.commentMargin!==a&&(this.V.commentMargin=a,this.C())}},alternateSetsPortSpot:{get:function(){return this.V.setsPortSpot},set:function(a){this.V.setsPortSpot!==a&&(this.V.setsPortSpot=a,this.C())}},alternatePortSpot:{get:function(){return this.V.portSpot},set:function(a){this.V.portSpot.w(a)||(this.V.portSpot=a,this.C())}},alternateSetsChildPortSpot:{get:function(){return this.V.setsChildPortSpot},set:function(a){this.V.setsChildPortSpot!==a&&(this.V.setsChildPortSpot=a,this.C())}},alternateChildPortSpot:{get:function(){return this.V.childPortSpot},set:function(a){this.V.childPortSpot.w(a)||(this.V.childPortSpot=a,this.C())}}});var rt=new _(Kg,"PathDefault",-1),My=new _(Kg,"PathDestination",0),Sy=new _(Kg,"PathSource",1),Py=new _(Kg,"SortingForwards",10),Ny=new _(Kg,"SortingReverse",11),Cy=new _(Kg,"SortingAscending",12),Ty=new _(Kg,"SortingDescending",13),Ly=new _(Kg,"AlignmentCenterSubtrees",20),Ay=new _(Kg,"AlignmentCenterChildren",21),jy=new _(Kg,"AlignmentStart",22),Dy=new _(Kg,"AlignmentEnd",23),Oy=new _(Kg,"AlignmentBus",24),Fy=new _(Kg,"AlignmentBusBranching",25),By=new _(Kg,"AlignmentTopLeftBus",26),Iy=new _(Kg,"AlignmentBottomRightBus",27),Ry=new _(Kg,"CompactionNone",30),Ey=new _(Kg,"CompactionBlock",31),zy=new _(Kg,"StyleLayered",40),Vy=new _(Kg,"StyleLastParents",41),Gy=new _(Kg,"StyleAlternating",42),Yy=new _(Kg,"StyleRootOnly",43),Xy=new _(Kg,"ArrangementVertical",50),qy=new _(Kg,"ArrangementHorizontal",51),Uy=new _(Kg,"ArrangementFixedRoots",52),Ky=new _(Kg,"LayerIndividual",60),Hy=new _(Kg,"LayerSiblings",61),Wy=new _(Kg,"LayerUniform",62);function Jy(a){Bf.call(this,a)}function Zy(a){Vf.call(this,a),this.Ja=!1,this.Cc=null,this.I=[],this.Uc=this.eb=this.T=this.Ka=0,this.ld=null,this.S=new St(0,0),this.wa=new Ut(0,0),this.fa=new St(0,0),this.Rm=this.Qm=this.WA=!1,this.ar=this.Nq=null,this.dd=Py,this.Yc=Gf,this.Yb=0,this.zb=Ay,this.Ds=this.Cs=0,this.Es=20,this.se=50,this.ss=0,this.Er=Ey,this.wr=0,this.Rs=25,this.Dr=this.Qs=10,this.Cr=20,this.dt=!0,this.Ns=Vi,this.ct=!0,this.zr=Vi}function $y(a){Yf.call(this,a),this.iv=new St(0,0)}Kg.className="TreeLayout",Kg.PathDefault=rt,Kg.PathDestination=My,Kg.PathSource=Sy,Kg.SortingForwards=Py,Kg.SortingReverse=Ny,Kg.SortingAscending=Cy,Kg.SortingDescending=Ty,Kg.AlignmentCenterSubtrees=Ly,Kg.AlignmentCenterChildren=Ay,Kg.AlignmentStart=jy,Kg.AlignmentEnd=Dy,Kg.AlignmentBus=Oy,Kg.AlignmentBusBranching=Fy,Kg.AlignmentTopLeftBus=By,Kg.AlignmentBottomRightBus=Iy,Kg.CompactionNone=Ry,Kg.CompactionBlock=Ey,Kg.StyleLayered=zy,Kg.StyleLastParents=Vy,Kg.StyleAlternating=Gy,Kg.StyleRootOnly=Yy,Kg.ArrangementVertical=Xy,Kg.ArrangementHorizontal=qy,Kg.ArrangementFixedRoots=Uy,Kg.LayerIndividual=Ky,Kg.LayerSiblings=Hy,Kg.LayerUniform=Wy,m(Jy,Bf),Jy.prototype.createVertex=function(){return new Zy(this)},Jy.prototype.createEdge=function(){return new $y(this)},Jy.className="TreeNetwork",m(Zy,Vf),Zy.prototype.copyInheritedPropertiesFrom=function(a){null!==a&&(this.dd=a.sorting,this.Yc=a.comparer,this.Yb=a.angle,this.zb=a.alignment,this.Cs=a.nodeIndent,this.Ds=a.nodeIndentPastParent,this.Es=a.nodeSpacing,this.se=a.layerSpacing,this.ss=a.layerSpacingParentOverlap,this.Er=a.compaction,this.wr=a.breadthLimit,this.Rs=a.rowSpacing,this.Qs=a.rowIndent,this.Dr=a.commentSpacing,this.Cr=a.commentMargin,this.dt=a.setsPortSpot,this.Ns=a.portSpot,this.ct=a.setsChildPortSpot,this.zr=a.childPortSpot)},v.Object.defineProperties(Zy.prototype,{initialized:{get:function(){return this.Ja},set:function(a){this.Ja!==a&&(this.Ja=a)}},parent:{get:function(){return this.Cc},set:function(a){this.Cc!==a&&(this.Cc=a)}},children:{get:function(){return this.I},set:function(a){if(this.I!==a){if(null!==a)for(var b=a.length,t=0;t<b;t++);this.I=a}}},level:{get:function(){return this.Ka},set:function(a){this.Ka!==a&&(this.Ka=a)}},descendantCount:{get:function(){return this.T},set:function(a){this.T!==a&&(this.T=a)}},maxChildrenCount:{get:function(){return this.eb},set:function(a){this.eb!==a&&(this.eb=a)}},maxGenerationCount:{get:function(){return this.Uc},set:function(a){this.Uc!==a&&(this.Uc=a)}},comments:{get:function(){return this.ld},set:function(a){if(this.ld!==a){if(null!==a)for(var b=a.length,t=0;t<b;t++);this.ld=a}}},sorting:{get:function(){return this.dd},set:function(a){this.dd!==a&&(this.dd=a)}},comparer:{get:function(){return this.Yc},set:function(a){this.Yc!==a&&(this.Yc=a)}},angle:{get:function(){return this.Yb},set:function(a){this.Yb!==a&&(this.Yb=a)}},alignment:{get:function(){return this.zb},set:function(a){this.zb!==a&&(this.zb=a)}},nodeIndent:{get:function(){return this.Cs},set:function(a){this.Cs!==a&&(this.Cs=a)}},nodeIndentPastParent:{get:function(){return this.Ds},set:function(a){this.Ds!==a&&(this.Ds=a)}},nodeSpacing:{get:function(){return this.Es},set:function(a){this.Es!==a&&(this.Es=a)}},layerSpacing:{get:function(){return this.se},set:function(a){this.se!==a&&(this.se=a)}},layerSpacingParentOverlap:{get:function(){return this.ss},set:function(a){this.ss!==a&&(this.ss=a)}},compaction:{get:function(){return this.Er},set:function(a){this.Er!==a&&(this.Er=a)}},breadthLimit:{get:function(){return this.wr},set:function(a){this.wr!==a&&(this.wr=a)}},rowSpacing:{get:function(){return this.Rs},set:function(a){this.Rs!==a&&(this.Rs=a)}},rowIndent:{get:function(){return this.Qs},set:function(a){this.Qs!==a&&(this.Qs=a)}},commentSpacing:{get:function(){return this.Dr},set:function(a){this.Dr!==a&&(this.Dr=a)}},commentMargin:{get:function(){return this.Cr},set:function(a){this.Cr!==a&&(this.Cr=a)}},setsPortSpot:{get:function(){return this.dt},set:function(a){this.dt!==a&&(this.dt=a)}},portSpot:{get:function(){return this.Ns},set:function(a){this.Ns.w(a)||(this.Ns=a)}},setsChildPortSpot:{get:function(){return this.ct},set:function(a){this.ct!==a&&(this.ct=a)}},childPortSpot:{get:function(){return this.zr},set:function(a){this.zr.w(a)||(this.zr=a)}},childrenCount:{get:function(){return this.children.length}},relativePosition:{get:function(){return this.S},set:function(a){this.S.set(a)}},subtreeSize:{get:function(){return this.wa},set:function(a){this.wa.set(a)}},subtreeOffset:{get:function(){return this.fa},set:function(a){this.fa.set(a)}}}),Zy.className="TreeVertex",m($y,Yf),$y.prototype.commit=function(){var a=this.link;if(null!==a&&!a.isAvoiding){var b=this.network.layout,t=null,e=null;switch(b.md){case My:t=this.fromVertex,e=this.toVertex;break;case Sy:t=this.toVertex,e=this.fromVertex;break;default:N("Unhandled path value "+b.md.toString())}if(null!==t&&null!==e)if(0!==(b=this.iv).x||0!==b.y||t.WA){e=t.bounds;var n=by(t),o=wy(t),g=t.rowSpacing;a.wj();var r,h=a.curve===Rc,l=a.isOrthogonal;if(a.Sh(),l||h){for(r=2;4<a.pointsCount;)a.tw(2);var c=a.i(1),f=a.i(2)}else{for(r=1;3<a.pointsCount;)a.tw(1);c=a.i(0),f=a.i(a.pointsCount-1)}var p=a.i(a.pointsCount-1);0===n?(t.alignment===Dy?(n=e.bottom+b.y,0===b.y&&c.y>p.y+t.rowIndent&&(n=Math.min(n,Math.max(c.y,n-ky(t))))):t.alignment===jy?(n=e.top+b.y,0===b.y&&c.y<p.y-t.rowIndent&&(n=Math.max(n,Math.min(c.y,n+ky(t))))):n=t.Qm||t.Rm&&1===t.maxGenerationCount?e.top-t.fa.y+b.y:e.y+e.height/2+b.y,h?(a.m(r,c.x,n),r++,a.m(r,e.right+o,n),r++,a.m(r,e.right+o+(b.x-g)/3,n),r++,a.m(r,e.right+o+2*(b.x-g)/3,n),r++,a.m(r,e.right+o+(b.x-g),n),r++,a.m(r,f.x,n)):(l&&(a.m(r,e.right+o/2,c.y),r++),a.m(r,e.right+o/2,n),r++,a.m(r,e.right+o+b.x-(l?g/2:g),n),r++,l&&a.m(r,a.i(r-1).x,f.y))):90===n?(t.alignment===Dy?(n=e.right+b.x,0===b.x&&c.x>p.x+t.rowIndent&&(n=Math.min(n,Math.max(c.x,n-ky(t))))):t.alignment===jy?(n=e.left+b.x,0===b.x&&c.x<p.x-t.rowIndent&&(n=Math.max(n,Math.min(c.x,n+ky(t))))):n=t.Qm||t.Rm&&1===t.maxGenerationCount?e.left-t.fa.x+b.x:e.x+e.width/2+b.x,h?(a.m(r,n,c.y),r++,a.m(r,n,e.bottom+o),r++,a.m(r,n,e.bottom+o+(b.y-g)/3),r++,a.m(r,n,e.bottom+o+2*(b.y-g)/3),r++,a.m(r,n,e.bottom+o+(b.y-g)),r++,a.m(r,n,f.y)):(l&&(a.m(r,c.x,e.bottom+o/2),r++),a.m(r,n,e.bottom+o/2),r++,a.m(r,n,e.bottom+o+b.y-(l?g/2:g)),r++,l&&a.m(r,f.x,a.i(r-1).y))):180===n?(t.alignment===Dy?(n=e.bottom+b.y,0===b.y&&c.y>p.y+t.rowIndent&&(n=Math.min(n,Math.max(c.y,n-ky(t))))):t.alignment===jy?(n=e.top+b.y,0===b.y&&c.y<p.y-t.rowIndent&&(n=Math.max(n,Math.min(c.y,n+ky(t))))):n=t.Qm||t.Rm&&1===t.maxGenerationCount?e.top-t.fa.y+b.y:e.y+e.height/2+b.y,h?(a.m(r,c.x,n),r++,a.m(r,e.left-o,n),r++,a.m(r,e.left-o+(b.x+g)/3,n),r++,a.m(r,e.left-o+2*(b.x+g)/3,n),r++,a.m(r,e.left-o+(b.x+g),n),r++,a.m(r,f.x,n)):(l&&(a.m(r,e.left-o/2,c.y),r++),a.m(r,e.left-o/2,n),r++,a.m(r,e.left-o+b.x+(l?g/2:g),n),r++,l&&a.m(r,a.i(r-1).x,f.y))):270===n?(t.alignment===Dy?(n=e.right+b.x,0===b.x&&c.x>p.x+t.rowIndent&&(n=Math.min(n,Math.max(c.x,n-ky(t))))):t.alignment===jy?(n=e.left+b.x,0===b.x&&c.x<p.x-t.rowIndent&&(n=Math.max(n,Math.min(c.x,n+ky(t))))):n=t.Qm||t.Rm&&1===t.maxGenerationCount?e.left-t.fa.x+b.x:e.x+e.width/2+b.x,h?(a.m(r,n,c.y),r++,a.m(r,n,e.top-o),r++,a.m(r,n,e.top-o+(b.y+g)/3),r++,a.m(r,n,e.top-o+2*(b.y+g)/3),r++,a.m(r,n,e.top-o+(b.y+g)),r++,a.m(r,n,f.y)):(l&&(a.m(r,c.x,e.top-o/2),r++),a.m(r,n,e.top-o/2),r++,a.m(r,n,e.top-o+b.y+(l?g/2:g)),r++,l&&a.m(r,f.x,a.i(r-1).y))):N("Invalid angle "+n),a.zf()}else a=this.link,(o=by(t))!==by(e)&&(g=wy(t),h=t.bounds,t=e.bounds,0===o&&t.left-h.right<g+1||90===o&&t.top-h.bottom<g+1||180===o&&h.left-t.right<g+1||270===o&&h.top-t.bottom<g+1||(a.wj(),t=a.curve===Rc,b=a.isOrthogonal,e=ty(this.fromVertex.alignment),a.Sh(),0===o?(o=h.right+g/2,t?4===a.pointsCount&&(t=a.i(3).y,a.L(1,o-20,a.i(1).y),a.m(2,o-20,t),a.m(3,o,t),a.m(4,o+20,t),a.L(5,a.i(5).x,t)):b?e?a.L(3,a.i(2).x,a.i(4).y):6===a.pointsCount&&(a.L(2,o,a.i(2).y),a.L(3,o,a.i(3).y)):4===a.pointsCount?a.m(2,o,a.i(2).y):3===a.pointsCount?a.L(1,o,a.i(2).y):2===a.pointsCount&&a.m(1,o,a.i(1).y)):90===o?(o=h.bottom+g/2,t?4===a.pointsCount&&(t=a.i(3).x,a.L(1,a.i(1).x,o-20),a.m(2,t,o-20),a.m(3,t,o),a.m(4,t,o+20),a.L(5,t,a.i(5).y)):b?e?a.L(3,a.i(2).x,a.i(4).y):6===a.pointsCount&&(a.L(2,a.i(2).x,o),a.L(3,a.i(3).x,o)):4===a.pointsCount?a.m(2,a.i(2).x,o):3===a.pointsCount?a.L(1,a.i(2).x,o):2===a.pointsCount&&a.m(1,a.i(1).x,o)):180===o?(o=h.left-g/2,t?4===a.pointsCount&&(t=a.i(3).y,a.L(1,o+20,a.i(1).y),a.m(2,o+20,t),a.m(3,o,t),a.m(4,o-20,t),a.L(5,a.i(5).x,t)):b?e?a.L(3,a.i(2).x,a.i(4).y):6===a.pointsCount&&(a.L(2,o,a.i(2).y),a.L(3,o,a.i(3).y)):4===a.pointsCount?a.m(2,o,a.i(2).y):3===a.pointsCount?a.L(1,o,a.i(2).y):2===a.pointsCount&&a.m(1,o,a.i(1).y)):270===o&&(o=h.top-g/2,t?4===a.pointsCount&&(t=a.i(3).x,a.L(1,a.i(1).x,o+20),a.m(2,t,o+20),a.m(3,t,o),a.m(4,t,o-20),a.L(5,t,a.i(5).y)):b?e?a.L(3,a.i(2).x,a.i(4).y):6===a.pointsCount&&(a.L(2,a.i(2).x,o),a.L(3,a.i(3).x,o)):4===a.pointsCount?a.m(2,a.i(2).x,o):3===a.pointsCount?a.L(1,a.i(2).x,o):2===a.pointsCount&&a.m(1,a.i(1).x,o)),a.zf()))}},v.Object.defineProperties($y.prototype,{fromVertex:{get:function(){return this.$c},set:function(a){this.$c!==a&&(this.$c=a)}},toVertex:{get:function(){return this.gd},set:function(a){this.gd!==a&&(this.gd=a)}},relativePoint:{get:function(){return this.iv},set:function(a){this.iv.set(a)}}}),$y.className="TreeEdge",Ge.prototype.initializeStandardTools=function(){this.Xa("Action",new Rn,this.mouseDownTools),this.Xa("Relinking",new Nn,this.mouseDownTools),this.Xa("LinkReshaping",new Tn,this.mouseDownTools),this.Xa("Rotating",new Bn,this.mouseDownTools),this.Xa("Resizing",new Fn,this.mouseDownTools),this.Xa("Linking",new kn,this.mouseMoveTools),this.Xa("Dragging",new Je,this.mouseMoveTools),this.Xa("DragSelecting",new zn,this.mouseMoveTools),this.Xa("Panning",new Vn,this.mouseMoveTools),this.Xa("ContextMenu",new Xn,this.mouseUpTools),this.Xa("TextEditing",new $n,this.mouseUpTools),this.Xa("ClickCreating",new En,this.mouseUpTools),this.Xa("ClickSelecting",new In,this.mouseUpTools)},el("Horizontal",new wh),el("Spot",new Mh),el("Table",new Ph),el("Viewbox",new Th),el("TableRow",new Nh),el("TableColumn",new Ch),el("Graduated",new Oh),el("Grid",new Lh),rs.add("GraphLinksModel",cd),rs.add("TreeModel",yd),Nf(Vp,null),Nf(Qp,null);var Qy=w.go,_y={get licenseKey(){return Xo.licenseKey},set licenseKey(a){Xo.licenseKey=a},get version(){return Xo.version},Group:oc,EnumValue:_,List:ut,Set:ft,Map:Mt,Point:St,Size:Ut,Rect:Jt,Margin:ui,Spot:$i,Geometry:td,PathFigure:be,PathSegment:we,InputEvent:Ae,DiagramEvent:je,ChangedEvent:De,Model:vd,GraphLinksModel:tr,TreeModel:ap,Binding:Ud,Transaction:Re,UndoManager:Ee,CommandHandler:_s,Tool:Ve,DraggingTool:Je,DraggingInfo:Fs,DraggingOptions:Ks,LinkingBaseTool:mn,LinkingTool:kn,RelinkingTool:Nn,LinkReshapingTool:Tn,ResizingTool:Fn,RotatingTool:Bn,ClickSelectingTool:In,ActionTool:Rn,ClickCreatingTool:En,HTMLInfo:Gn,ContextMenuTool:Xn,DragSelectingTool:zn,PanningTool:Vn,TextEditingTool:$n,ToolManager:Ge,Animation:To,AnimationManager:po,AnimationTrigger:Ro,Layer:li,Diagram:Xo,Palette:Hs,Overview:Js,Brush:qa,GraphObject:ea,Panel:Fh,RowColumnDefinition:al,Shape:pl,TextBlock:Sl,TextBlockMetrics:Zl,Picture:$l,Part:yu,Adornment:Eu,Node:zu,Link:uc,Placeholder:lc,Layout:wf,LayoutNetwork:Bf,LayoutVertex:Vf,LayoutEdge:Yf,GridLayout:Xf,PanelLayout:xh,CircularLayout:hp,CircularNetwork:Ip,CircularVertex:Rp,CircularEdge:zp,ForceDirectedLayout:Vp,ForceDirectedNetwork:Wp,ForceDirectedVertex:Jp,ForceDirectedEdge:Zp,LayeredDigraphLayout:Qp,LayeredDigraphNetwork:Xg,LayeredDigraphVertex:qg,LayeredDigraphEdge:Ug,TreeLayout:Kg,TreeNetwork:Jy,TreeVertex:Zy,TreeEdge:$y};"object"==typeof Qy&&Qy.version&&N("WARNING: a `go` object on the root object is already defined.  "+("Debug"in Qy?"debug ":"")+"version: "+Qy.version+", replaced with version: "+_y.version),Xo.prototype.go=_y,w.go=_y,(void 0===w||void 0===w.module||"object"!=typeof w.module.exports)&&w.define&&"function"==typeof w.define&&w.define.amd&&w.define(_y),"object"==typeof t.exports&&(t.exports=void 0!==e?e.go:self.go)}()}).call(this,n(80))}}]);