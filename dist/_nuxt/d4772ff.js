(window.webpackJsonp=window.webpackJsonp||[]).push([[31,5],{689:function(t,e,n){"use strict";n.r(e);var o=n(18),r=(n(102),n(694)),c=r.GraphObject.make,d={components:{},props:{params:{type:String,default:""}},computed:{setParams:{get:function(){return this.params},set:function(t){return this.$emit("update:params",t)}}},data:function(){return{nodes:[]}},mounted:function(){var t=this,e=c(r.Diagram,"myDiagramDiv",{initialAutoScale:r.Diagram.Uniform,"commandHandler.copiesTree":!0,"commandHandler.copiesParentKey":!0,"commandHandler.deletesTree":!0,"draggingTool.dragsTree":!0,"undoManager.isEnabled":!0});this.diagram=e;var n=c(r.TreeModel);function o(t,e){return"left"===t?e?r.Spot.Left:r.Spot.Right:e?r.Spot.Right:r.Spot.Left}function d(t,n){e.model.setDataProperty(t.data,"dir",n);for(var o=t.findTreeChildrenNodes();o.next();)d(o.value,n)}function l(t){0===t.data.key?function(){var t=e.findNodeForKey(0);if(null===t)return;e.startTransaction("Layout");var n=new r.Set,o=new r.Set;t.findLinksConnected().each((function(link){var e=link.toNode;"left"===e.data.dir?(o.add(t),o.add(link),o.addAll(e.findTreeParts())):(n.add(t),n.add(link),n.addAll(e.findTreeParts()))})),m(n,0),m(o,180),e.commitTransaction("Layout")}():m(t.findTreeParts(),"left"===t.data.dir?180:0)}function m(t,e){r.GraphObject.make(r.TreeLayout,{angle:e,arrangement:r.TreeLayout.ArrangementFixedRoots,nodeSpacing:5,layerSpacing:20,setsPortSpot:!1,setsChildPortSpot:!1}).doLayout(t)}n.nodeDataArray=this.nodes,e.model=n,e.addDiagramListener("Modified",(function(t){var button=document.getElementById("SaveButton");button&&(button.disabled=!e.isModified);var n=document.title.indexOf("*");e.isModified?n<0&&(document.title+="*"):n>=0&&(document.title=document.title.substr(0,n))})),e.nodeTemplate=c(r.Node,"Vertical",{selectionObjectName:"TEXT"},new r.Binding("location","loc",r.Point.parse).makeTwoWay(r.Point.stringify),new r.Binding("locationSpot","dir",(function(t){return o(t,!1)})),c(r.TextBlock,{name:"TEXT",minSize:new r.Size(30,15),editable:!0},new r.Binding("text","text").makeTwoWay(),new r.Binding("scale","scale").makeTwoWay(),new r.Binding("font","font").makeTwoWay()),c(r.Shape,"LineH",{stretch:r.GraphObject.Horizontal,strokeWidth:3,height:3,portId:"",fromSpot:r.Spot.LeftRightSides,toSpot:r.Spot.LeftRightSides},new r.Binding("stroke","brush"),new r.Binding("fromSpot","dir",(function(t){return o(t,!0)})),new r.Binding("toSpot","dir",(function(t){return o(t,!1)}))),new r.Binding("location","loc",r.Point.parse).makeTwoWay(r.Point.stringify),new r.Binding("locationSpot","dir",(function(t){return o(t,!1)}))),e.nodeTemplate.selectionAdornmentTemplate=c(r.Adornment,"Spot",c(r.Panel,"Auto",c(r.Shape,{fill:null,stroke:"dodgerblue",strokeWidth:3}),c(r.Placeholder,{margin:new r.Margin(4,4,0,4)})),c("Button",{alignment:r.Spot.Right,alignmentFocus:r.Spot.Left,click:function(t,e){var n=e.part,o=n.diagram;o.startTransaction("Add Node");var r=n.adornedPart,c=r.data;if(0==c.key)var d=["palevioletred","coral","darkseagreen","skyblue"],m={text:"idea",brush:d[Math.floor(Math.random()*d.length)],dir:c.dir,parent:c.key};else m={text:"idea",brush:c.brush,dir:c.dir,parent:c.key};o.model.addNodeData(m),l(r),o.commitTransaction("Add Node");var f=o.findNodeForData(m);null!==f&&o.scrollToRect(f.actualBounds)}},c(r.TextBlock,"+",{font:"bold 8pt sans-serif"}))),e.nodeTemplate.contextMenu=c("ContextMenu",c("ContextMenuButton",c(r.TextBlock,"Bold/Normal"),{click:function(t,e){!function(t){var e=t.part;e.diagram.startTransaction("Change Text Weight");var n=e.adornedPart.findObject("TEXT"),o=n.font.indexOf("bold");n.font=o<0?"bold "+n.font:n.font.substr(o+5);e.diagram.commitTransaction("Change Text Weight")}(e)}}),c("ContextMenuButton",c(r.TextBlock,"Copy"),{click:function(t,e){t.diagram.commandHandler.copySelection()}}),c("ContextMenuButton",c(r.TextBlock,"Delete"),{click:function(t,e){t.diagram.commandHandler.deleteSelection()}}),c("ContextMenuButton",c(r.TextBlock,"Undo"),{click:function(t,e){t.diagram.commandHandler.undo()}}),c("ContextMenuButton",c(r.TextBlock,"Redo"),{click:function(t,e){t.diagram.commandHandler.redo()}}),c("ContextMenuButton",c(r.TextBlock,"Layout"),{click:function(t,e){var n=e.part;n.diagram.startTransaction("Subtree Layout"),l(n.adornedPart),n.diagram.commitTransaction("Subtree Layout")}})),e.linkTemplate=c(r.Link,{curve:r.Link.Bezier,fromShortLength:-2,toShortLength:-2,selectable:!1},c(r.Shape,{strokeWidth:3},new r.Binding("stroke","toNode",(function(t){return t.data.brush?t.data.brush:"black"})).ofObject())),e.contextMenu=c("ContextMenu",c("ContextMenuButton",c(r.TextBlock,"Paste"),{click:function(t,e){t.diagram.commandHandler.pasteSelection(t.diagram.toolManager.contextMenuTool.mouseDownPoint)}},new r.Binding("visible","",(function(t){return t.diagram&&t.diagram.commandHandler.canPasteSelection(t.diagram.toolManager.contextMenuTool.mouseDownPoint)})).ofObject()),c("ContextMenuButton",c(r.TextBlock,"Undo"),{click:function(t,e){t.diagram.commandHandler.undo()}},new r.Binding("visible","",(function(t){return t.diagram&&t.diagram.commandHandler.canUndo()})).ofObject()),c("ContextMenuButton",c(r.TextBlock,"Redo"),{click:function(t,e){t.diagram.commandHandler.redo()}},new r.Binding("visible","",(function(t){return t.diagram&&t.diagram.commandHandler.canRedo()})).ofObject())),e.addDiagramListener("SelectionMoved",(function(t){var n=e.findNodeForKey(0).location.x;e.selection.each((function(t){if(0===t.data.parent){var e=t.location.x;n<e&&"right"!==t.data.dir?d(t,"right"):n>e&&"left"!==t.data.dir&&d(t,"left"),l(t)}}))})),this.$axios.$get("api/contents/"+this.params,{headers:{"X-Access-Token":localStorage.getItem("X-Access-Token")}}).then((function(n){t.nodes=n.data.attributes.content,e.model=new r.Model.fromJson({class:"go.TreeModel",nodeDataArray:t.nodes})}))},methods:{save:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n={room_id:t.params,content:t.nodes},t.$axios.$patch("api/contents/"+t.params,n,{headers:{"X-Access-Token":localStorage.getItem("X-Access-Token")}});case 2:case"end":return e.stop()}}),e)})))()}}},l=n(55),m=n(65),f=n.n(m),h=n(165),component=Object(l.a)(d,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t._m(0),t._v(" "),n("v-btn",{on:{click:t.save}},[t._v("SAVE")])],1)}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"wrapper"},[e("div",{staticStyle:{width:"100%",height:"600px"},attrs:{id:"myDiagramDiv"}})])}],!1,null,null,null);e.default=component.exports;f()(component,{VBtn:h.a})},869:function(t,e,n){var content=n(913);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(11).default)("1f7ece62",content,!0,{sourceMap:!1})},912:function(t,e,n){"use strict";n(869)},913:function(t,e,n){var o=n(10)(!1);o.push([t.i,'.full_page{height:100vh!important;font-weight:700!important;position:fixed!important;left:0!important;right:0!important;width:100vw!important}.mind_map_save{position:fixed;top:0;left:0;display:flex;align-items:center;padding:10px;z-index:2}.menu-item:first-child div{font-size:0}.menu-item:first-child div:before{font-size:12px;content:"削除"}.menu-item:nth-child(2) div{font-size:0}.menu-item:nth-child(2) div:before{font-size:12px;content:"折りたたむ"}.menu-item:nth-child(3) div{font-size:0}.menu-item:nth-child(3) div:before{font-size:12px;content:"展開"}.help{position:fixed!important;bottom:40px!important;right:5px!important;z-index:10!important}@media (min-width:960px){.full_page{height:100vh!important;width:100vw!important}.mind_map_save{position:fixed;top:0;left:0;display:flex;align-items:center;padding:10px;z-index:2}}',""]),t.exports=o},950:function(t,e,n){"use strict";n.r(e);var o=n(18),r=(n(35),n(102),n(103)),c={components:{mindmap:n(689).default,VueLoading:r.VueLoading},data:function(){return{contents:[],room:[],room_id:this.$route.params.id,saveAlert:!1,doneAlert:!1,notYetAlert:!1,loading:!0}},created:function(){var t=this;this.$axios.$get("api/contents/"+this.$route.params.id+"}",{headers:{"X-Access-Token":localStorage.getItem("X-Access-Token")}}).then((function(e){if(t.contents=e.data.attributes.content,0==t.contents.length){t.contents={key:0,text:"タイトル入力",loc:"0 0"};var n={room_id:t.$route.params.id,content:t.contents};t.$axios.$patch("api/contents/"+t.$route.params.id,n,{headers:{"X-Access-Token":localStorage.getItem("X-Access-Token")}}).then(t.saveAlert=!0,t.loading=!1)}t.room=e.data.attributes.room,t.loading=!1}))},methods:{done:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loading=!0,n={done:!0},e.next=4,t.$axios.$patch("api/rooms/"+t.$route.params.id,n,{headers:{"X-Access-Token":localStorage.getItem("X-Access-Token")}});case 4:t.$axios.$get("api/rooms/"+t.$route.params.id+"}",{headers:{"X-Access-Token":localStorage.getItem("X-Access-Token")}}).then((function(e){t.room=e.data.attributes,t.loading=!1,t.doneAlert=!0}));case 5:case"end":return e.stop()}}),e)})))()},notYet:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loading=!0,n={done:!1},e.next=4,t.$axios.$patch("api/rooms/"+t.$route.params.id,n,{headers:{"X-Access-Token":localStorage.getItem("X-Access-Token")}});case 4:t.$axios.$get("api/rooms/"+t.$route.params.id+"}",{headers:{"X-Access-Token":localStorage.getItem("X-Access-Token")}}).then((function(e){t.room=e.data.attributes,t.loading=!1,t.notYetAlert=!0}));case 5:case"end":return e.stop()}}),e)})))()},save:function(){this.loading=!0;var t={room_id:this.$route.params.id,content:this.contents};this.$axios.$patch("api/contents/"+this.$route.params.id,t,{headers:{"X-Access-Token":localStorage.getItem("X-Access-Token")}}).then(this.saveAlert=!0,this.loading=!1)}},watch:{saveAlert:function(t){var e=this;t&&setTimeout((function(){e.saveAlert=!1}),2e3)},doneAlert:function(t){var e=this;t&&setTimeout((function(){e.doneAlert=!1}),2e3)},notYetAlert:function(t){var e=this;t&&setTimeout((function(){e.notYetAlert=!1}),2e3)}}},d=(n(912),n(55)),l=n(65),m=n.n(l),f=n(667),h=n(165),v=n(162),component=Object(d.a)(c,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"college mt-0 mb-0 ml-0 mr-0"},[t.loading?n("div",{staticClass:"loading"},[n("div",{staticClass:"loading_inner"},[n("p",{staticClass:"loading_inner_text"},[t._v("Loading...")]),t._v(" "),n("vue-loading",{staticClass:"loading_inner_mark",attrs:{type:"beat",color:"gold",size:{width:"60px",height:"60px"}}})],1)]):t._e(),t._v(" "),n("v-alert",{staticClass:"alert",staticStyle:{top:"10px"},attrs:{color:"info",type:"success",transition:"slide-y-transition"},model:{value:t.saveAlert,callback:function(e){t.saveAlert=e},expression:"saveAlert"}},[t._v("\n    保存されました。\n  ")]),t._v(" "),n("v-alert",{staticClass:"alert",staticStyle:{top:"10px"},attrs:{color:"info",type:"success",transition:"slide-y-transition"},model:{value:t.doneAlert,callback:function(e){t.doneAlert=e},expression:"doneAlert"}},[t._v("\n    このルームが達成されました。\n  ")]),t._v(" "),n("v-alert",{staticClass:"alert",staticStyle:{top:"10px"},attrs:{color:"",type:"success",transition:"slide-y-transition"},model:{value:t.notYetAlert,callback:function(e){t.notYetAlert=e},expression:"notYetAlert"}},[t._v("\n    このルームが未達成されました。\n  ")]),t._v(" "),n("div",{staticClass:"mind_map_save"},[n("v-icon",{staticClass:"mr-3",attrs:{large:"",color:"info"},on:{click:function(e){return t.$router.push("/rooms")}}},[t._v("mdi-chevron-left")]),t._v(" "),1==t.room.done?n("v-icon",{staticClass:"mr-2",attrs:{color:"info"},on:{click:t.notYet}},[t._v("mdi-checkbox-marked-circle")]):n("v-icon",{staticClass:"mr-2",on:{click:t.done}},[t._v("mdi-checkbox-marked-circle-outline")]),t._v(" "),n("v-btn",{attrs:{small:"",color:"info"},on:{click:t.save}},[t._v("SAVE")])],1),t._v(" "),n("mindmap",{staticClass:"full_page",attrs:{params:t.$route.params.id}}),t._v(" "),n("v-icon",{staticClass:"help",attrs:{color:"gray"},on:{click:function(e){return t.$router.push("/help/")}}},[t._v("mdi-help-circle")])],1)}),[],!1,null,null,null);e.default=component.exports;m()(component,{Mindmap:n(689).default}),m()(component,{VAlert:f.a,VBtn:h.a,VIcon:v.a})}}]);